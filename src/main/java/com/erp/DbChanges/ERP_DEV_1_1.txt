// changes in rpt sequence
-- ptv_purchase_order_details_rpt source

-- ERP_DEV_1_1.ptv_purchase_order_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`ptv_purchase_order_details_rpt` AS
select
    concat(`v`.`purchase_order_no`, ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') AS `purchase_order_no`,
    concat(`v`.`purchase_order_date`, ':Purchase Order Date:Y:D:') AS `purchase_order_date`,
    concat(`v`.`purchase_order_version`, ':purchase Order Version:O:N:') AS `purchase_order_version`,
    concat(`v`.`purchase_order_item_status`, ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Bill Booked)') AS `purchase_order_status_desc`,
    concat(`v`.`purchase_order_type`, ':Purchase Order Type:O:N:') AS `purchase_order_type`,
    concat(`v`.`product_material_code`, ':Material Code:O:N:') AS `product_material_code`,
    concat(`v`.`product_material_name`, ':Material Name:O:N:') AS `product_material_name`,
    concat(`v`.`product_material_stock_unit_name`, ':Material Unit Name:O:N:') AS `product_material_stock_unit_name`,
    concat(`v`.`product_material_po_quantity`, ':Material Po Quantity:O:N:') AS `product_material_po_quantity`,
    concat(`v`.`product_material_po_weight`, ':Material Po Weight:O:N:') AS `product_material_po_weight`,
    concat(`v`.`material_rate`, ':Material Rate:O:N:') AS `material_rate`,
	concat(`v`.`material_basic_amount`, ':Material Basic Amount:O:N:') AS `material_basic_amount`,
    concat(`v`.`material_discount_percent`, ':Material Discount Percent:O:N:') AS `material_discount_percent`,
    concat(`v`.`material_discount_amount`, ':Material Discount Amount:O:N:') AS `material_discount_amount`,
    concat(`v`.`material_taxable_amount`, ':Material Taxable Amount:O:N:') AS `material_taxable_amount`,
    concat(`v`.`material_cgst_percent`, ':Material Cgst Percent:O:N:') AS `material_cgst_percent`,
    concat(`v`.`material_cgst_total`, ':Material Cgst Total:O:N:') AS `material_cgst_total`,
    concat(`v`.`material_sgst_percent`, ':Material Sgst Percent:O:N:') AS `material_sgst_percent`,
    concat(`v`.`material_sgst_total`, ':Material Sgst Total:O:N:') AS `material_sgst_total`,
    concat(`v`.`material_igst_percent`, ':Material Igst Percent:O:N:') AS `material_igst_percent`,
    concat(`v`.`material_igst_total`, ':Material Igst Total:O:N:') AS `material_igst_total`,
    concat(`v`.`material_total_amount`, ':Material Total Amount:O:N:') AS `material_total_amount`,
    concat(`v`.`product_material_po_approved_quantity`, ':Material Po Approved Quantity:O:N:') AS `product_material_po_approved_quantity`,
    concat(`v`.`product_material_po_approved_weight`, ':Material Po Approved Weight:O:N:') AS `product_material_po_approved_weight`,
    concat(`v`.`product_material_po_rejected_quantity`, ':Material Po Rejected Quantity:O:N:') AS `product_material_po_rejected_quantity`,
    concat(`v`.`product_material_po_rejected_weight`, ':Material Po Rejected Weight:O:N:') AS `product_material_po_rejected_weight`,
    concat(`v`.`material_po_approval_remark`, ':Material Po Approval Remark:O:N:') AS `material_po_approval_remark`,
    concat(`v`.`purchase_order_mail_sent_status`, ':Purchase Order Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') AS `purchase_order_mail_sent_status_desc`,
	concat(`v`.`material_schedule_date`, ':Material Schedule Date:Y:D:') AS `material_schedule_date`,
	concat(`v`.`approved_date`, ':Approved Date:Y:D:') AS `approved_date`,
	concat(`v`.`approved_by_name`, ':Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
	concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`hsn_sac_code`, ':Hsn Sac Code:O:N:') AS `hsn_sac_code`,
    concat(`v`.`hsn_sac_rate`, ':Hsn Sac Rate:O:N:') AS `hsn_sac_rate`,
    concat(`v`.`pree_closed_quantity`, ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(`v`.`pree_closed_weight`, ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(`v`.`purchase_return_quantity`, ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(`v`.`purchase_return_weight`, ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(`v`.`pending_quantity`, ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(`v`.`pending_weight`, ':Pending Weight:O:N:') AS `pending_weight`,
    concat(`v`.`excess_quantity`, ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(`v`.`excess_weight`, ':Excess Weight:O:N:') AS `excess_weight`,
    concat(`v`.`production_issue_quantity`, ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(`v`.`production_issue_weight`, ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(`v`.`production_issue_return_quantity`, ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(`v`.`production_issue_return_weight`, ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(`v`.`production_issue_rejection_quantity`, ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(`v`.`production_issue_rejection_weight`, ':Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(`v`.`assembly_production_issue_quantity`, ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(`v`.`assembly_production_issue_weight`, ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(`v`.`sales_quantity`, ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(`v`.`sales_weight`, ':Sales Weight:O:N:') AS `sales_weight`,
    concat(`v`.`sales_return_quantity`, ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(`v`.`sales_return_weight`, ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(`v`.`sales_rejection_quantity`, ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(`v`.`sales_rejection_weight`, ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(`v`.`transfer_issue_quantity`, ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(`v`.`transfer_issue_weight`, ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(`v`.`transfer_receipt_quantity`, ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(`v`.`transfer_receipt_weight`, ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(`v`.`outsources_out_quantity`, ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(`v`.`outsources_out_weight`, ':Outsourcess Out Weight:O:N:') AS `outsources_out_weight`,
    concat(`v`.`outsources_in_quantity`, ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(`v`.`outsources_in_weight`, ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(`v`.`outsources_rejection_quantity`, ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(`v`.`outsources_rejection_weight`, ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(`v`.`loan_receipt_quantity`, ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(`v`.`loan_receipt_weight`, ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(`v`.`loan_issue_quantity`, ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(`v`.`loan_issue_weight`, ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(`v`.`cancel_quantity`, ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(`v`.`prev_grn_quantity`, ':Cancel Quantity:O:N:') AS `prev_grn_quantity`,
    concat(`v`.`prev_grn_weight`, ':Cancel Quantity:O:N:') AS `prev_grn_weight`,
    concat(`v`.`cancel_weight`, ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(`v`.`difference_quantity`, ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(`v`.`difference_weight`, ':Difference Weight:O:N:') AS `difference_weight`,
    concat(`v`.`lead_time`, ':Lead Time:O:N:') AS `lead_time`,
    concat(`v`.`supplier_name`, ':Supplier Name:O:N:') AS `supplier_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:N:') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':Customer State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`indent_no`, ':Indent No:O:N:ptv_purchase_order_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indented_by_name`, ':Indented By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`sr_no`, ':Sr No:O:N:') AS `sr_no`,
    concat(`v`.`so_sr_no`, ':So Sr No:O:N:') AS `so_sr_no`,
    concat(`v`.`product_type_short_name`, ':Product Type Short Name:O:N:') AS `product_type_short_name`,
    concat(`v`.`product_type_group`, ':Product Type Group:O:N:') AS `product_type_group`,
    concat(`v`.`product_material_print_name`, ':Material Print Name:O:N:') AS `product_material_print_name`,
    concat(`v`.`product_material_tech_spect`, ':Material Tech Spect:O:N:') AS `product_material_tech_spect`,
    concat(`v`.`product_packing_name`, ':Product Packing Name:O:N:') AS `product_packing_name`,
    concat(`v`.`hsn_sac_type`, ':Hsn Sac Type:O:N:') AS `hsn_sac_type`,
    concat(`v`.`hsn_sac_description`, ':Hsn Sac Description:O:N:') AS `hsn_sac_description`,
    concat(`v`.`product_material_conversion_factor`, ':Material Conversion Factor:O:N:') AS `product_material_conversion_factor`,
    concat(`v`.`purchase_order_status`, ':Purchase Order Status:O:N:') AS `purchase_order_status`,
    concat(`v`.`purchase_order_item_status`, ':Purchase Order Item Status:O:N:') AS `purchase_order_item_status`,
    concat(`v`.`purchase_order_mail_sent_status`, ':Purchase Order Mail Sent Status:O:N:') AS `purchase_order_mail_sent_status`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`city_name`, ':City Name:O:N:') AS `city_name`,
    concat(`v`.`district_name`, ':District Name:O:N:') AS `district_name`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`product_type_name`, ':Product Type Name:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`supplier_id`, ':Supplier Id:N:N:') AS `supplier_id`,
    concat(`v`.`supplier_state_id`, ':Supplier State Id:N:N:') AS `supplier_state_id`,
    concat(`v`.`supplier_city_id`, ':Supplier City Id:N:N:') AS `supplier_city_id`,
    concat(`v`.`supplier_contacts_ids`, ':Supplier Contacts Ids:N:N:') AS `supplier_contacts_ids`,
    concat(`v`.`purchase_order_type_id`, ':Purchase Order Type Id:N:N:') AS `purchase_order_type_id`,
    concat(`v`.`purchase_order_master_transaction_id`, ':Purchase Order Master Transaction Id:O:N:') AS `purchase_order_master_transaction_id`,
    concat(`v`.`purchase_order_details_transaction_id`, ':Purchase Order Details Transaction_id:N:N:') AS `purchase_order_details_transaction_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_material_unit_id`, ':Product Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`product_material_packing_id`, ':Product Material Packing Id:N:N:') AS `product_material_packing_id`,
    concat(`v`.`product_material_hsn_code_id`, ':Product Material Hsn Code Id:N:N:') AS `product_material_hsn_code_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`approved_by_id`, ':Approved By Id:N:N:') AS `approved_by_id`
from
    `ERP_DEV_1_1`.`ptv_purchase_order_details` `v`
limit 1;

//---------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.ptv_purchase_order_master_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`ptv_purchase_order_master_summary_rpt` AS
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') AS `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') AS `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') AS `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') AS `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') AS `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') AS `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') AS `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') AS `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') AS `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') AS `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') AS `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') AS `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') AS `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') AS `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') AS `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') AS `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') AS `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') AS `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') AS `grand_total`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:C:cmv_employee_list:F') AS `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') AS `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_process_entry_desc`, ''), ':Purchase Process Entry:Y:H:(Manual,Open)') AS `purchase_process_entry_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') AS `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') AS `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') AS `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') AS `status_remark`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') AS `supplier_code`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') AS `supplier_type`,
    concat(ifnull(`v`.`supplier_short_name`, ''), ':Supplier Short Name:O:N:') AS `supplier_short_name`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Branch Address1:O:N:') AS `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Branch Pincode:O:N:') AS `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') AS `city_name`,
    concat(ifnull(`v`.`district_name`, ''), ':District Name:O:N:') AS `district_name`,
    concat(ifnull(`v`.`state_name`, ''), ':State Name:O:N:') AS `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Branch Phone No:O:N:') AS `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Branch EmailId:O:N:') AS `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Branch Name:O:N:') AS `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Branch Short Name:O:N:') AS `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Branch Address1:O:N:') AS `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Branch Pincode:O:N:') AS `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Branch City Name:O:N:') AS `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_district_name`, ''), ':Branch District Name:O:N:') AS `expected_branch_district_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Branch State Name:O:N:') AS `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Branch Phone No:O:N:') AS `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Expected Branch EmailId:O:N:') AS `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') AS `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') AS `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') AS `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') AS `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') AS `product_type_short_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') AS `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') AS `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_description`, ''), ':Hsn Sac Description:O:N:') AS `hsn_sac_description`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') AS `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') AS `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') AS `purchase_order_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') AS `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') AS `purchase_order_life`,
    concat(ifnull(`v`.`purchase_process_entry`, ''), ':Purchase Process Entry:O:N:') AS `purchase_process_entry`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') AS `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') AS `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') AS `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') AS `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') AS `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') AS `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') AS `expected_branch_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:N:N:') AS `approved_by_id`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:N:N:') AS `purchase_order_mail_sent_status`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:N:N:') AS `purchase_order_acceptance_status`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') AS `agent_id`
from
    `ERP_DEV_1_1`.`ptv_purchase_order_master_summary` `v`
limit 1;

//------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.stv_indent_master_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`stv_indent_master_summary_rpt` AS
select
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indent_type`, ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(`v`.`indent_status_desc`, ':Indent Status:Y:H:(Pending, Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(`v`.`indent_source_desc`, ':Indent Source:Y:H:(SO Based, Direct,Indent Based)') AS `indent_source_desc`,
	concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
	concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(`v`.`customer_order_date`, ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`indented_by_name`, ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`approved_by_name`, ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(`v`.`approved_date`, ':Approved Date:Y:D:') AS `approved_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`v`.`indent_source`, ':Indent Source:O:N:') AS `indent_source`,
    concat(`v`.`indent_status`, ':Indent Status:O:N:') AS `indent_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`indent_master_id`, ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(`v`.`indent_type_id`, ':Intdent Type Id:N:N:') AS `indent_type_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indeneted By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`indent_no`, ':Indent No:N:N:') AS `field_name`,
    concat(`v`.`indent_version`, ':Indent Version:N:N:') AS `field_id`
from
    `ERP_DEV_1_1`.`stv_indent_master_summary` `v`
limit 1;

//--------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.stv_indent_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`stv_indent_details_rpt` AS
select
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indent_type`, ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(`v`.`indent_status_desc`, ':Indent Status:Y:H:(Pending, Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(`v`.`department_name`, ':Department:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`product_type_name`, ':Product Type Name:O:N:') AS `product_type_name`,
    concat(`v`.`product_rm_name`, ':Material name:O:N:') AS `product_rm_name`,
    concat(`v`.`product_rm_stock_unit_name`, ':Material Stock Unit Name:O:N:') AS `product_rm_stock_unit_name`,
    concat(`v`.`product_material_quantity`, ':Material Quantity:O:N:') AS `product_material_quantity`,
    concat(`v`.`product_material_weight`, ':Material Weight:O:N:') AS `product_material_weight`,
    concat(`v`.`product_material_stock_quantity`, ':Material Stock Quantity:O:N:') AS `product_material_stock_quantity`,
    concat(`v`.`product_material_stock_weight`, ':Material Stock Weight:O:N:') AS `product_material_stock_weight`,
    concat(`v`.`product_material_reserve_quantity`, ':Material Reserve Quantity:O:N:') AS `product_material_reserve_quantity`,
    concat(`v`.`product_material_reserve_weight`, ':Material Reserve Weight:O:N:') AS `product_material_reserve_weight`,
    concat(`v`.`product_material_approved_quantity`, ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(`v`.`product_material_approved_weight`, ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(`v`.`product_material_rejected_quantity`, ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(`v`.`product_material_rejected_weight`, ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(`v`.`product_material_return_quantity`, ':Material Return Quantity:O:N:') AS `product_material_return_quantity`,
    concat(`v`.`product_material_return_weight`, ':Material Return Weight:O:N:') AS `product_material_return_weight`,
    concat(`v`.`product_material_receipt_quantity`, ':Material Receipt Quantity:O:N:') AS `product_material_receipt_quantity`,
    concat(`v`.`product_material_receipt_weight`, ':Material Receipt Weight:O:N:') AS `product_material_receipt_weight`,
    concat(`v`.`product_child_bom_quantity`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_quantity`,
    concat(`v`.`product_child_bom_weight`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_weight`,
    concat(`v`.`product_parent_fg_name`, ':Parent Finish Goods Name:O:N:') AS `product_parent_fg_name`,
    concat(`v`.`product_fg_material_quantity`, ':Fg Material Quantity:O:N:') AS `product_fg_material_quantity`,
    concat(`v`.`product_fg_material_weight`, ':Fg Material Weight:O:N:') AS `product_fg_material_weight`,
    concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(`v`.`customer_order_date`, ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(`v`.`indented_by_name`, ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`approved_by_name`, ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(`v`.`product_rm_tech_spect`, ':Material Tech spec:O:N:') AS `product_rm_tech_spect`,
    concat(`v`.`product_rm_drawing_no`, ':Material Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(`v`.`product_rm_oem_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_oem_part_code`,
    concat(`v`.`product_rm_our_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_our_part_code`,
    concat(`v`.`product_category1_name`, ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(`v`.`product_category2_name`, ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(`v`.`product_category3_name`, ':Product Category3 Name:O:N:') AS `product_category3_name`,
    concat(`v`.`product_category4_name`, ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(`v`.`product_category5_name`, ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(`v`.`product_make_name`, ':Product Make Name:O:N:') AS `product_make_name`,
    concat(`v`.`product_material_type_name`, ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(`v`.`product_material_grade_name`, ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(`v`.`lead_time`, ':Lead Time:O:N:') AS `lead_time`,
    concat(`v`.`so_sr_no`, ':So Sr No:O:N:') AS `so_sr_no`,
    concat(`v`.`issued_by_name`, ':Issued By:Y:C:cmv_employee_list:F') AS `issued_by_name`,
    concat(`v`.`issued_date`, ':Issued Date:Y:D:') AS `issued_date`,
    concat(`v`.`indent_item_status`, ':Indent Item Status:O:N:') AS `indent_item_status`,
    concat(`v`.`indent_status`, ':Indent Status:O:N:') AS `indent_status`,
    concat(`v`.`indent_source`, ':Indent Source:O:N:') AS `indent_source`,
    concat(`v`.`remark`, 'remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`product_fg_id`, ':Product Fg Id:N:N:') AS `product_fg_id`,
    concat(`v`.`product_material_unit_id`, ':Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_type_id`, ':Product Type Id:N:N:') AS `product_type_id`,
    concat(`v`.`product_category1_id`, ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(`v`.`product_category2_id`, ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(`v`.`product_category3_id`, ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(`v`.`product_category4_id`, ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(`v`.`product_category5_id`, ':Product Category5 Id:N:N:') AS `product_category5_id`,
    concat(`v`.`product_make_id`, ':Product Make Id:N:N:') AS `product_make_id`,
    concat(`v`.`product_material_type_id`, ':Product Material Type Id:N:N:') AS `product_material_type_id`,
    concat(`v`.`product_material_grade_id`, ':Product Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(`v`.`indent_master_id`, ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(`v`.`indent_details_id`, ':Indent Details Id:N:N:') AS `indent_details_id`,
    concat(`v`.`indent_type_id`, ':Indent Type Id:N:N:') AS `indent_type_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`indent_no`, ':Indent No:N:N:') AS `field_name`,
    concat(`v`.`indent_version`, ':Indent Version:N:N:') AS `field_id`
from
    `ERP_DEV_1_1`.`stv_indent_details` `v`
limit 1;


//------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.ptv_goods_receipt_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`ptv_goods_receipt_details_rpt` AS
select
    concat(`v`.`goods_receipt_no`, ':Goods Receipt No:Y:C:ptv_goods_receipt_details:O') AS `goods_receipt_no`,
    concat(`v`.`goods_receipt_date`, ':Goods Receipt Date:Y:D:') AS `goods_receipt_date`,
    concat(`v`.`goods_receipt_version`, ':Goods Receipt Version:O:N:') AS `goods_receipt_version`,
    concat(`v`.`goods_receipt_type`, ':Goods Receipt Type:O:N:') AS `goods_receipt_type`,
    concat(`v`.`grn_item_status`, ':Grn Item Status:Y:H:(GRN,Done,Rejected,Partial Receipt,Completed,Canceled,Pree Closed)') AS `grn_item_status_desc`,
    concat(`v`.`purchase_order_no`, ':Purchase Order No:O:N:') AS `purchase_order_no`,
    concat(`v`.`purchase_order_date`, ':Purchase Order Date:Y:D:') AS `purchase_order_date`,
    concat(`v`.`purchase_order_version`, ':Purchase Order Version:O:N:') AS `purchase_order_version`,
    concat(`v`.`purchase_order_item_status`, ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending,Pree Closed)') AS `purchase_order_item_status_desc`,
    concat(`v`.`supplier_challan_no`, ':Supplier Challan No:O:N:') AS `supplier_challan_no`,
    concat(`v`.`supplier_challan_date`, ':Supplier Challan Date:Y:D:') AS `supplier_challan_date`,
    concat(`v`.`product_material_name`, ':Product Material Name:O:N:') AS `product_material_name`,
    concat(`v`.`product_material_std_weight`, ':Product Std Weight:O:N:') AS `product_material_std_weight`,
    concat(`v`.`product_material_stock_unit_name`, ':Product Material Stock Unit Name:O:N:') AS `product_material_stock_unit_name`,
    concat(`v`.`supplier_name`, ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(`v`.`supplier_city_name`, ':Supplier City Name:O:N:') AS `supplier_city_name`,
    concat(`v`.`supplier_state_name`, ':Supplier State Name:Y:C:cmv_state:O') AS `supplier_state_name`,
    concat(`v`.`material_rate`, ':Material Rate:O:N:') AS `material_rate`,
    concat(`v`.`material_basic_amount`, ':Material Basic Amount:O:N:') AS `material_basic_amount`,
    concat(`v`.`material_discount_percent`, ':Material Discount Percent:O:N:') AS `material_discount_percent`,
    concat(`v`.`material_discount_amount`, ':Material Discount Amount:O:N:') AS `material_discount_amount`,
    concat(`v`.`material_taxable_amount`, ':Material Taxable Amount:O:N:') AS `material_taxable_amount`,
    concat(`v`.`material_cgst_percent`, ':Material Cgst Percent:O:N:') AS `material_cgst_percent`,
    concat(`v`.`material_cgst_total`, ':Material Cgst Total:O:N:') AS `material_cgst_total`,
    concat(`v`.`material_sgst_percent`, ':Material Sgst Percent:O:N:') AS `material_sgst_percent`,
    concat(`v`.`material_sgst_total`, ':Material Sgst Total:O:N:') AS `material_sgst_total`,
    concat(`v`.`material_igst_percent`, ':Material Igst Percent:O:N:') AS `material_igst_percent`,
    concat(`v`.`material_igst_total`, ':Material Igst Total:O:N:') AS `material_igst_total`,
    concat(`v`.`material_total_amount`, ':Material Total Amount:O:N:') AS `material_total_amount`,
    concat(`v`.`material_schedule_date`, ':Material Schedule Date:Y:D:') AS `material_schedule_date`,
    concat(`v`.`product_material_conversion_factor`, ':Material Conversion Factor:O:N:') AS `product_material_conversion_factor`,
    concat(`v`.`prev_grn_quantity`, ':Cancel Quantity:O:N:') AS `prev_grn_quantity`,
    concat(`v`.`prev_grn_weight`, ':Cancel Quantity:O:N:') AS `prev_grn_weight`,
    concat(`v`.`product_material_po_approved_quantity`, ':Material Po Approved Quantity:O:N:') AS `product_material_po_approved_quantity`,
    concat(`v`.`product_material_po_approved_weight`, ':Material Po Approved Weight:O:N:') AS `product_material_po_approved_weight`,
    concat(`v`.`product_material_grn_quantity`, ':Material Po Approved Quantity:O:N:') AS `product_material_grn_quantity`,
    concat(`v`.`product_material_grn_weight`, ':Material Po Approved Weight:O:N:') AS `product_material_grn_weight`,
    concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer:O') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(`v`.`customer_order_Date`, ':Customer Order Date:Y:D:') AS `customer_order_Date`,
    concat(`v`.`item_qa_by_id`, ':Item QA By Id:O:N:') AS `item_qa_by_id`,
    concat(`v`.`item_qa_date`, ':Item QA Date:Y:D:') AS `item_qa_date`,
    concat(`v`.`product_material_tech_spect`, ':Product Material Tech Spect:O:N:') AS `product_material_tech_spect`,
    concat(`v`.`lead_time`, ':Lead Time:O:N:') AS `lead_time`,
    concat(`v`.`sr_no`, ':Sr No:O:N:') AS `sr_no`,
    concat(`v`.`purchase_order_status`, ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') AS `purchase_order_status_desc`,
    concat(`v`.`purchase_order_status`, ':Purchase Order Status:O:N:') AS `purchase_order_status`,
    concat(`v`.`purchase_order_item_status`, ':Purchase Order Item Status:O:N:') AS `purchase_order_item_status`,
    concat(`v`.`product_material_type_group`, ':Product Material Type Group:O:N:') AS `product_material_type_group`,
    concat(`v`.`product_type_short_name`, ':Product Type Short_name:O:N:') AS `product_type_short_name`,
    concat(`v`.`product_make_name`, ':Make Name:O:N:') AS `product_make_name`,
    concat(`v`.`product_packing_name`, ':Packing Name:O:N:') AS `product_packing_name`,
    concat(`v`.`product_category1_name`, ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(`v`.`product_category2_name`, ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(`v`.`product_category3_name`, ':product Category3 Name:O:N:') AS `product_category3_name`,
    concat(`v`.`product_category4_name`, ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(`v`.`product_category5_name`, ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(`v`.`product_material_type_name`, ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(`v`.`product_material_grade_name`, ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(`v`.`product_material_shape_name`, ':Material Shape Name:O:N:') AS `product_material_shape_name`,
    concat(`v`.`product_material_oem_part_code`, ':Material Oem Part Code:O:N:') AS `product_material_oem_part_code`,
    concat(`v`.`product_material_our_part_code`, ':Material Our Part Code:O:N:') AS `product_material_our_part_code`,
    concat(`v`.`product_material_drawing_no`, ':Product Material Drawing No:O:N:') AS `product_material_drawing_no`,
    concat(`v`.`product_material_hsn_sac_code`, ':Product Material Hsn Sac Code:O:N:') AS `product_material_hsn_sac_code`,
    concat(`v`.`hsn_sac_type`, ':Hsn Sac Type:O:N:') AS `hsn_sac_type`,
    concat(`v`.`hsn_sac_code`, ':Hsn Sac Type:O:N:') AS `hsn_sac_code`,
    concat(`v`.`hsn_sac_description`, ':Hsn Sac Description:O:N:') AS `hsn_sac_description`,
    concat(`v`.`hsn_sac_rate`, ':Hsn Sac Rate:O:N:') AS `hsn_sac_rate`,
    concat(`v`.`grn_item_status`, ':Grn Item Status:O:N:') AS `grn_item_status`,
    concat(`v`.`excess_quantity`, ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(`v`.`excess_weight`, ':Excess Weight:O:N:') AS `excess_weight`,
    concat(`v`.`pree_closed_grn_quantity`, ':Pree Closed Grn Quantity:O:N:') AS `pree_closed_grn_quantity`,
    concat(`v`.`pree_closed_grn_weight`, ':Pree Closed Grn Weight:O:N:') AS `pree_closed_grn_weight`,
    concat(`v`.`purchase_return_quantity`, ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(`v`.`purchase_return_weight`, ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(`v`.`production_issue_quantity`, ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(`v`.`production_issue_weight`, ':Issue weight:O:N:') AS `production_issue_weight`,
    concat(`v`.`production_issue_return_quantity`, ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(`v`.`production_issue_return_weight`, ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(`v`.`production_issue_rejection_quantity`, ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(`v`.`production_issue_rejection_weight`, ':Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(`v`.`assembly_production_issue_quantity`, ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(`v`.`assembly_production_issue_weight`, ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(`v`.`product_material_prev_accepted_quantity`, ':Material Prev Accepted Quantity:O:N:') AS `product_material_prev_accepted_quantity`,
    concat(`v`.`product_material_prev_accepted_weight`, ':Material Prev Accepted Weight:O:N:') AS `product_material_prev_accepted_weight`,
    concat(`v`.`purchase_order_life`, ':Purchase Order Life:O:N:') AS `purchase_order_life`,
    concat(`v`.`sales_quantity`, ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(`v`.`sales_weight`, ':Sales Weight:O:N:') AS `sales_weight`,
    concat(`v`.`sales_return_quantity`, ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(`v`.`sales_return_weight`, ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(`v`.`sales_rejection_quantity`, ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(`v`.`sales_rejection_weight`, ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(`v`.`transfer_issue_weight`, ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(`v`.`transfer_receipt_quantity`, ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(`v`.`transfer_receipt_weight`, ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(`v`.`outsources_out_quantity`, ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(`v`.`outsources_out_weight`, ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(`v`.`outsources_in_quantity`, ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(`v`.`outsources_in_weight`, ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(`v`.`outsources_rejection_quantity`, ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(`v`.`outsources_rejection_weight`, ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(`v`.`loan_receipt_quantity`, ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(`v`.`loan_receipt_weight`, ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(`v`.`loan_issue_quantity`, ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(`v`.`loan_issue_weight`, ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(`v`.`cancel_quantity`, ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(`v`.`cancel_weight`, ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(`v`.`difference_quantity`, ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(`v`.`difference_weight`, ':Difference Weight:O:N:') AS `difference_weight`,
    concat(`v`.`expiry_date`, ':Expiry Date:Y:D:') AS `expiry_date`,
    concat(`v`.`indent_no`, ':Indent No:O:N:') AS `indent_no`,
    concat(`v`.`remark`, ':remark:O:N:') AS `remark`,
    concat(`v`.`product_type_name`, ':Product Type Name:O:N:') AS `product_type_name`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`goods_receipt_details_transaction_id`, 'goods_receipt_details_transaction_id:N:N:') AS `goods_receipt_details_transaction_id`,
    concat(`v`.`product_material_unit_id`, ':Product Material Unit_id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`product_material_packing_id`, ':Product Material Packing_id:N:N:') AS `product_material_packing_id`,
    concat(`v`.`product_material_hsn_code_id`, ':Product Material Hsn Code_id:N:N:') AS `product_material_hsn_code_id`,
    concat(`v`.`goods_receipt_type_id`, ':Goods Receipt Type Id:N:N:') AS `goods_receipt_type_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`supplier_id`, ':Supplier Id:N:N:') AS `supplier_id`,
    concat(`v`.`approved_by_id`, ':Approved By:N:N:') AS `approved_by_id`,
    concat(`v`.`supplier_state_id`, ':Supplier State Id:N:N:') AS `supplier_state_id`,
    concat(`v`.`supplier_city_id`, ':Supplier City Id:N:N:') AS `supplier_city_id`,
    concat(`v`.`supplier_contacts_ids`, ':Supplier Contacts Ids:N:N:') AS `supplier_contacts_ids`,
    concat(`v`.`expected_branch_id`, ':Expected Branch Id:N:N:') AS `expected_branch_id`,
    concat(`v`.`expected_branch_state_id`, ':Expected Branch State Id:N:N:') AS `expected_branch_state_id`,
    concat(`v`.`expected_branch_city_id`, ':Expected Branch City Id:N:N:') AS `expected_branch_city_id`,
    concat(`v`.`payment_term_id`, ':Payment Term Id:N:N:') AS `payment_term_id`,
    concat(`v`.`agent_id`, ':Agent Id:N:N:') AS `agent_id`,
    concat(`v`.`product_type_id`, ':Product Type Id:N:N:') AS `product_type_id`,
    concat(`v`.`product_material_type_id`, ':Material Type Id:N:N:') AS `product_material_type_id`,
    concat(`v`.`product_material_stock_unit_id`, ':Material Stock Unit Id:N:N:') AS `product_material_stock_unit_id`,
    concat(`v`.`product_material_grade_id`, ':Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(`v`.`product_material_shape_id`, ':Material Shape Id:N:N:') AS `product_material_shape_id`,
    concat(`v`.`product_category1_id`, ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(`v`.`product_category2_id`, ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(`v`.`product_category3_id`, ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(`v`.`product_category4_id`, ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(`v`.`product_category5_id`, ':Product Category5 Id:N:N:') AS `product_category5_id`
from
    `ERP_DEV_1_1`.`ptv_goods_receipt_details` `v`
limit 1;





// Changes related product_material_sz_balance_quantity by AKshay
// 05-04-2024

-- ERP_DEV_1_1.xtv_weaving_production_material source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`xtv_weaving_production_material` AS
select
    `xt`.`production_order_no` AS `production_order_no`,
    `xt`.`production_order_date` AS `production_order_date`,
    `s`.`production_sub_section_name` AS `production_sub_section_name`,
    `s`.`production_section_name` AS `production_section_name`,
    `sm`.`product_material_name` AS `product_material_name`,
    `sm`.`product_material_code` AS `product_material_code`,
    `sm`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `u`.`product_unit_name` AS `product_material_unit_name`,
    `xt`.`set_no` AS `set_no`,
    `xt`.`product_material_quantity` AS `product_material_quantity`,
    `s`.`production_section_short_name` AS `production_section_short_name`,
    `s`.`production_sub_section_short_name` AS `production_sub_section_short_name`,
    ifnull((select sum(`st`.`closing_balance_quantity`) from `ERP_DEV_1_1`.`sm_product_rm_stock_summary` `st` where `st`.`product_rm_id` = `xt`.`product_material_id` and `st`.`company_id` = `xt`.`company_id` and `st`.`is_delete` = 0), 0) AS `stock_quantity`,
    (
    select
        ifnull(`wp`.`product_material_quantity` - sum(`wp`.`consumption_quantity`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_warping_material` `wp`
    where
        `wp`.`weaving_production_set_no` = `xt`.`set_no`
        and `wp`.`product_material_id` = `xt`.`product_material_id`
        and `wp`.`is_delete` = 0) AS `product_material_balance_quantity`,
    (
    select
        ifnull(`xt`.`product_material_quantity` - sum(`sz`.`consumption_quantity`), `xt`.`product_material_quantity`)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_sizing_material` `sz`
    where
        `sz`.`weaving_production_set_no` = `xt`.`set_no`
        and `sz`.`product_material_id` = `xt`.`product_material_id`
        and `sz`.`is_delete` = 0) AS `product_material_sz_balance_quantity`,
    (
    select
        ifnull(`xt`.`product_material_quantity` - sum(`im`.`consumption_quantity`), `xt`.`product_material_quantity`)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_material` `im`
    where
        `im`.`inspection_production_set_no` = `xt`.`set_no`
        and `im`.`product_material_id` = `xt`.`product_material_id`
        and `im`.`is_delete` = 0) AS `product_inspection_material_balance_quantity`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `xt`.`is_active` AS `is_active`,
    `xt`.`is_delete` AS `is_delete`,
    `xt`.`created_by` AS `created_by`,
    `xt`.`created_on` AS `created_on`,
    `xt`.`modified_by` AS `modified_by`,
    `xt`.`modified_on` AS `modified_on`,
    `xt`.`deleted_by` AS `deleted_by`,
    `xt`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `xt`.`financial_year` AS `financial_year`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `s`.`production_section_id` AS `production_section_id`,
    `s`.`production_sub_section_id` AS `production_sub_section_id`,
    `xt`.`production_order_material_id` AS `production_order_material_id`,
    `xt`.`weaving_production_order_id` AS `weaving_production_order_id`,
    `xt`.`product_material_id` AS `product_material_id`,
    `xt`.`product_material_unit_id` AS `product_material_unit_id`,
    `xt`.`production_order_material_id` AS `field_id`,
    `xt`.`production_order_no` AS `field_name`
from
    ((((`ERP_DEV_1_1`.`xt_weaving_production_material` `xt`
left join `ERP_DEV_1_1`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xm_production_sub_section` `s` on
    (`s`.`company_id` = `xt`.`company_id`
        and `s`.`production_sub_section_id` = `xt`.`production_sub_section_id`))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `sm` on
    (`sm`.`company_id` = `xt`.`company_id`
        and `sm`.`product_material_id` = `xt`.`product_material_id`))
left join `ERP_DEV_1_1`.`sm_product_unit` `u` on
    (`u`.`company_id` = `xt`.`company_id`
        and `u`.`product_unit_id` = `xt`.`product_material_unit_id`))
where
    `xt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
// Changes joins from view to table by AKshay
// 06-04-2024

-- xtv_spinning_production_rf_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`xtv_spinning_production_rf_details` AS
select
    `sp`.`spinning_production_date` AS `spinning_production_date`,
    `sm`.`shift` AS `shift`,
    `sm`.`prod_month` AS `prod_month`,
    `sm`.`prod_year` AS `prod_year`,
    `sp`.`spinning_production_rf_code` AS `spinning_production_rf_code`,
    `s`.`plant_name` AS `plant_name`,
    `s`.`production_sub_section_name` AS `production_sub_section_name`,
    `s`.`production_section_name` AS `production_section_name`,
    `sm`.`spinn_plan_code` AS `spinn_plan_code`,
    `e`.`employee_name` AS `production_supervisor`,
    `e1`.`employee_name` AS `production_operator`,
    `s`.`production_section_short_name` AS `production_section_short_name`,
    `s`.`production_sub_section_short_name` AS `production_sub_section_short_name`,
    `mc`.`machine_name` AS `machine_name`,
    `mc`.`machine_short_name` AS `machine_short_name`,
    `ct`.`production_count_name` AS `production_count_name`,
    `sp`.`actual_count` AS `actual_count`,
    `sp`.`speed` AS `speed`,
    `sp`.`tpi` AS `tpi`,
    `sp`.`tm` AS `tm`,
    `sp`.`spindle_utilisation_per` AS `spindle_utilisation_per`,
    `sp`.`install_spindles` AS `install_spindles`,
    `sp`.`work_spindles` AS `work_spindles`,
    `sp`.`ideal_spindle` AS `ideal_spindle`,
    `sp`.`efficiency_percent` AS `efficiency_percent`,
    `sp`.`grams_100` AS `grams_100`,
    `sp`.`grams_target` AS `grams_target`,
    `sp`.`grams_actual` AS `grams_actual`,
    `sp`.`kgs_100` AS `kgs_100`,
    `sp`.`kgs_target` AS `kgs_target`,
    `sp`.`kgs_actual` AS `kgs_actual`,
    `sp`.`efficiency_target` AS `efficiency_target`,
    `sp`.`prod_loss_with_reason` AS `prod_loss_with_reason`,
    `sp`.`prod_loss_with_out_reason` AS `prod_loss_with_out_reason`,
    `sp`.`waste_percent` AS `waste_percent`,
    `sp`.`production_mixing` AS `production_mixing`,
    `sp`.`production_count_desc` AS `production_count_desc`,
    `sp`.`conversion_40s` AS `conversion_40s`,
    `sp`.`total_stopage_time` AS `total_stopage_time`,
    `sp`.`total_stopage_spindles` AS `total_stopage_spindles`,
    `sp`.`yarn_construction` AS `yarn_construction`,
    `sp`.`yarn_count` AS `yarn_count`,
    case
        `sp`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sp`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sp`.`is_active` AS `is_active`,
    `sp`.`is_delete` AS `is_delete`,
    `sp`.`created_by` AS `created_by`,
    `sp`.`created_on` AS `created_on`,
    `sp`.`modified_by` AS `modified_by`,
    `sp`.`modified_on` AS `modified_on`,
    `sp`.`deleted_by` AS `deleted_by`,
    `sp`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sp`.`financial_year` AS `financial_year`,
    `sp`.`company_id` AS `company_id`,
    `sp`.`company_branch_id` AS `company_branch_id`,
    `sm`.`spinning_production_rf_summary_id` AS `spinning_production_rf_summary_id`,
    `sm`.`spinning_production_rf_master_id` AS `spinning_production_rf_master_id`,
    `sp`.`spinning_production_rf_details_id` AS `spinning_production_rf_details_id`,
    `sm`.`spinning_production_rf_stopage_id` AS `spinning_production_rf_stopage_id`,
    `sm`.`spinning_production_rf_wastage_id` AS `spinning_production_rf_wastage_id`,
    `sp`.`machine_id` AS `machine_id`,
    `sm`.`plant_id` AS `plant_id`,
    `sm`.`section_id` AS `section_id`,
    `sm`.`sub_section_id` AS `sub_section_id`,
    `sp`.`production_operator_id` AS `production_operator_id`,
    `sp`.`production_count_id` AS `production_count_id`,
    `sm`.`production_supervisor_id` AS `production_supervisor_id`
from
    (((((((`ERP_PASHUPATI_DEV_1_0`.`xt_spinning_production_rf_details` `sp`
left join `ERP_PASHUPATI_DEV_1_0`.`xt_spinning_production_rf_master` `sm` on
    (`sp`.`spinning_production_rf_master_id` = `sm`.`spinning_production_rf_master_id`
        and `sp`.`company_id` = `sm`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`sp`.`company_id` = `v`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_production_sub_section` `s` on
    (`s`.`company_id` = `sp`.`company_id`
        and `s`.`production_sub_section_id` = `sp`.`sub_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`sm`.`production_supervisor_id` = `e`.`employee_id`
        and `sm`.`company_id` = `e`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`sp`.`production_operator_id` = `e1`.`employee_id`
        and `sp`.`company_id` = `e1`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_spinning_prod_count` `ct` on
    (`sp`.`production_count_id` = `ct`.`production_count_id`
        and `sp`.`company_id` = `ct`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_machine` `mc` on
    (`sp`.`machine_id` = `mc`.`machine_id`
        and `sp`.`company_id` = `mc`.`company_id`))
where
    `sp`.`is_delete` = 0
order by
    `sm`.`spinning_production_date` desc,
    `sm`.`shift` desc,
    `mc`.`machine_short_name` desc;


// Created a rpt view for ring frame production report by AKshay
// 06-04-2024

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`xtv_spinning_production_rf_report_rpt` AS
select
	concat(ifnull(`v`.`machine_short_name`, ''), ':M/C No:O:N:') AS `machine_short_name`,
	concat(ifnull(`v`.`production_operator`, ''), ':Production Operator:O:N:') AS `production_operator`,
	concat(ifnull(`v`.`actual_count`, ''), ':Actual Count:Y:T:') AS `actual_count`,
    concat(ifnull(`v`.`tpi`, ''), ':TPI:O:N:') AS `tpi`,
    concat(ifnull(`v`.`tm`, ''), ':TM:O:N:') AS `tm`,
    concat(ifnull(`v`.`speed`, ''), ':SPL Speed:O:N:') AS `speed`,
    concat(ifnull(`v`.`install_spindles`, ''), ':Install Spindles:O:N:') AS `install_spindles`,
 	concat(ifnull(`v`.`grams_100`, ''), ':100% Grams:Y:T:') AS `grams_100`,
 	concat(ifnull(`v`.`kgs_100`, ''), ':kgs 100:Y:T:') AS `kgs_100`,
    concat(ifnull(`v`.`grams_target`, ''), ':Grams Target:Y:T:') AS `grams_target`,
    concat(ifnull(`v`.`kgs_target`, ''), ':Kgs Target:Y:T:') AS `kgs_target`,
    concat(ifnull(`v`.`grams_actual`, ''), ':Grams Actual:Y:T:') AS `grams_actual`,
    concat(ifnull(`v`.`kgs_actual`, ''), ':kgs Actual:Y:T:') AS `kgs_actual`,
    concat(ifnull(`v`.`efficiency_percent`, ''), ':Efficiency Percent:Y:T:') AS `efficiency_percent`,
    concat(ifnull(`v`.`efficiency_target`, ''), ':Efficiency Target:Y:T:') AS `efficiency_target`,
	concat(ifnull(`v`.`total_stopage_time`, ''), ':Total Stopage Time:O:N:') AS `total_stopage_time`,
 	concat(ifnull(`v`.`prod_loss_with_out_reason`, ''), ':Prod Loss With Out Reason:O:N:') AS `prod_loss_with_out_reason`,
    concat(ifnull(`v`.`prod_loss_with_reason`, ''), ':Prod Loss With Reason:O:N:') AS `prod_loss_with_reason`
from
    `ERP_PASHUPATI_DEV_1_0`.`xtv_spinning_production_rf_details` `v`
limit 1;



-------------------------------------------------------------------------------------------------------------------------------
// 08-04-2024 by akshay

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_fg_summary` AS
select
    `fgt`.`product_type_group` AS `product_type_group`,
    `fgt`.`product_type_name` AS `product_type_name`,
    `fgt`.`product_category1_name` AS `product_category1_name`,
    `fg`.`product_fg_id` AS `product_fg_id`,
    `fg`.`product_fg_code` AS `product_fg_code`,
    `fg`.`product_fg_name` AS `product_fg_name`,
    `fg`.`product_fg_short_name` AS `product_short_fg_name`,
    `fg`.`product_fg_tech_spect` AS `product_fg_tech_spect`,
    `fg`.`product_fg_stock_unit_name` AS `product_fg_stock_unit_name`,
    ifnull((select sum(`st`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `st` where `st`.`product_rm_id` = `fg`.`product_fg_id` and `st`.`company_id` = `fg`.`company_id`), 0) AS `stock_quantity`,
    ifnull((select sum(`st`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `st` where `st`.`product_rm_id` = `fg`.`product_fg_id` and `st`.`company_id` = `fg`.`company_id`), 0) AS `stock_weight`,
    ifnull((select sum(`st`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary_customer` `st` where `st`.`product_rm_id` = `fg`.`product_fg_id` and `st`.`company_id` = `fg`.`company_id`), 0) AS `customer_stock_quantity`,
    ifnull((select sum(`st`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary_customer` `st` where `st`.`product_rm_id` = `fg`.`product_fg_id` and `st`.`company_id` = `fg`.`company_id`), 0) AS `customer_stock_weight`,
    0 AS `lead_time`,
    0 AS `product_fg_moq`,
    0 AS `product_fg_mrp`,
    0 AS `product_fg_landed_price`,
    `fgt`.`product_fg_technical_name` AS `product_fg_technical_name`,
    `fgt`.`product_type_short_name` AS `product_type_short_name`,
    `fgt`.`product_category2_name` AS `product_category2_name`,
    `fgt`.`product_category3_name` AS `product_category3_name`,
    `fgt`.`product_category4_name` AS `product_category4_name`,
    `fgt`.`product_category5_name` AS `product_category5_name`,
    `fg`.`product_fg_packing_name` AS `product_fg_packing_name`,
    'NA' AS `product_make_name`,
    `fgt`.`product_material_type_name` AS `product_material_type_name`,
    `fgt`.`product_material_grade_name` AS `product_material_grade_name`,
    `fgt`.`product_material_shape_name` AS `product_material_shape_name`,
    `fg`.`product_fg_oem_part_code` AS `product_fg_oem_part_code`,
    `fg`.`product_fg_our_part_code` AS `product_fg_our_part_code`,
    `fgt`.`product_fg_drawing_no` AS `product_fg_drawing_no`,
    0 AS `product_fg_std_weight`,
    1 AS `product_fg_std_hours`,
    1 AS `process_duration`,
    0 AS `product_sr_std_profit_percent`,
    0 AS `product_sr_std_discount_percent`,
    case
        `fg`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `fg`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    'NA' AS `godown_name`,
    'NA' AS `godown_short_name`,
    'NA' AS `godown_area`,
    'NA' AS `godown_section_name`,
    'NA' AS `godown_section_short_name`,
    'NA' AS `godown_section_area`,
    'NA' AS `godown_section_beans_name`,
    'NA' AS `godown_section_beans_short_name`,
    'NA' AS `godown_section_beans_area`,
    `fg`.`product_fg_hsn_sac_code` AS `product_fg_hsn_sac_code`,
    `fg`.`product_fg_hsn_sac_rate` AS `product_fg_hsn_sac_rate`,
    `fg`.`company_name` AS `company_name`,
    `fg`.`company_branch_name` AS `company_branch_name`,
    `fgt`.`product_category1_id` AS `product_category1_id`,
    `fgt`.`product_type_id` AS `product_type_id`,
    `fg`.`product_fg_stock_unit_id` AS `product_fg_stock_unit_id`,
    1 AS `product_fg_packing_id`,
    `fg`.`product_fg_hsn_sac_code_id` AS `product_fg_hsn_sac_code_id`,
    `fgt`.`product_category2_id` AS `product_fg_category2_id`,
    `fgt`.`product_category3_id` AS `product_fg_category3_id`,
    `fgt`.`product_category4_id` AS `product_fg_category4_id`,
    `fgt`.`product_category5_id` AS `product_fg_category5_id`,
    1 AS `product_fg_make_id`,
    `fgt`.`product_material_type_id` AS `product_fg_material_type_id`,
    `fgt`.`product_material_grade_id` AS `product_fg_material_grade_id`,
    `fgt`.`product_material_shape_id` AS `product_material_shape_id`,
    `fg`.`company_id` AS `company_id`,
    `fg`.`company_branch_id` AS `company_branch_id`,
    '1' AS `godown_id`,
    '1' AS `godown_section_id`,
    '1' AS `godown_section_beans_id`,
    `fg`.`bom_applicable` AS `bom_applicable`,
    `fg`.`is_active` AS `is_active`,
    `fg`.`is_delete` AS `is_delete`,
    `fg`.`created_by` AS `created_by`,
    `fg`.`created_on` AS `created_on`,
    `fg`.`modified_by` AS `modified_by`,
    `fg`.`modified_on` AS `modified_on`,
    `fg`.`deleted_by` AS `deleted_by`,
    `fg`.`deleted_on` AS `deleted_on`,
    `fg`.`product_fg_name` AS `field_name`,
    `fg`.`product_fg_id` AS `field_id`
from
    (`ERP_PASHUPATI_DEV_1_0`.`smv_product_fg` `fg`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_fg_technical` `fgt` on
    (`fgt`.`company_id` = `fg`.`company_id`
        and `fgt`.`product_fg_id` = `fg`.`product_fg_id`))
where
    `fg`.`is_active` = 1
    and `fg`.`is_delete` = 0
    and `fgt`.`is_active` = 1
    and `fgt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
// 08-04-2024 by akshay

CREATE VIEW fmv_cost_center_heads AS
SELECT
	f.cost_center_heads_group,
	f.cost_center_heads_name,
	    `fc`.`cost_center_name` AS `cost_center_name`,
	f.cost_center_heads_short_name,
	`fc`.`cost_center_group` AS `cost_center_group`,
	`fc`.`cost_center_short_name` AS `cost_center_short_name`,
	`v`.`company_legal_name` AS `company_name`,
	`v`.`company_branch_name`,
	case
		`f`.`is_active` when 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		`f`.`is_delete` when 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	f.is_active,
	f.is_delete,
	f.created_by,
	f.created_on,
	f.modified_by,
	f.modified_on,
	f.deleted_by,
	f.deleted_on,
	f.company_id,
	f.company_branch_id,
	f.cost_center_heads_id,
	f.cost_center_id
FROM
	fm_cost_center_heads f
left join `cmv_company_summary` `v` on
	`v`.`company_id` = `f`.`company_id`
	and `v`.`company_branch_id` = `f`.`company_branch_id`
LEFT JOIN fm_cost_center fc ON
	fc.cost_center_id = f.cost_center_id
	and fc.`is_delete` = 0
where
    `f`.`is_delete` = 0;


   CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `fmv_cost_center_heads_rpt` AS
SELECT
    CONCAT(IFNULL(f.cost_center_heads_group, ''), ':Cost Center Heads Group:Y:P:costCenterHeadsGroups') AS cost_center_heads_group,
    CONCAT(IFNULL(f.cost_center_heads_name, ''), ':Cost Center Heads Name:Y:C:fmv_cost_center_heads:F') AS cost_center_heads_name,
    CONCAT(IFNULL(fc.cost_center_name, ''), ':Cost Center Name:Y:C:fmv_cost_center:F') AS cost_center_name,
    CONCAT(IFNULL(f.cost_center_heads_short_name, ''), ':Cost Center Heads Short Name:O:N:') AS cost_center_heads_short_name,
    CONCAT(IFNULL(fc.cost_center_group, ''), ':Cost Center Group:Y:P:costCenterGroups') AS cost_center_group,
    CONCAT(IFNULL(fc.cost_center_short_name, ''), ':Cost Center Short Name:O:N:') AS cost_center_short_name,
    CONCAT(IFNULL(v.company_legal_name, ''), ':Company Name:Y:C:cmv_company_summary:F') AS company_name,
    CONCAT(IFNULL(v.company_branch_name, ''), ':Company Branch Name:Y:C:cmv_company_branch_summary:F') AS company_branch_name,
    CONCAT(CASE WHEN f.is_active = 1 THEN 'Active' ELSE 'In Active' END, ':Active Status:Y:H:(Active, In Active)') AS Active,
    CONCAT(CASE WHEN f.is_delete = 1 THEN 'Yes' ELSE 'No' END, ':Deleted Status:Y:H:(Yes, No)') AS Deleted,
    CONCAT(IFNULL(f.created_by, ''), ':Created By:O:N:') AS created_by,
    CONCAT(IFNULL(f.created_on, ''), ':Created On:O:N:') AS created_on,
    CONCAT(IFNULL(f.modified_by, ''), ':Modified By:O:N:') AS modified_by,
    CONCAT(IFNULL(f.modified_on, ''), ':Modified On:O:N:') AS modified_on,
    CONCAT(IFNULL(f.deleted_by, ''), ':Deleted By:O:N:') AS deleted_by,
    CONCAT(IFNULL(f.deleted_on, ''), ':Deleted On:O:N:') AS deleted_on,
    CONCAT(IFNULL(f.company_id, ''), ':Company Id:N:N:') AS company_id,
    CONCAT(IFNULL(f.company_branch_id, ''), ':Company Branch Id:N:N:') AS company_branch_id,
    CONCAT(IFNULL(f.cost_center_heads_id, ''), ':Cost Center Heads Id:N:N:') AS cost_center_heads_id,
    CONCAT(IFNULL(f.cost_center_id, ''), ':Cost Center Id:N:N:') AS cost_center_id
FROM
    ((fm_cost_center_heads f
LEFT JOIN cmv_company_summary v ON
    (v.company_id = f.company_id
        AND v.company_branch_id = f.company_branch_id))
LEFT JOIN fm_cost_center fc ON
    (fc.cost_center_id = f.cost_center_id
        AND fc.is_delete = 0))
WHERE
    f.is_delete = 0;

-- ERP_DEV_1_1.fmv_cost_center_heads_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center_heads_rpt` AS
select
    concat(ifnull(`f`.`cost_center_heads_group`, ''), ':Cost Center Heads Group:Y:P:costCenterHeadsGroups') AS `cost_center_heads_group`,
    concat(ifnull(`f`.`cost_center_heads_name`, ''), ':Cost Center Heads Name:Y:C:fmv_cost_center_heads:F') AS `cost_center_heads_name`,
    concat(ifnull(`fc`.`cost_center_name`, ''), ':Cost Center Name:Y:C:fmv_cost_center:F') AS `cost_center_name`,
    concat(ifnull(`f`.`cost_center_heads_short_name`, ''), ':Cost Center Heads Short Name:O:N:') AS `cost_center_heads_short_name`,
    concat(ifnull(`fc`.`cost_center_group`, ''), ':Cost Center Group:Y:P:costCenterGroups') AS `cost_center_group`,
    concat(ifnull(`fc`.`cost_center_short_name`, ''), ':Cost Center Short Name:O:N:') AS `cost_center_short_name`,
    concat(ifnull(`v`.`company_legal_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(case when `f`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `f`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`f`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`f`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`f`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`f`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`f`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`f`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`f`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`f`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`f`.`cost_center_heads_id`, ''), ':Cost Center Heads Id:N:N:') AS `cost_center_heads_id`,
    concat(ifnull(`f`.`cost_center_id`, ''), ':Cost Center Id:N:N:') AS `cost_center_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`fm_cost_center_heads` `f`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `f`.`company_id`
        and `v`.`company_branch_id` = `f`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `f`.`cost_center_id`
        and `fc`.`is_delete` = 0))
where
    `f`.`is_delete` = 0 limit 1;



CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`xtv_weaving_production_inspection_details` AS
select
    `xt`.`inspection_production_code` AS `inspection_production_code`,
    `xt`.`inspection_production_set_no` AS `inspection_production_set_no`,
    `xt`.`inspection_order_no` AS `inspection_order_no`,
    `xt`.`inspection_production_date` AS `inspection_production_date`,
    `m`.`machine_name` AS `machine_name`,
    `s`.`godown_name` AS `godown_name`,
    case
        `xt`.`inspection_production_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'Z' then 'Canceled'
        when 'I' then 'Inprogress'
        else 'Partial'
    end AS `inspection_production_status_desc`,
    `xt`.`inspection_production_status` AS `inspection_production_status`,
    `p`.`plant_name` AS `plant_name`,
    `xt`.`prod_month` AS `prod_month`,
    `xt`.`prod_year` AS `prod_year`,
    `xt`.`sizing_beam_no` AS `sizing_beam_no`,
    `e`.`employee_name` AS `production_operator_name`,
    `e1`.`employee_name` AS `production_supervisor_name`,
    `xt`.`shift` AS `shift`,
    `xt`.`product_in_meter` AS `product_in_meter`,
    `xt`.`inspection_mtr` AS `inspection_mtr`,
    `xt`.`product_pick` AS `product_pick`,
    `xt`.`difference` AS `difference`,
    `xt`.`width` AS `width`,
    `xt`.`sort_no` AS `sort_no`,
    `xt`.`roll_no` AS `roll_no`,
    `xt`.`average` AS `average`,
    `xt`.`weight` AS `weight`,
    `po`.`product_material_id` AS `product_material_id`,
    `po`.`product_material_name` AS `product_material_name`,
    (
    select
        ifnull(sum(`wpi`.`product_in_meter`), 0)
    from
        `ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_details` `wpi`
    where
        `wpi`.`shift` = `xt`.`shift`
        and `wpi`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi`.`inspection_production_status` = 'A'
        and `wpi`.`is_delete` = 0) AS `total_product_in_meter`,
    (
    select
        ifnull(sum(`wpi1`.`inspection_mtr`), 0)
    from
        `ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_details` `wpi1`
    where
        `wpi1`.`shift` = `xt`.`shift`
        and `wpi1`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi1`.`inspection_production_status` = 'A'
        and `wpi1`.`is_delete` = 0) AS `total_inspection_mtr`,
    (
    select
        ifnull(`wi`.`product_in_meter` - sum(`wi`.`inspection_mtr`), 0)
    from
        `ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_details` `wi`
    where
        `wi`.`inspection_production_set_no` = `xt`.`inspection_production_set_no`
        and `wi`.`is_delete` = 0) AS `balance_product_in_meter`,
    (
    select
        ifnull(sum(`wpi2`.`weight`), 0)
    from
        `ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_details` `wpi2`
    where
        `wpi2`.`shift` = `xt`.`shift`
        and `wpi2`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi2`.`inspection_production_status` = 'A'
        and `wpi2`.`is_delete` = 0) AS `total_weight`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status_desc`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status`,
    `sb`.`production_section_name` AS `production_section_name`,
    `sb`.`production_sub_section_name` AS `production_sub_section_name`,
    `po`.`order_type` AS `order_type`,
    `po`.`sales_order_no` AS `sales_order_no`,
    `po`.`customer_name` AS `customer_name`,
    `xt`.`status_remark` AS `status_remark`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `xt`.`is_active` AS `is_active`,
    `xt`.`is_delete` AS `is_delete`,
    `xt`.`created_by` AS `created_by`,
    `xt`.`created_on` AS `created_on`,
    `xt`.`modified_by` AS `modified_by`,
    `xt`.`modified_on` AS `modified_on`,
    `xt`.`deleted_by` AS `deleted_by`,
    `xt`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `xt`.`financial_year` AS `financial_year`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `xt`.`weaving_production_inspection_details_id` AS `weaving_production_inspection_details_id`,
    `xt`.`weaving_production_inspection_master_id` AS `weaving_production_inspection_master_id`,
    `xt`.`plant_id` AS `plant_id`,
    `xt`.`product_id` AS `product_id`,
    `xt`.`section_id` AS `section_id`,
    `xt`.`godown_id` AS `godown_id`,
    `xt`.`sub_section_id` AS `sub_section_id`,
    `xt`.`production_operator_id` AS `production_operator_id`,
    `xt`.`production_supervisor_id` AS `production_supervisor_id`,
    `xt`.`machine_id` AS `machine_id`
from
    (((((((((`ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_details` `xt`
left join `ERP_PASHUPATI_DEV_1_0`.`xt_weaving_production_inspection_master` `wm` on
    (`wm`.`weaving_production_inspection_master_id` = `xt`.`weaving_production_inspection_master_id`
        and `wm`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `s` on
    (`s`.`godown_id` = `xt`.`godown_id`
        and `s`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xtv_weaving_production_order` `po` on
    (`po`.`set_no` = `xt`.`inspection_production_set_no`
        and `po`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_plant` `p` on
    (`p`.`plant_id` = `xt`.`plant_id`
        and `p`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_machine` `m` on
    (`m`.`machine_id` = `xt`.`machine_id`
        and `m`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_production_sub_section` `sb` on
    (`sb`.`production_sub_section_id` = `xt`.`sub_section_id`
        and `sb`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `xt`.`production_operator_id`
        and `e`.`company_id` = `xt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e1` on
    (`e1`.`employee_id` = `xt`.`production_supervisor_id`
        and `e1`.`company_id` = `xt`.`company_id`))
where
    `xt`.`is_delete` = 0;



-------------------------------------------------------------------------------------------------------------------------------


-- ERP_DEV_1_1.mt_dispatch_inspection_details_trading definition

CREATE TABLE `mt_dispatch_inspection_details_trading` (
  `dispatch_inspection_details_transaction_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `dispatch_challan_master_transaction_id` bigint(20) NOT NULL COMMENT '* will come from header section',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session  ',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
  `financial_year` varchar(20) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_no` varchar(50) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_date` date NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_version` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
      `sales_order_no` varchar(500) DEFAULT NULL COMMENT 'combo box with mtv_sales_order_summary with customer id filter on  sales ORder no   ',
  `sales_order_Date` date DEFAULT NULL COMMENT '* DTPpicker Date will come selection of sales_order_no combo',
  `sales_order_version` varchar(500) DEFAULT NULL COMMENT ' read only text box will come selection of sales_order_no combo ',
  `customer_id` bigint(20) DEFAULT NULL COMMENT 'will come from header section  *',
  `customer_order_no` varchar(500) DEFAULT NULL COMMENT 'combo box with mtv_sales_order_summary with customer id filter on select of Every Customer ORder no , Fill Grid data from mt_sales_order_trading  ',
  `customer_order_Date` date DEFAULT NULL COMMENT '* DTPpicker Date will come selection of customer _order_no combo',
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format for  for mannual data will come from material selection grid  with cmv_product_rm/cmv_product_fg/cmv_product_sr with all technical parameter shows ing grids for selected material else will show data from sales order details ',
  `product_material_unit_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_unit can editable ',
  `inspection_order_no`  varchar(500) DEFAULT NULL COMMENT 'get form inspection details table ',
  `inspection_production_date` date DEFAULT NULL COMMENT 'get form inspection details table ',
  `weaving_production_inspection_details_id` bigint(20)DEFAULT NULL COMMENT 'get form inspection details table',
  `inspection_production_set_no` varchar(255) DEFAULT NULL COMMENT 'get form inspection details table ',
  `inspection_mtr` decimal(18,4) DEFAULT 0.0000 COMMENT 'get form inspection details table',
  `dispatch_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* show two cloumn before this  prev_dispatch_quantity & prev_dispatch_weight show previos sum of dispatched qty  Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `sort_no` varchar(255) DEFAULT NULL COMMENT 'get form inspection details table ',
  `roll_no` bigint(20)DEFAULT NULL COMMENT 'get form inspection details table',
  `godown_id`bigint(20)DEFAULT NULL COMMENT 'get form inspection details table',
  `remark` varchar(1000) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`dispatch_inspection_details_transaction_id`)
)



-------------------------------------------------------------------------------------------------------------------------------
 ALTER TABLE ERP_DEV_1_1.mt_dispatch_inspection_details_trading ADD inspection_production_code varchar(255) DEFAULT null NULL COMMENT 'get from inspection stock view';
 ALTER TABLE ERP_DEV_1_1.mt_dispatch_inspection_details_trading CHANGE inspection_production_code inspection_production_code varchar(255) DEFAULT null NULL COMMENT 'get from inspection stock view' AFTER product_material_unit_id;



-------------------------------------------------------------------------------------------------------------------------------

-- ERP_DEV_1_1.mtv_dispatch_inspection_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_inspection_details_trading` AS
select
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `c`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_Date` AS `sales_order_Date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `mt`.`inspection_production_code` AS `inspection_production_code`,
    `mt`.`inspection_order_no` AS `inspection_order_no`,
    `mt`.`inspection_production_date` AS `inspection_production_date`,
    `mt`.`inspection_production_set_no` AS `inspection_production_set_no`,
    `mt`.`inspection_mtr` AS `inspection_mtr`,
    `mt`.`dispatch_quantity` AS `dispatch_quantity`,
    `mt`.`sort_no` AS `sort_no`,
    `mt`.`roll_no` AS `roll_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_name` AS `company_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`godown_id` AS `godown_id`,
    `mt`.`dispatch_inspection_details_transaction_id` AS `dispatch_inspection_details_transaction_id`,
    `mt`.`weaving_production_inspection_details_id` AS `weaving_production_inspection_details_id`
from
    ((((`ERP_DEV_1_1`.`mt_dispatch_inspection_details_trading` `mt`
left join `ERP_DEV_1_1`.`cm_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `mt`.`product_material_unit_id`
        and `u`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_company` `v` on
    (`v`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------
-- 11-04-2024

ALTER TABLE xt_weaving_production_inspection_details ADD dispatch_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'update dispatch quantity after dispatch material';
ALTER TABLE xt_weaving_production_inspection_details CHANGE dispatch_quantity dispatch_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'update dispatch quantity after dispatch material' AFTER machine_id;




-------------------------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.xtv_weaving_production_inspection_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`xtv_weaving_production_inspection_details` AS
select
    `xt`.`inspection_production_code` AS `inspection_production_code`,
    `xt`.`inspection_production_set_no` AS `inspection_production_set_no`,
    `xt`.`inspection_order_no` AS `inspection_order_no`,
    `xt`.`inspection_production_date` AS `inspection_production_date`,
    `m`.`machine_name` AS `machine_name`,
    `s`.`godown_name` AS `godown_name`,
    case
        `xt`.`inspection_production_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'Z' then 'Canceled'
        when 'I' then 'Inprogress'
        when 'PD' then 'Partial Dispatch'
        when 'D' then 'Dispatch Done'
        else 'Partial'
    end AS `inspection_production_status_desc`,
    `xt`.`inspection_production_status` AS `inspection_production_status`,
    `p`.`plant_name` AS `plant_name`,
    `xt`.`prod_month` AS `prod_month`,
    `xt`.`prod_year` AS `prod_year`,
    `xt`.`sizing_beam_no` AS `sizing_beam_no`,
    `e`.`employee_name` AS `production_operator_name`,
    `e1`.`employee_name` AS `production_supervisor_name`,
    `xt`.`shift` AS `shift`,
    `xt`.`product_in_meter` AS `product_in_meter`,
    `xt`.`inspection_mtr` AS `inspection_mtr`,
    `xt`.`product_pick` AS `product_pick`,
    `xt`.`difference` AS `difference`,
    `xt`.`width` AS `width`,
    `xt`.`sort_no` AS `sort_no`,
    `xt`.`roll_no` AS `roll_no`,
    `xt`.`average` AS `average`,
    `xt`.`weight` AS `weight`,
    `po`.`product_material_id` AS `product_material_id`,
    `po`.`product_material_name` AS `product_material_name`,
    (
    select
        ifnull(sum(`wpi`.`product_in_meter`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi`
    where
        `wpi`.`shift` = `xt`.`shift`
        and `wpi`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi`.`inspection_production_status` = 'A'
        and `wpi`.`is_delete` = 0) AS `total_product_in_meter`,
    (
    select
        ifnull(sum(`wpi1`.`inspection_mtr`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi1`
    where
        `wpi1`.`shift` = `xt`.`shift`
        and `wpi1`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi1`.`inspection_production_status` = 'A'
        and `wpi1`.`is_delete` = 0) AS `total_inspection_mtr`,
    (
    select
        ifnull(`wi`.`product_in_meter` - sum(`wi`.`inspection_mtr`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wi`
    where
        `wi`.`inspection_production_set_no` = `xt`.`inspection_production_set_no`
        and `wi`.`is_delete` = 0) AS `balance_product_in_meter`,
    (
    select
        ifnull(sum(`wpi2`.`weight`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi2`
    where
        `wpi2`.`shift` = `xt`.`shift`
        and `wpi2`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi2`.`inspection_production_status` = 'A'
        and `wpi2`.`is_delete` = 0) AS `total_weight`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status_desc`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status`,
    `sb`.`production_section_name` AS `production_section_name`,
    `sb`.`production_sub_section_name` AS `production_sub_section_name`,
    `po`.`order_type` AS `order_type`,
    `po`.`sales_order_no` AS `sales_order_no`,
    `po`.`customer_name` AS `customer_name`,
    `xt`.`status_remark` AS `status_remark`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `xt`.`is_active` AS `is_active`,
    `xt`.`is_delete` AS `is_delete`,
    `xt`.`created_by` AS `created_by`,
    `xt`.`created_on` AS `created_on`,
    `xt`.`modified_by` AS `modified_by`,
    `xt`.`modified_on` AS `modified_on`,
    `xt`.`deleted_by` AS `deleted_by`,
    `xt`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `xt`.`financial_year` AS `financial_year`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `xt`.`weaving_production_inspection_details_id` AS `weaving_production_inspection_details_id`,
    `xt`.`weaving_production_inspection_master_id` AS `weaving_production_inspection_master_id`,
    `xt`.`plant_id` AS `plant_id`,
    `xt`.`product_id` AS `product_id`,
    `rm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_packing_id` AS `product_material_packing_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `xt`.`section_id` AS `section_id`,
    `xt`.`godown_id` AS `godown_id`,
    `xt`.`sub_section_id` AS `sub_section_id`,
    `xt`.`production_operator_id` AS `production_operator_id`,
    `xt`.`production_supervisor_id` AS `production_supervisor_id`,
    `xt`.`machine_id` AS `machine_id`
from
    ((((((((((`ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `xt`
left join `ERP_DEV_1_1`.`xt_weaving_production_inspection_master` `wm` on
    (`wm`.`weaving_production_inspection_master_id` = `xt`.`weaving_production_inspection_master_id`
        and `wm`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xmv_production_sub_section_godown_mapping` `s` on
    (`s`.`production_sub_section_godown_id` = `xt`.`godown_id`
        and `s`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xtv_weaving_production_order` `po` on
    (`po`.`set_no` = `xt`.`inspection_production_set_no`
        and `po`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cm_plant` `p` on
    (`p`.`plant_id` = `xt`.`plant_id`
        and `p`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cm_machine` `m` on
    (`m`.`machine_id` = `xt`.`machine_id`
        and `m`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xm_production_sub_section` `sb` on
    (`sb`.`production_sub_section_id` = `xt`.`sub_section_id`
        and `sb`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `xt`.`production_operator_id`
        and `e`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_employee_list` `e1` on
    (`e1`.`employee_id` = `xt`.`production_supervisor_id`
        and `e1`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `xt`.`product_id`
        and `rm`.`company_id` = `xt`.`company_id`))
where
    `xt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

-- ERP_DEV_1_1.xtv_weaving_production_inspection_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`xtv_weaving_production_inspection_details` AS
select
    `xt`.`inspection_production_code` AS `inspection_production_code`,
    `xt`.`inspection_production_set_no` AS `inspection_production_set_no`,
    `xt`.`inspection_order_no` AS `inspection_order_no`,
    `xt`.`inspection_production_date` AS `inspection_production_date`,
    `m`.`machine_name` AS `machine_name`,
    `s`.`godown_name` AS `godown_name`,
    case
        `xt`.`inspection_production_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'Z' then 'Canceled'
        when 'I' then 'Inprogress'
        when 'PD' then 'Partial Dispatch'
        when 'D' then 'Dispatch Done'
        else 'Partial'
    end AS `inspection_production_status_desc`,
    `xt`.`inspection_production_status` AS `inspection_production_status`,
    `p`.`plant_name` AS `plant_name`,
    `xt`.`prod_month` AS `prod_month`,
    `xt`.`prod_year` AS `prod_year`,
    `xt`.`sizing_beam_no` AS `sizing_beam_no`,
    `e`.`employee_name` AS `production_operator_name`,
    `e1`.`employee_name` AS `production_supervisor_name`,
    `xt`.`shift` AS `shift`,
    `xt`.`product_in_meter` AS `product_in_meter`,
    `xt`.`inspection_mtr` AS `inspection_mtr`,
    `xt`.`product_pick` AS `product_pick`,
    `xt`.`difference` AS `difference`,
    `xt`.`width` AS `width`,
    `xt`.`sort_no` AS `sort_no`,
    `xt`.`roll_no` AS `roll_no`,
    `xt`.`average` AS `average`,
    `xt`.`weight` AS `weight`,
    `po`.`product_material_id` AS `product_material_id`,
    `po`.`product_material_name` AS `product_material_name`,
    (
    select
        ifnull(sum(`wpi`.`product_in_meter`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi`
    where
        `wpi`.`shift` = `xt`.`shift`
        and `wpi`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi`.`inspection_production_status` = 'A'
        and `wpi`.`is_delete` = 0) AS `total_product_in_meter`,
    (
    select
        ifnull(sum(`wpi1`.`inspection_mtr`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi1`
    where
        `wpi1`.`shift` = `xt`.`shift`
        and `wpi1`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi1`.`inspection_production_status` = 'A'
        and `wpi1`.`is_delete` = 0) AS `total_inspection_mtr`,
    (
    select
        ifnull(`wi`.`product_in_meter` - sum(`wi`.`inspection_mtr`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wi`
    where
        `wi`.`inspection_production_set_no` = `xt`.`inspection_production_set_no`
        and `wi`.`is_delete` = 0) AS `balance_product_in_meter`,
    (
    select
        ifnull(sum(`wpi2`.`weight`), 0)
    from
        `ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `wpi2`
    where
        `wpi2`.`shift` = `xt`.`shift`
        and `wpi2`.`inspection_production_date` = `xt`.`inspection_production_date`
        and `wpi2`.`inspection_production_status` = 'A'
        and `wpi2`.`is_delete` = 0) AS `total_weight`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status_desc`,
    `wm`.`inspection_production_master_status` AS `inspection_production_master_status`,
    `sb`.`production_section_name` AS `production_section_name`,
    `sb`.`production_sub_section_name` AS `production_sub_section_name`,
    `po`.`order_type` AS `order_type`,
    `po`.`sales_order_no` AS `sales_order_no`,
    `po`.`customer_name` AS `customer_name`,
    `xt`.`status_remark` AS `status_remark`,
    `xt`.`dispatch_quantity` As `dispatch_quantity`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `xt`.`is_active` AS `is_active`,
    `xt`.`is_delete` AS `is_delete`,
    `xt`.`created_by` AS `created_by`,
    `xt`.`created_on` AS `created_on`,
    `xt`.`modified_by` AS `modified_by`,
    `xt`.`modified_on` AS `modified_on`,
    `xt`.`deleted_by` AS `deleted_by`,
    `xt`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `xt`.`financial_year` AS `financial_year`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `xt`.`weaving_production_inspection_details_id` AS `weaving_production_inspection_details_id`,
    `xt`.`weaving_production_inspection_master_id` AS `weaving_production_inspection_master_id`,
    `xt`.`plant_id` AS `plant_id`,
    `xt`.`product_id` AS `product_id`,
    `rm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_packing_id` AS `product_material_packing_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `xt`.`section_id` AS `section_id`,
    `xt`.`godown_id` AS `godown_id`,
    `xt`.`sub_section_id` AS `sub_section_id`,
    `xt`.`production_operator_id` AS `production_operator_id`,
    `xt`.`production_supervisor_id` AS `production_supervisor_id`,
    `xt`.`machine_id` AS `machine_id`
from
    ((((((((((`ERP_DEV_1_1`.`xt_weaving_production_inspection_details` `xt`
left join `ERP_DEV_1_1`.`xt_weaving_production_inspection_master` `wm` on
    (`wm`.`weaving_production_inspection_master_id` = `xt`.`weaving_production_inspection_master_id`
        and `wm`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xmv_production_sub_section_godown_mapping` `s` on
    (`s`.`production_sub_section_godown_id` = `xt`.`godown_id`
        and `s`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xtv_weaving_production_order` `po` on
    (`po`.`set_no` = `xt`.`inspection_production_set_no`
        and `po`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cm_plant` `p` on
    (`p`.`plant_id` = `xt`.`plant_id`
        and `p`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cm_machine` `m` on
    (`m`.`machine_id` = `xt`.`machine_id`
        and `m`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`xm_production_sub_section` `sb` on
    (`sb`.`production_sub_section_id` = `xt`.`sub_section_id`
        and `sb`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `xt`.`production_operator_id`
        and `e`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_employee_list` `e1` on
    (`e1`.`employee_id` = `xt`.`production_supervisor_id`
        and `e1`.`company_id` = `xt`.`company_id`))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `xt`.`product_id`
        and `rm`.`company_id` = `xt`.`company_id`))
where
    `xt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

RENAME TABLE ERP_DEV_1_1.pt_sales_order_product_dynamic_parameters TO ERP_DEV_1_1.mt_sales_order_product_dynamic_parameters;
RENAME TABLE pt_sales_order_product_dynamic_parameters TO mt_sales_order_product_dynamic_parameters;

-------------------------------------------------------------------------------------------------------------------------------
//12-04-2024 by akshay
//Product type related changes

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` AS
select
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mt`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Order Accepted'
        when 'X' then 'Order Cancelled'
        else 'Aceptance Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `cc`.`cust_branch_gst_no` AS `consignee_gst_no`,
    `cc`.`cust_branch_pan_no` AS `consignee_pan_no`,
    `cc`.`cust_branch_phone_no` AS `consignee_phone_no`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`sales_order_type` AS `sales_order_type`,
    `mt`.`sales_order_life` AS `sales_order_life`,
    `mt`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_pincode` AS `company_pincode`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`state_name` AS `company_branch_state`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`company_id` = `mt`.`company_id`
    and `mt`.`sales_order_type_id` = `pt`.`product_type_id`
    and `pt`.`is_delete` = 0
    ))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`
        and `vp`.`company_branch_id` = `mt`.`company_branch_id`
        and `vp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`
        and `hsn`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;



-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE mt_dispatch_challan_batchwise_trading ADD goods_receipt_no varchar(100) DEFAULT null NULL COMMENT 'get goods receipt no from stock details';
ALTER TABLE mt_dispatch_challan_batchwise_trading CHANGE goods_receipt_no goods_receipt_no varchar(100) DEFAULT null NULL COMMENT 'get goods receipt no from stock details' AFTER dispatch_challan_batch_remark;
ALTER TABLE mt_dispatch_challan_batchwise_trading ADD godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get from stock details while dispatching materials';
ALTER TABLE mt_dispatch_challan_batchwise_trading CHANGE godown_id godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get from stock details while dispatching materials' AFTER goods_receipt_no;
ALTER TABLE mt_dispatch_challan_batchwise_trading ADD godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section id from stock details while dispatch materials';
ALTER TABLE mt_dispatch_challan_batchwise_trading CHANGE godown_section_id godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section id from stock details while dispatch materials' AFTER godown_id;
ALTER TABLE mt_dispatch_challan_batchwise_trading ADD godown_section_beans_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section beans id from stock details while despatching materials';
ALTER TABLE mt_dispatch_challan_batchwise_trading CHANGE godown_section_beans_id godown_section_beans_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section beans id from stock details while despatching materials' AFTER godown_section_id;


-------------------------------------------------------------------------------------------------------------------------------

- ERP_DEV_1_1.mtv_dispatch_challan_batchwise_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_challan_batchwise_trading` AS
select
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    case
        `mt`.`dispatch_challan_batch_status` when 'A' then 'Aprroved'
        when 'I' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_challan_batch_status_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_Date` AS `sales_order_Date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `mtvdt`.`customer_name` AS `customer_name`,
    `mtvdt`.`customer_state_name` AS `customer_state_name`,
    `mtvdt`.`customer_name` AS `consignee_name`,
    `mtvdt`.`consignee_state_name` AS `consignee_state_name`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`batch_no` AS `batch_no`,
    `mtvdt`.`product_type_group` AS `product_type_group`,
    `mtvdt`.`product_material_name` AS `product_material_name`,
    `mt`.`batch_dispatch_quantity` AS `batch_dispatch_quantity`,
    `mt`.`batch_dispatch_weight` AS `batch_dispatch_weight`,
    `mt`.`dispatch_challan_batch_status` AS `dispatch_challan_batch_status`,
    `mt`.`dispatch_challan_batch_remark` AS `dispatch_challan_batch_remark`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mtvdt`.`customer_email` AS `customer_email`,
    `mtvdt`.`customer_city_name` AS `customer_city_name`,
    `mtvdt`.`consignee_email` AS `consignee_email`,
    `mtvdt`.`consignee_city_name` AS `consignee_city_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`dispatch_challan__batchwise_transaction_id` AS `dispatch_challan__batchwise_transaction_id`,
    `mt`.`dispatch_challan_details_transaction_id` AS `dispatch_challan_details_transaction_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`goods_receipt_no` AS `goods_receipt_no`,
    `mt`.`godown_id` AS `godown_id`,
    `mt`.`godown_section_id` AS `godown_section_id`,
    `mt`.`godown_section_beans_id` AS `godown_section_beans_id`

from
    ((`ERP_DEV_1_1`.`mt_dispatch_challan_batchwise_trading` `mt`
left join `ERP_DEV_1_1`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`mtv_dispatch_challan_details_trading` `mtvdt` on
    (`mtvdt`.`company_id` = `mt`.`company_id`
        and `mtvdt`.`dispatch_challan_details_transaction_id` = `mt`.`dispatch_challan_details_transaction_id`
        and `mtvdt`.`dispatch_challan_master_transaction_id` = `mt`.`dispatch_challan_master_transaction_id`))
where
    `mt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

--- 15-04-2024---
-- ERP_DEV_1_1.mtv_dispatch_challan_master_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_challan_master_trading` AS
select
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    case
        `mt`.`dispatch_challan_status` when 'A' then 'Aprroved'
        when 'U' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_challan_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `st1`.`state_name` AS `consignee_state_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`dispatch_challan_remark` AS `dispatch_challan_remark`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`customer_gst_no` AS `customer_gst_no`,
    `mt`.`consignee_gst_no` AS `consignee_gst_no`,
    `mt`.`customer_pan_no` AS `customer_pan_no`,
    `mt`.`consignee_pan_no` AS `consignee_pan_no`,
    `mt`.`transporter_gst_no` AS `transporter_gst_no`,
    `mt`.`vehicle_no` AS `vehicle_no`,
    `mt`.`vehicle_type` AS `vehicle_type`,
    `mt`.`transporter_challan_no` AS `transporter_challan_no`,
    `mt`.`transporter_challan_date` AS `transporter_challan_date`,
    `mt`.`loading_time` AS `loading_time`,
    `mt`.`transport_mode` AS `transport_mode`,
    `mt`.`transaction_type` AS `transaction_type`,
    `mt`.`is_service` AS `is_service`,
    `mt`.`is_sez` AS `is_sez`,
    `mt`.`interim` AS `interim`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `h`.`hsn_sac_code` AS `freight_fg_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `freight_fg_hsn_sac_rate`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `mt`.`agent_id` AS `agent_id`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    `mt`.`agent_amount` AS `agent_amount`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    case
        `mt`.`dispatch_challan_creation_type` when 'M' then 'Mannual'
        when 'D' then 'Dispatch Schedule Based'
        when 'O' then 'Sales Order Based'
    end AS `dispatch_challan_creation_type_desc`,
    case
        `mt`.`mail_sent_status` when 'S' then 'Sent'
        when 'F' then 'Failed'
    end AS `mail_sent_status_desc`,
    `mt`.`dispatch_challan_creation_type` AS `dispatch_challan_creation_type`,
    `mt`.`dispatch_challan_status` AS `dispatch_challan_status`,
    `mt`.`dispatch_challan_type` AS `dispatch_challan_type`,
    `mt`.`remark` AS `remark`,
    `v`.`company_name` AS `company_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`cust_branch_address1` AS `customer_address1`,
    `ct`.`city_name` AS `customer_city_name`,
    `cc`.`cust_branch_EmailId` AS `consignee_email`,
    `ct1`.`city_name` AS `consignee_city_name`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `mt`.`dispatch_challan_type_id` AS `dispatch_challan_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`transporter_id` AS `transporter_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`mail_sent_status` AS `mail_sent_status`
from
    (((((((((`ERP_DEV_1_1`.`mt_dispatch_challan_master_trading` `mt`
left join `ERP_DEV_1_1`.`cmv_company_branch_summary` `v` on
    (`v`.`company_branch_id` = `mt`.`expected_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_DEV_1_1`.`cmv_agent` `a` on
    (`a`.`company_id` = `mt`.`company_id`
        and `a`.`agent_id` = `mt`.`agent_id`))
left join `ERP_DEV_1_1`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_DEV_1_1`.`cm_city` `ct` on
    (`ct`.`city_id` = `mt`.`customer_city_id`))
left join `ERP_DEV_1_1`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `mt`.`consignee_city_id`))
left join `ERP_DEV_1_1`.`cm_state` `st` on
    (`st`.`state_id` = `mt`.`customer_state_id`))
left join `ERP_DEV_1_1`.`cm_state` `st1` on
    (`st1`.`state_id` = `mt`.`consignee_state_id`))
left join `ERP_DEV_1_1`.`cmv_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`
        and `h`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.mtv_dispatch_challan_master_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_challan_master_trading` AS
select
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    case
        `mt`.`dispatch_challan_status` when 'A' then 'Aprroved'
        when 'U' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_challan_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `st1`.`state_name` AS `consignee_state_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`dispatch_challan_remark` AS `dispatch_challan_remark`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`customer_gst_no` AS `customer_gst_no`,
    `mt`.`consignee_gst_no` AS `consignee_gst_no`,
    `mt`.`customer_pan_no` AS `customer_pan_no`,
    `mt`.`consignee_pan_no` AS `consignee_pan_no`,
    `mt`.`transporter_gst_no` AS `transporter_gst_no`,
    `mt`.`vehicle_no` AS `vehicle_no`,
    `mt`.`vehicle_type` AS `vehicle_type`,
    `mt`.`transporter_challan_no` AS `transporter_challan_no`,
    `mt`.`transporter_challan_date` AS `transporter_challan_date`,
    `mt`.`loading_time` AS `loading_time`,
    `mt`.`transport_mode` AS `transport_mode`,
    `mt`.`transaction_type` AS `transaction_type`,
    `mt`.`is_service` AS `is_service`,
    `mt`.`is_sez` AS `is_sez`,
    `mt`.`interim` AS `interim`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `h`.`hsn_sac_code` AS `freight_fg_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `freight_fg_hsn_sac_rate`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `mt`.`agent_id` AS `agent_id`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    `mt`.`agent_amount` AS `agent_amount`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    case
        `mt`.`dispatch_challan_creation_type` when 'M' then 'Mannual'
        when 'D' then 'Dispatch Schedule Based'
        when 'O' then 'Sales Order Based'
    end AS `dispatch_challan_creation_type_desc`,
    case
        `mt`.`mail_sent_status` when 'S' then 'Sent'
        when 'F' then 'Failed'
    end AS `mail_sent_status_desc`,
    `mt`.`dispatch_challan_creation_type` AS `dispatch_challan_creation_type`,
    `mt`.`dispatch_challan_status` AS `dispatch_challan_status`,
    `mt`.`dispatch_challan_type` AS `dispatch_challan_type`,
    `mt`.`remark` AS `remark`,
    `v`.`company_name` AS `company_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`cust_branch_address1` AS `customer_address1`,
    `ct`.`city_name` AS `customer_city_name`,
    `cc`.`cust_branch_EmailId` AS `consignee_email`,
    `ct1`.`city_name` AS `consignee_city_name`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `pt`.`product_type_short_name` As `product_type_short_name`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `mt`.`dispatch_challan_type_id` AS `dispatch_challan_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`transporter_id` AS `transporter_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`mail_sent_status` AS `mail_sent_status`
from
    ((((((((((`ERP_DEV_1_1`.`mt_dispatch_challan_master_trading` `mt`
left join `ERP_DEV_1_1`.`cmv_company_branch_summary` `v` on
    (`v`.`company_branch_id` = `mt`.`expected_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_DEV_1_1`.`cmv_agent` `a` on
    (`a`.`company_id` = `mt`.`company_id`
        and `a`.`agent_id` = `mt`.`agent_id`))
left join `ERP_DEV_1_1`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_DEV_1_1`.`cm_city` `ct` on
    (`ct`.`city_id` = `mt`.`customer_city_id`))
left join `ERP_DEV_1_1`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `mt`.`consignee_city_id`))
left join `ERP_DEV_1_1`.`cm_state` `st` on
    (`st`.`state_id` = `mt`.`customer_state_id`))
left join `ERP_DEV_1_1`.`cm_state` `st1` on
    (`st1`.`state_id` = `mt`.`consignee_state_id`))
left join `ERP_DEV_1_1`.`cmv_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`
        and `h`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`sm_product_type` `pt` on
    (`pt`.`product_type_id` = `mt`.`dispatch_challan_type_id`
        and `pt`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------


ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading ADD goods_receipt_no varchar(100) DEFAULT null NULL COMMENT 'get goods receipt no from stock details';
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading CHANGE goods_receipt_no goods_receipt_no varchar(100) DEFAULT null NULL COMMENT 'get goods receipt no from stock details' AFTER dispatch_challan_batch_remark;
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading ADD godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get from stock details while dispatching materials';
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading CHANGE godown_id godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get from stock details while dispatching materials' AFTER goods_receipt_no;
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading ADD godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section id from stock details while dispatch materials';
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading CHANGE godown_section_id godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section id from stock details while dispatch materials' AFTER godown_id;
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading ADD godown_section_beans_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section beans id from stock details while despatching materials';
ALTER TABLE ERP_DEV_1_1.mt_dispatch_challan_batchwise_trading CHANGE godown_section_beans_id godown_section_beans_id BIGINT(20) DEFAULT 0 NULL COMMENT 'get section beans id from stock details while despatching materials' AFTER godown_section_id;

-------------------------------------------------------------------------------------------------------------------------------



-- ERP_DEV_1_1.mtv_dispatch_schedule_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_schedule_details_trading` AS
select
    `mt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
    case
        `mt`.`dispatch_schedule_creation_type` when 'M' then 'Manual'
        when 'S' then 'Sales Order Based'
    end AS `dispatch_schedule_creation_type_desc`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    case
        `mt`.`dispatch_schedule_item_status` when 'P' then 'Pending'
        when 'A' then 'Aprroved'
        when 'R' then 'Rejected'
        when 'U' then 'Partial Sales Issue'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_schedule_item_status_desc`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mtso`.`sales_order_no` AS `sales_order_no`,
    `mtso`.`sales_order_version` AS `sales_order_version`,
    `mtso`.`sales_order_date` AS `sales_order_date`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`batch_no` AS `batch_no`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `mt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `mt`.`sr_no` AS `sr_no`,
    `rmfgsr`.`product_type_name` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `mtso`.`material_quantity` AS `material_quantity`,
    `mtso`.`material_weight` AS `material_weight`,
    `mtso`.`material_rate` AS `material_rate`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_rate`,
    `mtso`.`material_basic_amount` AS `material_basic_amount`,
    `mtso`.`material_discount_percent` AS `material_discount_percent`,
    `mtso`.`material_discount_amount` AS `material_discount_amount`,
    `mtso`.`material_taxable_amount` AS `material_taxable_amount`,
    `mtso`.`material_cgst_percent` AS `material_cgst_percent`,
    `mtso`.`material_cgst_total` AS `material_cgst_total`,
    `mtso`.`material_sgst_percent` AS `material_sgst_percent`,
    `mtso`.`material_sgst_total` AS `material_sgst_total`,
    `mtso`.`material_igst_percent` AS `material_igst_percent`,
    `mtso`.`material_igst_total` AS `material_igst_total`,
    `mtso`.`material_total_amount` AS `material_total_amount`,
    `mtso`.`material_schedule_date` AS `material_schedule_date`,
    `mtso`.`so_rate` AS `so_rate`,
    `mt`.`expected_dispatch_quantity` AS `expected_dispatch_quantity`,
    `mt`.`expected_dispatch_weight` AS `expected_dispatch_weight`,
    `mt`.`actual_dispatch_quantity` AS `actual_dispatch_quantity`,
    `mt`.`actual_dispatch_weight` AS `actual_dispatch_weight`,
    `mt`.`dispatch_return_quantity` AS `dispatch_return_quantity`,
    `mt`.`dispatch_return_weight` AS `dispatch_return_weight`,
    `mt`.`pending_quantity` AS `pending_quantity`,
    `mt`.`pending_weight` AS `pending_weight`,
    `mt`.`expected_schedule_date` AS `expected_schedule_date`,
    `mt`.`delayed_days` AS `delayed_days`,
    `mt`.`dispatched_quantity` AS `dispatched_quantity`,
    `mt`.`dispatched_weight` AS `dispatched_weight`,
    `mt`.`invoice_quantity` AS `invoice_quantity`,
    `mt`.`invoice_weight` AS `invoice_weight`,
    `mt`.`dispatch_schedule_item_status` AS `dispatch_schedule_item_status`,
    `mt`.`dispatch_schedule_creation_type` AS `dispatch_schedule_creation_type`,
    `mt`.`dispatch_schedule_remark` AS `dispatch_schedule_remark`,
    `dsmt`.`approved_date` AS `approved_date`,
    `dsmt`.`total_quantity` AS `total_quantity`,
    `dsmt`.`total_weight` AS `total_weight`,
    `dsmt`.`actual_quantity` AS `actual_quantity`,
    `dsmt`.`actual_weight` AS `actual_weight`,
    `dsmt`.`dispatch_note_status` AS `dispatch_note_status`,
    `dsmt`.`dispatch_note_remark` AS `dispatch_note_remark`,
    `dsmt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_hsn_sac_code_id` AS `product_material_hsn_code_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`dispatch_schedule_type_id` AS `dispatch_schedule_type_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `dsmt`.`customer_id` AS `customer_id`,
    `dsmt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `dsmt`.`customer_state_id` AS `customer_state_id`,
    `dsmt`.`customer_city_id` AS `customer_city_id`,
    `dsmt`.`consignee_id` AS `consignee_id`,
    `dsmt`.`consignee_state_id` AS `consignee_state_id`,
    `dsmt`.`consignee_city_id` AS `consignee_city_id`,
    `dsmt`.`dispatch_supervisor_id` AS `dispatch_supervisor_id`,
    `dsmt`.`approved_by_id` AS `approved_by_id`
from
    ((((`ERP_DEV_1_1`.`mt_dispatch_schedule_details_trading` `mt`
left join `ERP_DEV_1_1`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`mt_dispatch_schedule_master_trading` `dsmt` on
    (`dsmt`.`dispatch_schedule_master_transaction_id` = `mt`.`dispatch_schedule_master_transaction_id`
        and `dsmt`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`mtv_sales_order_details_trading` `mtso` on
    (`mtso`.`customer_order_no` = `mt`.`customer_order_no`
        and `mtso`.`sales_order_no` = `mt`.`sales_order_no`
        and `mtso`.`product_material_id` = `mt`.`product_material_id`
        and `mtso`.`so_sr_no` = `mt`.`so_sr_no`
        and `mtso`.`company_id` = `mt`.`company_id`
        and `mtso`.`company_branch_id` = `mt`.`company_branch_id`
        and `mtso`.`is_delete` = 0))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------


-- ERP_DEV_1_1.mtv_dispatch_schedule_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_schedule_details_trading` AS
select
    `mt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
    case
        `mt`.`dispatch_schedule_creation_type` when 'M' then 'Manual'
        when 'S' then 'Sales Order Based'
    end AS `dispatch_schedule_creation_type_desc`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    case
        `mt`.`dispatch_schedule_item_status` when 'P' then 'Pending'
        when 'A' then 'Aprroved'
        when 'R' then 'Rejected'
        when 'U' then 'Partial Sales Issue'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_schedule_item_status_desc`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mtso`.`sales_order_no` AS `sales_order_no`,
    `mtso`.`sales_order_version` AS `sales_order_version`,
    `mtso`.`sales_order_date` AS `sales_order_date`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`batch_no` AS `batch_no`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `mt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `mt`.`sr_no` AS `sr_no`,
    `rmfgsr`.`product_type_name` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_type_short_name` AS `dispatch_type_short_name`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `mtso`.`material_quantity` AS `material_quantity`,
    `mtso`.`material_weight` AS `material_weight`,
    `mtso`.`material_rate` AS `material_rate`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_rate`,
    `mtso`.`material_basic_amount` AS `material_basic_amount`,
    `mtso`.`material_discount_percent` AS `material_discount_percent`,
    `mtso`.`material_discount_amount` AS `material_discount_amount`,
    `mtso`.`material_taxable_amount` AS `material_taxable_amount`,
    `mtso`.`material_cgst_percent` AS `material_cgst_percent`,
    `mtso`.`material_cgst_total` AS `material_cgst_total`,
    `mtso`.`material_sgst_percent` AS `material_sgst_percent`,
    `mtso`.`material_sgst_total` AS `material_sgst_total`,
    `mtso`.`material_igst_percent` AS `material_igst_percent`,
    `mtso`.`material_igst_total` AS `material_igst_total`,
    `mtso`.`material_total_amount` AS `material_total_amount`,
    `mtso`.`material_schedule_date` AS `material_schedule_date`,
    `mtso`.`so_rate` AS `so_rate`,
    `mt`.`expected_dispatch_quantity` AS `expected_dispatch_quantity`,
    `mt`.`expected_dispatch_weight` AS `expected_dispatch_weight`,
    `mt`.`actual_dispatch_quantity` AS `actual_dispatch_quantity`,
    `mt`.`actual_dispatch_weight` AS `actual_dispatch_weight`,
    `mt`.`dispatch_return_quantity` AS `dispatch_return_quantity`,
    `mt`.`dispatch_return_weight` AS `dispatch_return_weight`,
    `mt`.`pending_quantity` AS `pending_quantity`,
    `mt`.`pending_weight` AS `pending_weight`,
    `mt`.`expected_schedule_date` AS `expected_schedule_date`,
    `mt`.`delayed_days` AS `delayed_days`,
    `mt`.`dispatched_quantity` AS `dispatched_quantity`,
    `mt`.`dispatched_weight` AS `dispatched_weight`,
    `mt`.`invoice_quantity` AS `invoice_quantity`,
    `mt`.`invoice_weight` AS `invoice_weight`,
    `mt`.`dispatch_schedule_item_status` AS `dispatch_schedule_item_status`,
    `mt`.`dispatch_schedule_creation_type` AS `dispatch_schedule_creation_type`,
    `mt`.`dispatch_schedule_remark` AS `dispatch_schedule_remark`,
    `dsmt`.`approved_date` AS `approved_date`,
    `dsmt`.`total_quantity` AS `total_quantity`,
    `dsmt`.`total_weight` AS `total_weight`,
    `dsmt`.`actual_quantity` AS `actual_quantity`,
    `dsmt`.`actual_weight` AS `actual_weight`,
    `dsmt`.`dispatch_note_status` AS `dispatch_note_status`,
    `dsmt`.`dispatch_note_remark` AS `dispatch_note_remark`,
    `dsmt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_hsn_sac_code_id` AS `product_material_hsn_code_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`dispatch_schedule_type_id` AS `dispatch_schedule_type_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `dsmt`.`customer_id` AS `customer_id`,
    `dsmt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `dsmt`.`customer_state_id` AS `customer_state_id`,
    `dsmt`.`customer_city_id` AS `customer_city_id`,
    `dsmt`.`consignee_id` AS `consignee_id`,
    `dsmt`.`consignee_state_id` AS `consignee_state_id`,
    `dsmt`.`consignee_city_id` AS `consignee_city_id`,
    `dsmt`.`dispatch_supervisor_id` AS `dispatch_supervisor_id`,
    `dsmt`.`approved_by_id` AS `approved_by_id`
from
    ((((`ERP_DEV_1_1`.`mt_dispatch_schedule_details_trading` `mt`
left join `ERP_DEV_1_1`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`mt_dispatch_schedule_master_trading` `dsmt` on
    (`dsmt`.`dispatch_schedule_master_transaction_id` = `mt`.`dispatch_schedule_master_transaction_id`
        and `dsmt`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`mtv_sales_order_details_trading` `mtso` on
    (`mtso`.`customer_order_no` = `mt`.`customer_order_no`
        and `mtso`.`sales_order_no` = `mt`.`sales_order_no`
        and `mtso`.`product_material_id` = `mt`.`product_material_id`
        and `mtso`.`so_sr_no` = `mt`.`so_sr_no`
        and `mtso`.`company_id` = `mt`.`company_id`
        and `mtso`.`company_branch_id` = `mt`.`company_branch_id`
        and `mtso`.`is_delete` = 0))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
--By yogesh 17-04-2024
-- mtv_sales_order_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_details_trading` AS
select
    case
        `sotv`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `sotv`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'A' then 'Auto'
        when 'R' then 'Reorder'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `sotv`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    case
        `mt`.`sales_order_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        when 'O' then 'PO'
        when 'G' then 'GRN'
        else 'Pending'
    end AS `sales_order_item_status_desc`,
    case
        `sotv`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `sotv`.`department_name` AS `department_name`,
    `sotv`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `sotv`.`customer_state_name` AS `customer_state_name`,
    `sotv`.`consignee_name` AS `consignee_name`,
    `sotv`.`consignee_state_name` AS `consignee_state_name`,
    `sotv`.`approved_date` AS `approved_date`,
    `sotv`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`invoice_nos` AS `invoice_nos`,
    `mt`.`sales_quantity` AS `previous_dispatch_quantity`,
    `mt`.`sales_weight` AS `previous_dispatch_weight`,
    '0' AS `stock_quantity`,
    '0' AS `stock_weight`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_type_short_name` AS `product_type_short_name`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `rmfgsr`.`product_material_make_name` AS `product_material_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`quotation_rate` AS `quotation_rate`,
    `mt`.`material_rate` AS `material_rate`,
    `mt`.`material_basic_amount` AS `material_basic_amount`,
    `mt`.`material_discount_percent` AS `material_discount_percent`,
    `mt`.`material_discount_amount` AS `material_discount_amount`,
    `mt`.`so_rate` AS `so_rate`,
    `mt`.`material_taxable_amount` AS `material_taxable_amount`,
    `mt`.`material_cgst_percent` AS `material_cgst_percent`,
    `mt`.`material_cgst_total` AS `material_cgst_total`,
    `mt`.`material_sgst_percent` AS `material_sgst_percent`,
    `mt`.`material_sgst_total` AS `material_sgst_total`,
    `mt`.`material_igst_percent` AS `material_igst_percent`,
    `mt`.`material_igst_total` AS `material_igst_total`,
    `mt`.`material_freight_amount` AS `material_freight_amount`,
    `mt`.`material_total_amount` AS `material_total_amount`,
    `mt`.`material_schedule_date` AS `material_schedule_date`,
    `mt`.`dispatch_note_nos` AS `dispatch_note_nos`,
    `mt`.`dispatch_challan_nos` AS `dispatch_challan_nos`,
    `mt`.`production_issue_quantity` AS `production_issue_quantity`,
    `mt`.`production_issue_weight` AS `production_issue_weight`,
    `mt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `mt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `mt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `mt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sotv`.`sales_order_status` AS `sales_order_status`,
    `sotv`.`sales_order_life` AS `sales_order_life`,
    `sotv`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `mt`.`sales_order_item_status` AS `sales_order_item_status`,
    `sotv`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `sotv`.`customer_email` AS `customer_email`,
    `sotv`.`customer_city_name` AS `customer_city_name`,
    `sotv`.`customer_district_name` AS `customer_district_name`,
    `sotv`.`consignee_city_name` AS `consignee_city_name`,
    `sotv`.`consignee_district_name` AS `consignee_district_name`,
    `sotv`.`approved_by_name` AS `approved_by_name`,
    `sotv`.`basic_total` AS `basic_total`,
    `sotv`.`transport_amount` AS `transport_amount`,
    `sotv`.`freight_amount` AS `freight_amount`,
    `sotv`.`packing_amount` AS `packing_amount`,
    `sotv`.`discount_percent` AS `discount_percent`,
    `sotv`.`discount_amount` AS `discount_amount`,
    `sotv`.`other_amount` AS `other_amount`,
    `sotv`.`taxable_total` AS `taxable_total`,
    `sotv`.`cgst_percent` AS `cgst_percent`,
    `sotv`.`cgst_total` AS `cgst_total`,
    `sotv`.`sgst_percent` AS `sgst_percent`,
    `sotv`.`sgst_total` AS `sgst_total`,
    `sotv`.`igst_percent` AS `igst_percent`,
    `sotv`.`igst_total` AS `igst_total`,
    `sotv`.`roundoff` AS `roundoff`,
    `sotv`.`grand_total` AS `grand_total`,
    `sotv`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `sotv`.`company_name` AS `company_name`,
    `sotv`.`company_branch_name` AS `company_branch_name`,
    `sotv`.`company_address1` AS `company_address1`,
    `sotv`.`company_address2` AS `company_address2`,
    `sotv`.`company_phone_no` AS `company_phone_no`,
    `sotv`.`company_cell_no` AS `company_cell_no`,
    `sotv`.`company_EmailId` AS `company_EmailId`,
    `sotv`.`company_website` AS `company_website`,
    `sotv`.`company_gst_no` AS `company_gst_no`,
    `sotv`.`company_pan_no` AS `company_pan_no`,
    `sotv`.`company_branch_state` AS `company_state`,
    `sotv`.`company_pincode` AS `company_pincode`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `sotv`.`customer_id` AS `customer_id`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_quantity`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_weight`) from `ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_weight`,
    `sop`.`product_parameter_name` AS `product_parameter_name`,
    `sop`.`product_parameter_value` AS `product_parameter_value`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_details_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_branch_id` = `mt`.`company_branch_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`
        and `rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` `sotv` on
    (`sotv`.`company_branch_id` = `mt`.`company_branch_id`
        and `sotv`.`company_id` = `mt`.`company_id`
        and `sotv`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_product_dynamic_parameters` `sop` on
    (`sop`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`
        and `sop`.`product_id` = `mt`.`product_material_id`
        and `sop`.`product_parameter_name` = 'COUNT'))
where
    `mt`.`is_delete` = 0 order by mt.sales_order_details_transaction_id desc;


-------------------------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.mtv_sales_order_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_sales_order_details_trading` AS
select
    case
        `sotv`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `sotv`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'A' then 'Auto'
        when 'R' then 'Reorder'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `sotv`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    case
        `mt`.`sales_order_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        when 'O' then 'PO'
        when 'G' then 'GRN'
        else 'Pending'
    end AS `sales_order_item_status_desc`,
    case
        `sotv`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `sotv`.`department_name` AS `department_name`,
    `sotv`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `sotv`.`customer_state_name` AS `customer_state_name`,
    `sotv`.`consignee_name` AS `consignee_name`,
    `sotv`.`consignee_state_name` AS `consignee_state_name`,
    `sotv`.`approved_date` AS `approved_date`,
    `sotv`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`invoice_nos` AS `invoice_nos`,
    `mt`.`sales_quantity` AS `previous_dispatch_quantity`,
    `mt`.`sales_weight` AS `previous_dispatch_weight`,
    '0' AS `stock_quantity`,
    '0' AS `stock_weight`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_type_short_name` AS `product_type_short_name`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `rmfgsr`.`product_material_make_name` AS `product_material_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`quotation_rate` AS `quotation_rate`,
    `mt`.`material_rate` AS `material_rate`,
    `mt`.`material_basic_amount` AS `material_basic_amount`,
    `mt`.`material_discount_percent` AS `material_discount_percent`,
    `mt`.`material_discount_amount` AS `material_discount_amount`,
    `mt`.`so_rate` AS `so_rate`,
    `mt`.`material_taxable_amount` AS `material_taxable_amount`,
    `mt`.`material_cgst_percent` AS `material_cgst_percent`,
    `mt`.`material_cgst_total` AS `material_cgst_total`,
    `mt`.`material_sgst_percent` AS `material_sgst_percent`,
    `mt`.`material_sgst_total` AS `material_sgst_total`,
    `mt`.`material_igst_percent` AS `material_igst_percent`,
    `mt`.`material_igst_total` AS `material_igst_total`,
    `mt`.`material_freight_amount` AS `material_freight_amount`,
    `mt`.`material_total_amount` AS `material_total_amount`,
    `mt`.`material_schedule_date` AS `material_schedule_date`,
    `mt`.`dispatch_note_nos` AS `dispatch_note_nos`,
    `mt`.`dispatch_challan_nos` AS `dispatch_challan_nos`,
    `mt`.`production_issue_quantity` AS `production_issue_quantity`,
    `mt`.`production_issue_weight` AS `production_issue_weight`,
    `mt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `mt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `mt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `mt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sotv`.`sales_order_status` AS `sales_order_status`,
    `sotv`.`sales_order_life` AS `sales_order_life`,
    `sotv`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `mt`.`sales_order_item_status` AS `sales_order_item_status`,
    `sotv`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `sotv`.`customer_email` AS `customer_email`,
    `sotv`.`customer_city_name` AS `customer_city_name`,
    `sotv`.`customer_district_name` AS `customer_district_name`,
    `sotv`.`consignee_city_name` AS `consignee_city_name`,
    `sotv`.`consignee_district_name` AS `consignee_district_name`,
    `sotv`.`approved_by_name` AS `approved_by_name`,
    `sotv`.`basic_total` AS `basic_total`,
    `sotv`.`transport_amount` AS `transport_amount`,
    `sotv`.`freight_amount` AS `freight_amount`,
    `sotv`.`packing_amount` AS `packing_amount`,
    `sotv`.`discount_percent` AS `discount_percent`,
    `sotv`.`discount_amount` AS `discount_amount`,
    `sotv`.`other_amount` AS `other_amount`,
    `sotv`.`taxable_total` AS `taxable_total`,
    `sotv`.`cgst_percent` AS `cgst_percent`,
    `sotv`.`cgst_total` AS `cgst_total`,
    `sotv`.`sgst_percent` AS `sgst_percent`,
    `sotv`.`sgst_total` AS `sgst_total`,
    `sotv`.`igst_percent` AS `igst_percent`,
    `sotv`.`igst_total` AS `igst_total`,
    `sotv`.`roundoff` AS `roundoff`,
    `sotv`.`grand_total` AS `grand_total`,
    `sotv`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `sotv`.`company_name` AS `company_name`,
    `sotv`.`company_branch_name` AS `company_branch_name`,
    `sotv`.`company_address1` AS `company_address1`,
    `sotv`.`company_address2` AS `company_address2`,
    `sotv`.`company_phone_no` AS `company_phone_no`,
    `sotv`.`company_cell_no` AS `company_cell_no`,
    `sotv`.`company_EmailId` AS `company_EmailId`,
    `sotv`.`company_website` AS `company_website`,
    `sotv`.`company_gst_no` AS `company_gst_no`,
    `sotv`.`company_pan_no` AS `company_pan_no`,
    `sotv`.`company_branch_state` AS `company_state`,
    `sotv`.`company_pincode` AS `company_pincode`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `sotv`.`customer_id` AS `customer_id`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_quantity`) from `ERP_DEV_1_1`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_quantity`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_weight`) from `ERP_DEV_1_1`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_weight`

from
    ((`ERP_DEV_1_1`.`mt_sales_order_details_trading` `mt`
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_branch_id` = `mt`.`company_branch_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`
        and `rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_DEV_1_1`.`mtv_sales_order_master_trading_summary` `sotv` on
    (`sotv`.`company_branch_id` = `mt`.`company_branch_id`
        and `sotv`.`company_id` = `mt`.`company_id`
        and `sotv`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`))
where
    `mt`.`is_delete` = 0
order by
    `mt`.`sales_order_details_transaction_id` desc;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_details_trading` AS
select
    case
        `sotv`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `sotv`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'A' then 'Auto'
        when 'R' then 'Reorder'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `sotv`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    case
        `mt`.`sales_order_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        when 'O' then 'PO'
        when 'G' then 'GRN'
        else 'Pending'
    end AS `sales_order_item_status_desc`,
    case
        `sotv`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `sotv`.`department_name` AS `department_name`,
    `sotv`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `sotv`.`customer_state_name` AS `customer_state_name`,
    `sotv`.`consignee_name` AS `consignee_name`,
    `sotv`.`consignee_state_name` AS `consignee_state_name`,
    `sotv`.`approved_date` AS `approved_date`,
    `sotv`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`invoice_nos` AS `invoice_nos`,
    `mt`.`sales_quantity` AS `previous_dispatch_quantity`,
    `mt`.`sales_weight` AS `previous_dispatch_weight`,
    '0' AS `stock_quantity`,
    '0' AS `stock_weight`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_type_short_name` AS `product_type_short_name`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `rmfgsr`.`product_material_make_name` AS `product_material_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`quotation_rate` AS `quotation_rate`,
    `mt`.`material_rate` AS `material_rate`,
    `mt`.`material_basic_amount` AS `material_basic_amount`,
    `mt`.`material_discount_percent` AS `material_discount_percent`,
    `mt`.`material_discount_amount` AS `material_discount_amount`,
    `mt`.`so_rate` AS `so_rate`,
    `mt`.`material_taxable_amount` AS `material_taxable_amount`,
    `mt`.`material_cgst_percent` AS `material_cgst_percent`,
    `mt`.`material_cgst_total` AS `material_cgst_total`,
    `mt`.`material_sgst_percent` AS `material_sgst_percent`,
    `mt`.`material_sgst_total` AS `material_sgst_total`,
    `mt`.`material_igst_percent` AS `material_igst_percent`,
    `mt`.`material_igst_total` AS `material_igst_total`,
    `mt`.`material_freight_amount` AS `material_freight_amount`,
    `mt`.`material_total_amount` AS `material_total_amount`,
    `mt`.`material_schedule_date` AS `material_schedule_date`,
    `mt`.`dispatch_note_nos` AS `dispatch_note_nos`,
    `mt`.`dispatch_challan_nos` AS `dispatch_challan_nos`,
    `mt`.`production_issue_quantity` AS `production_issue_quantity`,
    `mt`.`production_issue_weight` AS `production_issue_weight`,
    `mt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `mt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `mt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `mt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sotv`.`sales_order_status` AS `sales_order_status`,
    `sotv`.`sales_order_life` AS `sales_order_life`,
    `sotv`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `mt`.`sales_order_item_status` AS `sales_order_item_status`,
    `sotv`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `sotv`.`customer_email` AS `customer_email`,
    `sotv`.`customer_city_name` AS `customer_city_name`,
    `sotv`.`customer_district_name` AS `customer_district_name`,
    `sotv`.`consignee_city_name` AS `consignee_city_name`,
    `sotv`.`consignee_district_name` AS `consignee_district_name`,
    `sotv`.`approved_by_name` AS `approved_by_name`,
    `sotv`.`basic_total` AS `basic_total`,
    `sotv`.`transport_amount` AS `transport_amount`,
    `sotv`.`freight_amount` AS `freight_amount`,
    `sotv`.`packing_amount` AS `packing_amount`,
    `sotv`.`discount_percent` AS `discount_percent`,
    `sotv`.`discount_amount` AS `discount_amount`,
    `sotv`.`other_amount` AS `other_amount`,
    `sotv`.`taxable_total` AS `taxable_total`,
    `sotv`.`cgst_percent` AS `cgst_percent`,
    `sotv`.`cgst_total` AS `cgst_total`,
    `sotv`.`sgst_percent` AS `sgst_percent`,
    `sotv`.`sgst_total` AS `sgst_total`,
    `sotv`.`igst_percent` AS `igst_percent`,
    `sotv`.`igst_total` AS `igst_total`,
    `sotv`.`roundoff` AS `roundoff`,
    `sotv`.`grand_total` AS `grand_total`,
    `sotv`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `sotv`.`company_name` AS `company_name`,
    `sotv`.`company_branch_name` AS `company_branch_name`,
    `sotv`.`company_address1` AS `company_address1`,
    `sotv`.`company_address2` AS `company_address2`,
    `sotv`.`company_phone_no` AS `company_phone_no`,
    `sotv`.`company_cell_no` AS `company_cell_no`,
    `sotv`.`company_EmailId` AS `company_EmailId`,
    `sotv`.`company_website` AS `company_website`,
    `sotv`.`company_gst_no` AS `company_gst_no`,
    `sotv`.`company_pan_no` AS `company_pan_no`,
    `sotv`.`company_branch_state` AS `company_state`,
    `sotv`.`company_pincode` AS `company_pincode`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `sotv`.`customer_id` AS `customer_id`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_quantity`,
    coalesce((select sum(`mtDispatch`.`actual_dispatch_weight`) from `ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_details_trading` `mtDispatch` where `mtDispatch`.`customer_order_no` = `mt`.`customer_order_no` and `mtDispatch`.`product_material_id` = `mt`.`product_material_id` and `mtDispatch`.`so_sr_no` = `mt`.`so_sr_no`), 0) AS `dispatched_weight`

from
    ((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_details_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_branch_id` = `mt`.`company_branch_id`
        and `rmfgsr`.`company_id` = `mt`.`company_id`
        and `rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` `sotv` on
    (`sotv`.`company_branch_id` = `mt`.`company_branch_id`
        and `sotv`.`company_id` = `mt`.`company_id`
        and `sotv`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`))
where
    `mt`.`is_delete` = 0
order by
    `mt`.`sales_order_details_transaction_id` desc;
-------------------------------------------------------------------------------------------------------------------------------
--changes by yogesh---

-- ERP_DEV_1_1.mt_dispatch_schedule_packing_details definition

CREATE or REPLACE  TABLE `mt_dispatch_schedule_packing_details` (
  `dispatch_schedule_master_transaction_id` bigint(20) NOT NULL COMMENT '* will come from header section',
  `dispatch_schedule_details_transaction_id` bigint(20) DEFAULT NULL COMMENT '* read only back end auto generated *',
  `dispatch_schedule_packing_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `yarn_packing_details_id` bigint(20) DEFAULT NULL COMMENT '* read only back end*',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session  ',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
  `financial_year` varchar(20) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_schedule_no` varchar(50) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_schedule_date` date NOT NULL COMMENT 'will come from header section  *',
  `dispatch_schedule_version` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
  `customer_order_no` varchar(500) DEFAULT NULL COMMENT 'combo box with mtv_sales_order_summary with customer id filter on select of Every Customer ORder no , Fill Grid data from mt_sales_order_schedules_trading  ',
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format  combo box with cmv_product_rm/cmv_product_fg/cmv_product_sr with all technical parameter shows ing grids for selected material ',
  `so_sr_no` varchar(100) DEFAULT NULL COMMENT '* * Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `sr_no` bigint(20) DEFAULT NULL COMMENT '* * Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `product_unit_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_unit ',
  `dispatch_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `dispatch_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `cone_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `cone_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `per_packing_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_gross_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_net_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_starting_no` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `packing_ending_no` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `lot_no` text DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `sub_lot_no` text DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `yarn_packing_date` date DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `yarn_packing_types_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `production_count_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `remark` varchar(1000) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`dispatch_schedule_packing_id`)
)

-------------------------------------------------------------------------------------------------------------------------------
CREATE TABLE `mt_dispatch_schedule_product_dynamic_parameters` (
  `company_id` bigint(20) NOT NULL DEFAULT 1,
  `company_branch_id` bigint(20) DEFAULT 1,
  `dispatch_schedule_parameter_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'dispatch schedule parameter id Autogenerate ',
  `product_parameter_id` bigint(20) NOT NULL,
  `dispatch_schedule_master_transaction_id` bigint(20) DEFAULT NULL,
  `dispatch_schedule_details_transaction_id` bigint(20) DEFAULT NULL,
  `dispatch_schedule_no` varchar(500) NOT NULL,
  `dispatch_schedule_date` date DEFAULT NULL,
  `dispatch_schedule_version` bigint(20) DEFAULT NULL,
  `customer_order_no` varchar(250) DEFAULT NULL COMMENT 'get from dispatch schedule master data front end',
  `product_id` varchar(20) NOT NULL,
  `product_type_id` bigint(20) NOT NULL,
  `product_parameter_name` text NOT NULL,
  `product_parameter_value` varchar(500) NOT NULL COMMENT 'parmater value select if combo , text or date',
  `product_parameter_actual_value` varchar(500) DEFAULT NULL COMMENT 'data Entry texbox',
  `product_parameter_prefix` varchar(5) DEFAULT NULL,
  `product_parameter_sufix` varchar(5) DEFAULT NULL COMMENT 'Suffix data entry',
  `product_parameter_calculation_type` text DEFAULT NULL,
  `product_parameter_from_value` text DEFAULT NULL,
  `product_parameter_to_value` text DEFAULT NULL,
  `product_parameter_formula` text DEFAULT NULL,
  `remark` varchar(255) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`dispatch_schedule_parameter_id`)
)
-------------------------------------------------------------------------------------------------------------------------------
---changes by yogesh ---------------------

-- ERP_DEV_1_1.mtv_dispatch_schedule_packing_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`mtv_dispatch_schedule_packing_details` AS
select
	`mt`.`sr_no` AS `sr_no`,
	`ddt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
	`mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
	`mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
	`mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
	`mt`.`customer_order_no` AS `customer_order_no`,
	`xm`.`production_count_name` AS `production_count_name`,
	`yp`.`yarn_packing_types_name` AS `yarn_packing_types_name`,
	`mt`.`so_sr_no` AS `so_sr_no`,
	`ddt`.`product_material_name` AS `product_material_name`,
	`ddt`.`product_material_print_name` AS `product_material_print_name`,
    `ddt`.`product_material_tech_spect` AS `product_material_tech_spect`,
	`u`.`product_unit_name` AS `product_unit_name`,
	`mt`.`dispatch_quantity` AS `dispatch_quantity`,
	`mt`.`dispatch_weight` AS `dispatch_weight`,
	`mt`.`cone_weight` AS `cone_weight`,
	`mt`.`cone_quantity` AS `cone_quantity`,
	`mt`.`per_packing_weight` AS `per_packing_weight`,
	`mt`.`packing_gross_weight` AS `packing_gross_weight`,
	`mt`.`packing_net_weight` AS `packing_net_weight`,
	`mt`.`packing_quantity` AS `packing_quantity`,
	`mt`.`packing_starting_no` AS `packing_starting_no`,
	`mt`.`packing_ending_no` AS `packing_ending_no`,
	`mt`.`lot_no` AS `lot_no`,
	`mt`.`sub_lot_no` AS `sub_lot_no`,
	`mt`.`remark` AS `remark`,
	`v`.`company_legal_name` AS `company_name`,
	`v`.`company_branch_name` AS `company_branch_name`,
	`mt`.`financial_year` AS `financial_year`,
	case
		`mt`.`is_active` when 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		`mt`.`is_delete` when 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`mt`.`is_active` AS `is_active`,
	`mt`.`is_delete` AS `is_delete`,
	`mt`.`created_by` AS `created_by`,
	`mt`.`created_on` AS `created_on`,
	`mt`.`modified_by` AS `modified_by`,
	`mt`.`modified_on` AS `modified_on`,
	`mt`.`deleted_by` AS `deleted_by`,
	`mt`.`deleted_on` AS `deleted_on`,
	`mt`.`yarn_packing_date` AS `yarn_packing_date`,
	`mt`.`yarn_packing_types_id` AS `yarn_packing_types_id`,
	`mt`.`production_count_id` AS `production_count_id`,
	`mt`.`product_material_id` AS `product_material_id`,
	`mt`.`product_unit_id` AS `product_unit_id`,
	`mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
	`mt`.`company_id` AS `company_id`,
	`mt`.`company_branch_id` AS `company_branch_id`,
	`mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
	`mt`.`dispatch_schedule_packing_id` As `dispatch_schedule_packing_id` ,
	`mt`.`yarn_packing_details_id` As `yarn_packing_details_id`
from
	(((((`ERP_DEV_1_1`.`mt_dispatch_schedule_packing_details` `mt`
left join `ERP_DEV_1_1`.`cmv_company` `v` on
	(`v`.`company_branch_id` = `mt`.`company_branch_id`
		and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`xm_spinning_prod_count` `xm` on
	(`xm`.`production_count_id` = `mt`.`production_count_id`
		and `xm`.`company_id` = `mt`.`company_id`))
left join `ERP_DEV_1_1`.`xm_yarn_packing_types` `yp` on
	(`yp`.`yarn_packing_types_id` = `mt`.`yarn_packing_types_id`
		and `yp`.`company_id` = `mt`.`company_id`))
 left join `ERP_DEV_1_1`.`sm_product_unit` `u` on
    (`u`.`company_id` = `mt`.`company_id`
        and `u`.`product_unit_id` = `mt`.`product_unit_id`))
left join `ERP_DEV_1_1`.`mtv_dispatch_schedule_details_trading` `ddt` on
    (`ddt`.`company_id` = `mt`.`company_id`
        and `ddt`.`dispatch_schedule_details_transaction_id` = `mt`.`dispatch_schedule_details_transaction_id`))
where
	`mt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

-- ptv_purchase_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_product_dynamic_parameters` AS
select
	`b`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
	`b`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
	`rm_fg_sr`.`product_type_name` AS `product_type_name`,
	`rm_fg_sr`.`product_type_group` AS `product_type_group`,
	`rm_fg_sr`.`product_material_name` AS `product_material_name`,
	`rm_fg_sr`.`product_material_code` AS `product_material_code`,
	`b`.`product_parameter_name` AS `product_parameter_name`,
	`b`.`product_parameter_value` AS `product_parameter_value`,
	`b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
	`b`.`product_parameter_prefix` AS `product_parameter_prefix`,
	`b`.`product_parameter_sufix` AS `product_parameter_sufix`,
	`b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
	`b`.`product_parameter_from_value` AS `product_parameter_from_value`,
	`b`.`product_parameter_to_value` AS `product_parameter_to_value`,
	`b`.`product_parameter_formula` AS `product_parameter_formula`,
	`b`.`remark` AS `remark`,
	`d`.`control_master` AS `control_master`,
	`d`.`control_type` AS `control_type`,
	`b`.`customer_order_no` As `customer_order_no`,
	`v`.`company_legal_name` AS `company_name`,
	`v`.`company_branch_name` AS `company_branch_name`,
	case
		`b`.`is_active` when 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		`b`.`is_delete` when 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`b`.`dispatch_schedule_version` As `dispatch_schedule_version`,
	`b`.`is_active` AS `is_active`,
	`b`.`is_delete` AS `is_delete`,
	`b`.`created_by` AS `created_by`,
	`b`.`created_on` AS `created_on`,
	`b`.`modified_by` AS `modified_by`,
	`b`.`modified_on` AS `modified_on`,
	`b`.`deleted_by` AS `deleted_by`,
	`b`.`deleted_on` AS `deleted_on`,
	`b`.`company_id` AS `company_id`,
	`b`.`company_branch_id` AS `company_branch_id`,
	`b`.`product_id` AS `product_id`,
	`b`.`product_type_id` AS `product_type_id`,
	`b`.`dispatch_schedule_parameter_id` AS `dispatch_schedule_parameter_id`,
	`b`.`product_parameter_id` AS `product_parameter_id`,
	`b`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
	`b`.`dispatch_schedule_details_transaction_id` As `dispatch_schedule_details_transaction_id`,
	`b`.`dispatch_schedule_parameter_id` AS `field_id`,
	`b`.`product_parameter_name` AS `field_name`
from
	(((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
	(`v`.`company_id` = `b`.`company_id`
		and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
	(`d`.`company_id` = `b`.`company_id`
		and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
	(`rm_fg_sr`.`company_id` = `b`.`company_id`
		and `rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
		and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
	`b`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------

-- mtv_sales_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_product_dynamic_parameters` AS
select
    `b`.`sales_order_no` AS `sales_order_no`,
    `b`.`sales_order_date` AS `sales_order_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`, ------Added after changes
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`sales_order_version` AS `sales_order_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`sales_order_parameter_id` AS `sales_order_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `b`.`sales_order_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`company_id` = `b`.`company_id`
        and `rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE sm_product_type_dynamic_controls ADD display_sequence INT(11) DEFAULT NULL NULL COMMENT 'data entry textbox for display sequence of control types';
-------------------------------------------------------------------------------------------------------------------------------

-- smv_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` AS
select
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `d`.`display_sequence` AS `display_sequence`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`product_type_dynamic_controls_id` AS `product_type_dynamic_controls_id`,
    `b`.`product_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`sm_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type_dynamic_controls` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_type_dynamic_controls_id` = `b`.`product_type_dynamic_controls_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`company_id` = `b`.`company_id`
        and `rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- amv_properties source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`amv_properties` AS
select
    `P`.`properties_master_name` AS `properties_master_name`,
    `P`.`property_name` AS `property_name`,
    `P`.`property_value` AS `property_value`,
    CONCAT( `P`.`property_name`,':',`P`.`property_value`)  AS `property_name_value`,
    case
        `P`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `P`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `P`.`is_delete` AS `is_delete`,
    `P`.`is_active` AS `is_active`,
    `P`.`property_master_id` AS `property_master_id`,
    `P`.`property_group` AS `property_group`,
    `P`.`property_id` AS `property_id`,
    `P`.`company_id` AS `company_id`,
    `P`.`created_by` AS `created_by`,
    `P`.`created_on` AS `created_on`,
    `P`.`modified_by` AS `modified_by`,
    `P`.`modified_on` AS `modified_on`,
    `P`.`deleted_by` AS `deleted_by`,
    `P`.`deleted_on` AS `deleted_on`,
    `P`.`property_id` AS `field_id`,
    `P`.`property_name` AS `field_name`,
    `P`.`remark` AS `remark`
from
    `ERP_PASHUPATI_DEV_1_0`.`am_properties` `P`
order by
    `P`.`property_master_id`;
-------------------------------------------------------------------------------------------------------------------------------
------28-04-2024-------------------

ALTER TABLE sm_product_rm MODIFY COLUMN product_rm_code varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL;
-------------------------------------------------------------------------------------------------------------------------------

INSERT INTO sm_product_type_accordian_access (company_id,company_branch_id,module_id,sub_module_id,modules_forms_id,product_type_id,product_type_name,product_type_short_name,accordian_name,is_display,display_sequence,is_taxable,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,1,16,169,15,'Raw Cotton','RC','General Header',0,1,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','Raw Cotton Form',1,2,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','PO Details',0,0,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','Purchase Order Terms',1,5,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','Payment Terms',1,4,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','Payment Terms',1,4,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','General Header',1,2,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','PO Details',1,3,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','Purchase Order Terms',1,5,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','Raw Cotton Details',1,3,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO sm_product_type_accordian_access (company_id,company_branch_id,module_id,sub_module_id,modules_forms_id,product_type_id,product_type_name,product_type_short_name,accordian_name,is_display,display_sequence,is_taxable,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,1,16,169,15,'Raw Cotton','RC','Ginning Footer',1,7,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','Document List',1,6,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','Document List',1,6,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,169,15,'Raw Cotton','RC','General Footer',0,8,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,105,15,'NA','NA','General Footer',1,7,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,272,17,'Yarn','YN','Payment Terms',1,4,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,272,17,'Yarn','YN','General Header',1,2,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,272,17,'Yarn','YN','PO Details',1,3,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,272,17,'Yarn','YN','Purchase Order Terms',1,5,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,272,17,'Yarn','YN','Document List',1,6,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO sm_product_type_accordian_access (company_id,company_branch_id,module_id,sub_module_id,modules_forms_id,product_type_id,product_type_name,product_type_short_name,accordian_name,is_display,display_sequence,is_taxable,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,1,16,272,17,'Yarn','YN','General Footer',1,7,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','Payment Terms',1,4,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','General Header',1,2,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','PO Details',1,3,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','Purchase Order Terms',1,5,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','Document List',1,6,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,273,18,'Greige  Fabric','GF','General Footer',1,7,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,248,15,'NA','NA','Payment Terms',1,4,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,248,15,'NA','NA','General Header',1,2,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,248,15,'NA','NA','PO Details',1,3,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO sm_product_type_accordian_access (company_id,company_branch_id,module_id,sub_module_id,modules_forms_id,product_type_id,product_type_name,product_type_short_name,accordian_name,is_display,display_sequence,is_taxable,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,1,16,248,15,'NA','NA','Purchase Order Terms',1,5,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,248,15,'NA','NA','Document List',1,6,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,248,15,'NA','NA','General Footer',1,7,1,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','General Header',0,1,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','Raw Cotton Form',1,2,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','PO Details',0,0,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','Purchase Order Terms',1,5,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','Payment Terms',1,4,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','Raw Cotton Details',1,3,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','Ginning Footer',1,7,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO sm_product_type_accordian_access (company_id,company_branch_id,module_id,sub_module_id,modules_forms_id,product_type_id,product_type_name,product_type_short_name,accordian_name,is_display,display_sequence,is_taxable,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,1,16,277,15,'Raw Cotton','RC','Document List',1,6,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,16,277,15,'Raw Cotton','RC','General Footer',0,8,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,289,17,'Yarn','YN','Product Properties',1,3,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,289,17,'Yarn','YN','Yarn Packing Details',1,2,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,124,15,'NA','NA','Product Properties',1,3,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,289,17,'Yarn','YN','Gate Pass Details',1,4,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,124,15,'NA','NA','Dispatch Note Details',1,1,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL),
	 (1,1,1,19,289,17,'Yarn','YN','Dispatch Note Details',1,1,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL);
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- fmv_cost_center_heads source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center_heads` AS
select
    `f`.`cost_center_heads_group` AS `cost_center_heads_group`,
    `f`.`cost_center_heads_name` AS `cost_center_heads_name`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `f`.`cost_center_heads_short_name` AS `cost_center_heads_short_name`,
    `fc`.`cost_center_group` AS `cost_center_group`,
    `fc`.`cost_center_short_name` AS `cost_center_short_name`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `f`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `f`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `f`.`is_active` AS `is_active`,
    `f`.`is_delete` AS `is_delete`,
    `f`.`created_by` AS `created_by`,
    `f`.`created_on` AS `created_on`,
    `f`.`modified_by` AS `modified_by`,
    `f`.`modified_on` AS `modified_on`,
    `f`.`deleted_by` AS `deleted_by`,
    `f`.`deleted_on` AS `deleted_on`,
    `f`.`company_id` AS `company_id`,
    `f`.`company_branch_id` AS `company_branch_id`,
    `f`.`cost_center_heads_id` AS `cost_center_heads_id`,
    `f`.`cost_center_id` AS `cost_center_id`,
    `f`.`cost_center_heads_name` AS `field_name`,
    `f`.`cost_center_heads_id` AS `field_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`fm_cost_center_heads` `f`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `f`.`company_id`
        and `v`.`company_branch_id` = `f`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `f`.`cost_center_id`
        and `fc`.`is_delete` = 0))
where
    `f`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
---29-04-24----

add stock and display


-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`company_id` = `pt`.`company_id`
        and `p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `pt`.`company_id`
        and `rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`company_id` = `pt`.`company_id`
        and `pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`company_id` = `pt`.`company_id`
        and `hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`
        and `p`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;

-------------------------------------------------------------------------------------------------------------------------------
add cost centre id in indent master
ALTER TABLE st_indent_master ADD cost_center_id BIGINT(20) NOT NULL COMMENT 'combo box default load from fmv_cost_center';
ALTER TABLE st_indent_master CHANGE cost_center_id cost_center_id BIGINT(20) NOT NULL COMMENT 'combo box default load from fmv_cost_center' AFTER indent_status;

-------------------------------------------------------------------------------------------------------------------------------
add cost centre in indent master view
-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` AS
	select
	    `st`.`indent_no` AS `indent_no`,
	    `st`.`indent_date` AS `indent_date`,
	    `st`.`indent_version` AS `indent_version`,
	    case
	        `st`.`indent_source` when 'S' then 'SO Based'
	        when 'O' then 'Direct'
	        else 'Internal'
	    end AS `indent_source_desc`,
	    `vp`.`department_name` AS `department_name`,
	    `sd`.`department_name` AS `sub_department_name`,
	    `e`.`employee_name` AS `indented_by_name`,
	    `e1`.`employee_name` AS `approved_by_name`,
	    `st`.`approved_date` AS `approved_date`,
	    case
	        `st`.`indent_status` when 'A' then 'Approved'
	        when 'R' then 'Rejected'
	        when 'C' then 'Completed'
	        when 'X' then 'Cenceled'
	        when 'O' then 'Purchse Order Genreated'
	        when 'POA' then 'Purchse Order Approved'
	        when 'G' then 'Goods Receipts'
	        when 'I' then 'Partial Issue'
	        else 'Pending'
	    end AS `indent_status_desc`,
	    `c`.`customer_name` AS `customer_name`,
	    `c`.`state_name` AS `customer_state_name`,
	    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
	    `c`.`cust_branch_address1` AS `cust_branch_address1`,
	    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
	    `st`.`customer_order_no` AS `customer_order_no`,
	    `st`.`customer_order_Date` AS `customer_order_date`,
	    `st`.`expected_schedule_date` AS `expected_schedule_date`,
	    `fc`.`cost_center_name` AS `cost_center_name`,
	    case
	        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
	        else 'Manual'
	    end AS `indent_transaction_type_desc`,
	    case
	        when `st`.`is_active` = 1 then 'Active'
	        else 'In Active'
	    end AS `Active`,
	    case
	        when `st`.`is_delete` = 1 then 'Yes'
	        else 'No'
	    end AS `Deleted`,
	    `st`.`remark` AS `remark`,
	    `st`.`indent_no` AS `field_name`,
	    `st`.`indent_version` AS `field_id`,
	    `st`.`is_active` AS `is_active`,
	    `st`.`is_delete` AS `is_delete`,
	    `st`.`created_by` AS `created_by`,
	    `st`.`created_on` AS `created_on`,
	    `st`.`modified_by` AS `modified_by`,
	    `st`.`modified_on` AS `modified_on`,
	    `st`.`deleted_by` AS `deleted_by`,
	    `st`.`deleted_on` AS `deleted_on`,
	    `v`.`company_legal_name` AS `company_name`,
	    `v`.`company_branch_name` AS `company_branch_name`,
	    `st`.`financial_year` AS `financial_year`,
	    `st`.`indent_master_id` AS `indent_master_id`,
	    `st`.`indent_type_id` AS `indent_type_id`,
	    `st`.`customer_id` AS `customer_id`,
	    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
	    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
	    `st`.`department_id` AS `department_id`,
	    `st`.`sub_department_id` AS `sub_department_id`,
	    `st`.`indented_by_id` AS `indented_by_id`,
	    `st`.`approved_by_id` AS `approved_by_id`,
	    `st`.`cost_center_id` AS `cost_center_id`,
	    `st`.`indent_status` AS `indent_status`,
	    `st`.`company_id` AS `company_id`,
	    `st`.`company_branch_id` AS `company_branch_id`,
	    `st`.`indent_transaction_type` AS `indent_transaction_type`,
	    `st`.`Indent_type` AS `indent_type`,
	    `p`.`product_type_short_name` AS `indent_type_short_name`,
	    `st`.`indent_source` AS `indent_source`
	from
	    ((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_master` `st`
	left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
	    (`v`.`company_branch_id` = `st`.`company_branch_id`
	        and `v`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
	    (`c`.`company_id` = `st`.`company_id`
	        and `c`.`customer_id` = `st`.`customer_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
	    (`vp`.`department_id` = `st`.`department_id`
	        and `vp`.`company_branch_id` = `st`.`company_branch_id`
	        and `vp`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
	    (`sd`.`department_id` = `st`.`sub_department_id`
	        and `sd`.`company_branch_id` = `st`.`company_branch_id`
	        and `sd`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
	    (`e`.`employee_id` = `st`.`indented_by_id`
	        and `e`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
	    (`e1`.`employee_id` = `st`.`approved_by_id`
	        and `e1`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
	    (`p`.`product_type_id` = `st`.`indent_type_id`
	        and `p`.`company_id` = `st`.`company_id`))
	left join `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center` `fc` on
	    (`fc`.`cost_center_id` = `st`.`cost_center_id`
	        and `fc`.`company_id` = `st`.`company_id`))
	where
	    `st`.`is_delete` = 0
	order by
	    `st`.`indent_no`,
	    `st`.`indent_version`;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `v`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_stock` `ptdetails` where `ptdetails`.`product_material_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_stock` `ptdetails` where `ptdetails`.`product_material_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `child` on
    (`child`.`company_id` = `st`.`company_id`
        and `child`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `parent` on
    (`parent`.`company_id` = `st`.`company_id`
        and `parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_details ADD cost_center_id TEXT NULL COMMENT 'cost center id from fmv_cost_center_id';
ALTER TABLE st_indent_details CHANGE cost_center_id cost_center_id TEXT NULL COMMENT 'cost center id from fmv_cost_center_id' AFTER issued_date;


-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_purchase_order_details ADD cost_center_id TEXT NULL COMMENT 'combo box cost fmv_cost_center';
ALTER TABLE pt_purchase_order_details CHANGE cost_center_id cost_center_id TEXT NULL COMMENT 'combo box cost fmv_cost_center' AFTER godown_section_beans_id;

-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pom`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`company_id` = `pt`.`company_id`
        and `p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `pt`.`company_id`
        and `rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`company_id` = `pt`.`company_id`
        and `pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`company_id` = `pt`.`company_id`
        and `hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

 INSERT INTO ERP_DEV_1_1.am_modules_forms (company_id,company_branch_id,module_id,sub_module_id,modules_menu_id,modules_sub_menu_id,modules_forms_name,display_sequence,display_name,menu_type,listing_component_name,listing_component_import_path,listing_navigation_url,form_component_name,form_component_import_path,form_navigation_url,icon_class,page_header,is_selected,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,is_protected,header,footer,url_parameter) VALUES
	 (1,1,1,19,3,17,'Dispatch Challan (Yarn)',0,'Dispatch Challan (Yarn)','Sales','<TYarnDispatchChallanListing />','import TYarnDispatchChallanListing from "Transactions/TYarnDispatchChallan/TYarnDispatchChallanListing";','/Transactions/TYarnDispatchChallan/TYarnDispatchChallanListing','<TYarnDispatchChallanEntry />','import TYarnDispatchChallanEntry from "Transactions/TYarnDispatchChallan/TYarnDispatchChallanEntry";','/Transactions/TYarnDispatchChallan/TYarnDispatchChallanEntry',NULL,'',0,1,0,NULL,NULL,NULL,NULL,NULL,NULL,0,1,1,'');
-------------------------------------------------------------------------------------------------------------------------------

-- smv_product_rm_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_summary` AS
select
    `rmt`.`product_type_group` AS `product_type_group`,
    `rmt`.`product_type_name` AS `product_type_name`,
    `rmt`.`product_category1_name` AS `product_category1_name`,
    `rm`.`product_rm_id` AS `product_rm_id`,
    `rm`.`product_rm_code` AS `product_rm_code`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `rm`.`product_rm_tech_spect` AS `product_rm_tech_spect`,
    `rm`.`product_rm_stock_unit_name` AS `product_rm_stock_unit_name`,
    ifnull((select sum(`st`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `st` where `st`.`product_rm_id` = `rm`.`product_rm_id` and `st`.`company_id` = `rm`.`company_id`), 0) AS `stock_quantity`,
    ifnull((select sum(`st`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `st` where `st`.`product_rm_id` = `rm`.`product_rm_id` and `st`.`company_id` = `rm`.`company_id`), 0) AS `stock_weight`,
    ifnull((select sum(`st`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary_customer` `st` where `st`.`product_rm_id` = `rm`.`product_rm_id` and `st`.`company_id` = `rm`.`company_id`), 0) AS `customer_stock_quantity`,
    ifnull((select sum(`st`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary_customer` `st` where `st`.`product_rm_id` = `rm`.`product_rm_id` and `st`.`company_id` = `rm`.`company_id`), 0) AS `customer_stock_weight`,
    `rmc`.`lead_time` AS `lead_time`,
    `rmc`.`product_rm_moq` AS `product_rm_moq`,
    `rmc`.`product_rm_mrp` AS `product_rm_mrp`,
    `rmc`.`product_rm_landed_price` AS `product_rm_landed_price`,
    `rmt`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `rmt`.`product_type_short_name` AS `product_type_short_name`,
    `rmt`.`product_category2_name` AS `product_category2_name`,
    `rmt`.`product_category3_name` AS `product_category3_name`,
    `rmt`.`product_category4_name` AS `product_category4_name`,
    `rmt`.`product_category5_name` AS `product_category5_name`,
    `rm`.`product_rm_packing_name` AS `product_rm_packing_name`,
    `rmt`.`product_make_name` AS `product_make_name`,
    `rmt`.`product_material_type_name` AS `product_material_type_name`,
    `rmt`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmt`.`product_material_shape_name` AS `product_material_shape_name`,
    `rm`.`product_rm_oem_part_code` AS `product_rm_oem_part_code`,
    `rm`.`product_rm_our_part_code` AS `product_rm_our_part_code`,
    `rmt`.`product_rm_drawing_no` AS `product_rm_drawing_no`,
    `rmc`.`product_rm_std_weight` AS `product_rm_std_weight`,
    1 AS `product_rm_std_hours`,
    1 AS `process_duration`,
    0 AS `product_rm_std_profit_percent`,
    0 AS `product_rm_std_discount_percent`,
    case
        `rm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `rm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `rm`.`product_rm_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `rm`.`product_rm_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `rm`.`company_name` AS `company_name`,
    `rm`.`company_branch_name` AS `company_branch_name`,
    `rm`.`product_category1_id` AS `product_category1_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_rm_stock_unit_id` AS `product_rm_stock_unit_id`,
    `rm`.`product_rm_packing_id` AS `product_rm_packing_id`,
    `rm`.`product_rm_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `rmt`.`product_category2_id` AS `product_category2_id`,
    `rmt`.`product_category3_id` AS `product_category3_id`,
    `rmt`.`product_category4_id` AS `product_category4_id`,
    `rmt`.`product_category5_id` AS `product_category5_id`,
    `rmt`.`product_make_id` AS `product_make_id`,
    `rmt`.`product_material_type_id` AS `product_material_type_id`,
    `rmt`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmt`.`product_material_shape_id` AS `product_material_shape_id`,
    `rm`.`company_id` AS `company_id`,
    `rm`.`company_branch_id` AS `company_branch_id`,
    `rm`.`godown_id` AS `godown_id`,
    `rm`.`godown_section_id` AS `godown_section_id`,
    `rm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `rm`.`product_id` AS `product_id`,
    'No' AS `bom_applicable`,
    `rm`.`is_active` AS `is_active`,
    `rm`.`is_delete` AS `is_delete`,
    `rm`.`created_by` AS `created_by`,
    `rm`.`created_on` AS `created_on`,
    `rm`.`modified_by` AS `modified_by`,
    `rm`.`modified_on` AS `modified_on`,
    `rm`.`deleted_by` AS `deleted_by`,
    `rm`.`deleted_on` AS `deleted_on`,
    `rm`.`product_rm_name` AS `field_name`,
    `rm`.`product_rm_id` AS `field_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`godown_id` = `rm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`godown_section_id` = `rm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `rm`.`godown_section_beans_id`))
where
    `rm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mt_dispatch_challan_packing_details definition
CREATE TABLE `mt_dispatch_challan_packing_details` (
  `dispatch_challan_master_transaction_id` bigint(20) NOT NULL COMMENT '* will come from header section',
  `dispatch_challan_packing_id`  bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `yarn_packing_details_id` bigint(20) DEFAULT NULL COMMENT '* read only back end*',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session  ',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
  `financial_year` varchar(20) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_no` varchar(50) NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_date` date NOT NULL COMMENT 'will come from header section  *',
  `dispatch_challan_version` bigint(20) NOT NULL DEFAULT 1 COMMENT 'will come from header section  *',
  `customer_order_no` varchar(500) DEFAULT NULL COMMENT 'combo box with mtv_sales_order_summary with customer id filter on select of Every Customer ORder no , Fill Grid data from mt_sales_order_challans_trading  ',
  `sales_order_details_transaction_id` bigint(20) DEFAULT NULL,
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format  combo box with cmv_product_rm/cmv_product_fg/cmv_product_sr with all technical parameter shows ing grids for selected material ',
  `so_sr_no` varchar(100) DEFAULT NULL COMMENT '* * Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `sr_no` bigint(20) DEFAULT NULL COMMENT '* * Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `product_unit_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_unit ',
  `item_dispatch_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `item_dispatch_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `cone_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `cone_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `per_packing_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_gross_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_net_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format EntryData Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `packing_starting_no` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `packing_ending_no` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `lot_no` text DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `sub_lot_no` text DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `yarn_packing_date` date DEFAULT NULL COMMENT 'read only get from xtv_spinning_yarn_packing_details',
  `yarn_packing_types_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `production_count_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_Packing ',
  `dispatch_schedule_packing_id` bigint(20) COMMENT '* read only *',
  `remark` varchar(1000) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`dispatch_challan_packing_id`)
)
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_packing_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_packing_details` AS
select
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `xm`.`production_count_name` AS `production_count_name`,
    `yp`.`yarn_packing_types_name` AS `yarn_packing_types_name`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `mt`.`item_dispatch_quantity` AS `item_dispatch_quantity`,
    `mt`.`item_dispatch_weight` AS `item_dispatch_weight`,
    `mt`.`cone_weight` AS `cone_weight`,
    `mt`.`cone_quantity` AS `cone_quantity`,
    `mt`.`per_packing_weight` AS `per_packing_weight`,
    `mt`.`packing_gross_weight` AS `packing_gross_weight`,
    `mt`.`packing_net_weight` AS `packing_net_weight`,
    `mt`.`packing_quantity` AS `packing_quantity`,
    `mt`.`packing_starting_no` AS `packing_starting_no`,
    `mt`.`packing_ending_no` AS `packing_ending_no`,
    `mt`.`lot_no` AS `lot_no`,
    `mt`.`sub_lot_no` AS `sub_lot_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`yarn_packing_date` AS `yarn_packing_date`,
    `mt`.`yarn_packing_types_id` AS `yarn_packing_types_id`,
    `mt`.`production_count_id` AS `production_count_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_unit_id` AS `product_unit_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_challan_packing_id` AS `dispatch_challan_packing_id`,
    `mt`.`yarn_packing_details_id` AS `yarn_packing_details_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_packing_details` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_spinning_prod_count` `xm` on
    (`xm`.`production_count_id` = `mt`.`production_count_id`
        and `xm`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_yarn_packing_types` `yp` on
    (`yp`.`yarn_packing_types_id` = `mt`.`yarn_packing_types_id`
        and `yp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`company_id` = `mt`.`company_id`
        and `u`.`product_unit_id` = `mt`.`product_unit_id`))

where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_packing_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_packing_details` AS
select
    `mt`.`sr_no` AS `sr_no`,
    `ddt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `xm`.`production_count_name` AS `production_count_name`,
    `xm`.`production_actual_count` AS `production_actual_count`,
    `yp`.`yarn_packing_types_name` AS `yarn_packing_types_name`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `ddt`.`product_material_name` AS `product_material_name`,
    `ddt`.`product_material_print_name` AS `product_material_print_name`,
    `ddt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `mt`.`item_dispatch_quantity` AS `item_dispatch_quantity`,
    `mt`.`item_dispatch_weight` AS `item_dispatch_weight`,
    `mt`.`cone_weight` AS `cone_weight`,
    `mt`.`cone_quantity` AS `cone_quantity`,
    `mt`.`per_packing_weight` AS `per_packing_weight`,
    `mt`.`packing_gross_weight` AS `packing_gross_weight`,
    `mt`.`packing_net_weight` AS `packing_net_weight`,
    `mt`.`packing_quantity` AS `packing_quantity`,
    `mt`.`packing_starting_no` AS `packing_starting_no`,
    `mt`.`packing_ending_no` AS `packing_ending_no`,
    `mt`.`lot_no` AS `lot_no`,
    `mt`.`sub_lot_no` AS `sub_lot_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`yarn_packing_date` AS `yarn_packing_date`,
    `mt`.`yarn_packing_types_id` AS `yarn_packing_types_id`,
    `mt`.`production_count_id` AS `production_count_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_unit_id` AS `product_unit_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `mt`.`dispatch_schedule_packing_id` AS `dispatch_schedule_packing_id`,
    `mt`.`yarn_packing_details_id` AS `yarn_packing_details_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_packing_details` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_spinning_prod_count` `xm` on
    (`xm`.`production_count_id` = `mt`.`production_count_id`
        and `xm`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_yarn_packing_types` `yp` on
    (`yp`.`yarn_packing_types_id` = `mt`.`yarn_packing_types_id`
        and `yp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`company_id` = `mt`.`company_id`
        and `u`.`product_unit_id` = `mt`.`product_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_details_trading` `ddt` on
    (`ddt`.`company_id` = `mt`.`company_id`
        and `ddt`.`dispatch_schedule_details_transaction_id` = `mt`.`dispatch_schedule_details_transaction_id`))
where
    `mt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- Added this fields for the fabric Sales Order.
ALTER TABLE mt_sales_order_details_trading 
ADD COLUMN product_recommendation varchar(50) NULL COMMENT 'Combo box with values:- Normal, Organic (Default: Normal)' AFTER sales_order_item_status,
ADD COLUMN special_remark text NULL COMMENT 'Text box data entry if product_recommendation is Organic then this field is mandatory otherwise not-mandatory' AFTER product_recommendation,
ADD COLUMN monogram_is_applicable bit(1) DEFAULT b'0' COMMENT 'Combo box with values:- Yes, No (Default: No)' AFTER special_remark;

-- also added this three fields into the mtv_sales_order_details_trading and also added the monogram_is_applicable_desc

`mt`.`product_recommendation` AS `product_recommendation`,
`mt`.`special_remark` AS `special_remark`,
case `mt`.`monogram_is_applicable` when 1 then 'Yes' else 'No' end AS `monogram_is_applicable_desc`,
`mt`.`monogram_is_applicable` AS `monogram_is_applicable`,


-------------------------------------------------------------------------------------------------------------------------------
	ALTER TABLE sm_product_fg_commercial MODIFY COLUMN cost_center_id TEXT DEFAULT 1 NULL
COMMENT 'profit center from fmv_cost_centre';
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`company_id` = `pt`.`company_id`
        and `p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `pt`.`company_id`
        and `rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`company_id` = `pt`.`company_id`
        and `pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`company_id` = `pt`.`company_id`
        and `hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
	ALTER TABLE sm_product_rm_commercial MODIFY COLUMN cost_center_id TEXT DEFAULT 1 NULL
COMMENT 'profit center from fmv_cost_centre';
-------------------------------------------------------------------------------------------------------------------------------

-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
 	 case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`company_id` = `pt`.`company_id`
        and `p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `pt`.`company_id`
        and `rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`company_id` = `pt`.`company_id`
        and `pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`company_id` = `pt`.`company_id`
        and `hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
07-02-24

-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'P' then 'Pending'
        else 'Completed'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` As `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE st_indent_material_issue_details ADD indented_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'indent by id get from indent details';
ALTER TABLE st_indent_material_issue_details CHANGE indented_by_id indented_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'indent by id get from indent details' AFTER issue_item_status;

-------------------------------------------------------------------------------------------------------------------------------

-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'P' then 'Pending'
        else 'Completed'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` As `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_material_issue_master MODIFY COLUMN indented_by_id bigint(20) NULL COMMENT '* combo box with cmv_employee with department id filter';

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Pending,Completed)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indented_by_name`, ':Indented By Name:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_details ADD product_material_issue_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'issue quantity will change by issue quantity';
ALTER TABLE st_indent_details CHANGE product_material_issue_quantity product_material_issue_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'issue quantity will change by issue quantity' AFTER product_material_rejected_weight;
ALTER TABLE st_indent_details ADD product_material_issue_weight DECIMAL(18,4) NULL COMMENT 'issue quantity will be update from indent issue';
ALTER TABLE st_indent_details CHANGE product_material_issue_weight product_material_issue_weight DECIMAL(18,4) NULL COMMENT 'issue quantity will be update from indent issue' AFTER product_material_issue_quantity;

-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE st_indent_details MODIFY COLUMN product_material_issue_weight decimal(18,4) DEFAULT 0 NULL COMMENT 'issue quantity will be update from indent issue';
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_material_issue_details ADD godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'for stock management and for issue indent';
ALTER TABLE st_indent_material_issue_details CHANGE godown_id godown_id BIGINT(20) DEFAULT 0 NULL COMMENT 'for stock management and for issue indent' AFTER indented_by_id;
ALTER TABLE st_indent_material_issue_details ADD godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'for stock management and for issue indent';
ALTER TABLE st_indent_material_issue_details CHANGE godown_section_id godown_section_id BIGINT(20) DEFAULT 0 NULL COMMENT 'for stock management and for issue indent' AFTER godown_id;
ALTER TABLE st_indent_material_issue_details ADD godown_section_beans_id BIGINT(20) NULL COMMENT 'for issue materialsgodown need';
ALTER TABLE st_indent_material_issue_details CHANGE godown_section_beans_id godown_section_beans_id BIGINT(20) NULL COMMENT 'for issue materialsgodown need' AFTER godown_section_id;

-------------------------------------------------------------------------------------------------------------------------------

-- stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `v`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `child` on
    (`child`.`company_id` = `st`.`company_id`
        and `child`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `parent` on
    (`parent`.`company_id` = `st`.`company_id`
        and `parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------


-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'P' then 'Pending'
        else 'Completed'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `st`.`company_id`
        and `rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`company_id` = `st`.`company_id`
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `st`.`company_id`
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `st`.`company_id`
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `st`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE st_indent_master ADD accepted_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'combo in master accepted_by_id when indent get accepted by department get';
ALTER TABLE st_indent_master CHANGE accepted_by_id accepted_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'combo in master accepted_by_id when indent get accepted by department get' AFTER cost_center_id;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'P' then 'Pending'
        else 'Completed'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `accepted_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` As `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Pending,Completed)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`accepted_by_name`, ':Indented By Name:Y:C:cmv_employee_list:F') AS `accepted_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`
        and `p`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_material_issue_master CHANGE indented_by_id accepted_by_id bigint(20) DEFAULT NULL NULL COMMENT '* combo box with cmv_employee with department id filter';

-------------------------------------------------------------------------------------------------------------------------------

-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'P' then 'Pending'
        else 'Completed'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `accepted_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` As `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`accepted_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;

-------------------------------------------------------------------------------------------------------------------------------
08-05-24




-- ERP_PASHUPATI_PROD_1_0.stv_indent_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_details_rpt` AS
select
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indent_type`, ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(`v`.`indent_status_desc`, ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(`v`.`department_name`, ':Department:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`product_type_name`, ':Product Type Name:O:N:') AS `product_type_name`,
    concat(`v`.`product_rm_name`, ':Material name:O:N:') AS `product_rm_name`,
    concat(`v`.`product_rm_stock_unit_name`, ':Material Stock Unit Name:O:N:') AS `product_rm_stock_unit_name`,
    concat(`v`.`product_material_quantity`, ':Material Quantity:O:N:') AS `product_material_quantity`,
    concat(`v`.`product_material_weight`, ':Material Weight:O:N:') AS `product_material_weight`,
    concat(`v`.`product_material_stock_quantity`, ':Material Stock Quantity:O:N:') AS `product_material_stock_quantity`,
    concat(`v`.`product_material_stock_weight`, ':Material Stock Weight:O:N:') AS `product_material_stock_weight`,
    concat(`v`.`product_material_reserve_quantity`, ':Material Reserve Quantity:O:N:') AS `product_material_reserve_quantity`,
    concat(`v`.`product_material_reserve_weight`, ':Material Reserve Weight:O:N:') AS `product_material_reserve_weight`,
    concat(`v`.`product_material_approved_quantity`, ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(`v`.`product_material_approved_weight`, ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(`v`.`product_material_rejected_quantity`, ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(`v`.`product_material_rejected_weight`, ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(`v`.`product_material_return_quantity`, ':Material Return Quantity:O:N:') AS `product_material_return_quantity`,
    concat(`v`.`product_material_return_weight`, ':Material Return Weight:O:N:') AS `product_material_return_weight`,
    concat(`v`.`product_material_receipt_quantity`, ':Material Receipt Quantity:O:N:') AS `product_material_receipt_quantity`,
    concat(`v`.`product_material_receipt_weight`, ':Material Receipt Weight:O:N:') AS `product_material_receipt_weight`,
    concat(`v`.`product_material_issue_quantity`, ':Material Issue Quantity:O:N:') AS `product_material_issue_quantity`,
    concat(`v`.`product_material_issue_weight`, ':Material Issue Weight:O:N:') AS `product_material_issue_weight`,
    concat(`v`.`product_child_bom_quantity`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_quantity`,
    concat(`v`.`product_child_bom_weight`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_weight`,
    concat(`v`.`product_parent_fg_name`, ':Parent Finish Goods Name:O:N:') AS `product_parent_fg_name`,
    concat(`v`.`product_fg_material_quantity`, ':Fg Material Quantity:O:N:') AS `product_fg_material_quantity`,
    concat(`v`.`product_fg_material_weight`, ':Fg Material Weight:O:N:') AS `product_fg_material_weight`,
    concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(`v`.`customer_order_date`, ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(`v`.`indented_by_name`, ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`approved_by_name`, ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(`v`.`product_rm_tech_spect`, ':Material Tech spec:O:N:') AS `product_rm_tech_spect`,
    concat(`v`.`product_rm_drawing_no`, ':Material Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(`v`.`product_rm_oem_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_oem_part_code`,
    concat(`v`.`product_rm_our_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_our_part_code`,
    concat(`v`.`product_category1_name`, ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(`v`.`product_category2_name`, ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(`v`.`product_category3_name`, ':Product Category3 Name:O:N:') AS `product_category3_name`,
    concat(`v`.`product_category4_name`, ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(`v`.`product_category5_name`, ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(`v`.`product_make_name`, ':Product Make Name:O:N:') AS `product_make_name`,
    concat(`v`.`product_material_type_name`, ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(`v`.`product_material_grade_name`, ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(`v`.`lead_time`, ':Lead Time:O:N:') AS `lead_time`,
    concat(`v`.`so_sr_no`, ':So Sr No:O:N:') AS `so_sr_no`,
    concat(`v`.`issued_by_name`, ':Issued By:Y:C:cmv_employee_list:F') AS `issued_by_name`,
    concat(`v`.`issued_date`, ':Issued Date:Y:D:') AS `issued_date`,
    concat(`v`.`indent_item_status`, ':Indent Item Status:O:N:') AS `indent_item_status`,
    concat(`v`.`indent_status`, ':Indent Status:O:N:') AS `indent_status`,
    concat(`v`.`indent_source`, ':Indent Source:O:N:') AS `indent_source`,
    concat(`v`.`remark`, 'remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`product_fg_id`, ':Product Fg Id:N:N:') AS `product_fg_id`,
    concat(`v`.`product_material_unit_id`, ':Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_type_id`, ':Product Type Id:N:N:') AS `product_type_id`,
    concat(`v`.`product_category1_id`, ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(`v`.`product_category2_id`, ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(`v`.`product_category3_id`, ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(`v`.`product_category4_id`, ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(`v`.`product_category5_id`, ':Product Category5 Id:N:N:') AS `product_category5_id`,
    concat(`v`.`product_make_id`, ':Product Make Id:N:N:') AS `product_make_id`,
    concat(`v`.`product_material_type_id`, ':Product Material Type Id:N:N:') AS `product_material_type_id`,
    concat(`v`.`product_material_grade_id`, ':Product Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(`v`.`indent_master_id`, ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(`v`.`indent_details_id`, ':Indent Details Id:N:N:') AS `indent_details_id`,
    concat(`v`.`indent_type_id`, ':Indent Type Id:N:N:') AS `indent_type_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`indent_no`, ':Indent No:N:N:') AS `field_name`,
    concat(`v`.`indent_version`, ':Indent Version:N:N:') AS `field_id`
from
    `stv_indent_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.stv_indent_material_issue_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Pending,Completed)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`accepted_by_name`, ':Accepted By Name:Y:C:cmv_employee_list:F') AS `accepted_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`issue_status`, ':Issue Status:O:N:') AS `issue_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master ADD consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo';
ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master CHANGE consignee_id consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo' AFTER grader_by_id;
ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master ADD consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',';
ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master CHANGE consignee_state_id consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',' AFTER consignee_id;
ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master ADD consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';';
ALTER TABLE ERP_DEV_1_1.pt_purchase_order_master CHANGE consignee_city_id consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';' AFTER consignee_state_id;





ALTER TABLE pt_purchase_order_master ADD consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo';
ALTER TABLE pt_purchase_order_master CHANGE consignee_id consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo' AFTER grader_by_id;
ALTER TABLE pt_purchase_order_master ADD consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',';
ALTER TABLE pt_purchase_order_master CHANGE consignee_state_id consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',' AFTER consignee_id;
ALTER TABLE pt_purchase_order_master ADD consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';';
ALTER TABLE pt_purchase_order_master CHANGE consignee_city_id consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';' AFTER consignee_state_id;



ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master ADD consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo';
ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master CHANGE consignee_id consignee_id BIGINT(20) NULL COMMENT 'combo box with cmv_supplier show address, Contact person list ,emails, customer state combo,customer city Combo' AFTER grader_by_id;
ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master ADD consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',';
ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master CHANGE consignee_state_id consignee_state_id BIGINT(20) NULL COMMENT '''combo box with cmv_state show will change on selection of Supplier Consignee combo '',' AFTER consignee_id;
ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master ADD consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';';
ALTER TABLE ERP_PASHUPATI_PROD_1_0.pt_purchase_order_master CHANGE consignee_city_id consignee_city_id BIGINT(20) NULL COMMENT '''combo box with cmv_city show will change on selection of Supplier Consignee combo '';' AFTER consignee_state_id;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE `ERP_DEV_1.0`.cm_employee_grade ADD employee_group_type varchar(3) NULL;
------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_grade_rpt` AS
SELECT
    concat(ifnull(`b`.`employee_grade_name`, ''), ':Employee Grade Name:Y:C:cmv_employee_grade:F') AS `employee_grade_name`,
    concat(ifnull(`b`.`short_name`, ':Short Name:O:N:')) AS `short_name`,
    concat(ifnull(`v`.`company_legal_name`, ''), ':Company Name:Y:C:cmv_company_summary') AS `company_name`,
    concat(CASE WHEN ifnull(`b`.`is_active`, 0) = 1 THEN 'Active' ELSE 'In Active' END, ':Y:H:(Active, In Active)') AS `Active`,
    concat(CASE WHEN ifnull(`b`.`is_delete`, 0) = 1 THEN 'Yes' ELSE 'No' END, ':Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`b`.`is_active`, ''), ':N:N:') AS `is_active`,
    concat(ifnull(`b`.`is_delete`, ''), ':N:N:') AS `is_delete`,
    concat(ifnull(`b`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`b`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`b`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`b`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`b`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`b`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`b`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    
    concat(ifnull(`b`.`employee_grade_id`, ''), ':Employee Grade Id:O:N:') AS `employee_grade_id`,
    concat(ifnull(`b`.`employee_grade_name`, ''), ':Employee Grade Name:N:N:') AS `field_name`,
    concat(ifnull(`b`.`employee_grade_id`, ''), ':Employee Grade Id:N:N:') AS `field_id`
FROM
    `ERP_PASHUPATI_DEV_1_0`.`cm_employee_grade` `b`
LEFT JOIN `ERP_PASHUPATI_DEV_1_0`.`cm_company` `v` ON
    `v`.`company_id` = `b`.`company_id`
LIMIT 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `accepted_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`accepted_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details_rpt source
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:o:N:') AS `issue_version`,
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:o:N:') AS `indent_version`,
    concat(`v`.`indented_by_name`, ':Indented By Name:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`godown_name`, ':Godown Name:o:N:') AS `godown_name`,
    concat(`v`.`godown_section_name`, ':Godown Section Name:o:N:') AS `godown_section_name`,
    concat(`v`.`godown_section_beans_name`, ':Godown Section Beans Name:o:N:') AS `godown_section_beans_name`,
    concat(`v`.`issue_item_status_desc`, ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Pending)') AS `issue_item_status_desc`,
    concat(`v`.`product_material_indent_quantity`, ':Product Material Indent Quantity:Y:T:') AS `product_material_indent_quantity`,
    concat(`v`.`product_material_indent_weight`, ':Product Material Indent Weight:Y:T:') AS `product_material_indent_weight`,
    concat(`v`.`product_material_approved_quantity`, ':Product Material Approved Quantity:Y:T:') AS `product_material_approved_quantity`,
    concat(`v`.`product_material_approved_weight`, ':Product Material Approved Weight:Y:T:') AS `product_material_approved_weight`,
    concat(`v`.`product_material_rejected_quantity`, ':Product Material Rejected Quantity:Y:T:') AS `product_material_rejected_quantity`,
    concat(`v`.`product_material_rejected_weight`, ':Product Material Rejected Weight:Y:T:') AS `product_material_rejected_weight`,
    concat(`v`.`product_material_issue_quantity`, ':Product Material Issue Quantity:Y:T:') AS `product_material_issue_quantity`,
    concat(`v`.`product_material_issue_weight`, ':Product Material Issue Weight:Y:T:') AS `product_material_issue_weight`,
    concat(`v`.`product_material_issue_return_quantity`, ':Product Material Issue Return Quantity:Y:T:') AS `product_material_issue_return_quantity`,
    concat(`v`.`product_material_issue_return_weight`, ':Product Material Return Weight:Y:T:)') AS `product_material_issue_return_weight`,
    concat(`v`.`product_material_receipt_quantity`, ':Product Material Receipt Quantity:Y:T:)') AS `product_material_receipt_quantity`,
    concat(`v`.`product_material_receipt_weight`, ':Product Material Receipt Weight:Y:T:)') AS `product_material_receipt_weight`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`customer_name`, ':Customer Name:o:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:o:N:') AS `customer_order_no`,
    concat(`v`.`customer_state_name`, ':State Name:o:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:o:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`issue_remark`, ':Remark:O:N:') AS `issue_remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:o:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:o:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:o:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:o:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:o:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:o:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:o:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issue_details_transaction_id`, ':Issue Details Transaction_Id:o:N:') AS `issue_details_transaction_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id Id:N:N:') AS `indented_by_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_material_unit_id`, ':Product Material Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`godown_id`, ':Godown Id:N:N:') AS `godown_id`,
    concat(`v`.`godown_section_id`, ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(`v`.`godown_section_beans_id`, ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------

-- smv_product_rm_stock_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `sm`.`company_id`
        and `gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`product_type_id` = `sm`.`product_type_id`
        and `gd`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`company_id` = `sm`.`company_id`
        and `pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`company_id` = `sm`.`company_id`
        and `rm`.`company_branch_id` = `sm`.`company_branch_id`
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `pu` on
    (`pu`.`company_id` = `sm`.`company_id`
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`company_id` = `sm`.`company_id`
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
----14-05-2024-----

-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `st`.`company_id`
        and `rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`company_id` = `st`.`company_id`
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `st`.`company_id`
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `st`.`company_id`
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `st`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
----- 13-05-24
-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
         when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `st`.`company_id`
        and `rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`company_id` = `st`.`company_id`
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `st`.`company_id`
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `st`.`company_id`
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `st`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
16-05-24
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_rpt_summary` AS
SELECT
    CONCAT(IFNULL(`rm`.`product_rm_name`, ''), ':Product Name:Y:C:smv_product_rm:F') AS `product_rm_name`,
    CONCAT(IFNULL(`rm`.`product_rm_code`, ''), ':Product Code:O:N:') AS `product_rm_code`,
    CONCAT(IFNULL(`rmt`.`product_type_name`, ''), ':Product Type:Y:C:smv_product_type:F') AS `product_type_name`,
    CONCAT(IFNULL(`rmt`.`product_rm_technical_name`, ''), ':Technical Name:Y:C:smv_product_rm_technical:O') AS `product_rm_technical_name`,
    CONCAT(IFNULL(`rmt`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    CONCAT(IFNULL(`rmt`.`product_category1_name`, ''), ':Category 1:Y:C:smv_product_category1:F') AS `product_category1_name`,
    CONCAT(IFNULL(`rmt`.`product_category2_name`, ''), ':Category 2:Y:C:smv_product_category2:F') AS `product_category2_name`,
    CONCAT(IFNULL(`rmt`.`product_category3_name`, ''), ':Category 3:Y:C:smv_product_category3:F') AS `product_category3_name`,
    CONCAT(IFNULL(`rmt`.`product_category4_name`, ''), ':Category 4:Y:C:smv_product_category4:F') AS `product_category4_name`,
    CONCAT(IFNULL(`rmt`.`product_category5_name`, ''), ':Category 5:Y:C:smv_product_category5:F') AS `product_category5_name`,
    CONCAT(IFNULL(`rmt`.`product_make_name`, ''), ':Make Name:Y:C:smv_product_make:F') AS `product_make_name`,
    CONCAT(IFNULL(`rmt`.`product_material_type_name`, ''), ':Material Type:Y:C:smv_product_material_type:F') AS `product_material_type_name`,
    CONCAT(IFNULL(`rmt`.`product_material_grade_name`, ''), ':Material Grade:Y:C:smv_product_material_grade:F') AS `product_material_grade_name`,
    CONCAT(IFNULL(`rmt`.`product_material_shape_name`, ''), ':Material Shape:Y:C:smv_product_material_shape:F') AS `product_material_shape_name`,
    CONCAT(IFNULL(`rm`.`product_rm_hsn_sac_code`, ''), ':HSN_SAC Code:Y:C:smv_product_rm:O') AS `product_rm_hsn_sac_code`,
    CONCAT(IFNULL(`rm`.`product_rm_oem_part_code`, ''), ':OEM Part Code:Y:C:smv_product_rm:O') AS `product_rm_oem_part_code`,
    CONCAT(IFNULL(`rm`.`product_rm_our_part_code`, ''), ':OUR Part Code:Y:C:smv_product_rm:O') AS `product_rm_our_part_code`,
    CONCAT(IFNULL(`rmt`.`product_rm_drawing_no`, ''), ':Drawing No:Y:C:smv_product_rm_technical:O') AS `product_rm_drawing_no`,
    CONCAT(IFNULL(`rmc`.`product_rm_std_weight`, ''), ':Standard Wt.:Y:T') AS `product_rm_std_weight`,
    CONCAT(IFNULL(`rmc`.`product_rm_mrp`, ''), ':MRP:Y:T') AS `product_rm_mrp`,
    CONCAT(IFNULL(CASE WHEN `rm`.`is_active` = 1 THEN 'Active' ELSE 'In Active' END, ''), ':Is Active:Y:H:(Active, In Active)') AS `Active`,
    CONCAT(IFNULL(CASE WHEN `rm`.`is_delete` = 1 THEN 'Yes' ELSE 'No' END, ''), ':Is Deleted:Y:H:(Yes, No)') AS `Deleted`,
    CONCAT(IFNULL(`rm`.`created_by`, ''), 'Created By:O:N:') AS `created_by`,
    CONCAT(IFNULL(`rm`.`created_on`, ''), 'Modified On:O:N:') AS `created_on`,
    CONCAT(IFNULL(`rm`.`modified_by`, ''), 'Modified By:O:N:') AS `modified_by`,
    CONCAT(IFNULL(`rm`.`modified_on`, ''), 'Modified On:O:N:') AS `modified_on`,
    CONCAT(IFNULL(`rm`.`deleted_by`, ''), 'Deleted By:O:N:') AS `deleted_by`,
    CONCAT(IFNULL(`rm`.`deleted_on`, ''), 'Deleted On:O:N:') AS `deleted_on`,
    CONCAT(IFNULL(`rm`.`product_rm_id`, ''), ':Material Id:O:N:') AS `product_rm_id`
FROM
    ((`smv_product_rm` `rm`
LEFT JOIN `smv_product_rm_technical` `rmt` ON
    (`rmt`.`company_id` = `rm`.`company_id`
        AND `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        AND `rmt`.`is_active` = 1))
LEFT JOIN `sm_product_rm_commercial` `rmc` ON
    (`rmc`.`company_id` = `rm`.`company_id`
        AND `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        AND `rmc`.`is_active` = 1))
WHERE
    `rm`.`is_delete` = 0
LIMIT 1;

-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master ADD requisition_by_id BIGINT(20) DEFAULT null NULL COMMENT 'combobox in master who creates requisition';
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master ADD requisition_date DATE NULL COMMENT 'date on which requisition created';
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master ADD approved_by_id BIGINT(20) DEFAULT null NULL COMMENT 'combobox of employees approved by id';
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master ADD approved_date DATE NULL COMMENT 'date on which day approved by HOD department';
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master ADD accepted_date DATE NULL COMMENT 'date on user accept materials';

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_DEV_1_1.st_indent_material_issue_master MODIFY COLUMN issued_by_id bigint(20) NULL COMMENT '* combo box with cmv_employee with department id filter';
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
  case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
         when 'A' then 'Approved'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `e`.`employee_name` AS `accepted_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((`ERP_DEV_1_1`.`st_indent_material_issue_master` `st`
left join `ERP_DEV_1_1`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_DEV_1_1`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_DEV_1_1`.`cmv_employee_list` `e` on
    (`e`.`employee_id` = `st`.`accepted_by_id`
        and `e`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_DEV_1_1.stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_DEV_1_1`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
     case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'A' then 'Approved'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_DEV_1_1`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_DEV_1_1`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_DEV_1_1`.`st_indent_material_issue_details` `st`
left join `ERP_DEV_1_1`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_DEV_1_1`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `st`.`company_id`
        and `rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_DEV_1_1`.`cm_employee` `e` on
    (`e`.`company_id` = `st`.`company_id`
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_DEV_1_1`.`cm_godown` `gd` on
    (`gd`.`company_id` = `st`.`company_id`
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_DEV_1_1`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `st`.`company_id`
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_DEV_1_1`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `st`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
------17-05-24 ------------

ALTER TABLE st_indent_material_issue_master ADD cost_center_id bigint(20) NOT NULL COMMENT 'combo box default load from fmv_cost_center';
ALTER TABLE st_indent_material_issue_master CHANGE cost_center_id cost_center_id bigint(20) NOT NULL COMMENT 'combo box default load from fmv_cost_center' AFTER accepted_date;
ALTER TABLE st_indent_material_issue_master CHANGE requisition_by_id requisition_by_id bigint(20) DEFAULT NULL NULL COMMENT 'combobox in master who creates requisition' AFTER issued_by_id;
ALTER TABLE st_indent_material_issue_master CHANGE requisition_date requisition_date date DEFAULT NULL NULL COMMENT 'date on which requisition created' AFTER requisition_by_id;
ALTER TABLE st_indent_material_issue_master CHANGE approved_by_id approved_by_id bigint(20) DEFAULT NULL NULL COMMENT 'combobox of employees approved by id' AFTER requisition_date;
ALTER TABLE st_indent_material_issue_master CHANGE approved_date approved_date date DEFAULT NULL NULL COMMENT 'date on which day approved by HOD department' AFTER approved_by_id;
ALTER TABLE st_indent_material_issue_master CHANGE accepted_date accepted_date date DEFAULT NULL NULL COMMENT 'date on user accept materials' AFTER approved_date;

-------------------------------------------------------------------------------------------------------------------------------
25-05-24

CREATE or replace TABLE `pt_goods_receipts_indent_details` (
  `goods_receipts_indent_details_transaction_id` bigint(20) NOT NULL AUTO_INCREMENT,
  `goods_receipt_master_transaction_id` bigint(20) NULL COMMENT '* read only back end auto generated id of Master*',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session*',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*combo box with cmv_company_branch and set default backend from session*',
  `financial_year` varchar(20) NOT NULL,
  `goods_receipt_no` varchar(50) NOT NULL COMMENT '* will be used from Header part data',
  `goods_receipt_date` date NOT NULL COMMENT '* will be used from Header part data',
  `goods_receipt_version` bigint(20) NOT NULL DEFAULT 1 COMMENT '* will be used from Header part data',
  `purchase_order_no` varchar(50) NOT NULL COMMENT '* will be used from Header part data',
  `indent_no` varchar(50) NOT NULL COMMENT '*read only text box Combination of Company Short name/ProductType_group/FyearShort name/0000Last ID*',
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Details Part Data Grid Entry shows grids for selected material id*',
  `product_material_indent_approved_quantity` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid with Export/Import excel format Entry txtbox data entry with validation*',
  `product_material_indent_approved_weight` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid with Export/Import excel format Entry txtbox data entry with validation*',
  `product_material_grn_accepted_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Text box Data Entry with numeric validation*',
  `product_material_grn_accepted_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Text box Data Entry with numeric validation*',
  `indent_details_id` bigint(20) NULL COMMENT '* read only back end auto generated*',
  `purchase_order_details_transaction_id` bigint(20) NULL  COMMENT '* read only back end auto generated*',
  `product_material_std_weight` decimal(18,4) DEFAULT 0.0000,
  `product_material_unit_id` bigint(20) NULL,
  `remark` varchar(1000) DEFAULT NULL,
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`goods_receipts_indent_details_transaction_id`)
);

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_material_issue_master ADD sub_department_id BIGINT(20) NULL COMMENT 'combo load filter from depatment id';
ALTER TABLE st_indent_material_issue_master CHANGE sub_department_id sub_department_id BIGINT(20) NULL COMMENT 'combo load filter from depatment id' AFTER department_id;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    (((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`
        and `re`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`
        and `ie`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------

-- stv_indent_material_issue_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Pending)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`requisition_by_name`, ':Requisition By Name:Y:C:cm_employee:F') AS `requisition_by_name`,
    concat(`v`.`approved_by_name`, ':Approved By Name:Y:C:cm_employee:F') AS `approved_by_name`,
    concat(`v`.`issued_by_name`, ':Issue By Name:Y:C:cm_employee:F') AS `issued_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`sub_department_name`, ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`issue_status`, ':Issue Status:O:N:') AS `issue_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    (((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`
        and `re`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`
        and `ie`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Approved,Pending)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`requisition_by_name`, ':Requisition By Name:Y:C:cm_employee:F') AS `requisition_by_name`,
    concat(`v`.`approved_by_name`, ':Approved By Name:Y:C:cm_employee:F') AS `approved_by_name`,
    concat(`v`.`issued_by_name`, ':Issue By Name:Y:C:cm_employee:F') AS `issued_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`sub_department_name`, ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`issue_status`, ':Issue Status:O:N:') AS `issue_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------

22-05-24


-- stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `v`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `child` on
    (`child`.`company_id` = `st`.`company_id`
        and `child`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `parent` on
    (`parent`.`company_id` = `st`.`company_id`
        and `parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details_rpt` AS
select
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indent_type`, ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(`v`.`indent_status_desc`, ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(`v`.`department_name`, ':Department:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`product_type_name`, ':Product Type Name:O:N:') AS `product_type_name`,
    concat(`v`.`product_rm_name`, ':Material name:O:N:') AS `product_rm_name`,
    concat(`v`.`product_rm_stock_unit_name`, ':Material Stock Unit Name:O:N:') AS `product_rm_stock_unit_name`,
    concat(`v`.`product_material_quantity`, ':Material Quantity:O:N:') AS `product_material_quantity`,
    concat(`v`.`product_material_weight`, ':Material Weight:O:N:') AS `product_material_weight`,
    concat(`v`.`product_material_stock_quantity`, ':Material Stock Quantity:O:N:') AS `product_material_stock_quantity`,
    concat(`v`.`product_material_stock_weight`, ':Material Stock Weight:O:N:') AS `product_material_stock_weight`,
    concat(`v`.`product_material_reserve_quantity`, ':Material Reserve Quantity:O:N:') AS `product_material_reserve_quantity`,
    concat(`v`.`product_material_reserve_weight`, ':Material Reserve Weight:O:N:') AS `product_material_reserve_weight`,
    concat(`v`.`product_material_approved_quantity`, ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(`v`.`product_material_approved_weight`, ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(`v`.`product_material_rejected_quantity`, ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(`v`.`product_material_rejected_weight`, ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(`v`.`product_material_return_quantity`, ':Material Return Quantity:O:N:') AS `product_material_return_quantity`,
    concat(`v`.`product_material_return_weight`, ':Material Return Weight:O:N:') AS `product_material_return_weight`,
    concat(`v`.`product_material_receipt_quantity`, ':Material Receipt Quantity:O:N:') AS `product_material_receipt_quantity`,
    concat(`v`.`product_material_receipt_weight`, ':Material Receipt Weight:O:N:') AS `product_material_receipt_weight`,
    concat(`v`.`product_material_issue_quantity`, ':Material Issue Quantity:O:N:') AS `product_material_issue_quantity`,
    concat(`v`.`product_material_issue_weight`, ':Material Issue Weight:O:N:') AS `product_material_issue_weight`,
    concat(`v`.`product_material_grn_accepted_quantity`, ':GRN Accepted Quantity:O:N:') AS `product_material_grn_accepted_quantity`,
    concat(`v`.`product_material_grn_accepted_weight`, ':GRN Accepted Weight:O:N:') AS `product_material_grn_accepted_weight`,
    concat(`v`.`product_child_bom_quantity`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_quantity`,
    concat(`v`.`product_child_bom_weight`, ':Product Child Bom Quantity:O:N:') AS `product_child_bom_weight`,
    concat(`v`.`product_parent_fg_name`, ':Parent Finish Goods Name:O:N:') AS `product_parent_fg_name`,
    concat(`v`.`product_fg_material_quantity`, ':Fg Material Quantity:O:N:') AS `product_fg_material_quantity`,
    concat(`v`.`product_fg_material_weight`, ':Fg Material Weight:O:N:') AS `product_fg_material_weight`,
    concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(`v`.`customer_order_date`, ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(`v`.`indented_by_name`, ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`approved_by_name`, ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(`v`.`product_rm_tech_spect`, ':Material Tech spec:O:N:') AS `product_rm_tech_spect`,
    concat(`v`.`product_rm_drawing_no`, ':Material Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(`v`.`product_rm_oem_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_oem_part_code`,
    concat(`v`.`product_rm_our_part_code`, ':Material Oem Part Code:O:N:') AS `product_rm_our_part_code`,
    concat(`v`.`product_category1_name`, ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(`v`.`product_category2_name`, ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(`v`.`product_category3_name`, ':Product Category3 Name:O:N:') AS `product_category3_name`,
    concat(`v`.`product_category4_name`, ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(`v`.`product_category5_name`, ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(`v`.`product_make_name`, ':Product Make Name:O:N:') AS `product_make_name`,
    concat(`v`.`product_material_type_name`, ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(`v`.`product_material_grade_name`, ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(`v`.`lead_time`, ':Lead Time:O:N:') AS `lead_time`,
    concat(`v`.`so_sr_no`, ':So Sr No:O:N:') AS `so_sr_no`,
    concat(`v`.`issued_by_name`, ':Issued By:Y:C:cmv_employee_list:F') AS `issued_by_name`,
    concat(`v`.`issued_date`, ':Issued Date:Y:D:') AS `issued_date`,
    concat(`v`.`indent_item_status`, ':Indent Item Status:O:N:') AS `indent_item_status`,
    concat(`v`.`indent_status`, ':Indent Status:O:N:') AS `indent_status`,
    concat(`v`.`indent_source`, ':Indent Source:O:N:') AS `indent_source`,
    concat(`v`.`remark`, 'remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`product_fg_id`, ':Product Fg Id:N:N:') AS `product_fg_id`,
    concat(`v`.`product_material_unit_id`, ':Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_type_id`, ':Product Type Id:N:N:') AS `product_type_id`,
    concat(`v`.`product_category1_id`, ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(`v`.`product_category2_id`, ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(`v`.`product_category3_id`, ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(`v`.`product_category4_id`, ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(`v`.`product_category5_id`, ':Product Category5 Id:N:N:') AS `product_category5_id`,
    concat(`v`.`product_make_id`, ':Product Make Id:N:N:') AS `product_make_id`,
    concat(`v`.`product_material_type_id`, ':Product Material Type Id:N:N:') AS `product_material_type_id`,
    concat(`v`.`product_material_grade_id`, ':Product Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(`v`.`indent_master_id`, ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(`v`.`indent_details_id`, ':Indent Details Id:N:N:') AS `indent_details_id`,
    concat(`v`.`indent_type_id`, ':Indent Type Id:N:N:') AS `indent_type_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`indent_no`, ':Indent No:N:N:') AS `field_name`,
    concat(`v`.`indent_version`, ':Indent Version:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details` `v`
limit 1;


-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `e`.`email_id1` AS `indented_by_email`,
    `e1`.`email_id1` AS `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`
        and `p`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary_rpt` AS
select
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indent_type`, ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(`v`.`indent_status_desc`, ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(`v`.`indent_source_desc`, ':Indent Source:Y:H:(SO Based,Direct,Internal)') AS `indent_source_desc`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`customer_name`, ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(`v`.`customer_order_date`, ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`indented_by_name`, ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`approved_by_name`, ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(`v`.`approved_date`, ':Approved Date:Y:D:') AS `approved_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`indent_source`, ':Indent Source:O:N:') AS `indent_source`,
    concat(`v`.`indent_status`, ':Indent Status:O:N:') AS `indent_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`indent_master_id`, ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(`v`.`indent_type_id`, ':Intdent Type Id:N:N:') AS `indent_type_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`indented_by_id`, ':Indeneted By Id:N:N:') AS `indented_by_id`,
    concat(`v`.`indent_no`, ':Indent No:N:N:') AS `field_name`,
    concat(`v`.`indent_version`, ':Indent Version:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`cmv_contractor_banks` AS
select
    `vc`.`contractor_name` AS `contractor_name`,
    `b`.`contractor_bank_name` AS `contractor_bank_name`,
    `b`.`contractor_bank_branch_name` AS `contractor_bank_branch_name`,
    `b`.`contractor_bank_account_type` AS `contractor_bank_account_type`,
    `b`.`contractor_bank_account_no` AS `contractor_bank_account_no`,
    `b`.`contractor_bank_ifsc_code` AS `contractor_bank_ifsc_code`,
    `b`.`contractor_bank_swift_code` AS `contractor_bank_swift_code`,
    `b`.`currency_type` AS `currency_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`contractor_id` AS `contractor_id`,
    `b`.`contractor_bank_id` AS `contractor_bank_id`,
    `b`.`bank_id` AS `bank_id`,
    `b`.`bank_id` AS `field_id`,
    `vb`.`bank_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`cm_contractor_banks` `b`
join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
join `ERP_PASHUPATI_DEV_1_0`.`cm_contractor` `vc` on
    (`vc`.`contractor_id` = `b`.`contractor_id`
        and `vc`.`company_id` = `b`.`company_id`
        and `vc`.`company_branch_id` = `b`.`company_branch_id`))
join `ERP_PASHUPATI_DEV_1_0`.`cm_banks_List` `vb` on
    (`vb`.`company_id` = `b`.`company_id`
        and `vb`.`bank_id` = `b`.`contractor_bank_id`));

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_PASHUPATI_PROD_1_0.cm_employees_academic CHANGE Qualification qualification varchar(500) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL NULL;
-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipts_indent_details` AS
select
    `pt`.`goods_receipt_no`,
    `pt`.`goods_receipt_date`,
    `pt`.`goods_receipt_version`,
    `pt`.`purchase_order_no`,
    `pt`.`indent_no`,
    `rm`.`product_rm_name` As `product_material_name`,
    `pt`.`product_material_indent_approved_quantity`,
    `pt`.`product_material_indent_approved_weight`,
    `pt`.`product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight`,
    `u`.`product_unit_name`,
    `pt`.`remark`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete`,
    `pt`.`created_by`,
    `pt`.`created_on`,
    `pt`.`modified_by`,
    `pt`.`modified_on`,
    `pt`.`deleted_by`,
    `pt`.`deleted_on`,
    `pt`.`financial_year`,
    `pt`.`company_id`,
    `pt`.`company_branch_id`,
    `pt`.`product_material_unit_id`,
    `pt`.`product_material_id`,
    `pt`.`goods_receipts_indent_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id`,
    `pt`.`indent_details_id`
from
   ((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipts_indent_details` `pt`

left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pt`.`company_id`
        and `rm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pt`.`company_id`
      ))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
27-05-24


-- ptv_goods_receipts_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipts_indent_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`indent_no` AS `indent_no`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `pt`.`product_material_indent_approved_quantity` AS `product_material_indent_approved_quantity`,
    `pt`.`product_material_indent_approved_weight` AS `product_material_indent_approved_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `pt`.`remark` AS `remark`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipts_indent_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `total_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipts_indent_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `total_grn_weight`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`goods_receipts_indent_details_transaction_id` AS `goods_receipts_indent_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`indent_details_id` AS `indent_details_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipts_indent_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pt`.`company_id`
        and `rm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pt`.`company_id`))
where
    `pt`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------

CREATE TABLE `cm_employees_work_experience` (
  `company_id` int(11) DEFAULT 1,
  `company_branch_id` int(11) DEFAULT 1,
  `employee_work_experience_id` bigint(20) NOT NULL AUTO_INCREMENT,
  `employee_id` bigint(20) NOT NULL,
  `previous_organisation` varchar(500) DEFAULT NULL,
  `working_experience` varchar(500) DEFAULT NULL,
  `desigantion` varchar(255) DEFAULT NULL,
  `previous_salary` decimal(18,2) DEFAULT 0,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT NULL,
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`employee_work_experience_id`)
)  

-------------------------------------------------------------------------------------------------------------------------------
30-05-24
-- st_indent_master definition

CREATE TABLE `pt_material_loan_master` (
  `material_loan_master_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `financial_year` varchar(20) NOT NULL,
  `loan_no` varchar(50) NOT NULL,
  `loan_version` bigint(20) NOT NULL,
  `loan_date` date NOT NULL,
  `from_company_id` int(11) DEFAULT NULL,
  `from_company_branch_id` bigint(20) DEFAULT NULL COMMENT '*backend from session  *',
  `from_department_id` bigint(20) NOT NULL COMMENT '* combo box with cmv_department department type M',
  `from_sub_department_id` bigint(20) DEFAULT NULL COMMENT 'combobox dependent on department selection ',
  `requested_by_id` bigint(20) NOT NULL COMMENT '* combo box with cmv_employee with department id filter',
  `to_company_id` int(11) DEFAULT NULL,
  `to_company_branch_id` bigint(20) DEFAULT NULL COMMENT '*backend from session  *',
  `to_department_id` bigint(20) DEFAULT NULL COMMENT '* combo box with cmv_department department type M',
  `to_sub_department_id` bigint(20) DEFAULT NULL COMMENT 'combobox dependent on department selection ',
  `received_by_id` bigint(20) DEFAULT NULL COMMENT '* combo box with cmv_employee with department id filter',
  `material_loan_status` varchar(3) DEFAULT 'P' COMMENT 'P-Pending,A-Aprroved, R-Rejected,I-Partial Issue, MI-Material Issued',
  `from_cost_center_id` bigint(20) DEFAULT NULL COMMENT 'combo box default load from fmv_cost_center',
  `to_cost_center_id` bigint(20) DEFAULT NULL COMMENT 'combo box default load from fmv_cost_center',
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`material_loan_master_id`)
)

-------------------------------------------------------------------------------------------------------------------------------
-- st_indent_details definition

CREATE or REPLACE  TABLE `pt_material_loan_details` (
  `material_loan_details_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `material_loan_master_id` bigint(20) DEFAULT NULL,
  `company_id` bigint(20) NULL DEFAULT NULL COMMENT '*backend from session  ',
  `company_branch_id` bigint(20) NULL DEFAULT NULL COMMENT '*backend from session  *',
  `financial_year` varchar(20) NOT NULL COMMENT '*backend from session  *',
  `loan_no` varchar(50) NOT NULL,
  `loan_version` bigint(20) NOT NULL,
  `loan_date` date NOT NULL,
  `indent_no` varchar(50)  NULL DEFAULT NULL COMMENT '*read only text box Combination of Company Short name/ProductType_group /FyearShort name/ 0000Last ID ',
  `indent_date` date  NULL DEFAULT NULL COMMENT '* DTPpicker Data Entry',
  `indent_version` bigint(20)  NULL DEFAULT NULL COMMENT '* read only text box auto generated next Version *',
  `indent_details_id` bigint(20)  NULL DEFAULT NULL ,
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format  combo box with cmv_product_rm/cmv_product_fg/cmv_product_sr with all technical parameter shows ing grids for selected material ',
  `product_material_unit_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_unit ',
  `product_material_balance_quantity` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `product_material_balance_weight` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `product_material_requested_quantity` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid  with Export/Import excel format   show data from  stock table ',
  `product_material_requested_weight` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid  with Export/Import excel format   show data from  stock table ',
  `product_material_issue_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT 'issue quantity  Data Grid ',
  `product_material_issue_weight` decimal(18,4) DEFAULT 0.0000 COMMENT 'issue quantity Data Grid ',
  `loan_item_status` varchar(3) DEFAULT 'P' COMMENT 'P-Pending,A-Aprroved, R-Rejected, MI- Material Issued',
  `issue_remark` varchar(500) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
 PRIMARY KEY (`material_loan_details_id`)
)


-------------------------------------------------------------------------------------------------------------------------------
-- ptv_material_loan_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_master_summary` AS
select
    `st`.`loan_no` AS `loan_no`,
    `st`.`loan_version` AS `loan_version`,
    `st`.`loan_date` AS `loan_date`,
    `fcp`.`company_legal_name` AS `from_company_name`,
    `tcp`.`company_legal_name` AS `to_company_name`,
    `fd`.`department_name` AS `from_department_name`,
    `fds`.`department_name` AS `from_sub_department_name`,
    `td`.`department_name` AS `to_department_name`,
    `tds`.`department_name` AS `to_sub_department_name`,
    `e`.`employee_name` AS `requested_by_name`,
    `e1`.`employee_name` AS `received_by_name`,
    case
        `st`.`material_loan_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        else 'Pending'
    end AS `material_loan_status_desc`,
    `ffc`.`cost_center_name` AS `from_cost_center_name`,
    `tfc`.`cost_center_name` AS `to_cost_center_name`,
    `e`.`email_id1` AS `requested_by_email`,
    `e1`.`email_id1` AS `received_by_email`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`from_cost_center_id` AS `from_cost_center_id`,
    `st`.`to_cost_center_id` AS `to_cost_center_id`,
    `st`.`material_loan_status` AS `material_loan_status`,
    `st`.`from_company_id` AS `from_company_id`,
    `st`.`from_company_branch_id` AS `from_company_branch_id`,
    `st`.`from_department_id` AS `from_department_id`,
    `st`.`from_sub_department_id` AS `from_sub_department_id`,
    `st`.`requested_by_id` AS `requested_by_id`,
    `st`.`to_company_id` AS `to_company_id`,
    `st`.`to_company_branch_id` AS `to_company_branch_id`,
    `st`.`to_department_id` AS `to_department_id`,
    `st`.`to_sub_department_id` AS `to_sub_department_id`,
    `st`.`received_by_id` AS `received_by_id`,
    `st`.`material_loan_master_id` AS `material_loan_master_id`,
    `st`.`loan_no` AS `field_name`,
    `st`.`loan_version` AS `field_id`


from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `fcp` on
    (`fcp`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `tcp` on
    (`tcp`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `fd` on
    (`fd`.`department_id` = `st`.`from_department_id`
	and `fd`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `fds` on
    (`fds`.`department_id` = `st`.`from_sub_department_id`
	and `fds`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `td` on
    (`td`.`department_id` = `st`.`to_department_id`
	and `td`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `tds` on
    (`tds`.`department_id` = `st`.`to_sub_department_id`
	and `tds`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`requested_by_id`
	and `e`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`received_by_id`
	and `e1`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `ffc` on
    (`ffc`.`cost_center_id` = `st`.`from_cost_center_id`
	and `ffc`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `tfc` on
    (`tfc`.`cost_center_id` = `st`.`to_cost_center_id`
	and `tfc`.`company_id` = `st`.`to_company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`loan_no`,
    `st`.`loan_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_material_loan_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
select
    `pt`.`loan_no` AS `loan_no`,
    `pt`.`loan_date` AS `loan_date`,
    `pt`.`loan_version` AS `loan_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
    `pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
    `pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
    `pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
    `pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `pt`.`issue_remark` AS `issue_remark`,
        case
        `pt`.`loan_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        else 'Pending'
    end AS `loan_item_status_desc`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`loan_item_status` AS `loan_item_status`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`material_loan_details_id` AS `material_loan_details_id`,
    `pt`.`material_loan_master_id` AS `material_loan_master_id`,
    `pt`.`indent_details_id` AS `indent_details_id`
from
    (`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pt`.`company_id`)
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pt`.`company_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
07-06-24


ALTER TABLE pt_goods_receipt_details ADD total_box_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total weight of box';
ALTER TABLE pt_goods_receipt_details CHANGE total_box_weight total_box_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total weight of box' AFTER product_material_rejection_reason_id;
ALTER TABLE pt_goods_receipt_details ADD total_quantity_in_box DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total quantities in box';
ALTER TABLE pt_goods_receipt_details CHANGE total_quantity_in_box total_quantity_in_box DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total quantities in box' AFTER total_box_weight;
ALTER TABLE pt_goods_receipt_details ADD weight_per_box_item DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for weight of per cone in box';
ALTER TABLE pt_goods_receipt_details CHANGE weight_per_box_item weight_per_box_item DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for weight of per cone in box' AFTER total_quantity_in_box;




-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `d` on
    (`d`.`company_id` = `pt`.`company_id`
        and `d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
8-6-24

ALTER TABLE sm_product_rm_stock_details ADD total_box_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total weight of box';
ALTER TABLE sm_product_rm_stock_details ADD total_quantity_in_box DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total quantities in box';
ALTER TABLE sm_product_rm_stock_details ADD weight_per_box_item DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for weight of per cone in box';


-------------------------------------------------------------------------------------------------------------------------------

-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_rm_purchase_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_details` `rm` on
    (`rm`.`company_id` = `sm`.`company_id`
        and `rm`.`company_branch_id` = `sm`.`company_branch_id`
        and `rm`.`product_rm_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cm` on
    (`cm`.`company_id` = `sm`.`company_id`
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`company_id` = `sm`.`company_id`
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_unit` `pu` on
    (`pu`.`company_id` = `sm`.`company_id`
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `supp` on
    (`supp`.`company_id` = `sm`.`company_id`
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `su` on
    (`su`.`company_id` = `sm`.`company_id`
        and `su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
10-06-2024

ALTER TABLE pt_material_loan_details ADD issue_batch_no varchar(255) DEFAULT null NULL;
ALTER TABLE pt_material_loan_details CHANGE issue_batch_no issue_batch_no varchar(255) DEFAULT null NULL AFTER loan_item_status;




-- ptv_material_loan_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
select
	`pt`.`loan_no` AS `loan_no`,
	`pt`.`loan_date` AS `loan_date`,
	`pt`.`loan_version` AS `loan_version`,
	`pt`.`indent_no` AS `indent_no`,
	`pt`.`indent_date` AS `indent_date`,
	`pt`.`indent_version` AS `indent_version`,
	`rm`.`product_rm_name` AS `product_material_name`,
	`pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
	`pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
	`pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
	`pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
	`pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
	`pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
	`u`.`product_unit_name` AS `product_unit_name`,
	`pt`.`issue_remark` AS `issue_remark`,
	case
		`pt`.`loan_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'C' then 'Completed'
		when 'MI' then 'Material Issue'
		else 'Pending'
	end AS `loan_item_status_desc`,
	case
		when `pt`.`is_delete` = 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`pt`.`is_delete` AS `is_delete`,
	`pt`.`created_by` AS `created_by`,
	`pt`.`created_on` AS `created_on`,
	`pt`.`modified_by` AS `modified_by`,
	`pt`.`modified_on` AS `modified_on`,
	`pt`.`deleted_by` AS `deleted_by`,
	`pt`.`deleted_on` AS `deleted_on`,
	`pt`.`financial_year` AS `financial_year`,
	`pt`.`loan_item_status` AS `loan_item_status`,
	`pt`.`company_id` AS `company_id`,
	`pt`.`company_branch_id` AS `company_branch_id`,
	`pt`.`product_material_unit_id` AS `product_material_unit_id`,
	`pt`.`product_material_id` AS `product_material_id`,
	`pt`.`material_loan_details_id` AS `material_loan_details_id`,
	`pt`.`material_loan_master_id` AS `material_loan_master_id`,
	`pt`.`indent_details_id` AS `indent_details_id`,
	`pm`.`from_company_id` As `from_company_id`,
	`pm`.`from_department_id` As `from_department_id`,
	`pm`.`from_sub_department_id` As `from_sub_department_id`,
	`pm`.`to_company_id` As `to_company_id`,
	`pm`.`to_company_branch_id` As `to_company_branch_id`,
	`pm`.`to_department_id` As `to_department_id`,
	`pm`.`to_sub_department_id` As `to_sub_department_id`
from
	(((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `pm` on
	(`pm`.`material_loan_master_id` = `pt`.`material_loan_master_id` ))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
	(`rm`.`product_rm_id` = `pt`.`product_material_id`
		and `rm`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
	(`u`.`product_unit_id` = `pt`.`product_material_unit_id`
		and `u`.`company_id` = `pm`.`to_company_id`))
where
	`pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

ALTER TABLE sm_product_rm_stock_summary ADD total_box_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total weight of box';
ALTER TABLE sm_product_rm_stock_summary ADD total_quantity_in_box DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for total quantities in box';
ALTER TABLE sm_product_rm_stock_summary ADD weight_per_box_item DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'text box for weight of per cone in box';


-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `sm`.`company_id`
        and `gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`company_id` = `sm`.`company_id`
        and `pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`company_id` = `sm`.`company_id`
        and `rm`.`company_branch_id` = `sm`.`company_branch_id`
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `pu` on
    (`pu`.`company_id` = `sm`.`company_id`
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`company_id` = `sm`.`company_id`
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
11-06-24

-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`company_id` = `st`.`company_id`
        and `rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`company_id` = `st`.`company_id`
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `st`.`company_id`
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `st`.`company_id`
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `st`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------

--- ptv_material_loan_details source

 CREATE OR REPLACE
 ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
 select
     `pt`.`loan_no` AS `loan_no`,
     `pt`.`loan_date` AS `loan_date`,
     `pt`.`loan_version` AS `loan_version`,
     `pt`.`indent_no` AS `indent_no`,
     `pt`.`indent_date` AS `indent_date`,
     `pt`.`indent_version` AS `indent_version`,
     `rm`.`product_rm_name` AS `product_material_name`,
     `pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
     `pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
     `pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
     `pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
     `pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
     `pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
     coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_quantity`,
     coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_weight`,
     `u`.`product_unit_name` AS `product_unit_name`,
     `pt`.`issue_remark` AS `issue_remark`,
     case
         `pt`.`loan_item_status` when 'A' then 'Approved'
         when 'R' then 'Rejected'
         when 'C' then 'Completed'
         when 'MI' then 'Material Issue'
         else 'Pending'
     end AS `loan_item_status_desc`,
     case
         when `pt`.`is_delete` = 1 then 'Yes'
         else 'No'
     end AS `Deleted`,
     `pt`.`is_delete` AS `is_delete`,
     `pt`.`created_by` AS `created_by`,
     `pt`.`created_on` AS `created_on`,
     `pt`.`modified_by` AS `modified_by`,
     `pt`.`modified_on` AS `modified_on`,
     `pt`.`deleted_by` AS `deleted_by`,
     `pt`.`deleted_on` AS `deleted_on`,
     `pt`.`financial_year` AS `financial_year`,
     `pt`.`loan_item_status` AS `loan_item_status`,
     `pt`.`company_id` AS `company_id`,
     `pt`.`company_branch_id` AS `company_branch_id`,
     `pt`.`product_material_unit_id` AS `product_material_unit_id`,
     `pt`.`product_material_id` AS `product_material_id`,
     `pt`.`material_loan_details_id` AS `material_loan_details_id`,
     `pt`.`material_loan_master_id` AS `material_loan_master_id`,
     `pt`.`indent_details_id` AS `indent_details_id`,
     `pm`.`from_company_id` AS `from_company_id`,
     `pm`.`from_department_id` AS `from_department_id`,
     `pm`.`from_sub_department_id` AS `from_sub_department_id`,
     `pm`.`to_company_id` AS `to_company_id`,
     `pm`.`to_company_branch_id` AS `to_company_branch_id`,
     `pm`.`to_department_id` AS `to_department_id`,
     `pm`.`to_sub_department_id` AS `to_sub_department_id`
 from
     (((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
 left join `ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `pm` on
     (`pm`.`material_loan_master_id` = `pt`.`material_loan_master_id`))
 left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
     (`rm`.`product_rm_id` = `pt`.`product_material_id`
         and `rm`.`company_id` = `pm`.`to_company_id`))
 left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
     (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
         and `u`.`company_id` = `pm`.`to_company_id`))
 where
     `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_material_loan_details ADD godown_id BIGINT(20) DEFAULT null NULL;
ALTER TABLE pt_material_loan_details CHANGE godown_id godown_id BIGINT(20) DEFAULT null NULL AFTER issue_batch_no;

ALTER TABLE pt_material_loan_details ADD product_material_std_weight DECIMAL(18,4) DEFAULT 0 NULL;
ALTER TABLE pt_material_loan_details CHANGE product_material_std_weight product_material_std_weight DECIMAL(18,4) DEFAULT 0 NULL AFTER product_material_issue_weight;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_material_loan_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
select
    `pt`.`loan_no` AS `loan_no`,
    `pt`.`loan_date` AS `loan_date`,
    `pt`.`loan_version` AS `loan_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
    `pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
    `pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
    `pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
    `pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `pt`.`product_material_std_weight` AS `product_material_std_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_weight`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `gd`.`godown_name` AS `godown_name`,
    `pt`.`issue_remark` AS `issue_remark`,
    case
        `pt`.`loan_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        else 'Pending'
    end AS `loan_item_status_desc`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`loan_item_status` AS `loan_item_status`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`material_loan_details_id` AS `material_loan_details_id`,
    `pt`.`material_loan_master_id` AS `material_loan_master_id`,
    `pt`.`indent_details_id` AS `indent_details_id`,
    `pm`.`from_company_id` AS `from_company_id`,
    `pm`.`from_department_id` AS `from_department_id`,
    `pm`.`from_sub_department_id` AS `from_sub_department_id`,
    `pm`.`to_company_id` AS `to_company_id`,
    `pm`.`to_company_branch_id` AS `to_company_branch_id`,
    `pm`.`to_department_id` AS `to_department_id`,
    `pm`.`to_sub_department_id` AS `to_sub_department_id`,
     `pt`.`godown_id` AS `godown_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `pm` on
    (`pm`.`material_loan_master_id` = `pt`.`material_loan_master_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `pt`.`godown_id`
        and `gd`.`company_id` = `pm`.`to_company_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_material_loan_details MODIFY COLUMN godown_id varchar(50) DEFAULT NULL NULL;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_material_loan_details ADD product_material_return_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'textbox return material to requested to company';
ALTER TABLE pt_material_loan_details CHANGE product_material_return_quantity product_material_return_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'textbox return material to requested to company' AFTER product_material_std_weight;
ALTER TABLE pt_material_loan_details ADD product_material_return_weight DECIMAL(18,4) DEFAULT 0 NULL;
ALTER TABLE pt_material_loan_details CHANGE product_material_return_weight product_material_return_weight DECIMAL(18,4) DEFAULT 0 NULL AFTER product_material_return_quantity;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_material_loan_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
select
    `pt`.`loan_no` AS `loan_no`,
    `pt`.`loan_date` AS `loan_date`,
    `pt`.`loan_version` AS `loan_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
    `pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
    `pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
    `pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
    `pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `pt`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `pt`.`product_material_return_weight` AS `product_material_return_weight`,
    `pt`.`product_material_std_weight` AS `product_material_std_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_weight`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `gd`.`godown_name` AS `godown_name`,
    `pt`.`issue_remark` AS `issue_remark`,
    case
        `pt`.`loan_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        else 'Pending'
    end AS `loan_item_status_desc`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`loan_item_status` AS `loan_item_status`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`material_loan_details_id` AS `material_loan_details_id`,
    `pt`.`material_loan_master_id` AS `material_loan_master_id`,
    `pt`.`indent_details_id` AS `indent_details_id`,
    `pm`.`from_company_id` AS `from_company_id`,
    `pm`.`from_department_id` AS `from_department_id`,
    `pm`.`from_sub_department_id` AS `from_sub_department_id`,
    `pm`.`to_company_id` AS `to_company_id`,
    `pm`.`to_company_branch_id` AS `to_company_branch_id`,
    `pm`.`to_department_id` AS `to_department_id`,
    `pm`.`to_sub_department_id` AS `to_sub_department_id`,
     `pt`.`godown_id` AS `godown_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `pm` on
    (`pm`.`material_loan_master_id` = `pt`.`material_loan_master_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `pt`.`godown_id`
        and `gd`.`company_id` = `pm`.`to_company_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

-- ptv_material_loan_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_master_summary` AS
select
    `st`.`loan_no` AS `loan_no`,
    `st`.`loan_version` AS `loan_version`,
    `st`.`loan_date` AS `loan_date`,
    `fcp`.`company_legal_name` AS `from_company_name`,
    `tcp`.`company_legal_name` AS `to_company_name`,
    `fd`.`department_name` AS `from_department_name`,
    `fds`.`department_name` AS `from_sub_department_name`,
    `td`.`department_name` AS `to_department_name`,
    `tds`.`department_name` AS `to_sub_department_name`,
    `e`.`employee_name` AS `requested_by_name`,
    `e1`.`employee_name` AS `received_by_name`,
    case
        `st`.`material_loan_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        when 'R' then 'Received'
        else 'Pending'
    end AS `material_loan_status_desc`,
    `ffc`.`cost_center_name` AS `from_cost_center_name`,
    `tfc`.`cost_center_name` AS `to_cost_center_name`,
    `e`.`email_id1` AS `requested_by_email`,
    `e1`.`email_id1` AS `received_by_email`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`from_cost_center_id` AS `from_cost_center_id`,
    `st`.`to_cost_center_id` AS `to_cost_center_id`,
    `st`.`material_loan_status` AS `material_loan_status`,
    `st`.`from_company_id` AS `from_company_id`,
    `st`.`from_company_branch_id` AS `from_company_branch_id`,
    `st`.`from_department_id` AS `from_department_id`,
    `st`.`from_sub_department_id` AS `from_sub_department_id`,
    `st`.`requested_by_id` AS `requested_by_id`,
    `st`.`to_company_id` AS `to_company_id`,
    `st`.`to_company_branch_id` AS `to_company_branch_id`,
    `st`.`to_department_id` AS `to_department_id`,
    `st`.`to_sub_department_id` AS `to_sub_department_id`,
    `st`.`received_by_id` AS `received_by_id`,
    `st`.`material_loan_master_id` AS `material_loan_master_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`loan_no` AS `field_name`,
    `st`.`loan_version` AS `field_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `fcp` on
    (`fcp`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `tcp` on
    (`tcp`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `fd` on
    (`fd`.`department_id` = `st`.`from_department_id`
        and `fd`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `fds` on
    (`fds`.`department_id` = `st`.`from_sub_department_id`
        and `fds`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `td` on
    (`td`.`department_id` = `st`.`to_department_id`
        and `td`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `tds` on
    (`tds`.`department_id` = `st`.`to_sub_department_id`
        and `tds`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`requested_by_id`
        and `e`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`received_by_id`
        and `e1`.`company_id` = `st`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `ffc` on
    (`ffc`.`cost_center_id` = `st`.`from_cost_center_id`
        and `ffc`.`company_id` = `st`.`from_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `tfc` on
    (`tfc`.`cost_center_id` = `st`.`to_cost_center_id`
        and `tfc`.`company_id` = `st`.`to_company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`loan_no`,
    `st`.`loan_version`;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_material_loan_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_material_loan_details` AS
select
    `pt`.`loan_no` AS `loan_no`,
    `pt`.`loan_date` AS `loan_date`,
    `pt`.`loan_version` AS `loan_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `pt`.`product_material_balance_quantity` AS `product_material_balance_quantity`,
    `pt`.`product_material_balance_weight` AS `product_material_balance_weight`,
    `pt`.`product_material_requested_quantity` AS `product_material_requested_quantity`,
    `pt`.`product_material_requested_weight` AS `product_material_requested_weight`,
    `pt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `pt`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `pt`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `pt`.`product_material_return_weight` AS `product_material_return_weight`,
    `pt`.`product_material_std_weight` AS `product_material_std_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pm`.`to_company_id`), 0) AS `product_material_stock_weight`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `gd`.`godown_name` AS `godown_name`,
    `pt`.`issue_remark` AS `issue_remark`,
    case
        `pt`.`loan_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'MI' then 'Material Issue'
        when 'R' then 'Received'
        else 'Pending'
    end AS `loan_item_status_desc`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`loan_item_status` AS `loan_item_status`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`material_loan_details_id` AS `material_loan_details_id`,
    `pt`.`material_loan_master_id` AS `material_loan_master_id`,
    `pt`.`indent_details_id` AS `indent_details_id`,
    `pm`.`from_company_id` AS `from_company_id`,
    `pm`.`from_department_id` AS `from_department_id`,
    `pm`.`from_sub_department_id` AS `from_sub_department_id`,
    `pm`.`to_company_id` AS `to_company_id`,
    `pm`.`to_company_branch_id` AS `to_company_branch_id`,
    `pm`.`to_department_id` AS `to_department_id`,
    `pm`.`to_sub_department_id` AS `to_sub_department_id`,
     `pt`.`godown_id` AS `godown_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`pt_material_loan_master` `pm` on
    (`pm`.`material_loan_master_id` = `pt`.`material_loan_master_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `u`.`company_id` = `pm`.`to_company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `pt`.`godown_id`
        and `gd`.`company_id` = `pm`.`to_company_id`))
where
    `pt`.`is_delete` = 0;


--------------------------------------------changes of company_id in views-----------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_category1 source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_category1` AS
select
    `b`.`product_category1_name` AS `product_category1_name`,
    `b`.`product_category1_short_name` AS `product_category1_short_name`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `v`.`company_legal_name` AS `company_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `b`.`remark` AS `remark`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`product_category1_id` AS `product_category1_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`company_id` AS `company_id`,
    `b`.`product_category1_name` AS `field_name`,
    `b`.`product_category1_id` AS `field_id`
from
    ((`sm_product_category1` `b`
left join `sm_product_type` `p` on
    (`p`.`company_id` = `b`.`company_id`
        and `p`.`product_type_id` = `b`.`product_type_id`))
left join `cm_company` `v` on
    (`v`.`company_id` = `b`.`company_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_category2 source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_category2` AS
select
    `b`.`product_category2_name` AS `product_category2_name`,
    `b`.`product_category2_short_name` AS `product_category2_short_name`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `pc1`.`product_category1_name` AS `product_category1_name`,
    `pc1`.`product_category1_short_name` AS `product_category1_short_name`,
    `v`.`company_legal_name` AS `company_name`,
    `b`.`remark` AS `remark`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`product_category2_id` AS `product_category2_id`,
    `b`.`product_category1_id` AS `product_category1_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`product_category2_name` AS `field_name`,
    `b`.`product_category2_id` AS `field_id`
from
    (((`sm_product_category2` `b`
left join `sm_product_category1` `pc1` on
    (`pc1`.`product_category1_id` = `b`.`product_category1_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `b`.`product_type_id`))
left join `cm_company` `v` on
    (`v`.`company_id` = `b`.`company_id`))
where
    `b`.`is_delete` = 0;


-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.cmv_godown source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `cmv_godown` AS
select
    `b`.`godown_type` AS `godown_type`,
    `b`.`godown_id` AS `godown_id`,
    `b`.`godown_name` AS `godown_name`,
    `b`.`godown_short_name` AS `godown_short_name`,
    `b`.`godown_area` AS `godown_area`,
    `b`.`godown_section_count` AS `godown_section_count`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `p`.`product_type_id` AS `product_type_id`,
    `b`.`godown_name` AS `field_name`,
    `b`.`godown_id` AS `field_id`
from
    ((`cm_godown` `b`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `b`.`company_branch_id`
        and `v`.`company_id` = `b`.`company_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `b`.`product_type_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.cmv_godown_section source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `cmv_godown_section` AS
select
    `b`.`godown_section_name` AS `godown_section_name`,
    `b`.`godown_section_short_name` AS `godown_section_short_name`,
    `b`.`godown_section_area` AS `godown_section_area`,
    `b`.`section_beans_count` AS `section_beans_count`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_section_count` AS `godown_section_count`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`godown_id` AS `godown_id`,
    `g`.`product_type_id` AS `product_type_id`,
    `b`.`godown_section_id` AS `godown_section_id`,
    `b`.`godown_section_name` AS `field_name`,
    `b`.`godown_section_id` AS `field_id`
from
    (((`cm_godown_section` `b`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `b`.`company_branch_id`
        and `v`.`company_id` = `b`.`company_id`))
left join `cm_godown` `g` on
    (`g`.`godown_id` = `b`.`godown_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `g`.`product_type_id`))
where
    `b`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------

-- ERP_PASHUPATI_PROD_1_0.cmv_godown_section_beans source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `cmv_godown_section_beans` AS
select
    `b`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `b`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `b`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `s`.`godown_section_name` AS `godown_section_name`,
    `s`.`godown_section_short_name` AS `godown_section_short_name`,
    `s`.`godown_section_area` AS `godown_section_area`,
    `s`.`section_beans_count` AS `section_beans_count`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_section_count` AS `godown_section_count`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`godown_id` AS `godown_id`,
    `b`.`godown_section_id` AS `godown_section_id`,
    `g`.`product_type_id` AS `product_type_id`,
    `b`.`godown_section_beans_name` AS `field_name`,
    `b`.`godown_section_beans_id` AS `field_id`
from
    ((((`cm_godown_section_beans` `b`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `b`.`company_branch_id`
        and `v`.`company_id` = `b`.`company_id`))
left join `cm_godown_section` `s` on
    (`s`.`godown_id` = `b`.`godown_id`
        and `s`.`godown_section_id` = `b`.`godown_section_id`))
left join `cm_godown` `g` on
    (`g`.`godown_id` = `b`.`godown_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `g`.`product_type_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `amv_properties` AS
select
    `P`.`properties_master_name` AS `properties_master_name`,
    `P`.`property_name` AS `property_name`,
    `P`.`property_value` AS `property_value`,
    concat(`P`.`property_name`, ':', `P`.`property_value`) AS `property_name_value`,
    case
        `P`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `P`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `P`.`is_delete` AS `is_delete`,
    `P`.`is_active` AS `is_active`,
    `P`.`property_master_id` AS `property_master_id`,
    `P`.`property_group` AS `property_group`,
    `P`.`property_id` AS `property_id`,
    `P`.`company_id` AS `company_id`,
    `P`.`created_by` AS `created_by`,
    `P`.`created_on` AS `created_on`,
    `P`.`modified_by` AS `modified_by`,
    `P`.`modified_on` AS `modified_on`,
    `P`.`deleted_by` AS `deleted_by`,
    `P`.`deleted_on` AS `deleted_on`,
    `P`.`property_id` AS `field_id`,
    `P`.`property_name` AS `field_name`,
    `P`.`remark` AS `remark`
from
    `am_properties` `P`
    WHERE `P`.`is_delete` = 0
order by
    `P`.`property_master_id`;
-------------------------------------------------------------------------------------------------------------------------------


select * from am_properties_master WHERE is_delete = 0
 update am_properties_master set is_delete = 1 , is_active = 0 WHERE company_id != 1

-------------------------------------------------------------------------------------------------------------------------------
14-06-24

-- ERP_PASHUPATI_PROD_1_0.smv_product_rm_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_details` AS
select
    'NA' AS `company_name`,
    'NA' AS `company_branch_name`,
    `rm`.`product_rm_code` AS `product_rm_code`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `rm`.`product_rm_print_name` AS `product_rm_print_name`,
    `rm`.`product_rm_tech_spect` AS `product_rm_tech_spect`,
    `rm`.`product_rm_oem_part_code` AS `product_rm_oem_part_code`,
    `rm`.`product_rm_our_part_code` AS `product_rm_our_part_code`,
    `rm`.`product_rm_drawing_no` AS `product_rm_drawing_no`,
    `rm`.`product_rm_item_sr_no` AS `product_rm_item_sr_no`,
    `rm`.`product_rm_model_no` AS `product_rm_model_no`,
    `rm`.`product_rm_bar_code` AS `product_rm_bar_code`,
    `rm`.`product_rm_qr_code` AS `product_rm_qr_code`,
    `rm`.`product_consumption_mode` AS `product_consumption_mode`,
    `rm`.`product_origin_type` AS `product_origin_type`,
    `rm`.`product_origin_country` AS `product_origin_country`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `h`.`hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `h`.`hsn_sac_type` AS `product_rm_hsn_sac_type`,
    `h`.`is_exampted` AS `product_rm_hsn_sac_is_exampted`,
    `u1`.`product_unit_name` AS `product_rm_purchase_unit_name`,
    `u1`.`product_unit_name` AS `product_rm_sales_unit_name`,
    `u1`.`product_unit_name` AS `product_rm_stock_unit_name`,
    `p1`.`product_packing_name` AS `product_rm_packing_name`,
    `p1`.`quantity_per_packing` AS `product_rm_quantity_per_packing`,
    `p1`.`weight_per_packing` AS `product_rm_weight_per_packing`,
    `pm`.`product_make_name` AS `product_make_name`,
    `gsb`.`godown_name` AS `godown_name`,
    `gsb`.`godown_short_name` AS `godown_short_name`,
    0 AS `godown_area`,
    `gsb`.`godown_section_count` AS `godown_section_count`,
    `gsb`.`godown_section_name` AS `godown_section_name`,
    `gsb`.`godown_section_short_name` AS `godown_section_short_name`,
    0 AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    0 AS `godown_section_beans_area`,
    `rm`.`product_rm_name` AS `product_alternate_rm_name`,
    `rmt`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `pc1`.`product_category1_name` AS `product_category1_name`,
    `pc2`.`product_category2_name` AS `product_category2_name`,
    `pc3`.`product_category3_name` AS `product_category3_name`,
    'NA' AS `product_category4_name`,
    'NA' AS `product_category5_name`,
    'NA' AS `product_material_type_name`,
    'NA' AS `product_material_grade_name`,
    'NA' AS `product_material_shape_name`,
    'NA' AS `product_material_colour`,
    0 AS `assembly_scrap_percent`,
    `rmc`.`product_rm_gross_weight` AS `product_rm_gross_weight`,
    `rmc`.`product_rm_net_weight` AS `product_rm_net_weight`,
    `rmc`.`product_rm_std_weight` AS `product_rm_std_weight`,
    `rmc`.`product_rm_volume` AS `product_rm_volume`,
    `rmc`.`product_rm_mrp` AS `product_rm_mrp`,
    `rmc`.`product_rm_landed_price` AS `product_rm_landed_price`,
    `rmc`.`product_rm_avg_price` AS `product_rm_avg_price`,
    `rmc`.`product_rm_std_profit_percent` AS `product_rm_std_profit_percent`,
    `rmc`.`product_rm_std_discount_percent` AS `product_rm_std_discount_percent`,
    `rmc`.`lead_time` AS `lead_time`,
    `rmc`.`product_rm_moq` AS `product_rm_moq`,
    `rmc`.`product_rm_mpq` AS `product_rm_mpq`,
    `rmc`.`product_rm_mov` AS `product_rm_mov`,
    `rmc`.`product_rm_eoq` AS `product_rm_eoq`,
    `rmc`.`product_rm_min_stock_level` AS `product_rm_min_stock_level`,
    `rmc`.`product_rm_max_stock_level` AS `product_rm_max_stock_level`,
    `rmc`.`product_rm_reorder_stock_level` AS `product_rm_reorder_stock_level`,
    `rmc`.`product_rm_depriciation_percent` AS `product_rm_depriciation_percent`,
    `rmc`.`purchase_tolerance_percent` AS `purchase_tolerance_percent`,
    `rmc`.`product_rm_price_type` AS `product_rm_price_type`,
    `rmc`.`product_rm_abc_analysis` AS `product_rm_abc_analysis`,
    `rmc`.`qa_required` AS `qa_required`,
    `rmc`.`test_certificate_required` AS `test_certificate_required`,
    `rm`.`remark` AS `remark`,
    case
        `rm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `rm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `rm`.`is_active` AS `is_active`,
    `rm`.`is_delete` AS `is_delete`,
    `rm`.`created_by` AS `created_by`,
    `rm`.`created_on` AS `created_on`,
    `rm`.`modified_by` AS `modified_by`,
    `rm`.`modified_on` AS `modified_on`,
    `rm`.`deleted_by` AS `deleted_by`,
    `rm`.`deleted_on` AS `deleted_on`,
    `rm`.`company_id` AS `company_id`,
    `rm`.`company_branch_id` AS `company_branch_id`,
    `rm`.`product_rm_id` AS `product_rm_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_rm_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `rm`.`product_rm_purchase_unit_id` AS `product_rm_purchase_unit_id`,
    `rm`.`product_rm_sales_unit_id` AS `product_rm_sales_unit_id`,
    `rm`.`product_rm_stock_unit_id` AS `product_rm_stock_unit_id`,
    `rm`.`product_rm_packing_id` AS `product_rm_packing_id`,
    `rm`.`godown_id` AS `godown_id`,
    `rm`.`godown_section_id` AS `godown_section_id`,
    `rm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `rm`.`product_category1_id` AS `product_category1_id`,
    `rmt`.`product_alternate_rm_id` AS `product_alternate_rm_id`,
    `rmt`.`product_category2_id` AS `product_category2_id`,
    `rmt`.`product_category3_id` AS `product_category3_id`,
    `rmt`.`product_category4_id` AS `product_category4_id`,
    `rmt`.`product_category5_id` AS `product_category5_id`,
    `rmt`.`product_material_type_id` AS `product_material_type_id`,
    `rmt`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmt`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmt`.`product_make_id` AS `product_make_id`,
    `rm`.`product_id` As `product_id`,
    `rm`.`product_rm_name` AS `field_name`,
    `rm`.`product_rm_id` AS `field_id`
from
    (((((((((((`sm_product_rm` `rm`
left join `sm_product_type` `p` on
    (`p`.`company_id` = `rm`.`company_id`
        and `p`.`product_type_id` = `rm`.`product_type_id`))
left join `sm_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`))
left join `sm_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_delete` = 0))
left join `cm_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `rm`.`product_rm_hsn_sac_code_id`
        and `h`.`company_id` = `rm`.`company_id`))
left join `sm_product_unit` `u1` on
    (`u1`.`product_unit_id` = `rm`.`product_rm_stock_unit_id`
        and `u1`.`company_id` = `rm`.`company_id`))
left join `sm_product_make` `pm` on
    (`pm`.`company_id` = `rmt`.`company_id`
        and `pm`.`product_make_id` = `rmt`.`product_make_id`))
left join `sm_product_packing` `p1` on
    (`p1`.`product_packing_id` = `rm`.`product_rm_packing_id`
        and `p1`.`company_id` = `rm`.`company_id`))
left join `sm_product_category1` `pc1` on
    (`pc1`.`company_id` = `rm`.`company_id`
        and `pc1`.`product_category1_id` = `rm`.`product_category1_id`))
left join `sm_product_category2` `pc2` on
    (`pc2`.`company_id` = `rmt`.`company_id`
        and `pc2`.`product_category2_id` = `rmt`.`product_category2_id`))
left join `sm_product_category3` `pc3` on
    (`pc3`.`company_id` = `rmt`.`company_id`
        and `pc3`.`product_category3_id` = `rmt`.`product_category3_id`))
left join `cmv_godown_section_beans` `gsb` on
    (`gsb`.`godown_id` = `rm`.`godown_id`
        and `gsb`.`godown_section_id` = `rm`.`godown_section_id`
        and `gsb`.`godown_section_beans_id` = `rm`.`godown_section_beans_id`
        and `gsb`.`company_id` = `rm`.`company_id`))
where
    `rm`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_rm_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_details` AS
	select
	    'NA' AS `company_name`,
	    'NA' AS `company_branch_name`,
	    `rm`.`product_rm_code` AS `product_rm_code`,
	    `rm`.`product_rm_name` AS `product_rm_name`,
	    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
	    `rm`.`product_rm_print_name` AS `product_rm_print_name`,
	    `rm`.`product_rm_tech_spect` AS `product_rm_tech_spect`,
	    `rm`.`product_rm_oem_part_code` AS `product_rm_oem_part_code`,
	    `rm`.`product_rm_our_part_code` AS `product_rm_our_part_code`,
	    `rm`.`product_rm_drawing_no` AS `product_rm_drawing_no`,
	    `rm`.`product_rm_item_sr_no` AS `product_rm_item_sr_no`,
	    `rm`.`product_rm_model_no` AS `product_rm_model_no`,
	    `rm`.`product_rm_bar_code` AS `product_rm_bar_code`,
	    `rm`.`product_rm_qr_code` AS `product_rm_qr_code`,
	    `rm`.`product_consumption_mode` AS `product_consumption_mode`,
	    `rm`.`product_origin_type` AS `product_origin_type`,
	    `rm`.`product_origin_country` AS `product_origin_country`,
	    `p`.`product_type_name` AS `product_type_name`,
	    `p`.`product_type_short_name` AS `product_type_short_name`,
	    `p`.`product_type_group` AS `product_type_group`,
	    `h`.`hsn_sac_code` AS `product_rm_hsn_sac_code`,
	    `h`.`hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
	    `h`.`hsn_sac_type` AS `product_rm_hsn_sac_type`,
	    `h`.`is_exampted` AS `product_rm_hsn_sac_is_exampted`,
	    `u1`.`product_unit_name` AS `product_rm_purchase_unit_name`,
	    `u1`.`product_unit_name` AS `product_rm_sales_unit_name`,
	    `u1`.`product_unit_name` AS `product_rm_stock_unit_name`,
	    `p1`.`product_packing_name` AS `product_rm_packing_name`,
	    `p1`.`quantity_per_packing` AS `product_rm_quantity_per_packing`,
	    `p1`.`weight_per_packing` AS `product_rm_weight_per_packing`,
	    `pm`.`product_make_name` AS `product_make_name`,
	    `gsb`.`godown_name` AS `godown_name`,
	    `gsb`.`godown_short_name` AS `godown_short_name`,
	    0 AS `godown_area`,
	    `gsb`.`godown_section_count` AS `godown_section_count`,
	    `gsb`.`godown_section_name` AS `godown_section_name`,
	    `gsb`.`godown_section_short_name` AS `godown_section_short_name`,
	    0 AS `godown_section_area`,
	    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
	    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
	    0 AS `godown_section_beans_area`,
	    `rm`.`product_rm_name` AS `product_alternate_rm_name`,
	    `rmt`.`product_rm_technical_name` AS `product_rm_technical_name`,
	    `pc1`.`product_category1_name` AS `product_category1_name`,
	    `pc2`.`product_category2_name` AS `product_category2_name`,
	    `pc3`.`product_category3_name` AS `product_category3_name`,
	    'NA' AS `product_category4_name`,
	    'NA' AS `product_category5_name`,
	    'NA' AS `product_material_type_name`,
	    'NA' AS `product_material_grade_name`,
	    'NA' AS `product_material_shape_name`,
	    'NA' AS `product_material_colour`,
	    0 AS `assembly_scrap_percent`,
	    `rmc`.`product_rm_gross_weight` AS `product_rm_gross_weight`,
	    `rmc`.`product_rm_net_weight` AS `product_rm_net_weight`,
	    `rmc`.`product_rm_std_weight` AS `product_rm_std_weight`,
	    `rmc`.`product_rm_volume` AS `product_rm_volume`,
	    `rmc`.`product_rm_mrp` AS `product_rm_mrp`,
	    `rmc`.`product_rm_landed_price` AS `product_rm_landed_price`,
	    `rmc`.`product_rm_avg_price` AS `product_rm_avg_price`,
	    `rmc`.`product_rm_std_profit_percent` AS `product_rm_std_profit_percent`,
	    `rmc`.`product_rm_std_discount_percent` AS `product_rm_std_discount_percent`,
	    `rmc`.`lead_time` AS `lead_time`,
	    `rmc`.`product_rm_moq` AS `product_rm_moq`,
	    `rmc`.`product_rm_mpq` AS `product_rm_mpq`,
	    `rmc`.`product_rm_mov` AS `product_rm_mov`,
	    `rmc`.`product_rm_eoq` AS `product_rm_eoq`,
	    `rmc`.`product_rm_min_stock_level` AS `product_rm_min_stock_level`,
	    `rmc`.`product_rm_max_stock_level` AS `product_rm_max_stock_level`,
	    `rmc`.`product_rm_reorder_stock_level` AS `product_rm_reorder_stock_level`,
	    `rmc`.`product_rm_depriciation_percent` AS `product_rm_depriciation_percent`,
	    `rmc`.`purchase_tolerance_percent` AS `purchase_tolerance_percent`,
	    `rmc`.`product_rm_price_type` AS `product_rm_price_type`,
	    `rmc`.`product_rm_abc_analysis` AS `product_rm_abc_analysis`,
	    `rmc`.`qa_required` AS `qa_required`,
	    `rmc`.`test_certificate_required` AS `test_certificate_required`,
	    `rmc`.`routing_code` AS `routing_code`,
	    `fpc`.`profit_center_name` AS `profit_center_name`,
	    `fcc`.`cost_center_name` AS `cost_center_name`,
	    `rm`.`remark` AS `remark`,
	    case
	        `rm`.`is_active` when 1 then 'Active'
	        else 'In Active'
	    end AS `Active`,
	    case
	        `rm`.`is_delete` when 1 then 'Yes'
	        else 'No'
	    end AS `Deleted`,
	    `rm`.`is_active` AS `is_active`,
	    `rm`.`is_delete` AS `is_delete`,
	    `rm`.`created_by` AS `created_by`,
	    `rm`.`created_on` AS `created_on`,
	    `rm`.`modified_by` AS `modified_by`,
	    `rm`.`modified_on` AS `modified_on`,
	    `rm`.`deleted_by` AS `deleted_by`,
	    `rm`.`deleted_on` AS `deleted_on`,
	    `rm`.`company_id` AS `company_id`,
	    `rm`.`company_branch_id` AS `company_branch_id`,
	    `rm`.`product_rm_id` AS `product_rm_id`,
	    `rm`.`product_type_id` AS `product_type_id`,
	    `rm`.`product_rm_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
	    `rm`.`product_rm_purchase_unit_id` AS `product_rm_purchase_unit_id`,
	    `rm`.`product_rm_sales_unit_id` AS `product_rm_sales_unit_id`,
	    `rm`.`product_rm_stock_unit_id` AS `product_rm_stock_unit_id`,
	    `rm`.`product_rm_packing_id` AS `product_rm_packing_id`,
	    `rm`.`godown_id` AS `godown_id`,
	    `rm`.`godown_section_id` AS `godown_section_id`,
	    `rm`.`godown_section_beans_id` AS `godown_section_beans_id`,
	    `rm`.`product_category1_id` AS `product_category1_id`,
	    `rmt`.`product_alternate_rm_id` AS `product_alternate_rm_id`,
	    `rmt`.`product_category2_id` AS `product_category2_id`,
	    `rmt`.`product_category3_id` AS `product_category3_id`,
	    `rmt`.`product_category4_id` AS `product_category4_id`,
	    `rmt`.`product_category5_id` AS `product_category5_id`,
	    `rmt`.`product_material_type_id` AS `product_material_type_id`,
	    `rmt`.`product_material_grade_id` AS `product_material_grade_id`,
	    `rmt`.`product_material_shape_id` AS `product_material_shape_id`,
	    `rmt`.`product_make_id` AS `product_make_id`,
	    `rmc`.`profit_center_id` AS `profit_center_id`,
	    `rmc`.`cost_center_id` AS `cost_center_id`,
	    `rm`.`product_id` As `product_id`,
	    `rm`.`product_rm_name` AS `field_name`,
	    `rm`.`product_rm_id` AS `field_id`
	from
	    (((((((((((((`sm_product_rm` `rm`
	left join `sm_product_type` `p` on
	    (`p`.`company_id` = `rm`.`company_id`
	        and `p`.`product_type_id` = `rm`.`product_type_id`))
	left join `sm_product_rm_technical` `rmt` on
	    (`rmt`.`company_id` = `rm`.`company_id`
	        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`))
	left join `sm_product_rm_commercial` `rmc` on
	    (`rmc`.`company_id` = `rm`.`company_id`
	        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
	        and `rmc`.`is_delete` = 0))
	left join `cm_hsn_sac` `h` on
	    (`h`.`hsn_sac_id` = `rm`.`product_rm_hsn_sac_code_id`
	        and `h`.`company_id` = `rm`.`company_id`))
	left join `sm_product_unit` `u1` on
	    (`u1`.`product_unit_id` = `rm`.`product_rm_stock_unit_id`
	        and `u1`.`company_id` = `rm`.`company_id`))
	left join `sm_product_make` `pm` on
	    (`pm`.`company_id` = `rmt`.`company_id`
	        and `pm`.`product_make_id` = `rmt`.`product_make_id`))
	left join `sm_product_packing` `p1` on
	    (`p1`.`product_packing_id` = `rm`.`product_rm_packing_id`
	        and `p1`.`company_id` = `rm`.`company_id`))
	left join `sm_product_category1` `pc1` on
	    (`pc1`.`company_id` = `rm`.`company_id`
	        and `pc1`.`product_category1_id` = `rm`.`product_category1_id`))
	left join `sm_product_category2` `pc2` on
	    (`pc2`.`company_id` = `rmt`.`company_id`
	        and `pc2`.`product_category2_id` = `rmt`.`product_category2_id`))
	left join `sm_product_category3` `pc3` on
	    (`pc3`.`company_id` = `rmt`.`company_id`
	        and `pc3`.`product_category3_id` = `rmt`.`product_category3_id`))
	left join `cmv_godown_section_beans` `gsb` on
	    (`gsb`.`godown_id` = `rm`.`godown_id`
	        and `gsb`.`godown_section_id` = `rm`.`godown_section_id`
	        and `gsb`.`godown_section_beans_id` = `rm`.`godown_section_beans_id`
	        and `gsb`.`company_id` = `rm`.`company_id`))
	left join `fm_profit_center` `fpc` on
	    (`fpc`.`company_id` = `rmc`.`company_id`
	        and `fpc`.`profit_center_id` = `rmc`.`profit_center_id`))
	left join `fm_cost_center` `fcc` on
	    (`fcc`.`company_id` = `rmc`.`company_id`
	        and `fcc`.`cost_center_id` = `rmc`.`cost_center_id`))
	where
	    `rm`.`is_delete` = 0;




-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_rm_rpt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_rpt_details` AS
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Raw Material Name:Y:C:smv_product_rm:F') AS `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Raw Material Code:O:N:') AS `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, 'NA'), ':Tech. Spect.:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Raw Material Category 1:Y:C:smv_product_category1:F') AS `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Raw Material Category 2:Y:C:smv_product_category2:F') AS `product_category2_name`,
    concat(ifnull(`rmt`.`product_category3_name`, 'NA'), ':Raw Material Category 3:Y:C:smv_product_category3:F') AS `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, 'NA'), ':Raw Material Category 4:Y:C:smv_product_category4:F') AS `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, 'NA'), ':Raw Material Category 5:Y:C:smv_product_category5:F') AS `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, 'NA'), ':Raw Material Make:Y:C:smv_product_make:F') AS `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, 'NA'), ':Raw Material Type:Y:C:smv_product_material_type:F') AS `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, 'NA'), ':Raw Material Grade:Y:C:smv_product_material_grade:F') AS `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, 'NA'), ':Raw Material Shape:Y:C:smv_product_material_shape:F') AS `product_material_shape_name`,
    concat(ifnull(`rmt`.`product_rm_name`, 'NA'), ':Alternate Raw Material:Y:C:smv_product_rm:F') AS `product_alternate_rm_name`,
    concat(ifnull(`rm`.`product_rm_tech_spect`, 'NA'), ':Tech Spect.:O:N:') AS `product_rm_tech_spect`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, 'NA'), ':OEM Part Code:Y:T:') AS `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') AS `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') AS `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') AS `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') AS `product_rm_stock_unit_name`,
    concat(ifnull(`rm`.`product_rm_packing_name`, 'NA'), ':Packing:Y:C:smv_product_packing:F') AS `product_rm_packing_name`,
    concat(ifnull(`rm`.`product_rm_item_sr_no`, 'NA'), ':Item Sr. No:O:N:') AS `product_rm_item_sr_no`,
    concat(ifnull(`rm`.`product_rm_drawing_no`, 'NA'), ':Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(ifnull(`rm`.`product_rm_model_no`, 'NA'), ':Model No:O:N:') AS `product_rm_model_no`,
    concat(ifnull(`rm`.`product_rm_bar_code`, 'NA'), ':Bar Code:O:N:') AS `product_rm_bar_code`,
    concat(ifnull(`rm`.`product_rm_qr_code`, 'NA'), ':QR Code:O:N:') AS `product_rm_qr_code`,
    concat(ifnull(`rm`.`product_consumption_mode`, 'NA'), ':Consumption Mode:Y:P:MaterialConsumptionMode') AS `product_consumption_mode`,
    concat(ifnull(`rm`.`product_origin_type`, 'NA'), ':Origin Type:Y:P:MaterialOrigin') AS `product_origin_type`,
    concat(ifnull(`rm`.`product_origin_country`, 'NA'), ':Origin Country:O:N:') AS `product_origin_country`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_is_exampted`, 'NA'), ':HSN Type Exampted:O:N:') AS `product_rm_hsn_sac_is_exampted`,
    concat(ifnull(`rmt`.`product_material_colour`, 'NA'), ':Colour:O:N:') AS `product_material_colour`,
    concat(ifnull(`rmt`.`assembly_scrap_percent`, 'NA'), ':Scrap Percent:O:N:') AS `assembly_scrap_percent`,
    concat(ifnull(`rmc`.`product_rm_gross_weight`, 'NA'), ':Gross Weight:Y:T') AS `product_rm_gross_weight`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') AS `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_volume`, 'NA'), ':Volume:Y:T') AS `product_rm_volume`,
    concat(ifnull(`rmc`.`product_rm_mrp`, 'NA'), ':MRP:Y:T') AS `product_rm_mrp`,
    concat(ifnull(`rmc`.`product_rm_landed_price`, 'NA'), ':Landed Price:Y:T') AS `product_rm_landed_price`,
    concat(ifnull(`rmc`.`product_rm_avg_price`, 'NA'), ':Avg. Price:Y:T') AS `product_rm_avg_price`,
    concat(ifnull(`rmc`.`product_rm_std_profit_percent`, 'NA'), ': Std. Profit Percent:Y:T') AS `product_rm_std_profit_percent`,
    concat(ifnull(`rmc`.`product_rm_std_discount_percent`, 'NA'), ':Std. Discount Percent:Y:T') AS `product_rm_std_discount_percent`,
    concat(ifnull(`rmc`.`product_rm_moq`, 'NA'), ':MOQ:Y:T') AS `product_rm_moq`,
    concat(ifnull(`rmc`.`product_rm_mpq`, 'NA'), ':MPQ:Y:T') AS `product_rm_mpq`,
    concat(ifnull(`rmc`.`product_rm_mov`, 'NA'), ':MOV:Y:T') AS `product_rm_mov`,
    concat(ifnull(`rmc`.`product_rm_eoq`, 'NA'), ':EOQ:Y:T') AS `product_rm_eoq`,
    concat(ifnull(`rmc`.`product_rm_min_stock_level`, 'NA'), ':Minimum Stock:Y:T') AS `product_rm_min_stock_level`,
    concat(ifnull(`rmc`.`product_rm_max_stock_level`, 'NA'), ':Maximum Stock:Y:T') AS `product_rm_max_stock_level`,
    concat(ifnull(`rmc`.`product_rm_reorder_stock_level`, 'NA'), ':Reorder Stock:Y:T') AS `product_rm_reorder_stock_level`,
    concat(ifnull(`rmc`.`purchase_tolerance_percent`, 'NA'), ': Purchase Tolerance Percent:Y:T') AS `purchase_tolerance_percent`,
    concat(ifnull(`rmc`.`product_rm_price_type`, 'NA'), ':Price Type:Y:H:(Fixed,Moving Average)') AS `product_rm_price_type`,
    concat(ifnull(`rmc`.`product_rm_abc_analysis`, 'NA'), ':ABC Category:Y:H:(A,B,C)') AS `product_rm_abc_analysis`,
    concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`rmc`.`qa_required`, 'NA'), ':QA Required:Y:H:(Yes,No)') AS `qa_required`,
    concat(ifnull(`rmc`.`test_certificate_required`, 'NA'), ':Test Certificate Required:Y:H:(Yes,No)') AS `test_certificate_required`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') AS `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') AS `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') AS `routing_code`,
    concat(ifnull(`rm`.`product_rm_print_name`, 'NA'), ':Print Name:O:N:') AS `product_rm_print_name`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') AS `remark`,
    concat(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Delete By:O:N:') AS `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`rm`.`company_id`, 'NA'), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`rm`.`company_branch_id`, 'NA'), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`rm`.`product_type_id`, 'NA'), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`rm`.`product_category1_id`, 'NA'), ':Product Category Id 1:N:N:') AS `product_category1_id`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Raw Material Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`rmc`.`profit_center_id`, ''), ':Profit Center Id:N:N:') AS `profit_center_id`,
    concat(ifnull(`rmc`.`cost_center_id`, ''), ':Cost Center Id:N:N:') AS `cost_center_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `v`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`st_indent_details` `st`
left join `stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `parent` on
    (`parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ptv_purchase_order_master_summary` AS
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end AS `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end AS `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `s`.`supplier_name` AS `supplier_name`,
    `st`.`state_name` AS `state_name`,
    `s`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `st1`.`state_name` AS `expected_branch_state_name`,
    `e`.`employee_name` AS `approved_by`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`expected_schedule_date` AS `expected_schedule_date`,
    `pt`.`basic_total` AS `basic_total`,
    `pt`.`transport_amount` AS `transport_amount`,
    `pt`.`freight_amount` AS `freight_amount`,
    `pt`.`is_freight_taxable` AS `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `pt`.`packing_amount` AS `packing_amount`,
    `pt`.`po_discount_percent` AS `po_discount_percent`,
    `pt`.`po_discount_amount` AS `po_discount_amount`,
    `pt`.`other_amount` AS `other_amount`,
    `pt`.`taxable_total` AS `taxable_total`,
    `pt`.`cgst_total` AS `cgst_total`,
    `pt`.`sgst_total` AS `sgst_total`,
    `pt`.`igst_total` AS `igst_total`,
    `pt`.`roundoff` AS `roundoff`,
    `pt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `pt`.`agent_percent` AS `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` AS `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`status_remark` AS `status_remark`,
    `pt`.`other_terms_conditions` AS `other_terms_conditions`,
    `s`.`supplier_type` AS `supplier_type`,
    `s`.`supplier_code` AS `supplier_code`,
    `s`.`supplier_short_name` AS `supplier_short_name`,
    `s`.`supp_branch_address1` AS `supp_branch_address1`,
    `s`.`supp_branch_pincode` AS `supp_branch_pincode`,
    `ct`.`city_name` AS `city_name`,
    `s`.`district_name` AS `district_name`,
    `s`.`country_name` AS `country_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `ct1`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`purchase_process_entry` AS `purchase_process_entry`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `pt`.`purchase_order_life` AS `purchase_order_life`,
    `pt`.`purchase_order_status` AS `purchase_order_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end AS `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` AS `purchase_order_creation_type`,
    `pt`.`gate_pass_no` AS `gate_pass_no`,
    `pt`.`gate_pass_date` AS `gate_pass_date`,
    `pt`.`vehicale_no` AS `vehicale_no`,
    `pt`.`vehicale_type` AS `vehicale_type`,
    `pt`.`gross_weight` AS `gross_weight`,
    `pt`.`tare_weight` AS `tare_weight`,
    `pt`.`net_weight` AS `net_weight`,
    `pt`.`variation_weight` AS `variation_weight`,
    `pt`.`deduction1_name` AS `deduction1_name`,
    `pt`.`deduction1_percent` AS `deduction1_percent`,
    `pt`.`deduction1_amount` AS `deduction1_amount`,
    `pt`.`deduction2_name` AS `deduction2_name`,
    `pt`.`deduction2_percent` AS `deduction2_percent`,
    `pt`.`deduction2_amount` AS `deduction2_amount`,
    `pt`.`deduction3_name` AS `deduction3_name`,
    `pt`.`deduction3_percent` AS `deduction3_percent`,
    `pt`.`deduction3_amount` AS `deduction3_amount`,
    `pt`.`deduction4_name` AS `deduction4_name`,
    `pt`.`deduction4_percent` AS `deduction4_percent`,
    `pt`.`deduction4_amount` AS `deduction4_amount`,
    `pt`.`deduction5_name` AS `deduction5_name`,
    `pt`.`deduction5_percent` AS `deduction5_percent`,
    `pt`.`deduction5_amount` AS `deduction5_amount`,
    `e1`.`employee_name` AS `grader_by_name`,
    `pt`.`remark` AS `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    `pt`.`agent_id` AS `agent_id`,
    `cc`.`supplier_name` AS `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` AS `supp_consignee_address1`,
    `cc`.`supp_branch_address2` AS `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` AS `supp_consignee_pincode`,
    `cc`.`city_name` AS `supp_consignee_city_name`,
    `cc`.`district_name` AS `supp_consignee_district_name`,
    `cc`.`state_name` AS `supp_consignee_state_name`,
    `pt`.`consignee_id` AS `consignee_id`,
    `pt`.`consignee_state_id` AS `consignee_state_id`,
    `pt`.`consignee_city_id` AS `consignee_city_id`,
    `pt`.`grader_by_id` AS `grader_by_id`,
    `pt`.`deduction5_id` AS `deduction5_id`,
    `pt`.`deduction4_id` AS `deduction4_id`,
    `pt`.`deduction3_id` AS `deduction3_id`,
    `pt`.`deduction2_id` AS `deduction2_id`,
    `pt`.`deduction1_id` AS `deduction1_id`,
    `pt`.`agent_paid_status` AS `agent_paid_status`
from
    (((((((((((((`pt_purchase_order_master` `pt`
left join `cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier` `s` on
    (`s`.`company_branch_id` = `pt`.`company_branch_id`
        and `s`.`company_id` = `pt`.`company_id`
        and `s`.`supplier_id` = `pt`.`supplier_id`))
left join `cmv_employee` `e` on
    (`e`.`company_branch_id` = `pt`.`company_branch_id`
        and `e`.`company_id` = `pt`.`company_id`
        and `e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`
        and `hsn`.`company_id` = `pt`.`company_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`
        and `p`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier_branch` `cc` on
    (`cc`.`company_branch_id` = `pt`.`company_branch_id`
        and `cc`.`company_id` = `pt`.`company_id`
        and `cc`.`supplier_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
15-06-2024

select * from cm_hsn_sac WHERE is_delete = 0 and company_id = 1
update cm_hsn_sac set is_delete = 1 , is_active = 0 WHERE company_id != 1

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.ptv_purchase_order_tax_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ptv_purchase_order_tax_summary` AS
select
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `s`.`supplier_type` AS `supplier_type`,
    `s`.`supplier_code` AS `supplier_code`,
    `s`.`supplier_name` AS `supplier_name`,
    `s`.`supplier_short_name` AS `supplier_short_name`,
    `s`.`supp_branch_address1` AS `supp_branch_address1`,
    `s`.`supp_branch_pincode` AS `supp_branch_pincode`,
    `s`.`city_name` AS `supplier_city_name`,
    `s`.`district_name` AS `supplier_district_name`,
    `s`.`state_name` AS `supplier_state_name`,
    `s`.`country_name` AS `supplier_country_name`,
    `s`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `cb`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`state_name` AS `expected_branch_state_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`summary_taxable_amount` AS `summary_taxable_amount`,
    `pt`.`summary_cgst_percent` AS `summary_cgst_percent`,
    `pt`.`summary_cgst_total` AS `summary_cgst_total`,
    `pt`.`summary_sgst_percent` AS `summary_sgst_percent`,
    `pt`.`summary_sgst_total` AS `summary_sgst_total`,
    `pt`.`summary_igst_percent` AS `summary_igst_percent`,
    `pt`.`summary_igst_total` AS `summary_igst_total`,
    `pt`.`summary_total_amount` AS `summary_total_amount`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_tax_summary_transaction_id` AS `purchase_order_tax_summary_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`hsn_code_id` AS `hsn_code_id`
from
    ((((`pt_purchase_order_tax_summary` `pt`
left join `cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier` `s` on
    (`s`.`company_branch_id` = `pt`.`company_branch_id`
        and `s`.`company_id` = `pt`.`company_id`
        and `s`.`supplier_id` = `pt`.`supplier_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`hsn_code_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    1 AS `available_stock_quantity`,
    0 As `available_stock_weight`,
--     `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
--     `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
UPDATE sm_product_stock_tracking SET  is_delete = 1 WHERE   product_material_id= 'RM00129'

   UPDATE sm_product_rm_stock_details SET  is_delete = 1 WHERE   product_rm_id= 'RM00129'

    UPDATE sm_product_rm_stock_summary SET  is_delete = 1 WHERE   product_rm_id= 'RM00129'

     UPDATE sm_product_rm_technical SET  is_delete = 1 WHERE   product_rm_id= 'RM00129'

      UPDATE sm_product_rm_commercial SET  is_delete = 1 WHERE   product_rm_id= 'RM00129'

       UPDATE sm_product_rm SET  is_delete = 1 WHERE   product_rm_id= 'RM00129'


-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`company_id` = `sm`.`company_id`
        and `gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`product_type_id` = `sm`.`product_type_id`
        and `gd`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`and `pu`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_rm_purchase_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_details` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_rm_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cm` on
    (`cm`.`company_id` = `sm`.`company_id`
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `supp` on
    (`supp`.`company_id` = `sm`.`company_id`
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0 AND
    `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
employee_id = 652, 655 , 654 dummy employee removed
removed wrong material product_rm_id = 'RM0764'
-------------------------------------------------------------------------------------------------------------------------------

  INSERT INTO ERP_PASHUPATI_PROD_1_0.am_company_settings (company_id,company_type_id,auto_rm_materail_name_flag,RawMaterialCategoryCount,after_decimal_places,from_email_id,from_email_password,smtp_host_name,pop3_host_name,smtp_port,email_service_status,sms_service_status,sms_api,whatsapp_service_status,whatsapp_api,purchase_process_entry,stock_management,so_schedule_grace_days,po_schedule_grace_days,administration_percent,profit_percent,adminstration_cost,is_excess_allowed,e_inv_type_version,e_inv_tax_scheme,e_inv_transaction_category,e_inv_reverse_charges,e_inv_ecmgst,e_inv_igst_on_intra,e_inv_api_provider,e_inv_client_id,e_inv_client_secret,e_inv_sandbox_gsp_name,e_inv_sandbox_auth_url,e_inv_sandbox_base_url,e_inv_sandbox_ewb_url,e_inv_sandbox_cancel_ewb_url,e_inv_sandbox_user_name,e_inv_sandbox_password,e_inv_production_gsp_name,e_inv_production_auth_url,e_inv_production_base_url,e_inv_production_ewb_url,e_inv_production_cancel_ewb_url,e_inv_production_user_name,e_inv_production_password,e_inv_purchase_invoice_count,e_inv_balance_invoice_count,e_inv_client_connection_string,e_inv_auth_token,e_inv_sek,e_inv_token_expiry,e_inv_sez_header,e_inv_sez_footer,is_active,is_delete,created_by,deleted_on,created_on,modified_by,modified_on,deleted_by,remark,erp_version,salary_heads_calculation_on,earning_deduction_mapping_base) VALUES
	 (3,4,'N',1,2,'ganeshjsurve@gmail.com','wapivhsierevssmj','smtp.gmail.com','',465,1,1,'test',1,'','M','Datewise',2,2,0.0000,0.0000,NULL,0,'1.1','GST','B2B','1.0','1.0','N','TaxPro','client_id','cleint_secret','TaxPro_Sandbox','https://gstsandbox.charteredinfo.com/eivital/dec/v1.04/auth?&','https://gstsandbox.charteredinfo.com/eicore/dec/v1.03/Invoice?','https://gstsandbox.charteredinfo.com/eiewb/v1.04','https://gstsandbox.charteredinfo.com/v1.03','TaxProEnvPON','abc34*','TaxPro_Production','https://einvapi.charteredinfo.com/eivital/dec/v1.04/auth?','https://einvapi.charteredinfo.com/eicore/dec/v1.03/Invoice?','https://einvapi.charteredinfo.com/eiewb/v1.03','https://einvapi.charteredinfo.com/v1.03','API_FABRITEK_151','Raut@800','0','0','GST version','s8Bvj1HAu07xUZNwDs1DpFele',NULL,'2023-04-08 18:38:21.000','Supply To SEZ without payment of IGST against LUT ( ARN:AD270422O15254I)','Note:IGST Nill for F.Y. 20022-2023 Against LUT ( ARN:AD270422O15254I)',1,0,'1',NULL,NULL,'',NULL,'','testing','DAKSHABHI ERP','EmployeeType','DW'),
	 (2,3,'N',1,2,'ganeshjsurve@gmail.com','wapivhsierevssmj','smtp.gmail.com','',465,1,1,'test',1,'','M','Datewise',2,2,0.0000,0.0000,NULL,0,'1.1','GST','B2B','1.0','1.0','N','TaxPro','client_id','cleint_secret','TaxPro_Sandbox','https://gstsandbox.charteredinfo.com/eivital/dec/v1.04/auth?&','https://gstsandbox.charteredinfo.com/eicore/dec/v1.03/Invoice?','https://gstsandbox.charteredinfo.com/eiewb/v1.04','https://gstsandbox.charteredinfo.com/v1.03','TaxProEnvPON','abc34*','TaxPro_Production','https://einvapi.charteredinfo.com/eivital/dec/v1.04/auth?','https://einvapi.charteredinfo.com/eicore/dec/v1.03/Invoice?','https://einvapi.charteredinfo.com/eiewb/v1.03','https://einvapi.charteredinfo.com/v1.03','API_FABRITEK_151','Raut@800','0','0','GST version','s8Bvj1HAu07xUZNwDs1DpFele',NULL,'2023-04-08 18:38:21.000','Supply To SEZ without payment of IGST against LUT ( ARN:AD270422O15254I)','Note:IGST Nill for F.Y. 20022-2023 Against LUT ( ARN:AD270422O15254I)',1,0,'1',NULL,NULL,'',NULL,'','testing','DAKSHABHI ERP','EmployeeType','DW');

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_rm_stock_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`
from
    ((((((((((`sm_product_rm_stock_summary` `sm`
left join `cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`company_id` = `sm`.`company_id`
        and `gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`product_type_id` = `sm`.`product_type_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`company_id` = `sm`.`company_id`
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`company_id` = `sm`.`company_id`
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 AND  `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 AND `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`
        and `vp`.`company_branch_id` = `pt`.`company_branch_id`
        and `vp`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_rm_purchase_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_details` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_rm_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cm` on
    (`cm`.`company_id` = `sm`.`company_id`
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `supp` on
    (`supp`.`company_id` = `sm`.`company_id`
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
update am_modules_forms set modules_sub_menu_id = 8 where modules_forms_id = 298

update am_modules_forms set modules_sub_menu_id = 8 where modules_forms_id = 607

update am_modules_sub_menu set is_delete  = 1 where modules_sub_menu_id = 11



update am_modules_sub_menu set modules_sub_menu_name  = "Indents" where modules_sub_menu_id = 8

update am_modules_forms set display_sequence = 2 where modules_forms_id = 103

update am_modules_forms set display_sequence = 4 where modules_forms_id = 149

update am_modules_forms set display_sequence = 5 where modules_forms_id = 150

update am_modules_forms set display_sequence = 3 where modules_forms_id = 152

update am_modules_forms set display_sequence = 1 where modules_forms_id = 298

update am_modules_forms set display_sequence = 6 where modules_forms_id = 607


update am_modules_forms set modules_forms_name  = "Material Issue Slip"  where modules_forms_id = 298

update am_modules_forms set modules_forms_name  = "Purch. Indent (Material)"  where modules_forms_id = 103

update am_modules_forms set modules_forms_name  = "Purch. Indent (Greige Fabric)"  where modules_forms_id = 152

update am_modules_forms set modules_forms_name  = "Purch. Indent (Cotton Yarn)" where modules_forms_id = 149

update am_modules_forms set modules_forms_name  = "Material Loan Requisition"  where modules_forms_id = 607


update am_modules_forms set display_name = "Material Issue Slip" where modules_forms_id = 298

update am_modules_forms set display_name = "Purch. Indent (Material)" where modules_forms_id = 103

update am_modules_forms set display_name = "Purch. Indent (Greige Fabric)" where modules_forms_id = 152

update am_modules_forms set display_name = "Purch. Indent (Cotton Yarn)" where modules_forms_id = 149

update am_modules_forms set display_name =  "Material Loan Requisition" where modules_forms_id = 607

update am_modules_forms set  display_name =  "Purch. Indent (Raw Cotton)" where modules_forms_id = 150


update am_modules_forms set modules_forms_name  = "Purch. Indent (Raw Cotton)"  where modules_forms_id = 150


-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_rpt_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_rpt_summary` AS
select
  	concat(ifnull(`rmc`.`product_rm_name`, ''), ':Product Name:Y:T') AS `product_rm_name`,
--     concat(ifnull(`rm`.`product_rm_name`, ''), ':Product Name:Y:C:smv_product_rm:F') AS `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, ''), ':Product Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`rmt`.`product_type_name`, ''), ':Product Type:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, ''), ':Technical Name:Y:C:smv_product_rm_technical:O') AS `product_rm_technical_name`,
    concat(ifnull(`rmt`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`rmt`.`product_category1_name`, ''), ':Category 1:Y:C:smv_product_category1:F') AS `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, ''), ':Category 2:Y:C:smv_product_category2:F') AS `product_category2_name`,
    concat(ifnull(`rmt`.`product_category3_name`, ''), ':Category 3:Y:C:smv_product_category3:F') AS `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, ''), ':Category 4:Y:C:smv_product_category4:F') AS `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, ''), ':Category 5:Y:C:smv_product_category5:F') AS `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, ''), ':Make Name:Y:C:smv_product_make:F') AS `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, ''), ':Material Type:Y:C:smv_product_material_type:F') AS `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, ''), ':Material Grade:Y:C:smv_product_material_grade:F') AS `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, ''), ':Material Shape:Y:C:smv_product_material_shape:F') AS `product_material_shape_name`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, ''), ':HSN_SAC Code:Y:C:smv_product_rm:O') AS `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, ''), ':OEM Part Code:Y:C:smv_product_rm:O') AS `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_our_part_code`, ''), ':OUR Part Code:Y:C:smv_product_rm:O') AS `product_rm_our_part_code`,
    concat(ifnull(`rmt`.`product_rm_drawing_no`, ''), ':Drawing No:Y:C:smv_product_rm_technical:O') AS `product_rm_drawing_no`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, ''), ':Standard Wt.:Y:T') AS `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_mrp`, ''), ':MRP:Y:T') AS `product_rm_mrp`,
    concat(ifnull(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Is Active:Y:H:(Active, In Active)') AS `Active`,
    concat(ifnull(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Is Deleted:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`rm`.`created_by`, ''), 'Created By:O:N:') AS `created_by`,
    concat(ifnull(`rm`.`created_on`, ''), 'Modified On:O:N:') AS `created_on`,
    concat(ifnull(`rm`.`modified_by`, ''), 'Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`rm`.`modified_on`, ''), 'Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, ''), 'Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, ''), 'Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, ''), ':Material Id:O:N:') AS `product_rm_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_rpt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_rpt_details` AS
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Raw Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Raw Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, 'NA'), ':Tech. Spect.:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Raw Material Category 1:Y:C:smv_product_category1:F') AS `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Raw Material Category 2:Y:C:smv_product_category2:F') AS `product_category2_name`,
    concat(ifnull(`rmt`.`product_category3_name`, 'NA'), ':Raw Material Category 3:Y:C:smv_product_category3:F') AS `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, 'NA'), ':Raw Material Category 4:Y:C:smv_product_category4:F') AS `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, 'NA'), ':Raw Material Category 5:Y:C:smv_product_category5:F') AS `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, 'NA'), ':Raw Material Make:Y:C:smv_product_make:F') AS `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, 'NA'), ':Raw Material Type:Y:C:smv_product_material_type:F') AS `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, 'NA'), ':Raw Material Grade:Y:C:smv_product_material_grade:F') AS `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, 'NA'), ':Raw Material Shape:Y:C:smv_product_material_shape:F') AS `product_material_shape_name`,
    concat(ifnull(`rmt`.`product_rm_name`, 'NA'), ':Alternate Raw Material:Y:C:smv_product_rm:F') AS `product_alternate_rm_name`,
    concat(ifnull(`rm`.`product_rm_tech_spect`, 'NA'), ':Tech Spect.:O:N:') AS `product_rm_tech_spect`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, 'NA'), ':OEM Part Code:Y:T:') AS `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') AS `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') AS `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') AS `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') AS `product_rm_stock_unit_name`,
    concat(ifnull(`rm`.`product_rm_packing_name`, 'NA'), ':Packing:Y:C:smv_product_packing:F') AS `product_rm_packing_name`,
    concat(ifnull(`rm`.`product_rm_item_sr_no`, 'NA'), ':Item Sr. No:O:N:') AS `product_rm_item_sr_no`,
    concat(ifnull(`rm`.`product_rm_drawing_no`, 'NA'), ':Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(ifnull(`rm`.`product_rm_model_no`, 'NA'), ':Model No:O:N:') AS `product_rm_model_no`,
    concat(ifnull(`rm`.`product_rm_bar_code`, 'NA'), ':Bar Code:O:N:') AS `product_rm_bar_code`,
    concat(ifnull(`rm`.`product_rm_qr_code`, 'NA'), ':QR Code:O:N:') AS `product_rm_qr_code`,
    concat(ifnull(`rm`.`product_consumption_mode`, 'NA'), ':Consumption Mode:Y:P:MaterialConsumptionMode') AS `product_consumption_mode`,
    concat(ifnull(`rm`.`product_origin_type`, 'NA'), ':Origin Type:Y:P:MaterialOrigin') AS `product_origin_type`,
    concat(ifnull(`rm`.`product_origin_country`, 'NA'), ':Origin Country:O:N:') AS `product_origin_country`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_is_exampted`, 'NA'), ':HSN Type Exampted:O:N:') AS `product_rm_hsn_sac_is_exampted`,
    concat(ifnull(`rmt`.`product_material_colour`, 'NA'), ':Colour:O:N:') AS `product_material_colour`,
    concat(ifnull(`rmt`.`assembly_scrap_percent`, 'NA'), ':Scrap Percent:O:N:') AS `assembly_scrap_percent`,
    concat(ifnull(`rmc`.`product_rm_gross_weight`, 'NA'), ':Gross Weight:Y:T') AS `product_rm_gross_weight`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') AS `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_volume`, 'NA'), ':Volume:Y:T') AS `product_rm_volume`,
    concat(ifnull(`rmc`.`product_rm_mrp`, 'NA'), ':MRP:Y:T') AS `product_rm_mrp`,
    concat(ifnull(`rmc`.`product_rm_landed_price`, 'NA'), ':Landed Price:Y:T') AS `product_rm_landed_price`,
    concat(ifnull(`rmc`.`product_rm_avg_price`, 'NA'), ':Avg. Price:Y:T') AS `product_rm_avg_price`,
    concat(ifnull(`rmc`.`product_rm_std_profit_percent`, 'NA'), ': Std. Profit Percent:Y:T') AS `product_rm_std_profit_percent`,
    concat(ifnull(`rmc`.`product_rm_std_discount_percent`, 'NA'), ':Std. Discount Percent:Y:T') AS `product_rm_std_discount_percent`,
    concat(ifnull(`rmc`.`product_rm_moq`, 'NA'), ':MOQ:Y:T') AS `product_rm_moq`,
    concat(ifnull(`rmc`.`product_rm_mpq`, 'NA'), ':MPQ:Y:T') AS `product_rm_mpq`,
    concat(ifnull(`rmc`.`product_rm_mov`, 'NA'), ':MOV:Y:T') AS `product_rm_mov`,
    concat(ifnull(`rmc`.`product_rm_eoq`, 'NA'), ':EOQ:Y:T') AS `product_rm_eoq`,
    concat(ifnull(`rmc`.`product_rm_min_stock_level`, 'NA'), ':Minimum Stock:Y:T') AS `product_rm_min_stock_level`,
    concat(ifnull(`rmc`.`product_rm_max_stock_level`, 'NA'), ':Maximum Stock:Y:T') AS `product_rm_max_stock_level`,
    concat(ifnull(`rmc`.`product_rm_reorder_stock_level`, 'NA'), ':Reorder Stock:Y:T') AS `product_rm_reorder_stock_level`,
    concat(ifnull(`rmc`.`purchase_tolerance_percent`, 'NA'), ': Purchase Tolerance Percent:Y:T') AS `purchase_tolerance_percent`,
    concat(ifnull(`rmc`.`product_rm_price_type`, 'NA'), ':Price Type:Y:H:(Fixed,Moving Average)') AS `product_rm_price_type`,
    concat(ifnull(`rmc`.`product_rm_abc_analysis`, 'NA'), ':ABC Category:Y:H:(A,B,C)') AS `product_rm_abc_analysis`,
    concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`rmc`.`qa_required`, 'NA'), ':QA Required:Y:H:(Yes,No)') AS `qa_required`,
    concat(ifnull(`rmc`.`test_certificate_required`, 'NA'), ':Test Certificate Required:Y:H:(Yes,No)') AS `test_certificate_required`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') AS `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') AS `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') AS `routing_code`,
    concat(ifnull(`rm`.`product_rm_print_name`, 'NA'), ':Print Name:O:N:') AS `product_rm_print_name`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') AS `remark`,
    concat(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Delete By:O:N:') AS `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`rm`.`company_id`, 'NA'), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`rm`.`company_branch_id`, 'NA'), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`rm`.`product_type_id`, 'NA'), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`rm`.`product_category1_id`, 'NA'), ':Product Category Id 1:N:N:') AS `product_category1_id`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Raw Material Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`rmc`.`profit_center_id`, ''), ':Profit Center Id:N:N:') AS `profit_center_id`,
    concat(ifnull(`rmc`.`cost_center_id`, ''), ':Cost Center Id:N:N:') AS `cost_center_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`smv_product_rm` `rm`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fm`.`cost_center_name` as `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((((((`st_indent_material_issue_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`
        and `re`.`company_id` = `st`.`company_id`))
left join `cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`
        and `ie`.`company_id` = `st`.`company_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
    and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------

INSERT INTO ERP_PASHUPATI_PROD_1_0.am_properties_master (company_id,properties_master_name,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,remark) VALUES
	 (1,'IssueGroupTypes',0,0,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO ERP_PASHUPATI_PROD_1_0.am_properties (property_master_id,properties_master_name,company_id,property_name,property_value,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,property_group,remark) VALUES
	 (174,'IssueGroupTypes',1,'Capital','Capital',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL),
	 (174,'IssueGroupTypes',1,'Consumables','Consumables',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL),
	 (174,'IssueGroupTypes',1,'Loan','Loan',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL),
	 (174,'IssueGroupTypes',1,'Repair','Repair',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL),
	 (174,'IssueGroupTypes',1,'Cleaning','Cleaning',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL),
	 (174,'IssueGroupTypes',1,'New Job','New Job',0,0,NULL,NULL,'admin','2024-04-16 17:01:44.000',NULL,NULL,'NA',NULL);


-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_PASHUPATI_PROD_1_0.st_indent_material_issue_master ADD issue_group_type varchar(50) NOT NULL COMMENT 'issue_group_type combobox for issue group from amv_properties';

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`issue_group_type` AS `issue_group_type`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fm`.`cost_center_name` AS `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`
        and `vp`.`company_branch_id` = `st`.`company_branch_id`
        and `vp`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`
        and `sd`.`company_branch_id` = `st`.`company_branch_id`
        and `sd`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`
        and `re`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`
        and `ie`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_rm_code` AS `product_rm_code`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_rm_purchase_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_details` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_rm_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cm` on
    (`cm`.`company_id` = `sm`.`company_id`
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `supp` on
    (`supp`.`company_id` = `sm`.`company_id`
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details_rpt` AS
select
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:O:N:') AS `product_type_name`,
    concat(ifnull(`v`.`stock_date`, ''), ':Stock Date:Y:D:') AS `stock_date`,
    concat(ifnull(`v`.`day_closed`, ''), ':Day Closed:O:N:') AS `day_closed`,
    concat(ifnull(`v`.`batch_no`, ''), ':Batch No:O:N:') AS `batch_no`,
    concat(ifnull(`v`.`batch_expiry_date`, ''), ':Batch Expiry Date:Y:D:') AS `batch_expiry_date`,
    concat(ifnull(`v`.`sales_order_no`, ''), ':Sales Order No:O:N:') AS `sales_order_no`,
    concat(ifnull(`v`.`sales_order_version`, ''), ':Sales Order Version:O:N:') AS `sales_order_version`,
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:O:N:') AS `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') AS `goods_receipt_version`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt No:O:N:') AS `customer_goods_receipt_no`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt Version:O:N:') AS `customer_goods_receipt_version`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`batch_rate`, ''), ':Batch Rate:O:N:') AS `batch_rate`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Production Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_rm_technical_name`, ''), ':Raw Material Technical Name:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`v`.`product_rm_short_name`, ''), ':Raw Material Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`v`.`product_rm_purchase_unit_name`, ''), 'Raw Material Purchase Unit Name:O:N:') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`v`.`customer_code`, ''), ':Customer Code:O:N:') AS `customer_code`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
    concat(ifnull(`v`.`godown_short_name`, ''), ':Godown Short Name:O:N:') AS `godown_short_name`,
    concat(ifnull(`v`.`godown_area`, ''), ':Godown Area:O:N:') AS `godown_area`,
    concat(ifnull(`v`.`godown_section_count`, ''), ':Godown Section Count:O:N:') AS `godown_section_count`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_short_name`, ''), ':Godown Section Short Name:O:N:') AS `godown_section_short_name`,
    concat(ifnull(`v`.`godown_section_area`, ''), ':Godown Section Area:O:N:') AS `godown_section_area`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`godown_section_beans_short_name`, ''), ':Godown Section Beans Short Name:O:N:') AS `godown_section_beans_short_name`,
    concat(ifnull(`v`.`godown_section_beans_area`, ''), ':Godown Section Beans Area:O:N:') AS `godown_section_beans_area`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing:F') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`weight_per_packing`, ''), ':Weight Per Packing:O:N:') AS `weight_per_packing`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') AS `supplier_code`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:O:N:') AS `customer_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit_id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_code` AS `product_rm_code`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary_rpt` AS
select
    concat(ifnull(`v`.`product_rm_name`, ''), ':Raw Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Raw Material Name:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Production Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Production Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Production Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Production Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') AS `product_type_short_name`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`product_unit_name`, ''), ':Product Unit Name:Y:C:smv_product_unit:F') AS `product_unit_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary_rpt` AS
select
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section:F') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans:F') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Raw Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Raw Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Production Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Production Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Production Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Production Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') AS `product_type_short_name`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`product_unit_name`, ''), ':Product Unit Name:Y:C:smv_product_unit:F') AS `product_unit_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details_rpt` AS
select
	concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
	concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
	concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section') AS `godown_section_name`,
	concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material Name:Y:T') AS `product_rm_name`,
	concat(ifnull(`v`.`product_rm_code`, ''), ':Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:O:N:') AS `product_type_name`,
    concat(ifnull(`v`.`stock_date`, ''), ':Stock Date:Y:D:') AS `stock_date`,
    concat(ifnull(`v`.`day_closed`, ''), ':Day Closed:O:N:') AS `day_closed`,
    concat(ifnull(`v`.`batch_no`, ''), ':Batch No:O:N:') AS `batch_no`,
    concat(ifnull(`v`.`batch_expiry_date`, ''), ':Batch Expiry Date:Y:D:') AS `batch_expiry_date`,
    concat(ifnull(`v`.`sales_order_no`, ''), ':Sales Order No:O:N:') AS `sales_order_no`,
    concat(ifnull(`v`.`sales_order_version`, ''), ':Sales Order Version:O:N:') AS `sales_order_version`,
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:O:N:') AS `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') AS `goods_receipt_version`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt No:O:N:') AS `customer_goods_receipt_no`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt Version:O:N:') AS `customer_goods_receipt_version`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`batch_rate`, ''), ':Batch Rate:O:N:') AS `batch_rate`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Production Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_rm_technical_name`, ''), ':Raw Material Technical Name:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`v`.`product_rm_short_name`, ''), ':Raw Material Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`v`.`product_rm_purchase_unit_name`, ''), 'Raw Material Purchase Unit Name:O:N:') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`v`.`customer_code`, ''), ':Customer Code:O:N:') AS `customer_code`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`godown_short_name`, ''), ':Godown Short Name:O:N:') AS `godown_short_name`,
    concat(ifnull(`v`.`godown_area`, ''), ':Godown Area:O:N:') AS `godown_area`,
    concat(ifnull(`v`.`godown_section_count`, ''), ':Godown Section Count:O:N:') AS `godown_section_count`,
    concat(ifnull(`v`.`godown_section_short_name`, ''), ':Godown Section Short Name:O:N:') AS `godown_section_short_name`,
    concat(ifnull(`v`.`godown_section_area`, ''), ':Godown Section Area:O:N:') AS `godown_section_area`,
    concat(ifnull(`v`.`godown_section_beans_short_name`, ''), ':Godown Section Beans Short Name:O:N:') AS `godown_section_beans_short_name`,
    concat(ifnull(`v`.`godown_section_beans_area`, ''), ':Godown Section Beans Area:O:N:') AS `godown_section_beans_area`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing:F') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`weight_per_packing`, ''), ':Weight Per Packing:O:N:') AS `weight_per_packing`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') AS `supplier_code`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:O:N:') AS `customer_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit_id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`st_indent_material_issue_details` `st`
left join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`  and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
27-06-2024

ALTER TABLE am_company_settings ADD stores_email_id varchar(50) NULL COMMENT 'stores email id for the company';
ALTER TABLE am_company_settings ADD stores_contact_no varchar(20) NULL COMMENT 'stores contact no for company';


------------------------------------------------------------------------------------------------------------------------------
-- amv_company_settings source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`amv_company_settings` AS
select
    `C`.`company_id` AS `company_id`,
    `V`.`company_legal_name` AS `company_name`,
    `C`.`company_type_id` AS `company_type_id`,
    `C`.`am_company_settings_id` AS `am_company_settings_id`,
    `C`.`auto_rm_materail_name_flag` AS `auto_rm_materail_name_flag`,
    `C`.`RawMaterialCategoryCount` AS `RawMaterialCategoryCount`,
    `C`.`e_inv_type_version` AS `e_inv_type_version`,
    `C`.`e_inv_tax_scheme` AS `e_inv_tax_scheme`,
    `C`.`e_inv_transaction_category` AS `e_inv_transaction_category`,
    `C`.`e_inv_reverse_charges` AS `e_inv_reverse_charges`,
    `C`.`e_inv_ecmgst` AS `e_inv_ecmgst`,
    `C`.`e_inv_igst_on_intra` AS `e_inv_igst_on_intra`,
    `C`.`e_inv_api_provider` AS `e_inv_api_provider`,
    `C`.`e_inv_client_id` AS `e_inv_client_id`,
    `C`.`e_inv_client_secret` AS `e_inv_client_secret`,
    `C`.`e_inv_sandbox_gsp_name` AS `e_inv_sandbox_gsp_name`,
    `C`.`e_inv_sandbox_auth_url` AS `e_inv_sandbox_auth_url`,
    `C`.`e_inv_sandbox_base_url` AS `e_inv_sandbox_base_url`,
    `C`.`e_inv_sandbox_ewb_url` AS `e_inv_sandbox_ewb_url`,
    `C`.`e_inv_sandbox_cancel_ewb_url` AS `e_inv_sandbox_cancel_ewb_url`,
    `C`.`e_inv_sandbox_user_name` AS `e_inv_sandbox_user_name`,
    `C`.`e_inv_sandbox_password` AS `e_inv_sandbox_password`,
    `C`.`e_inv_production_gsp_name` AS `e_inv_production_gsp_name`,
    `C`.`e_inv_production_auth_url` AS `e_inv_production_auth_url`,
    `C`.`e_inv_production_base_url` AS `e_inv_production_base_url`,
    `C`.`e_inv_production_ewb_url` AS `e_inv_production_ewb_url`,
    `C`.`e_inv_production_cancel_ewb_url` AS `e_inv_production_cancel_ewb_url`,
    `C`.`e_inv_production_user_name` AS `e_inv_production_user_name`,
    `C`.`e_inv_production_password` AS `e_inv_production_password`,
    `C`.`e_inv_purchase_invoice_count` AS `e_inv_purchase_invoice_count`,
    `C`.`e_inv_balance_invoice_count` AS `e_inv_balance_invoice_count`,
    `C`.`e_inv_client_connection_string` AS `e_inv_client_connection_string`,
    `C`.`e_inv_auth_token` AS `e_inv_auth_token`,
    `C`.`e_inv_sek` AS `e_inv_sek`,
    `C`.`e_inv_token_expiry` AS `e_inv_token_expiry`,
    `C`.`e_inv_sez_header` AS `e_inv_sez_header`,
    `C`.`e_inv_sez_footer` AS `e_inv_sez_footer`,
    `C`.`erp_version` AS `erp_version`,
    `C`.`is_active` AS `is_active`,
    `C`.`is_delete` AS `is_delete`,
    `C`.`created_by` AS `created_by`,
    `C`.`created_on` AS `created_on`,
    `C`.`modified_by` AS `modified_by`,
    `C`.`modified_on` AS `modified_on`,
    `C`.`deleted_by` AS `deleted_by`,
    `C`.`deleted_on` AS `deleted_on`,
    `C`.`remark` AS `remark`,
    `C`.`from_email_id` AS `from_email_id`,
    `C`.`from_email_password` AS `from_email_password`,
    `C`.`smtp_host_name` AS `smtp_host_name`,
    `C`.`pop3_host_name` AS `pop3_host_name`,
    `C`.`smtp_port` AS `smtp_port`,
    `C`.`email_service_status` AS `email_service_status`,
    `C`.`sms_service_status` AS `sms_service_status`,
    `C`.`sms_api` AS `sms_api`,
    `C`.`whatsapp_service_status` AS `whatsapp_service_status`,
    `C`.`whatsapp_api` AS `whatsapp_api`,
    `C`.`purchase_process_entry` AS `purchase_process_entry`,
    `C`.`so_schedule_grace_days` AS `so_schedule_grace_days`,
    `C`.`po_schedule_grace_days` AS `po_schedule_grace_days`,
    `C`.`administration_percent` AS `administration_percent`,
    `C`.`profit_percent` AS `profit_percent`,
    `C`.`is_excess_allowed` AS `is_excess_allowed`,
    `C`.`adminstration_cost` AS `adminstration_cost`,
    `C`.`earning_deduction_mapping_base` AS `earning_deduction_mapping_base`,
    `C`.`stores_email_id` AS `stores_email_id`,
    `C`.`stores_contact_no` AS `stores_contact_no`,
    case
        `C`.`earning_deduction_mapping_base` when 'DW' then 'Designation Wise'
        else 'Employee Type Wise'
    end AS `earning_deduction_mapping_base_desc`,
    `C`.`company_id` AS `field_id`,
    `V`.`company_legal_name` AS `field_name`
from
    (`ERP_PASHUPATI_DEV_1_0`.`am_company_settings` `C`
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `V` on
    (`C`.`company_id` = `V`.`company_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_stock_adjustment_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_stock_adjustment_details` AS
select
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `sm`.`stock_adjustment_type` AS `stock_adjustment_type`,
    `sm`.`stock_quantity` AS `stock_quantity`,
    `sm`.`stock_weight` AS `stock_weight`,
    `sm`.`stock_adjustment_quantity` AS `stock_adjustment_quantity`,
    `sm`.`stock_adjustment_weight` AS `stock_adjustment_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`stock_date` AS `stock_date`,
    `sa`.`adjustment_by` AS `adjustment_by`,
    `sa`.`adjustment_reason` AS `adjustment_reason`,
    `sa`.`approved_by` AS `approved_by`,
    `gd`.`godown_name` AS `godown_name`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`stock_adjustment_transaction_id` AS `stock_adjustment_transaction_id`,
    `sm`.`stock_adjustment_details_transaction_id` AS `stock_adjustment_details_transaction_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`product_material_id` AS `product_material_id`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`sm_product_stock_adjustment_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_stock_adjustment_master` `sa` on
    (`sa`.`stock_adjustment_transaction_id` = `sm`.`stock_adjustment_transaction_id`
        and `sa`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `sm`.`product_material_id` ))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id` ));
-------------------------------------------------------------------------------------------------------------------------------

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary_rpt` AS
select
    concat(`v`.`issue_group_type`, ':Issue Group Type:Y:P:IssueGroupTypes') AS `issue_group_type`,
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`issue_status_desc`, ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Approved,Pending)') AS `issue_status_desc`,
    concat(`v`.`indent_source_desc`, ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(`v`.`indent_no`, ':Indent No:Y:H:stv_indent_master_summary:F:') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`requisition_by_name`, ':Requisition By Name:Y:C:cm_employee:F') AS `requisition_by_name`,
    concat(`v`.`approved_by_name`, ':Approved By Name:Y:C:cm_employee:F') AS `approved_by_name`,
    concat(`v`.`issued_by_name`, ':Issue By Name:Y:C:cm_employee:F') AS `issued_by_name`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`sub_department_name`, ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`issue_status`, ':Issue Status:O:N:') AS `issue_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indented_by_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `d` on
    (`d`.`company_id` = `pt`.`company_id`
        and `d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_rm_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_summary` AS
select
    `p`.`product_type_group` AS `product_type_group`,
    `p`.`product_type_name` AS `product_type_name`,
    `pc1`.`product_category1_name` AS `product_category1_name`,
    `rm`.`product_rm_id` AS `product_rm_id`,
    `rm`.`product_rm_code` AS `product_rm_code`,
    `rm`.`product_rm_name` AS `product_rm_name`,
    `rm`.`product_rm_short_name` AS `product_rm_short_name`,
    `rm`.`product_rm_tech_spect` AS `product_rm_tech_spect`,
    `u1`.`product_unit_name` AS `product_rm_stock_unit_name`,
    ifnull((select sum(`st1`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `st1` where `st1`.`product_rm_id` = `rm`.`product_rm_id` and `st1`.`company_id` = `rm`.`company_id`), 0) AS `stock_quantity`,
    ifnull((select sum(`st2`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `st2` where `st2`.`product_rm_id` = `rm`.`product_rm_id` and `st2`.`company_id` = `rm`.`company_id`), 0) AS `stock_weight`,
    ifnull((select sum(`st3`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary_customer` `st3` where `st3`.`product_rm_id` = `rm`.`product_rm_id` and `st3`.`company_id` = `rm`.`company_id`), 0) AS `customer_stock_quantity`,
    ifnull((select sum(`st4`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary_customer` `st4` where `st4`.`product_rm_id` = `rm`.`product_rm_id` and `st4`.`company_id` = `rm`.`company_id`), 0) AS `customer_stock_weight`,
    `rmc`.`lead_time` AS `lead_time`,
    `rmc`.`product_rm_moq` AS `product_rm_moq`,
    `rmc`.`product_rm_mrp` AS `product_rm_mrp`,
    `rmc`.`product_rm_landed_price` AS `product_rm_landed_price`,
    `rmt`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `pc2`.`product_category2_name` AS `product_category2_name`,
    `pc3`.`product_category3_name` AS `product_category3_name`,
    'NA' AS `product_category4_name`,
    'NA' AS `product_category5_name`,
    `p1`.`product_packing_name` AS `product_rm_packing_name`,
    `pm`.`product_make_name` AS `product_make_name`,
    'NA' AS `product_material_type_name`,
    'NA' AS `product_material_grade_name`,
    'NA' AS `product_material_shape_name`,
    `rm`.`product_rm_oem_part_code` AS `product_rm_oem_part_code`,
    `rm`.`product_rm_our_part_code` AS `product_rm_our_part_code`,
    `rm`.`product_rm_drawing_no` AS `product_rm_drawing_no`,
    `rmc`.`product_rm_std_weight` AS `product_rm_std_weight`,
    1 AS `product_rm_std_hours`,
    1 AS `process_duration`,
    0 AS `product_rm_std_profit_percent`,
    0 AS `product_rm_std_discount_percent`,
    case
        `rm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `rm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `gsb`.`godown_name` AS `godown_name`,
    `gsb`.`godown_short_name` AS `godown_short_name`,
    0 AS `godown_area`,
    `gsb`.`godown_section_count` AS `godown_section_count`,
    `gsb`.`godown_section_name` AS `godown_section_name`,
    `gsb`.`godown_section_short_name` AS `godown_section_short_name`,
    0 AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    0 AS `godown_section_beans_area`,
    `h`.`hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    'NA' AS `company_name`,
    'NA' AS `company_branch_name`,
    `rm`.`product_category1_id` AS `product_category1_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_rm_stock_unit_id` AS `product_rm_stock_unit_id`,
    `rm`.`product_rm_packing_id` AS `product_rm_packing_id`,
    `rm`.`product_rm_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `rmt`.`product_category2_id` AS `product_category2_id`,
    `rmt`.`product_category3_id` AS `product_category3_id`,
    `rmt`.`product_category4_id` AS `product_category4_id`,
    `rmt`.`product_category5_id` AS `product_category5_id`,
    `rmt`.`product_make_id` AS `product_make_id`,
    `rmt`.`product_material_type_id` AS `product_material_type_id`,
    `rmt`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmt`.`product_material_shape_id` AS `product_material_shape_id`,
    `rm`.`company_id` AS `company_id`,
    `rm`.`company_branch_id` AS `company_branch_id`,
    `rm`.`godown_id` AS `godown_id`,
    `rm`.`godown_section_id` AS `godown_section_id`,
    `rm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `rm`.`product_id` AS `product_id`,
    'No' AS `bom_applicable`,
    `rm`.`is_active` AS `is_active`,
    `rm`.`is_delete` AS `is_delete`,
    `rm`.`created_by` AS `created_by`,
    `rm`.`created_on` AS `created_on`,
    `rm`.`modified_by` AS `modified_by`,
    `rm`.`modified_on` AS `modified_on`,
    `rm`.`deleted_by` AS `deleted_by`,
    `rm`.`deleted_on` AS `deleted_on`,
    `rm`.`product_rm_name` AS `field_name`,
    `rm`.`product_rm_id` AS `field_id`
from
    (((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm` `rm`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `rm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category1` `pc1` on
    (`pc1`.`product_category1_id` = `rm`.`product_category1_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category2` `pc2` on
    (`pc2`.`product_category2_id` = `rmt`.`product_category2_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category3` `pc3` on
    (`pc3`.`product_category1_id` = `rmt`.`product_category3_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_make` `pm` on
    (`pm`.`company_id` = `rmt`.`company_id`
        and `pm`.`product_make_id` = `rmt`.`product_make_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_unit` `u1` on
    (`u1`.`product_unit_id` = `rm`.`product_rm_stock_unit_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_packing` `p1` on
    (`p1`.`product_packing_id` = `rm`.`product_rm_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_godown_section_beans` `gsb` on
    (`gsb`.`godown_id` = `rm`.`godown_id`
        and `gsb`.`godown_section_id` = `rm`.`godown_section_id`
        and `gsb`.`godown_section_beans_id` = `rm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `rm`.`product_rm_hsn_sac_code_id`))
where
    `rm`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_rm_technical source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_technical` AS
select
    `b`.`product_rm_technical_id` AS `product_rm_technical_id`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `b`.`product_rm_id` AS `product_rm_id`,
    `r`.`product_rm_code` AS `product_rm_code`,
    `r`.`product_rm_name` AS `product_rm_name`,
    `b`.`product_rm_technical_name` AS `product_rm_technical_name`,
    `c1`.`product_type_group` AS `product_type_group`,
    `c1`.`product_type_name` AS `product_type_name`,
    `c1`.`product_type_short_name` AS `product_type_short_name`,
    `c1`.`product_category1_name` AS `product_category1_name`,
    `c2`.`product_category2_name` AS `product_category2_name`,
    `c3`.`product_category3_name` AS `product_category3_name`,
    `c4`.`product_category4_name` AS `product_category4_name`,
    `c5`.`product_category5_name` AS `product_category5_name`,
    `m`.`product_make_name` AS `product_make_name`,
    `t`.`product_material_type_name` AS `product_material_type_name`,
    `g`.`product_material_grade_name` AS `product_material_grade_name`,
    `s`.`product_material_shape_name` AS `product_material_shape_name`,
    `b`.`product_material_colour` AS `product_material_colour`,
    `b`.`assembly_scrap_percent` AS `assembly_scrap_percent`,
    `r`.`product_rm_short_name` AS `product_rm_short_name`,
    `r`.`product_rm_print_name` AS `product_rm_print_name`,
    `r`.`product_rm_tech_spect` AS `product_rm_tech_spect`,
    `r`.`product_rm_oem_part_code` AS `product_rm_oem_part_code`,
    `r`.`product_rm_our_part_code` AS `product_rm_our_part_code`,
    `r`.`product_rm_item_sr_no` AS `product_rm_item_sr_no`,
    `r`.`product_rm_drawing_no` AS `product_rm_drawing_no`,
    `r`.`product_rm_model_no` AS `product_rm_model_no`,
    `r1`.`product_rm_name` AS `product_alternate_rm_name`,
    `b`.`remark` AS `remark`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `c1`.`product_type_id` AS `product_type_id`,
    `r`.`product_category1_id` AS `product_category1_id`,
    `c2`.`product_category2_id` AS `product_category2_id`,
    `c3`.`product_category3_id` AS `product_category3_id`,
    `c4`.`product_category4_id` AS `product_category4_id`,
    `c5`.`product_category5_id` AS `product_category5_id`,
    `b`.`product_make_id` AS `product_make_id`,
    `b`.`product_material_type_id` AS `product_material_type_id`,
    `b`.`product_material_grade_id` AS `product_material_grade_id`,
    `b`.`product_material_shape_id` AS `product_material_shape_id`,
    `b`.`product_alternate_rm_id` AS `product_alternate_rm_id`,
    `b`.`product_rm_technical_name` AS `field_name`,
    `b`.`product_rm_id` AS `field_id`
from
    ((((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_technical` `b`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm` `r` on
    (`r`.`company_id` = `b`.`company_id`
        and `r`.`product_rm_id` = `b`.`product_rm_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `b`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_make` `m` on
    (`m`.`company_id` = `b`.`company_id`
        and `m`.`product_make_id` = `b`.`product_make_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_material_grade` `g` on
    (`g`.`company_id` = `b`.`company_id`
        and `g`.`product_material_grade_id` = `b`.`product_material_grade_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_material_type` `t` on
    (`t`.`company_id` = `b`.`company_id`
        and `t`.`product_material_type_id` = `b`.`product_material_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_material_shape` `s` on
    (`s`.`company_id` = `b`.`company_id`
        and `s`.`product_material_shape_id` = `b`.`product_material_shape_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm` `r1` on
    (`r1`.`is_delete` = 0
        and `r1`.`product_rm_id` = `b`.`product_alternate_rm_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_category1` `c1` on
    (`c1`.`is_delete` = 0
        and `c1`.`product_category1_id` = `r`.`product_category1_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category2` `c2` on
    (`c2`.`is_delete` = 0
        and `c2`.`product_category2_id` = `b`.`product_category2_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category3` `c3` on
    (`c3`.`is_delete` = 0
        and `c3`.`product_category3_id` = `b`.`product_category3_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category4` `c4` on
    (`c4`.`is_delete` = 0
        and `c4`.`product_category4_id` = `b`.`product_category4_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_category5` `c5` on
    (`c5`.`is_delete` = 0
        and `c5`.`product_category5_id` = `b`.`product_category5_id`))
where
    `b`.`is_active` = 1;
-------------------------------------------------------------------------------------------------------------------------------
-- amv_modules_forms_user_access source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`amv_modules_forms_user_access` AS
select
    `f`.`user_type` AS `user_type`,
    case
        `f`.`user_type` when 'customer' then (
        select
            `c1`.`customer_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `c1`
        where
            `c1`.`customer_id` = `f`.`user_id`
            and `c1`.`company_id` = `f`.`company_id`)
        when 'supplier' then (
        select
            `s1`.`supplier_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `s1`
        where
            `s1`.`supplier_id` = `f`.`user_id`
            and `s1`.`company_id` = `f`.`company_id`)
        when 'agent' then (
        select
            `a1`.`agent_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a1`
        where
            `a1`.`agent_id` = `f`.`user_id`
            and `a1`.`company_id` = `f`.`company_id`)
        when 'transporter' then (
        select
            `t1`.`transporter_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_transporter` `t1`
        where
            `t1`.`transporter_id` = `f`.`user_id`
            and `t1`.`company_id` = `f`.`company_id`)
        else (
        select
            `e1`.`employee_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1`
        where
            `e1`.`employee_id` = `f`.`user_id`
            and `e1`.`company_id` = `f`.`company_id`)
    end AS `user_name`,
    case
        `f`.`user_type` when 'customer' then (
        select
            `c1`.`username`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `c1`
        where
            `c1`.`customer_id` = `f`.`user_id`
            and `c1`.`company_id` = `f`.`company_id`)
        when 'supplier' then (
        select
            `s1`.`username`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `s1`
        where
            `s1`.`supplier_id` = `f`.`user_id`
            and `s1`.`company_id` = `f`.`company_id`)
        when 'agent' then (
        select
            `a1`.`username`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a1`
        where
            `a1`.`agent_id` = `f`.`user_id`
            and `a1`.`company_id` = `f`.`company_id`)
        when 'transporter' then (
        select
            `t1`.`username`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_transporter` `t1`
        where
            `t1`.`transporter_id` = `f`.`user_id`
            and `t1`.`company_id` = `f`.`company_id`)
        else (
        select
            `e1`.`username`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1`
        where
            `e1`.`employee_id` = `f`.`user_id`
            and `e1`.`company_id` = `f`.`company_id`)
    end AS `login_name`,
    case
        `f`.`user_type` when 'customer' then (
        select
            `c1`.`password`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `c1`
        where
            `c1`.`customer_id` = `f`.`user_id`
            and `c1`.`company_id` = `f`.`company_id`)
        when 'supplier' then (
        select
            `s1`.`password`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `s1`
        where
            `s1`.`supplier_id` = `f`.`user_id`
            and `s1`.`company_id` = `f`.`company_id`)
        when 'agent' then (
        select
            `a1`.`password`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a1`
        where
            `a1`.`agent_id` = `f`.`user_id`
            and `a1`.`company_id` = `f`.`company_id`)
        when 'transporter' then (
        select
            `t1`.`password`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_transporter` `t1`
        where
            `t1`.`transporter_id` = `f`.`user_id`
            and `t1`.`company_id` = `f`.`company_id`)
        else (
        select
            `e1`.`password`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1`
        where
            `e1`.`employee_id` = `f`.`user_id`
            and `e1`.`company_id` = `f`.`company_id`)
    end AS `login_password`,
    `m`.`parent_module_name` AS `parent_module_name`,
    `m`.`sub_module_name` AS `sub_module_name`,
    `m`.`modules_menu_name` AS `modules_menu_name`,
    `m`.`modules_sub_menu_name` AS `modules_sub_menu_name`,
    `m`.`modules_forms_name` AS `modules_forms_name`,
    `f`.`all_access` AS `all_access`,
    `f`.`read_access` AS `read_access`,
    `f`.`add_access` AS `add_access`,
    `f`.`modify_access` AS `modify_access`,
    `f`.`delete_access` AS `delete_access`,
    `f`.`approve_access` AS `approve_access`,
    `f`.`special_access` AS `special_access`,
    `f`.`access_control` AS `access_control`,
    `m`.`module_display_sequence` AS `module_display_sequence`,
    `m`.`sub_module_display_sequence` AS `sub_module_display_sequence`,
    `m`.`menu_display_sequence` AS `menu_display_sequence`,
    `m`.`sub_menu_display_sequence` AS `sub_menu_display_sequence`,
    `m`.`module_form_display_sequence` AS `module_form_display_sequence`,
    case
        `f`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `f`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `f`.`is_active` AS `is_active`,
    `f`.`is_delete` AS `is_delete`,
    `f`.`company_id` AS `company_id`,
    `f`.`user_id` AS `user_id`,
    `f`.`modules_forms_id` AS `modules_forms_id`,
    `f`.`modules_forms_user_access_id` AS `modules_forms_user_access_id`,
    `f`.`company_branch_id` AS `company_branch_id`,
    `f`.`module_id` AS `parent_module_id`,
    `f`.`sub_module_id` AS `sub_module_id`,
    `m`.`modules_sub_menu_id` AS `modules_sub_menu_id`,
    `m`.`modules_menu_id` AS `modules_menu_id`,
    `f`.`user_id` AS `field_id`,
    case
        `f`.`user_type` when 'employee' then (
        select
            `e1`.`employee_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1`
        where
            `e1`.`employee_id` = `f`.`user_id`
            and `e1`.`company_id` = `f`.`company_id`)
        when 'customer' then (
        select
            `c1`.`customer_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `c1`
        where
            `c1`.`customer_id` = `f`.`user_id`
            and `c1`.`company_id` = `f`.`company_id`)
        when 'supplier' then (
        select
            `s1`.`supplier_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `s1`
        where
            `s1`.`supplier_id` = `f`.`user_id`
            and `s1`.`company_id` = `f`.`company_id`)
        when 'agent' then (
        select
            `a1`.`agent_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a1`
        where
            `a1`.`agent_id` = `f`.`user_id`
            and `a1`.`company_id` = `f`.`company_id`)
        when 'transporter' then (
        select
            `t1`.`transporter_name`
        from
            `ERP_PASHUPATI_DEV_1_0`.`cm_transporter` `t1`
        where
            `t1`.`transporter_id` = `f`.`user_id`
            and `t1`.`company_id` = `f`.`company_id`)
    end AS `field_name`,
    `f`.`user_code` AS `user_code`,
    `m`.`display_name` AS `display_name`,
    `m`.`menu_type` AS `menu_type`,
    `m`.`icon_class` AS `icon_class`,
    `m`.`sub_menu_icon_class` AS `sub_menu_icon_class`,
    `m`.`listing_component_name` AS `listing_component_name`,
    `m`.`listing_component_import_path` AS `listing_component_import_path`,
    `m`.`listing_navigation_url` AS `listing_navigation_url`,
    `m`.`url_parameter` AS `url_parameter`,
    `m`.`form_component_name` AS `form_component_name`,
    `m`.`form_component_import_path` AS `form_component_import_path`,
    `m`.`form_navigation_url` AS `form_navigation_url`,
    `m`.`page_header` AS `page_header`,
    `m`.`is_selected` AS `is_selected`,
    `m`.`is_protected` AS `is_protected`,
    `m`.`header` AS `header`,
    `m`.`footer` AS `footer`,
    `f`.`company_access` AS `company_access`
from
    (`ERP_PASHUPATI_DEV_1_0`.`am_modules_forms_user_access` `f`
left join `ERP_PASHUPATI_DEV_1_0`.`amv_modules_forms` `m` on
    (`m`.`modules_forms_id` = `f`.`modules_forms_id`))
where
    `f`.`is_delete` = 0
order by
    `m`.`module_display_sequence`,
    `m`.`sub_module_display_sequence`,
    `m`.`menu_display_sequence`,
    `m`.`sub_menu_display_sequence`,
    `m`.`module_form_display_sequence`;
-------------------------------------------------------------------------------------------------------------------------------
04-07-2024

-- ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    `po`.`indented_by_name` AS `indented_by_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indented_by_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `d` on
    (`d`.`company_id` = `pt`.`company_id`
        and `d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    `po`.`indented_by_name` AS `indented_by_name`,
    `po`.`approved_by_name` AS `po_approved_by_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indented_by_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `d` on
    (`d`.`company_id` = `pt`.`company_id`
        and `d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_material_code` AS `product_rm_code`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `rm`.`product_material_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_material_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_material_stock_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`batch_rate` * `sm`.`closing_balance_quantity` AS `closing_amount`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `cm` on
    (`cm`.`company_id` = `sm`.`company_id`
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `supp` on
    (`supp`.`company_id` = `sm`.`company_id`
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details_rpt` AS
select
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:O:N:') AS `product_type_name`,
    concat(ifnull(`v`.`stock_date`, ''), ':Stock Date:Y:D:') AS `stock_date`,
    concat(ifnull(`v`.`day_closed`, ''), ':Day Closed:O:N:') AS `day_closed`,
    concat(ifnull(`v`.`batch_no`, ''), ':Batch No:O:N:') AS `batch_no`,
    concat(ifnull(`v`.`batch_expiry_date`, ''), ':Batch Expiry Date:Y:D:') AS `batch_expiry_date`,
    concat(ifnull(`v`.`sales_order_no`, ''), ':Sales Order No:O:N:') AS `sales_order_no`,
    concat(ifnull(`v`.`sales_order_version`, ''), ':Sales Order Version:O:N:') AS `sales_order_version`,
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:O:N:') AS `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') AS `goods_receipt_version`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt No:O:N:') AS `customer_goods_receipt_no`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt Version:O:N:') AS `customer_goods_receipt_version`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`batch_rate`, ''), ':Batch Rate:O:N:') AS `batch_rate`,
   	concat(ifnull(`v`.`closing_amount`, ''), ':Closing Amount:O:N:') AS `closing_amount`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Production Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_rm_technical_name`, ''), ':Raw Material Technical Name:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`v`.`product_rm_short_name`, ''), ':Raw Material Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`v`.`product_rm_purchase_unit_name`, ''), 'Raw Material Purchase Unit Name:O:N:') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`v`.`customer_code`, ''), ':Customer Code:O:N:') AS `customer_code`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`godown_short_name`, ''), ':Godown Short Name:O:N:') AS `godown_short_name`,
    concat(ifnull(`v`.`godown_area`, ''), ':Godown Area:O:N:') AS `godown_area`,
    concat(ifnull(`v`.`godown_section_count`, ''), ':Godown Section Count:O:N:') AS `godown_section_count`,
    concat(ifnull(`v`.`godown_section_short_name`, ''), ':Godown Section Short Name:O:N:') AS `godown_section_short_name`,
    concat(ifnull(`v`.`godown_section_area`, ''), ':Godown Section Area:O:N:') AS `godown_section_area`,
    concat(ifnull(`v`.`godown_section_beans_short_name`, ''), ':Godown Section Beans Short Name:O:N:') AS `godown_section_beans_short_name`,
    concat(ifnull(`v`.`godown_section_beans_area`, ''), ':Godown Section Beans Area:O:N:') AS `godown_section_beans_area`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing:F') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`weight_per_packing`, ''), ':Weight Per Packing:O:N:') AS `weight_per_packing`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') AS `supplier_code`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:O:N:') AS `customer_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit_id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_stock_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
06-07-24

ALTER TABLE am_company_settings ADD grn_excess_percent DECIMAL(18,2) DEFAULT 0 NULL COMMENT 'GRN quantity will accepted according to this percent extra';

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE st_indent_material_issue_details ADD material_batch_rate DOUBLE(18,4) DEFAULT 0 NULL COMMENT 'fill when material get issue update rate while issue from stock table';

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `st`.`material_batch_rate` AS `material_batch_rate`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `rmfgsr`.`product_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details_rpt` AS
select
    concat(`v`.`issue_no`, ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(`v`.`issue_date`, ':Issue Date:Y:D:') AS `issue_date`,
    concat(`v`.`issue_version`, ':Issue Version:O:N:') AS `issue_version`,
    concat(`v`.`indent_no`, ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(`v`.`indent_date`, ':Indent Date:Y:D:') AS `indent_date`,
    concat(`v`.`indent_version`, ':Indent Version:O:N:') AS `indent_version`,
    concat(`v`.`indented_by_name`, ':Indented By Name:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(`v`.`godown_name`, ':Godown Name:O:N:') AS `godown_name`,
    concat(`v`.`godown_section_name`, ':Godown Section Name:O:N:') AS `godown_section_name`,
    concat(`v`.`godown_section_beans_name`, ':Godown Section Beans Name:O:N:') AS `godown_section_beans_name`,
    concat(`v`.`issue_item_status_desc`, ':Issue Status:Y:H:(Pending,Completed)') AS `issue_item_status_desc`,
    concat(`v`.`product_material_indent_quantity`, ':Product Material Indent Quantity:Y:T:') AS `product_material_indent_quantity`,
    concat(`v`.`product_material_indent_weight`, ':Product Material Indent Weight:Y:T:') AS `product_material_indent_weight`,
    concat(`v`.`product_material_approved_quantity`, ':Product Material Approved Quantity:Y:T:') AS `product_material_approved_quantity`,
    concat(`v`.`product_material_approved_weight`, ':Product Material Approved Weight:Y:T:') AS `product_material_approved_weight`,
    concat(`v`.`product_material_rejected_quantity`, ':Product Material Rejected Quantity:Y:T:') AS `product_material_rejected_quantity`,
    concat(`v`.`product_material_rejected_weight`, ':Product Material Rejected Weight:Y:T:') AS `product_material_rejected_weight`,
    concat(`v`.`product_material_issue_quantity`, ':Product Material Issue Quantity:Y:T:') AS `product_material_issue_quantity`,
    concat(`v`.`product_material_issue_weight`, ':Product Material Issue Weight:Y:T:') AS `product_material_issue_weight`,
    concat(`v`.`product_material_issue_return_quantity`, ':Product Material Issue Return Quantity:Y:T:') AS `product_material_issue_return_quantity`,
    concat(`v`.`product_material_issue_return_weight`, ':Product Material Return Weight:Y:T:)') AS `product_material_issue_return_weight`,
    concat(`v`.`product_material_receipt_quantity`, ':Product Material Receipt Quantity:Y:T:)') AS `product_material_receipt_quantity`,
    concat(`v`.`product_material_receipt_weight`, ':Product Material Receipt Weight:Y:T:)') AS `product_material_receipt_weight`,
    concat(`v`.`department_name`, ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(`v`.`material_batch_rate`, ':Material Rate:Y:T:') AS `material_batch_rate`,
    concat(`v`.`customer_name`, ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(`v`.`customer_order_no`, ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(`v`.`customer_state_name`, ':State Name:O:N:') AS `customer_state_name`,
    concat(`v`.`cust_branch_gst_no`, ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`issue_remark`, ':Remark:O:N:') AS `issue_remark`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`department_id`, ':Department Id:N:N:') AS `department_id`,
    concat(`v`.`issue_master_transaction_id`, ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(`v`.`issue_details_transaction_id`, ':Issue Details Transaction_Id:O:N:') AS `issue_details_transaction_id`,
    concat(`v`.`indented_by_id`, ':Indented By Id Id:N:N:') AS `indented_by_id`,
    concat(`v`.`issued_by_id`, ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(`v`.`customer_id`, ':Customer Id:N:N:') AS `customer_id`,
    concat(`v`.`product_material_id`, ':Product Material Id:N:N:') AS `product_material_id`,
    concat(`v`.`product_material_unit_id`, ':Product Material Id:N:N:') AS `product_material_unit_id`,
    concat(`v`.`godown_id`, ':Godown Id:N:N:') AS `godown_id`,
    concat(`v`.`godown_section_id`, ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(`v`.`godown_section_beans_id`, ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(`v`.`issue_no`, ':Issue No:N:N:') AS `field_name`,
    concat(`v`.`issue_version`, ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_product_dynamic_parameters` AS
select
    `b`.`sales_order_no` AS `sales_order_no`,
    `b`.`sales_order_date` AS `sales_order_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`sales_order_version` AS `sales_order_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`sales_order_parameter_id` AS `sales_order_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `b`.`sales_order_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_product_dynamic_parameters` AS
select
    `b`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `b`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`dispatch_schedule_parameter_id` AS `dispatch_schedule_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `b`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `b`.`dispatch_schedule_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_product_dynamic_parameters` AS
select
    `b`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `b`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`dispatch_challan_parameter_id` AS `dispatch_challan_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `b`.`dispatch_challan_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_details_trading` AS
select
    `mt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
    case
        `mt`.`dispatch_schedule_creation_type` when 'M' then 'Manual'
        when 'S' then 'Sales Order Based'
    end AS `dispatch_schedule_creation_type_desc`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    case
        `mt`.`dispatch_schedule_item_status` when 'P' then 'Pending'
        when 'A' then 'Aprroved'
        when 'R' then 'Rejected'
        when 'U' then 'Partial Sales Issue'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_schedule_item_status_desc`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mtso`.`sales_order_no` AS `sales_order_no`,
    `mtso`.`sales_order_version` AS `sales_order_version`,
    `mtso`.`sales_order_date` AS `sales_order_date`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`batch_no` AS `batch_no`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `mt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `mt`.`sr_no` AS `sr_no`,
    `rmfgsr`.`product_type_name` AS `product_type`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_packing_name` AS `product_material_packing_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`stock_quantity` AS `stock_quantity`,
    `rmfgsr`.`stock_weight` AS `stock_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `mtso`.`material_quantity` AS `material_quantity`,
    `mtso`.`material_weight` AS `material_weight`,
    `mtso`.`material_rate` AS `material_rate`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_code`,
    `rmfgsr`.`product_material_hsn_sac_rate` AS `product_material_hsn_rate`,
    `mtso`.`material_basic_amount` AS `material_basic_amount`,
    `mtso`.`material_discount_percent` AS `material_discount_percent`,
    `mtso`.`material_discount_amount` AS `material_discount_amount`,
    `mtso`.`material_taxable_amount` AS `material_taxable_amount`,
    `mtso`.`material_cgst_percent` AS `material_cgst_percent`,
    `mtso`.`material_cgst_total` AS `material_cgst_total`,
    `mtso`.`material_sgst_percent` AS `material_sgst_percent`,
    `mtso`.`material_sgst_total` AS `material_sgst_total`,
    `mtso`.`material_igst_percent` AS `material_igst_percent`,
    `mtso`.`material_igst_total` AS `material_igst_total`,
    `mtso`.`material_total_amount` AS `material_total_amount`,
    `mtso`.`material_schedule_date` AS `material_schedule_date`,
    `mtso`.`so_rate` AS `so_rate`,
    `mt`.`expected_dispatch_quantity` AS `expected_dispatch_quantity`,
    `mt`.`expected_dispatch_weight` AS `expected_dispatch_weight`,
    `mt`.`actual_dispatch_quantity` AS `actual_dispatch_quantity`,
    `mt`.`actual_dispatch_weight` AS `actual_dispatch_weight`,
    `mt`.`dispatch_return_quantity` AS `dispatch_return_quantity`,
    `mt`.`dispatch_return_weight` AS `dispatch_return_weight`,
    `mt`.`pending_quantity` AS `pending_quantity`,
    `mt`.`pending_weight` AS `pending_weight`,
    `mt`.`expected_schedule_date` AS `expected_schedule_date`,
    `mt`.`delayed_days` AS `delayed_days`,
    `mt`.`dispatched_quantity` AS `dispatched_quantity`,
    `mt`.`dispatched_weight` AS `dispatched_weight`,
    `mt`.`invoice_quantity` AS `invoice_quantity`,
    `mt`.`invoice_weight` AS `invoice_weight`,
    `mt`.`dispatch_schedule_item_status` AS `dispatch_schedule_item_status`,
    `mt`.`dispatch_schedule_creation_type` AS `dispatch_schedule_creation_type`,
    `mt`.`dispatch_schedule_remark` AS `dispatch_schedule_remark`,
    `dsmt`.`approved_date` AS `approved_date`,
    `dsmt`.`total_quantity` AS `total_quantity`,
    `dsmt`.`total_weight` AS `total_weight`,
    `dsmt`.`actual_quantity` AS `actual_quantity`,
    `dsmt`.`actual_weight` AS `actual_weight`,
    `dsmt`.`dispatch_note_status` AS `dispatch_note_status`,
    `dsmt`.`dispatch_note_remark` AS `dispatch_note_remark`,
    `dsmt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `mt`.`lot_no` AS `lot_no`,
    `mt`.`count_no` AS `count_no`,
    `mt`.`roll_no` AS `roll_no`,
    `mt`.`set_no` AS `set_no`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_hsn_sac_code_id` AS `product_material_hsn_code_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`dispatch_schedule_type_id` AS `dispatch_schedule_type_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `dsmt`.`customer_id` AS `customer_id`,
    `dsmt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `dsmt`.`customer_state_id` AS `customer_state_id`,
    `dsmt`.`customer_city_id` AS `customer_city_id`,
    `dsmt`.`consignee_id` AS `consignee_id`,
    `dsmt`.`consignee_state_id` AS `consignee_state_id`,
    `dsmt`.`consignee_city_id` AS `consignee_city_id`,
    `dsmt`.`dispatch_supervisor_id` AS `dispatch_supervisor_id`,
    `dsmt`.`approved_by_id` AS `approved_by_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_details_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_master_trading` `dsmt` on
    (`dsmt`.`dispatch_schedule_master_transaction_id` = `mt`.`dispatch_schedule_master_transaction_id`
        and `dsmt`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_details_trading` `mtso` on
    (`mtso`.`customer_order_no` = `mt`.`customer_order_no`
        and `mtso`.`sales_order_no` = `mt`.`sales_order_no`
        and `mtso`.`product_material_id` = `mt`.`product_material_id`
        and `mtso`.`so_sr_no` = `mt`.`so_sr_no`
        and `mtso`.`company_id` = `mt`.`company_id`
        and `mtso`.`company_branch_id` = `mt`.`company_branch_id`
        and `mtso`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_inspection_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_inspection_details_trading` AS
select
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `c`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_Date` AS `sales_order_Date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `mt`.`inspection_production_code` AS `inspection_production_code`,
    `mt`.`inspection_order_no` AS `inspection_order_no`,
    `mt`.`inspection_production_date` AS `inspection_production_date`,
    `mt`.`inspection_production_set_no` AS `inspection_production_set_no`,
    `mt`.`inspection_mtr` AS `inspection_mtr`,
    `mt`.`dispatch_quantity` AS `dispatch_quantity`,
    `mt`.`sort_no` AS `sort_no`,
    `mt`.`roll_no` AS `roll_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_name` AS `company_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`godown_id` AS `godown_id`,
    `mt`.`dispatch_schedule_inspection_details_transaction_id` AS `dispatch_schedule_inspection_details_transaction_id`,
    `mt`.`weaving_production_inspection_details_id` AS `weaving_production_inspection_details_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_inspection_details_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cm_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `mt`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_master_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_master_trading` AS
select
    case
        `mt`.`dispatch_schedule_creation_type` when 'M' then 'Manual'
        when 'S' then 'Sales Order Based'
    end AS `dispatch_schedule_creation_type_desc`,
    case
        `mt`.`dispatch_note_status` when 'A' then 'Aprroved'
        when 'I' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_note_status_desc`,
    `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `st1`.`state_name` AS `consignee_state_name`,
    `e`.`employee_name` AS `dispatch_supervisor_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `p`.`product_type_short_name` AS `dispatch_type_short_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`total_quantity` AS `total_quantity`,
    `mt`.`total_weight` AS `total_weight`,
    `mt`.`actual_quantity` AS `actual_quantity`,
    `mt`.`actual_weight` AS `actual_weight`,
    `mt`.`dispatch_note_remark` AS `dispatch_note_remark`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `mt`.`gate_pass_no` AS `gate_pass_no`,
    `mt`.`gate_pass_date` AS `gate_pass_date`,
    `mt`.`vehical_no` AS `vehical_no`,
    `mt`.`container_no` AS `container_no`,
    `mt`.`seal_no` AS `seal_no`,
    `mt`.`net_weight` AS `net_weight`,
    `mt`.`driver_name` AS `driver_name`,
    `mt`.`driver_contact_no` AS `driver_contact_no`,
    `mt`.`vehicle_reporting_time` AS `vehicle_reporting_time`,
    `mt`.`vehicle_loading_started_time` AS `vehicle_loading_started_time`,
    `mt`.`vehicle_loading_finish_time` AS `vehicle_loading_finish_time`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`dispatch_note_status` AS `dispatch_note_status`,
    `mt`.`dispatch_schedule_creation_type` AS `dispatch_schedule_creation_type`,
    `c`.`cust_branch_phone_no` AS `customer_phone`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `ct`.`city_name` AS `customer_city_name`,
    `c`.`cust_branch_gst_no` AS `customer_gst_no`,
    `c`.`cust_branch_pan_no` AS `customer_pan_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `cc`.`cust_branch_address1` AS `consignee_address`,
    `cc`.`cust_branch_EmailId` AS `consignee_email`,
    `ct1`.`city_name` AS `consignee_city_name`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `mt`.`dispatch_schedule_type_id` AS `dispatch_schedule_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`dispatch_supervisor_id` AS `dispatch_supervisor_id`,
    `mt`.`approved_by_id` AS `approved_by_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `mt`.`dispatch_schedule_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct` on
    (`ct`.`city_id` = `mt`.`customer_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `mt`.`consignee_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st` on
    (`st`.`state_id` = `mt`.`customer_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st1` on
    (`st1`.`state_id` = `mt`.`consignee_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`company_branch_id` = `mt`.`company_branch_id`
        and `e`.`company_id` = `mt`.`company_id`
        and `e`.`employee_id` = `mt`.`dispatch_supervisor_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`company_branch_id` = `mt`.`company_branch_id`
        and `e1`.`company_id` = `mt`.`company_id`
        and `e1`.`employee_id` = `mt`.`approved_by_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
    -- mtv_dispatch_schedule_packing_details source

    CREATE OR REPLACE
    ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_packing_details` AS
    select
        `mt`.`sr_no` AS `sr_no`,
        `ddt`.`dispatch_schedule_type` AS `dispatch_schedule_type`,
        `mt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
        `mt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
        `mt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
        `mt`.`customer_order_no` AS `customer_order_no`,
        `xm`.`production_count_name` AS `production_count_name`,
        `xm`.`production_actual_count` AS `production_actual_count`,
        `yp`.`yarn_packing_types_name` AS `yarn_packing_types_name`,
        `mt`.`so_sr_no` AS `so_sr_no`,
        `ddt`.`product_material_name` AS `product_material_name`,
        `ddt`.`product_material_print_name` AS `product_material_print_name`,
        `ddt`.`product_material_tech_spect` AS `product_material_tech_spect`,
        `u`.`product_unit_name` AS `product_unit_name`,
        `mt`.`item_dispatch_quantity` AS `item_dispatch_quantity`,
        `mt`.`item_dispatch_weight` AS `item_dispatch_weight`,
        `mt`.`cone_weight` AS `cone_weight`,
        `mt`.`cone_quantity` AS `cone_quantity`,
        `mt`.`per_packing_weight` AS `per_packing_weight`,
        `mt`.`packing_gross_weight` AS `packing_gross_weight`,
        `mt`.`packing_net_weight` AS `packing_net_weight`,
        `mt`.`packing_quantity` AS `packing_quantity`,
        `mt`.`packing_starting_no` AS `packing_starting_no`,
        `mt`.`packing_ending_no` AS `packing_ending_no`,
        `mt`.`lot_no` AS `lot_no`,
        `mt`.`sub_lot_no` AS `sub_lot_no`,
        `mt`.`remark` AS `remark`,
        `v`.`company_legal_name` AS `company_name`,
        `v`.`company_branch_name` AS `company_branch_name`,
        `mt`.`financial_year` AS `financial_year`,
        case
            `mt`.`is_active` when 1 then 'Active'
            else 'In Active'
        end AS `Active`,
        case
            `mt`.`is_delete` when 1 then 'Yes'
            else 'No'
        end AS `Deleted`,
        `mt`.`is_active` AS `is_active`,
        `mt`.`is_delete` AS `is_delete`,
        `mt`.`created_by` AS `created_by`,
        `mt`.`created_on` AS `created_on`,
        `mt`.`modified_by` AS `modified_by`,
        `mt`.`modified_on` AS `modified_on`,
        `mt`.`deleted_by` AS `deleted_by`,
        `mt`.`deleted_on` AS `deleted_on`,
        `mt`.`yarn_packing_date` AS `yarn_packing_date`,
        `mt`.`yarn_packing_types_id` AS `yarn_packing_types_id`,
        `mt`.`production_count_id` AS `production_count_id`,
        `mt`.`product_material_id` AS `product_material_id`,
        `mt`.`product_unit_id` AS `product_unit_id`,
        `mt`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
        `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
        `mt`.`company_id` AS `company_id`,
        `mt`.`company_branch_id` AS `company_branch_id`,
        `mt`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
        `mt`.`dispatch_schedule_packing_id` AS `dispatch_schedule_packing_id`,
        `mt`.`yarn_packing_details_id` AS `yarn_packing_details_id`
    from
        (((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_packing_details` `mt`
    left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
        (`v`.`company_branch_id` = `mt`.`company_branch_id`
            and `v`.`company_id` = `mt`.`company_id`))
    left join `ERP_PASHUPATI_DEV_1_0`.`xm_spinning_prod_count` `xm` on
        (`xm`.`production_count_id` = `mt`.`production_count_id`
            and `xm`.`company_id` = `mt`.`company_id`))
    left join `ERP_PASHUPATI_DEV_1_0`.`xm_yarn_packing_types` `yp` on
        (`yp`.`yarn_packing_types_id` = `mt`.`yarn_packing_types_id`
            and `yp`.`company_id` = `mt`.`company_id`))
    left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
        (`u`.`product_unit_id` = `mt`.`product_unit_id`))
    left join `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_details_trading` `ddt` on
        (`ddt`.`company_id` = `mt`.`company_id`
            and `ddt`.`dispatch_schedule_details_transaction_id` = `mt`.`dispatch_schedule_details_transaction_id`))
    where
        `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_schedule_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_schedule_product_dynamic_parameters` AS
select
    `b`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `b`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`dispatch_schedule_parameter_id` AS `dispatch_schedule_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`dispatch_schedule_master_transaction_id` AS `dispatch_schedule_master_transaction_id`,
    `b`.`dispatch_schedule_details_transaction_id` AS `dispatch_schedule_details_transaction_id`,
    `b`.`dispatch_schedule_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_schedule_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_type_id` = `b`.`product_type_id`
        and `rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_tax_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_tax_summary` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `cb`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`state_name` AS `expected_branch_state_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`summary_taxable_amount` AS `summary_taxable_amount`,
    `mt`.`summary_cgst_percent` AS `summary_cgst_percent`,
    `mt`.`summary_cgst_total` AS `summary_cgst_total`,
    `mt`.`summary_sgst_percent` AS `summary_sgst_percent`,
    `mt`.`summary_sgst_total` AS `summary_sgst_total`,
    `mt`.`summary_igst_percent` AS `summary_igst_percent`,
    `mt`.`summary_igst_total` AS `summary_igst_total`,
    `mt`.`summary_total_amount` AS `summary_total_amount`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_tax_summary_transaction_id` AS `sales_order_tax_summary_transaction_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `mt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `mt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `mt`.`hsn_code_id` AS `hsn_code_id`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_tax_summary` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `mt`.`company_branch_id`
        and `cb`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `mt`.`hsn_code_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_schedules_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_schedules_trading` AS
select
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    case
        `mt`.`sales_order_schedules_trading_item_status` when 'P' then 'Pending'
        when 'A' then 'Aprroved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'O' then 'PO'
        when 'Z' then 'PreeClosed'
        else 'GRN'
    end AS `sales_order_schedules_trading_item_status_desc`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `rmfgsr`.`product_material_make_name` AS `product_material_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`product_material_schedule_quantity` AS `product_material_schedule_quantity`,
    `mt`.`product_material_schedule_weight` AS `product_material_schedule_weight`,
    `mt`.`expected_schedule_date` AS `expected_schedule_date`,
    `mt`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `mt`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `mt`.`material_issue_date` AS `material_issue_date`,
    `mt`.`sales_order_schedules_trading_item_status` AS `sales_order_schedules_trading_item_status`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_schedules_transaction_id` AS `sales_order_schedules_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_schedules_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_product_dynamic_parameters` AS
select
    `b`.`sales_order_no` AS `sales_order_no`,
    `b`.`sales_order_date` AS `sales_order_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`sales_order_version` AS `sales_order_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`sales_order_parameter_id` AS `sales_order_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `b`.`sales_order_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_payment_terms_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_payment_terms_trading` AS
select
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`payment_terms_name` AS `payment_terms_name`,
    `mt`.`payment_terms_days` AS `payment_terms_days`,
    `mt`.`payment_terms_grace_days` AS `payment_terms_grace_days`,
    `mt`.`payment_terms_Milestome` AS `payment_terms_Milestome`,
    `mt`.`payment_percent` AS `payment_percent`,
    `mt`.`payment_expected_value` AS `payment_expected_value`,
    `mt`.`payment_expected_date` AS `payment_expected_date`,
    `mt`.`payment_receipt_flag` AS `payment_receipt_flag`,
    `mt`.`payment_receipt_transaction_id` AS `payment_receipt_transaction_id`,
    `mt`.`payment_receipt_date` AS `payment_receipt_date`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_payment_terms_transaction_id` AS `sales_order_payment_terms_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`payment_terms_id` AS `payment_terms_id`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_payment_terms_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_payment_terms` `pt` on
    (`pt`.`payment_terms_id` = `mt`.`payment_terms_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` `sotv` on
    (`sotv`.`company_branch_id` = `mt`.`company_branch_id`
        and `sotv`.`company_id` = `mt`.`company_id`
        and `sotv`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_trading_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` AS
select
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mt`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Order Accepted'
        when 'X' then 'Order Cancelled'
        else 'Aceptance Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `cc`.`cust_branch_gst_no` AS `consignee_gst_no`,
    `cc`.`cust_branch_pan_no` AS `consignee_pan_no`,
    `cc`.`cust_branch_phone_no` AS `consignee_phone_no`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`sales_order_type` AS `sales_order_type`,
    `mt`.`sales_order_life` AS `sales_order_life`,
    `mt`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_pincode` AS `company_pincode`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`state_name` AS `company_branch_state`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`mt`.`sales_order_type_id` = `pt`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`
        and `vp`.`company_branch_id` = `mt`.`company_branch_id`
        and `vp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_details_tracking_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_details_tracking_trading` AS
select
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `rmfgsr`.`product_material_make_name` AS `product_material_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`,
    `mt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`quotation_rate` AS `quotation_rate`,
    `mt`.`material_rate` AS `material_rate`,
    `mt`.`material_schedule_date` AS `material_schedule_date`,
    case
        `mt`.`sales_order_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        when 'O' then 'PO'
        when 'G' then 'GRN'
        else 'Pending'
    end AS `sales_order_item_status_desc`,
    `mt`.`sales_order_item_status` AS `sales_order_item_status`,
    `mt`.`pending_quantity` AS `pending_quantity`,
    `mt`.`pending_weight` AS `pending_weight`,
    `mt`.`opening_quantity` AS `opening_quantity`,
    `mt`.`opening_weight` AS `opening_weight`,
    `mt`.`reserve_quantity` AS `reserve_quantity`,
    `mt`.`reserve_weight` AS `reserve_weight`,
    `mt`.`excess_quantity` AS `excess_quantity`,
    `mt`.`excess_weight` AS `excess_weight`,
    `mt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `mt`.`pree_closed_weight` AS `pree_closed_weight`,
    `mt`.`purchase_quantity` AS `purchase_quantity`,
    `mt`.`purchase_weight` AS `purchase_weight`,
    `mt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `mt`.`purchase_return_weight` AS `purchase_return_weight`,
    `mt`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `mt`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `mt`.`jobcard_quantity` AS `jobcard_quantity`,
    `mt`.`jobcard_weight` AS `jobcard_weight`,
    `mt`.`production_issue_quantity` AS `production_issue_quantity`,
    `mt`.`production_issue_weight` AS `production_issue_weight`,
    `mt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `mt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `mt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `mt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `mt`.`production_quantity` AS `production_quantity`,
    `mt`.`production_weight` AS `production_weight`,
    `mt`.`production_return_quantity` AS `production_return_quantity`,
    `mt`.`production_return_weight` AS `production_return_weight`,
    `mt`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `mt`.`production_rejection_weight` AS `production_rejection_weight`,
    `mt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `mt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `mt`.`sales_quantity` AS `sales_quantity`,
    `mt`.`sales_weight` AS `sales_weight`,
    `mt`.`sales_return_quantity` AS `sales_return_quantity`,
    `mt`.`sales_return_weight` AS `sales_return_weight`,
    `mt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `mt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `mt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `mt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `mt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `mt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `mt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `mt`.`outsources_out_weight` AS `outsources_out_weight`,
    `mt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `mt`.`outsources_in_weight` AS `outsources_in_weight`,
    `mt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `mt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `mt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `mt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `mt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `mt`.`loan_issue_weight` AS `loan_issue_weight`,
    `mt`.`cancel_quantity` AS `cancel_quantity`,
    `mt`.`cancel_weight` AS `cancel_weight`,
    `mt`.`difference_quantity` AS `difference_quantity`,
    `mt`.`difference_weight` AS `difference_weight`,
    `mt`.`remark` AS `remark`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_details_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` `sotv` on
    (`sotv`.`company_branch_id` = `mt`.`company_branch_id`
        and `sotv`.`company_id` = `mt`.`company_id`
        and `sotv`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_details_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_details_trading` AS
select
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `mt`.`dispatch_challan_status_desc` AS `dispatch_challan_status_desc`,
    `mt`.`customer_name` AS `customer_name`,
    `mt`.`customer_state_name` AS `customer_state_name`,
    `mt`.`consignee_name` AS `consignee_name`,
    `mt`.`consignee_state_name` AS `consignee_state_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`customer_gst_no` AS `customer_gst_no`,
    `mt`.`consignee_gst_no` AS `consignee_gst_no`,
    `mt`.`customer_pan_no` AS `customer_pan_no`,
    `mt`.`consignee_pan_no` AS `consignee_pan_no`,
    `mt`.`transporter_gst_no` AS `transporter_gst_no`,
    `mt`.`vehicle_no` AS `vehicle_no`,
    `mt`.`vehicle_type` AS `vehicle_type`,
    `mt`.`transporter_challan_no` AS `transporter_challan_no`,
    `mt`.`transporter_challan_date` AS `transporter_challan_date`,
    `mt`.`loading_time` AS `loading_time`,
    `mt`.`transport_mode` AS `transport_mode`,
    `mt`.`transaction_type` AS `transaction_type`,
    `mt`.`is_service` AS `is_service`,
    `mt`.`is_sez` AS `is_sez`,
    `mt`.`interim` AS `interim`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `mt`.`freight_fg_hsn_sac_code` AS `freight_fg_hsn_sac_code`,
    `mt`.`freight_fg_hsn_sac_rate` AS `freight_fg_hsn_sac_rate`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    `mt`.`agent_amount` AS `agent_amount`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `mt`.`dispatch_challan_creation_type_desc` AS `dispatch_challan_creation_type_desc`,
    case
        `dt`.`dispatch_challan_item_status` when 'A' then 'Aprroved'
        when 'U' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_challan_item_status_desc`,
    `dt`.`sales_order_no` AS `sales_order_no`,
    `dt`.`sales_order_Date` AS `sales_order_Date`,
    `dt`.`sales_order_version` AS `sales_order_version`,
    `dt`.`customer_order_no` AS `customer_order_no`,
    `dt`.`customer_order_Date` AS `customer_order_Date`,
    `dt`.`dispatch_schedule_no` AS `dispatch_schedule_no`,
    `dt`.`dispatch_schedule_date` AS `dispatch_schedule_date`,
    `dt`.`dispatch_schedule_version` AS `dispatch_schedule_version`,
    `dt`.`sr_no` AS `sr_no`,
    `dt`.`product_material_id` AS `product_material_id`,
    `dt`.`so_sr_no` AS `so_sr_no`,
    `rm`.`product_material_name` AS `product_material_name`,
    `rm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_std_weight` AS `product_material_std_weight`,
    `dt`.`product_material_print_name` AS `product_material_print_name`,
    `dt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `dt`.`product_material_unit_id` AS `product_material_unit_id`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `dt`.`product_material_packing_id` AS `product_material_packing_id`,
    `p`.`product_packing_name` AS `product_packing_name`,
    `dt`.`dispatch_quantity` AS `dispatch_quantity`,
    `dt`.`dispatch_weight` AS `dispatch_weight`,
    `dt`.`hsn_sac_id` AS `hsn_sac_id`,
    `h1`.`hsn_sac_code` AS `hsn_sac_code`,
    `h1`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `dt`.`hsn_sac_percent` AS `hsn_sac_percent`,
    `dt`.`item_rate` AS `item_rate`,
    `dt`.`item_amount` AS `item_amount`,
    `dt`.`item_discount_percent` AS `item_discount_percent`,
    `dt`.`item_discount_amount` AS `item_discount_amount`,
    `dt`.`item_taxable_amount` AS `item_taxable_amount`,
    `dt`.`item_cgst_percent` AS `item_cgst_percent`,
    `dt`.`item_cgst_amount` AS `item_cgst_amount`,
    `dt`.`item_sgst_percent` AS `item_sgst_percent`,
    `dt`.`item_sgst_amount` AS `item_sgst_amount`,
    `dt`.`item_igst_percent` AS `item_igst_percent`,
    `dt`.`item_igst_amount` AS `item_igst_amount`,
    `dt`.`item_total_amount` AS `item_total_amount`,
    `dt`.`item_freight_amount` AS `item_freight_amount`,
    `dt`.`dispatch_return_quantity` AS `dispatch_return_quantity`,
    `dt`.`dispatch_return_weight` AS `dispatch_return_weight`,
    `dt`.`pending_quantity` AS `pending_quantity`,
    `dt`.`pending_weight` AS `pending_weight`,
    `dt`.`expected_schedule_date` AS `expected_schedule_date`,
    `dt`.`delayed_days` AS `delayed_days`,
    `dt`.`invoice_quantity` AS `invoice_quantity`,
    `dt`.`invoice_weight` AS `invoice_weight`,
    `dt`.`pree_close_flag` AS `pree_close_flag`,
    `dt`.`pree_close_quantity` AS `pree_close_quantity`,
    `dt`.`dispatch_challan_item_status` AS `dispatch_challan_item_status`,
    `mt`.`dispatch_challan_status` AS `dispatch_challan_status`,
    `mt`.`dispatch_challan_type` AS `dispatch_challan_type`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `v`.`company_udyog_adhar_no` AS `company_udyog_adhar_no`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`customer_email` AS `customer_email`,
    `mt`.`customer_city_name` AS `customer_city_name`,
    `mt`.`consignee_email` AS `consignee_email`,
    `mt`.`consignee_city_name` AS `consignee_city_name`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `dt`.`dispatch_challan_details_transaction_id` AS `dispatch_challan_details_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `mt`.`dispatch_challan_type_id` AS `dispatch_challan_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`transporter_id` AS `transporter_id`,
    `mt`.`approved_by_id` AS `approved_by_id`
from
    (((((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_details_trading` `dt`
left join `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_master_trading` `mt` on
    (`mt`.`dispatch_challan_master_transaction_id` = `dt`.`dispatch_challan_master_transaction_id`
        and `mt`.`company_id` = `dt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `h1` on
    (`h1`.`hsn_sac_id` = `dt`.`hsn_sac_id`
        and `h1`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`
        and `h1`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `p` on
    (`p`.`product_packing_id` = `dt`.`product_material_packing_id`
        and `p`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `dt`.`product_material_unit_id`
        and `u`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `dt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `dt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_master_trading source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_master_trading` AS
select
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    case
        `mt`.`dispatch_challan_status` when 'A' then 'Aprroved'
        when 'U' then 'Partial Sales Issue'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'D' then 'Dispath Challan Created'
        when 'I' then 'Invoice Created'
        else 'Pending'
    end AS `dispatch_challan_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `st1`.`state_name` AS `consignee_state_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`dispatch_challan_remark` AS `dispatch_challan_remark`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`customer_gst_no` AS `customer_gst_no`,
    `mt`.`consignee_gst_no` AS `consignee_gst_no`,
    `mt`.`customer_pan_no` AS `customer_pan_no`,
    `mt`.`consignee_pan_no` AS `consignee_pan_no`,
    `mt`.`transporter_gst_no` AS `transporter_gst_no`,
    `mt`.`vehicle_no` AS `vehicle_no`,
    `mt`.`vehicle_type` AS `vehicle_type`,
    `mt`.`transporter_challan_no` AS `transporter_challan_no`,
    `mt`.`transporter_challan_date` AS `transporter_challan_date`,
    `mt`.`loading_time` AS `loading_time`,
    `mt`.`transport_mode` AS `transport_mode`,
    `mt`.`transaction_type` AS `transaction_type`,
    `mt`.`is_service` AS `is_service`,
    `mt`.`is_sez` AS `is_sez`,
    `mt`.`interim` AS `interim`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `h`.`hsn_sac_code` AS `freight_fg_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `freight_fg_hsn_sac_rate`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `mt`.`agent_id` AS `agent_id`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    `mt`.`agent_amount` AS `agent_amount`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    case
        `mt`.`dispatch_challan_creation_type` when 'M' then 'Mannual'
        when 'D' then 'Dispatch Schedule Based'
        when 'O' then 'Sales Order Based'
    end AS `dispatch_challan_creation_type_desc`,
    case
        `mt`.`mail_sent_status` when 'S' then 'Sent'
        when 'F' then 'Failed'
    end AS `mail_sent_status_desc`,
    `mt`.`dispatch_challan_creation_type` AS `dispatch_challan_creation_type`,
    `mt`.`dispatch_challan_status` AS `dispatch_challan_status`,
    `mt`.`dispatch_challan_type` AS `dispatch_challan_type`,
    `mt`.`remark` AS `remark`,
    `v`.`company_name` AS `company_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`cust_branch_address1` AS `customer_address1`,
    `ct`.`city_name` AS `customer_city_name`,
    `cc`.`cust_branch_EmailId` AS `consignee_email`,
    `ct1`.`city_name` AS `consignee_city_name`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `mt`.`dispatch_challan_type_id` AS `dispatch_challan_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`transporter_id` AS `transporter_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`mail_sent_status` AS `mail_sent_status`
from
    ((((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch_summary` `v` on
    (`v`.`company_branch_id` = `mt`.`expected_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_agent` `a` on
    (`a`.`company_id` = `mt`.`company_id`
        and `a`.`agent_id` = `mt`.`agent_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct` on
    (`ct`.`city_id` = `mt`.`customer_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `mt`.`consignee_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st` on
    (`st`.`state_id` = `mt`.`customer_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st1` on
    (`st1`.`state_id` = `mt`.`consignee_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`pt`.`product_type_id` = `mt`.`dispatch_challan_type_id`
        and `pt`.`is_delete` = 0))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_packing_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_packing_details` AS
select
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `xm`.`production_count_name` AS `production_count_name`,
    `yp`.`yarn_packing_types_name` AS `yarn_packing_types_name`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `mt`.`item_dispatch_quantity` AS `item_dispatch_quantity`,
    `mt`.`item_dispatch_weight` AS `item_dispatch_weight`,
    `mt`.`cone_weight` AS `cone_weight`,
    `mt`.`cone_quantity` AS `cone_quantity`,
    `mt`.`per_packing_weight` AS `per_packing_weight`,
    `mt`.`packing_gross_weight` AS `packing_gross_weight`,
    `mt`.`packing_net_weight` AS `packing_net_weight`,
    `mt`.`packing_quantity` AS `packing_quantity`,
    `mt`.`packing_starting_no` AS `packing_starting_no`,
    `mt`.`packing_ending_no` AS `packing_ending_no`,
    `mt`.`lot_no` AS `lot_no`,
    `mt`.`sub_lot_no` AS `sub_lot_no`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`yarn_packing_date` AS `yarn_packing_date`,
    `mt`.`yarn_packing_types_id` AS `yarn_packing_types_id`,
    `mt`.`production_count_id` AS `production_count_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_unit_id` AS `product_unit_id`,
    `mt`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`dispatch_challan_packing_id` AS `dispatch_challan_packing_id`,
    `mt`.`yarn_packing_details_id` AS `yarn_packing_details_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_packing_details` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_spinning_prod_count` `xm` on
    (`xm`.`production_count_id` = `mt`.`production_count_id`
        and `xm`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`xm_yarn_packing_types` `yp` on
    (`yp`.`yarn_packing_types_id` = `mt`.`yarn_packing_types_id`
        and `yp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`is_delete` = 0
        and `u`.`product_unit_id` = `mt`.`product_unit_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_dispatch_challan_product_dynamic_parameters` AS
select
    `b`.`dispatch_challan_no` AS `dispatch_challan_no`,
    `b`.`dispatch_challan_date` AS `dispatch_challan_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`dispatch_challan_version` AS `dispatch_challan_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`dispatch_challan_parameter_id` AS `dispatch_challan_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`dispatch_challan_master_transaction_id` AS `dispatch_challan_master_transaction_id`,
    `b`.`dispatch_challan_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_dispatch_challan_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
10-07-2024

-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `e`.`email_id1` AS `indented_by_email`,
    `e1`.`email_id1` AS `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`issue_group_type` AS `issue_group_type`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Indent Based'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fm`.`cost_center_name` AS `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`
        and `re`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_product_dynamic_parameters` AS
select
    `b`.`purchase_order_no` AS `purchase_order_no`,
    `b`.`purchase_order_date` AS `purchase_order_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`purchase_order_version` AS `purchase_order_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`purchase_order_parameter_id` AS `purchase_order_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `b`.`purchase_order_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`company_id` = `b`.`company_id`
        and `d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_schedules source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_schedules` AS
select
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `pt`.`purchase_order_schedules_item_status` when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `purchase_order_schedules_item_status_desc`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`product_type` AS `product_type`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`material_po_quantity` AS `material_po_quantity`,
    `pt`.`material_po_weight` AS `material_po_weight`,
    `pt`.`product_material_po_schedule_quantity` AS `product_material_po_schedule_quantity`,
    `pt`.`product_material_po_schedule_weight` AS `product_material_po_schedule_weight`,
    `pt`.`expected_schedule_date` AS `expected_schedule_date`,
    `pt`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `pt`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `pt`.`material_receipt_date` AS `material_receipt_date`,
    `pt`.`purchase_order_schedules_item_status` AS `purchase_order_schedules_item_status`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_schedules_transaction_id` AS `purchase_order_schedules_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`product_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`
from
    ((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_schedules` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_master_transaction_id` = `pt`.`purchase_order_master_transaction_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipts_notes_tax_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipts_notes_tax_summary` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `s`.`state_name` AS `state_name`,
    `ct`.`city_name` AS `city_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`summary_taxable_amount` AS `summary_taxable_amount`,
    `pt`.`summary_cgst_percent` AS `summary_cgst_percent`,
    `pt`.`summary_cgst_total` AS `summary_cgst_total`,
    `pt`.`summary_sgst_percent` AS `summary_sgst_percent`,
    `pt`.`summary_sgst_total` AS `summary_sgst_total`,
    `pt`.`summary_igst_percent` AS `summary_igst_percent`,
    `pt`.`summary_igst_total` AS `summary_igst_total`,
    `pt`.`summary_total_amount` AS `summary_total_amount`,
    `pt`.`tax_upload__status` AS `tax_upload__status`,
    `pt`.`tax_upload_date` AS `tax_upload_date`,
    `sup`.`supplier_type` AS `supplier_type`,
    `sup`.`supplier_code` AS `supplier_code`,
    `sup`.`supplier_name` AS `supplier_name`,
    `sup`.`supplier_short_name` AS `supplier_short_name`,
    `sup`.`supplier_sector` AS `supplier_sector`,
    `sup`.`nature_of_business` AS `nature_of_business`,
    `sup`.`supplier_rating` AS `supplier_rating`,
    `sup`.`supplier_gl_codes` AS `supplier_gl_codes`,
    `sup`.`supplier_history` AS `supplier_history`,
    `sup`.`username` AS `username`,
    `sup`.`password` AS `password`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`goods_receipts_notes_tax_summary_transaction_id` AS `goods_receipts_notes_tax_summary_transaction_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `ptvgrm`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`hsn_code_id` AS `hsn_code_id`,
    `pt`.`tax_upload_id` AS `tax_upload_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipts_notes_tax_summary` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `pt`.`company_branch_id`
        and `sup`.`company_id` = `pt`.`company_id`
        and `sup`.`supplier_id` = `pt`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`
        and `ct`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `s` on
    (`s`.`state_id` = `pt`.`supplier_state_id`
        and `s`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `ptvgrm` on
    (`ptvgrm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `ptvgrm`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`hsn_code_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_purchase_order_details ADD sub_department_id BIGINT(20) NULL COMMENT 'combo box load on selecting main department';

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sdp`.`department_name` AS `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `c`.`customer_name` AS `customer_name`,
    `pom`.`state_name` AS `customer_state_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`sub_department_id` AS `sub_department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    ((((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` AS
select
	`sup`.`supplier_name` AS `supplier_name`,
	`pt`.`goods_receipt_no` AS `goods_receipt_no`,
	`pt`.`goods_receipt_date` AS `goods_receipt_date`,
	`pt`.`goods_receipt_version` AS `goods_receipt_version`,
	case
		`pt`.`goods_receipt_status` when 'G' then 'GRN Done'
		when 'Q' then 'QC Done'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'B' then 'Bill Booked'
		else 'GRN'
	end AS `goods_receipt_status_desc`,
	case
		`pt`.`purchase_order_life` when 'C' then 'Close'
		else 'Open'
	end AS `purchase_order_life_desc`,
	(
	select
		distinct `PO1`.`indented_by_id`
	from
		`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `PO1`
	where
		`PO1`.`purchase_order_no`
        IN
    (
		select
			distinct `pd1`.`purchase_order_no`
		from
			`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pd1`
		where
			`pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
    )) AS `indent_by_id`,
	(
	select
		distinct `pd1`.`purchase_order_no`
	from
		`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pd1`
	where
		`pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
	limit 1) AS `purchase_order_no`,
	(
	select
		distinct `pd1`.`purchase_order_date`
	from
		`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pd1`
	where
		`pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
	limit 1) AS `purchase_order_date`,
	`pt`.`purchase_order_version` AS `purchase_order_version`,
	`pt`.`goods_receipt_type` AS `goods_receipt_type`,
	`pt`.`supplier_invoice_no` AS `supplier_invoice_no`,
	`pt`.`supplier_invoice_date` AS `supplier_invoice_date`,
	`pt`.`supplier_challan_no` AS `supplier_challan_no`,
	`pt`.`supplier_challan_date` AS `supplier_challan_date`,
	`pt`.`expected_schedule_date` AS `expected_schedule_date`,
	`a`.`agent_name` AS `agent_name`,
	`pt`.`agent_percent` AS `agent_percent`,
	`pt`.`agent_paid_status` AS `agent_paid_status`,
	`e1`.`employee_name` AS `qa_by_name`,
	`pt`.`approved_date` AS `approved_date`,
	`pt`.`qa_date` AS `qa_date`,
	`pt`.`basic_total` AS `basic_total`,
	`pt`.`transport_amount` AS `transport_amount`,
	`pt`.`freight_amount` AS `freight_amount`,
	`pt`.`is_freight_taxable` AS `is_freight_taxable`,
	`pt`.`packing_amount` AS `packing_amount`,
	`pt`.`goods_receipt_discount_percent` AS `goods_receipt_discount_percent`,
	`pt`.`goods_receipt_discount_amount` AS `goods_receipt_discount_amount`,
	`pt`.`other_amount` AS `other_amount`,
	`pt`.`taxable_total` AS `taxable_total`,
	`pt`.`cgst_total` AS `cgst_total`,
	`pt`.`sgst_total` AS `sgst_total`,
	`pt`.`igst_total` AS `igst_total`,
	`pt`.`grand_total` AS `grand_total`,
	`pt`.`roundoff` AS `roundoff`,
	`pt`.`goods_receipt_status` AS `goods_receipt_status`,
	`pt`.`lr_no` AS `lr_no`,
	`pt`.`lr_date` AS `lr_date`,
	`pt`.`vehicle_no` AS `vehicle_no`,
	`pt`.`other_terms_conditions` AS `other_terms_conditions`,
	`sup`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
	`sup`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
	`sup`.`supp_branch_address1` AS `supp_branch_address1`,
	`sup`.`supp_branch_pincode` AS `supp_branch_pincode`,
	`sup`.`supp_branch_gst_no` AS `supp_branch_gst_no`,
	`sup`.`supp_branch_pan_no` AS `supp_branch_pan_no`,
	`pt`.`remark` AS `remark`,
	`cb`.`is_sez` AS `is_sez`,
	`cb`.`company_name` AS `company_name`,
	`cb`.`company_branch_name` AS `company_branch_name`,
	`cb`.`branch_pincode` AS `company_pincode`,
	`cb`.`branch_phone_no` AS `company_phone_no`,
	`cb`.`state_name` AS `company_branch_state`,
	`cb`.`city_name` AS `company_branch_city`,
	`cb`.`branch_cell_no` AS `company_cell_no`,
	`cb`.`branch_EmailId` AS `company_EmailId`,
	`cb`.`branch_gst_no` AS `company_gst_no`,
	`cb`.`branch_pan_no` AS `company_pan_no`,
	`cb`.`branch_address1` AS `company_address1`,
	`cb`.`branch_address2` AS `company_address2`,
	`ct`.`city_name` AS `supplier_city_name`,
	`s`.`state_name` AS `supplier_state_name`,
	`pt`.`financial_year` AS `financial_year`,
	case
		when `pt`.`is_active` = 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		when `pt`.`is_delete` = 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`pt`.`is_active` AS `is_active`,
	`pt`.`is_delete` AS `is_delete`,
	`pt`.`is_preeclosed` AS `is_preeclosed`,
	`pt`.`purchase_order_life` AS `purchase_order_life`,
	`pt`.`created_by` AS `created_by`,
	`pt`.`created_on` AS `created_on`,
	`pt`.`modified_by` AS `modified_by`,
	`pt`.`modified_on` AS `modified_on`,
	`pt`.`deleted_by` AS `deleted_by`,
	`pt`.`deleted_on` AS `deleted_on`,
	`pt`.`company_id` AS `company_id`,
	`pt`.`company_branch_id` AS `company_branch_id`,
	`pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
	`pt`.`qa_by_id` AS `qa_by_id`,
	`pt`.`agent_id` AS `agent_id`,
	`pt`.`supplier_id` AS `supplier_id`,
	`pt`.`approved_by_id` AS `approved_by_id`,
	`pt`.`supplier_state_id` AS `supplier_state_id`,
	`pt`.`supplier_city_id` AS `supplier_city_id`,
	`pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
	`pt`.`expected_branch_id` AS `expected_branch_id`,
	`pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
	`pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
	`pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
	`pt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
	`sup`.`payment_term_id` AS `payment_term_id`
from
	(((((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_master` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company_branch` `v` on
	(`v`.`company_branch_id` = `pt`.`company_branch_id`
		and `v`.`company_id` = `pt`.`company_id`
		and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_supplier` `sup` on
	(`sup`.`company_branch_id` = `pt`.`company_branch_id`
		and `sup`.`company_id` = `pt`.`company_id`
		and `sup`.`supplier_id` = `pt`.`supplier_id`
		and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
	(`e1`.`employee_id` = `pt`.`qa_by_id`
		and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct` on
	(`ct`.`city_id` = `pt`.`supplier_city_id`
		and `ct`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `s` on
	(`s`.`state_id` = `pt`.`supplier_state_id`
		and `s`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
	(`a`.`agent_id` = `pt`.`agent_id`
		and `a`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch_summary` `cb` on
	(`cb`.`company_branch_id` = `pt`.`expected_branch_id`
		and `cb`.`company_id` = `pt`.`company_id`))
where
	`pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary_rpt` AS
select
    concat(`v`.`goods_receipt_no`, ':Goods Receipt No:Y:C:ptv_goods_receipt_summary:O') AS `goods_receipt_no`,
    concat(`v`.`goods_receipt_date`, ':Goods Receipt Date:Y:D:') AS `goods_receipt_date`,
    concat(`v`.`goods_receipt_version`, ':Goods Receipt version:O:N:') AS `goods_receipt_version`,
    concat(`v`.`goods_receipt_type`, ':Goods Receipt Type:O:N:') AS `goods_receipt_type`,
    concat(`v`.`goods_receipt_status`, ':Goods Receipt Status:Y:H:(GRN Done,QC Done,Rejected,Partial Receipt,Completed,Canceled,GRN)') AS `goods_receipt_status_desc`,
    concat(`v`.`purchase_order_no`, ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') AS `purchase_order_no`,
    concat(`v`.`purchase_order_date`, ':Purchase Order Date:Y:D:') AS `purchase_order_date`,
    concat(`v`.`purchase_order_version`, ':Purchase Order Version:O:N:') AS `purchase_order_version`,
    concat(`v`.`purchase_order_life_desc`, ':Purchase Order Life:Y:N:(Close,Open)') AS `purchase_order_life_desc`,
    concat(`v`.`supplier_name`, ':Supplier Name:Y:C:cmv_supplier_summary:F') AS `supplier_name`,
    concat(`v`.`supplier_challan_no`, ':Supplier Challan No:O:N:') AS `supplier_challan_no`,
    concat(`v`.`supplier_challan_date`, ':Supplier Challan Date:Y:D:') AS `supplier_challan_date`,
    concat(`v`.`basic_total`, ':Basic Total:O:N:') AS `basic_total`,
    concat(`v`.`transport_amount`, ':Transport Amount:O:N:') AS `transport_amount`,
    concat(`v`.`freight_amount`, ':Freight Amount:O:N:') AS `freight_amount`,
    concat(`v`.`is_freight_taxable`, ':Is Freight Taxable:O:N:') AS `is_freight_taxable`,
    concat(`v`.`packing_amount`, ':Packing Amount:O:N:') AS `packing_amount`,
    concat(`v`.`goods_receipt_discount_percent`, ':Discount Percent:O:N:') AS `goods_receipt_discount_percent`,
    concat(`v`.`goods_receipt_discount_amount`, ':Discount Amount:O:N:') AS `goods_receipt_discount_amount`,
    concat(`v`.`other_amount`, ':Other Amount:O:N:') AS `other_amount`,
    concat(`v`.`taxable_total`, ':Taxable Total:O:N:') AS `taxable_total`,
    concat(`v`.`cgst_total`, ':Cgst Total:O:N:') AS `cgst_total`,
    concat(`v`.`sgst_total`, ':Sgst Total:O:N:') AS `sgst_total`,
    concat(`v`.`igst_total`, ':Igst Total:O:N:') AS `igst_total`,
    concat(`v`.`grand_total`, ':Grand Total:O:N:') AS `grand_total`,
    concat(`v`.`roundoff`, ':Roundoff:O:N:') AS `roundoff`,
    concat(`v`.`supplier_invoice_no`, ':Supplier Invoice No:O:N:') AS `supplier_invoice_no`,
    concat(`v`.`supplier_invoice_date`, ':Supplier Invoice Date:Y:D:') AS `supplier_invoice_Date`,
    concat(`v`.`expected_schedule_date`, ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(`v`.`qa_by_name`, ':QA By:Y:C:cmv_employee_list:F') AS `qa_by_name`,
    concat(`v`.`qa_date`, ':QA Date:Y:D:') AS `qa_date`,
    concat(`v`.`approved_date`, ':Approved Date:Y:D:') AS `approved_date`,
    concat(`v`.`lr_no`, ':LR No:O:N:') AS `lr_no`,
    concat(`v`.`lr_date`, ':LR Date:Y:D:') AS `lr_date`,
    concat(`v`.`vehicle_no`, ':Vehicle No:O:N:') AS `vehicle_no`,
    concat(`v`.`other_terms_conditions`, ':Other Terms Conditions:O:N:') AS `other_terms_conditions`,
    concat(`v`.`agent_name`, ':Agent Name:Y:C:cmv_agent:F') AS `agent_name`,
    concat(`v`.`agent_percent`, ':Agent Percent:O:N:') AS `agent_percent`,
    concat(`v`.`agent_paid_status`, ':Agent Paid Status:O:N:') AS `agent_paid_status`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(`v`.`supplier_state_name`, ':Supplier State Name:Y:C:cmv_state:F') AS `supplier_state_name`,
    concat(`v`.`supplier_city_name`, ':Supplier City Name:Y:C:cmv_city:F') AS `supplier_city_name`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(`v`.`financial_year`, ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(`v`.`goods_receipt_status`, ':Goods Receipt Status:O:N:') AS `goods_receipt_status`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Modified On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`goods_receipt_master_transaction_id`, ':Goods Receipt Master Transaction Id:O:N:') AS `goods_receipt_master_transaction_id`,
    concat(`v`.`supplier_id`, ':Supplier Id:N:N:') AS `supplier_id`,
    concat(`v`.`agent_id`, ':Agent Id:N:N:') AS `agent_id`,
    concat(`v`.`qa_by_id`, ':QA By Id:N:N:') AS `qa_by_id`,
    concat(`v`.`indent_by_id`, ':Indent By Id:N:N:') AS `indent_by_id`,
    concat(`v`.`purchase_order_life`, ':Purchase Order Life:N:N:') AS `purchase_order_life`,
    concat(`v`.`approved_by_id`, ':Approved By Id:N:N:') AS `approved_by_id`,
    concat(`v`.`supplier_state_id`, ':Supplier State Id:N:N:') AS `supplier_state_id`,
    concat(`v`.`supplier_city_id`, ':Supplier City Id:N:N:') AS `supplier_city_id`,
    concat(`v`.`supplier_contacts_ids`, ':Supplier Contacts Ids:N:N:') AS `supplier_contacts_ids`,
    concat(`v`.`expected_branch_id`, ':Expected Branch Id:N:N:') AS `expected_branch_id`,
    concat(`v`.`expected_branch_state_id`, ':Expected Branch State Id:N:N:') AS `expected_branch_state_id`,
    concat(`v`.`expected_branch_city_id`, ':Expected Branch City Id:N:N:') AS `expected_branch_city_id`,
    concat(`v`.`goods_receipt_type_id`, ':Goods Receipt Type Id:N:N:') AS `goods_receipt_type_id`,
    concat(`v`.`payment_term_id`, ':Payment Term Id:N:N:') AS `payment_term_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    `po`.`indented_by_name` AS `indented_by_name`,
    `po`.`approved_by_name` AS `po_approved_by_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indent_by_id`
from
    (((((`ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `d` on
    (`d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details_rpt` AS
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') AS `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') AS `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`,''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') AS `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') AS `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') AS `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') AS `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') AS `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') AS `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') AS `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') AS `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') AS `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:') AS `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:') AS `product_material_receipt_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') AS `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') AS `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') AS `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') AS `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') AS `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') AS `product_child_bom_weight`,
    concat(ifnull(`v`.`product_parent_fg_name`, ''), ':Parent Finish Goods Name:O:N:') AS `product_parent_fg_name`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') AS `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') AS `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') AS `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') AS `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') AS `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(ifnull(`v`.`product_category3_name`, ''), ':Product Category3 Name:O:N:') AS `product_category3_name`,
    concat(ifnull(`v`.`product_category4_name`, ''), ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(ifnull(`v`.`product_category5_name`, ''), ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(ifnull(`v`.`product_make_name`, ''), ':Product Make Name:O:N:') AS `product_make_name`,
    concat(ifnull(`v`.`product_material_type_name`, ''), ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(ifnull(`v`.`product_material_grade_name`, ''), ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') AS `lead_time`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:C:cmv_employee_list:F') AS `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') AS `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') AS `indent_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') AS `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') AS `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') AS `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') AS `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(ifnull(`v`.`product_category3_id`, ''), ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(ifnull(`v`.`product_category4_id`, ''), ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(ifnull(`v`.`product_category5_id`, ''), ':Product Category5 Id:N:N:') AS `product_category5_id`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') AS `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') AS `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') AS `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') AS `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_details_rpt` AS
select
    concat(ifnull(v.indent_no, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS indent_no,
    concat(ifnull(v.indent_date, ''), ':Indent Date:Y:D:') AS indent_date,
    concat(ifnull(v.indent_version, ''), ':Indent Version:O:N:') AS indent_version,
    concat(ifnull(v.indent_type, ''), ':Indent Type:Y:C:smv_product_type:F') AS indent_type,
    concat(ifnull(v.indent_status_desc, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS indent_status_desc,
    concat(ifnull(v.department_name, ''), ':Department:Y:C:cmv_department:F') AS department_name,
    concat(ifnull(v.product_rm_name, ''), ':Material name:Y:T') AS product_rm_name,
    concat(ifnull(v.product_rm_stock_unit_name, ''), ':Material Stock Unit Name:O:N:') AS product_rm_stock_unit_name,
    concat(ifnull(v.product_material_quantity, ''), ':Material Quantity:O:N:') AS product_material_quantity,
    concat(ifnull(v.product_material_weight, ''), ':Material Weight:O:N:') AS product_material_weight,
    concat(ifnull(v.product_material_stock_quantity, ''), ':Material Stock Quantity:O:N:') AS product_material_stock_quantity,
    concat(ifnull(v.product_material_stock_weight, ''), ':Material Stock Weight:O:N:') AS product_material_stock_weight,
    concat(ifnull(v.product_material_reserve_quantity, ''), ':Material Reserve Quantity:O:N:') AS product_material_reserve_quantity,
    concat(ifnull(v.product_material_reserve_weight, ''), ':Material Reserve Weight:O:N:') AS product_material_reserve_weight,
    concat(ifnull(v.product_material_approved_quantity, ''), ':Material Approved Quantity:O:N:') AS product_material_approved_quantity,
    concat(ifnull(v.product_material_approved_weight, ''), ':Material Approved Weight:O:N:') AS product_material_approved_weight,
    concat(ifnull(v.product_material_rejected_quantity, ''), ':Material Rejected Quantity:O:N:') AS product_material_rejected_quantity,
    concat(ifnull(v.product_material_rejected_weight, ''), ':Material Rejected Weight:O:N:') AS product_material_rejected_weight,
    concat(ifnull(v.product_material_return_quantity, ''), ':Material Return Quantity:O:N:') AS product_material_return_quantity,
    concat(ifnull(v.product_material_return_weight, ''), ':Material Return Weight:O:N:') AS product_material_return_weight,
    concat(ifnull(v.product_material_receipt_quantity, ''), ':Material Receipt Quantity:O:N:') AS product_material_receipt_quantity,
    concat(ifnull(v.product_material_receipt_weight, ''), ':Material Receipt Weight:O:N:') AS product_material_receipt_weight,
    concat(ifnull(v.product_material_issue_quantity, ''), ':Material Issue Quantity:O:N:') AS product_material_issue_quantity,
    concat(ifnull(v.product_material_issue_weight, ''), ':Material Issue Weight:O:N:') AS product_material_issue_weight,
    concat(ifnull(v.product_material_grn_accepted_quantity, ''), ':GRN Accepted Quantity:O:N:') AS product_material_grn_accepted_quantity,
    concat(ifnull(v.product_material_grn_accepted_weight, ''), ':GRN Accepted Weight:O:N:') AS product_material_grn_accepted_weight,
    concat(ifnull(v.product_child_bom_quantity, ''), ':Product Child Bom Quantity:O:N:') AS product_child_bom_quantity,
    concat(ifnull(v.product_child_bom_weight, ''), ':Product Child Bom Weight:O:N:') AS product_child_bom_weight,
    concat(ifnull(v.product_parent_fg_name, ''), ':Parent Finish Goods Name:O:N:') AS product_parent_fg_name,
    concat(ifnull(v.product_fg_material_quantity, ''), ':Fg Material Quantity:O:N:') AS product_fg_material_quantity,
    concat(ifnull(v.product_fg_material_weight, ''), ':Fg Material Weight:O:N:') AS product_fg_material_weight,
    concat(ifnull(v.customer_name, ''), ':Customer Name:Y:C:cmv_customer_summary:F') AS customer_name,
    concat(ifnull(v.customer_order_no, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') AS customer_order_no,
    concat(ifnull(v.customer_order_date, ''), ':Customer Order Date:Y:D:') AS customer_order_date,
    concat(ifnull(v.indented_by_name, ''), ':Indent By:Y:C:cmv_employee_list:F') AS indented_by_name,
    concat(ifnull(v.approved_by_name, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') AS approved_by_name,
    concat(ifnull(v.product_rm_tech_spect, ''), ':Material Tech spec:O:N:') AS product_rm_tech_spect,
    concat(ifnull(v.product_rm_drawing_no, ''), ':Material Drawing No:O:N:') AS product_rm_drawing_no,
    concat(ifnull(v.product_rm_oem_part_code, ''), ':Material Oem Part Code:O:N:') AS product_rm_oem_part_code,
    concat(ifnull(v.product_rm_our_part_code, ''), ':Material Oem Part Code:O:N:') AS product_rm_our_part_code,
    concat(ifnull(v.product_category1_name, ''), ':Product Category1 Name:O:N:') AS product_category1_name,
    concat(ifnull(v.product_category2_name, ''), ':Product Category2 Name:O:N:') AS product_category2_name,
    concat(ifnull(v.product_category3_name, ''), ':Product Category3 Name:O:N:') AS product_category3_name,
    concat(ifnull(v.product_category4_name, ''), ':Product Category4 Name:O:N:') AS product_category4_name,
    concat(ifnull(v.product_category5_name, ''), ':Product Category5 Name:O:N:') AS product_category5_name,
    concat(ifnull(v.product_make_name, ''), ':Product Make Name:O:N:') AS product_make_name,
    concat(ifnull(v.product_material_type_name, ''), ':Material Type Name:O:N:') AS product_material_type_name,
    concat(ifnull(v.product_material_grade_name, ''), ':Material Grade Name:O:N:') AS product_material_grade_name,
    concat(ifnull(v.lead_time, ''), ':Lead Time:O:N:') AS lead_time,
    concat(ifnull(v.so_sr_no, ''), ':So Sr No:O:N:') AS so_sr_no,
    concat(ifnull(v.remark, ''), 'remark:O:N:') AS remark,
    concat(ifnull(v.company_name, ''), ':Company Name:Y:C:cmv_company_summary:F') AS company_name,
    concat(ifnull(v.company_branch_name, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS company_branch_name,
    concat(ifnull(v.financial_year, ''), ':Financial Year:Y:C:amv_financial_year:F') AS financial_year,
    concat(case when v.is_active = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS Active,
    concat(case when v.is_delete = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS Deleted,
    concat(ifnull(v.created_by, ''), ':Created By:O:N:') AS created_by,
    concat(ifnull(v.created_on, ''), ':Modified On:O:N:') AS created_on,
    concat(ifnull(v.modified_by, ''), ':Modified By:O:N:') AS modified_by,
    concat(ifnull(v.modified_on, ''), ':Modified On:O:N:') AS modified_on,
    concat(ifnull(v.deleted_by, ''), ':Deleted By:O:N:') AS deleted_by,
    concat(ifnull(v.deleted_on, ''), ':Deleted On:O:N:') AS deleted_on,
    concat(ifnull(v.indent_item_status, ''), ':Indent Item Status:O:N:') AS indent_item_status,
    concat(ifnull(v.indent_status, ''), ':Indent Status:O:N:') AS indent_status,
    concat(ifnull(v.indent_source, ''), ':Indent Source:O:N:') AS indent_source,
    concat(ifnull(v.company_id, ''), ':Company Id:N:N:') AS company_id,
    concat(ifnull(v.company_branch_id, ''), ':Company Branch Id:N:N:') AS company_branch_id,
    concat(ifnull(v.product_fg_id, ''), ':Product Fg Id:N:N:') AS product_fg_id,
    concat(ifnull(v.product_material_unit_id, ''), ':Material Unit Id:N:N:') AS product_material_unit_id,
    concat(ifnull(v.product_material_id, ''), ':Product Material Id:N:N:') AS product_material_id,
    concat(ifnull(v.product_type_id, ''), ':Product Type Id:N:N:') AS product_type_id,
    concat(ifnull(v.product_category1_id, ''), ':Product Category1 Id:N:N:') AS product_category1_id,
    concat(ifnull(v.product_category2_id, ''), ':Product Category2 Id:N:N:') AS product_category2_id,
    concat(ifnull(v.product_category3_id, ''), ':Product Category3 Id:N:N:') AS product_category3_id,
    concat(ifnull(v.product_category4_id, ''), ':Product Category4 Id:N:N:') AS product_category4_id,
    concat(ifnull(v.product_category5_id, ''), ':Product Category5 Id:N:N:') AS product_category5_id,
    concat(ifnull(v.product_make_id, ''), ':Product Make Id:N:N:') AS product_make_id,
    concat(ifnull(v.product_material_type_id, ''), ':Product Material Type Id:N:N:') AS product_material_type_id,
    concat(ifnull(v.product_material_grade_id, ''), ':Product Material Grade Id:N:N:') AS product_material_grade_id,
    concat(ifnull(v.indent_master_id, ''), ':Indent Master Id:O:N:') AS indent_master_id,
    concat(ifnull(v.indent_details_id, ''), ':Indent Details Id:N:N:') AS indent_details_id,
    concat(ifnull(v.indent_type_id, ''), ':Indent Type Id:N:N:') AS indent_type_id,
    concat(ifnull(v.customer_id, ''), ':Customer Id:N:N:') AS customer_id,
    concat(ifnull(v.department_id, ''), ':Department Id:N:N:') AS department_id,
    concat(ifnull(v.indented_by_id, ''), ':Indented By Id:N:N:') AS indented_by_id
FROM
    ERP_PASHUPATI_PROD_1_0.stv_indent_details v
LIMIT 1;


-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE ALGORITHM = UNDEFINED VIEW `stv_indent_master_summary_rpt` AS
SELECT
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') AS `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') AS `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') AS `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') AS `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') AS `indent_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') AS `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') AS `field_id`
FROM
    `stv_indent_master_summary` `v`
LIMIT 1;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` AS
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end AS `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end AS `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `s`.`supplier_name` AS `supplier_name`,
    `st`.`state_name` AS `state_name`,
    `s`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `st1`.`state_name` AS `expected_branch_state_name`,
    `e`.`employee_name` AS `approved_by`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`expected_schedule_date` AS `expected_schedule_date`,
    `pt`.`basic_total` AS `basic_total`,
    `pt`.`transport_amount` AS `transport_amount`,
    `pt`.`freight_amount` AS `freight_amount`,
    `pt`.`is_freight_taxable` AS `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `pt`.`packing_amount` AS `packing_amount`,
    `pt`.`po_discount_percent` AS `po_discount_percent`,
    `pt`.`po_discount_amount` AS `po_discount_amount`,
    `pt`.`other_amount` AS `other_amount`,
    `pt`.`taxable_total` AS `taxable_total`,
    `pt`.`cgst_total` AS `cgst_total`,
    `pt`.`sgst_total` AS `sgst_total`,
    `pt`.`igst_total` AS `igst_total`,
    `pt`.`roundoff` AS `roundoff`,
    `pt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `pt`.`agent_percent` AS `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` AS `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`status_remark` AS `status_remark`,
    `pt`.`other_terms_conditions` AS `other_terms_conditions`,
    `s`.`supplier_type` AS `supplier_type`,
    `s`.`supplier_code` AS `supplier_code`,
    `s`.`supplier_short_name` AS `supplier_short_name`,
    `s`.`supp_branch_address1` AS `supp_branch_address1`,
    `s`.`supp_branch_pincode` AS `supp_branch_pincode`,
    `ct`.`city_name` AS `city_name`,
    `s`.`district_name` AS `district_name`,
    `s`.`country_name` AS `country_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `ct1`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`purchase_process_entry` AS `purchase_process_entry`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `pt`.`purchase_order_life` AS `purchase_order_life`,
    `pt`.`purchase_order_status` AS `purchase_order_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end AS `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` AS `purchase_order_creation_type`,
    `pt`.`gate_pass_no` AS `gate_pass_no`,
    `pt`.`gate_pass_date` AS `gate_pass_date`,
    `pt`.`vehicale_no` AS `vehicale_no`,
    `pt`.`vehicale_type` AS `vehicale_type`,
    `pt`.`gross_weight` AS `gross_weight`,
    `pt`.`tare_weight` AS `tare_weight`,
    `pt`.`net_weight` AS `net_weight`,
    `pt`.`variation_weight` AS `variation_weight`,
    `pt`.`deduction1_name` AS `deduction1_name`,
    `pt`.`deduction1_percent` AS `deduction1_percent`,
    `pt`.`deduction1_amount` AS `deduction1_amount`,
    `pt`.`deduction2_name` AS `deduction2_name`,
    `pt`.`deduction2_percent` AS `deduction2_percent`,
    `pt`.`deduction2_amount` AS `deduction2_amount`,
    `pt`.`deduction3_name` AS `deduction3_name`,
    `pt`.`deduction3_percent` AS `deduction3_percent`,
    `pt`.`deduction3_amount` AS `deduction3_amount`,
    `pt`.`deduction4_name` AS `deduction4_name`,
    `pt`.`deduction4_percent` AS `deduction4_percent`,
    `pt`.`deduction4_amount` AS `deduction4_amount`,
    `pt`.`deduction5_name` AS `deduction5_name`,
    `pt`.`deduction5_percent` AS `deduction5_percent`,
    `pt`.`deduction5_amount` AS `deduction5_amount`,
    `e1`.`employee_name` AS `grader_by_name`,
    `pt`.`remark` AS `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    `pt`.`agent_id` AS `agent_id`,
    `cc`.`supplier_name` AS `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` AS `supp_consignee_address1`,
    `cc`.`supp_branch_address2` AS `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` AS `supp_consignee_pincode`,
    `cc`.`city_name` AS `supp_consignee_city_name`,
    `cc`.`district_name` AS `supp_consignee_district_name`,
    `cc`.`state_name` AS `supp_consignee_state_name`,
    `pt`.`consignee_id` AS `consignee_id`,
    `pt`.`consignee_state_id` AS `consignee_state_id`,
    `pt`.`consignee_city_id` AS `consignee_city_id`,
    `pt`.`grader_by_id` AS `grader_by_id`,
    `pt`.`deduction5_id` AS `deduction5_id`,
    `pt`.`deduction4_id` AS `deduction4_id`,
    `pt`.`deduction3_id` AS `deduction3_id`,
    `pt`.`deduction2_id` AS `deduction2_id`,
    `pt`.`deduction1_id` AS `deduction1_id`,
    `pt`.`agent_paid_status` AS `agent_paid_status`
from
    (((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_master` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_supplier` `s` on
    (`s`.`company_branch_id` = `pt`.`company_branch_id`
        and `s`.`company_id` = `pt`.`company_id`
        and `s`.`supplier_id` = `pt`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_supplier_branch` `cc` on
    (`cc`.`company_branch_id` = `pt`.`company_branch_id`
        and `cc`.`company_id` = `pt`.`company_id`
        and `cc`.`supplier_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sdp`.`department_name` AS `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `pom`.`state_name` AS `supplier_state_name`,
    `c`.`customer_name` AS `customer_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`sub_department_id` AS `sub_department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    ((((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`
        and `e`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW ERP_PASHUPATI_PROD_1_0.ptv_purchase_order_details_rpt AS
select
    concat(ifnull(v.purchase_order_no, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') AS purchase_order_no,
    concat(ifnull(v.purchase_order_date, ''), ':Purchase Order Date:Y:D:') AS purchase_order_date,
    concat(ifnull(v.purchase_order_version, ''), ':Purchase Order Version:O:N:') AS purchase_order_version,
    concat(ifnull(v.purchase_order_item_status, ''), ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Bill Booked)') AS purchase_order_status_desc,
    concat(ifnull(v.purchase_order_type, ''), ':Purchase Order Type:O:N:') AS purchase_order_type,
    concat(ifnull(v.product_material_code, ''), ':Material Code:Y:T') AS product_material_code,
    concat(ifnull(v.product_material_name, ''), ':Material Name:Y:T') AS product_material_name,
    concat(ifnull(v.indent_no, ''), ':Indent No:Y:C:ptv_purchase_order_details:O') AS indent_no,
    concat(ifnull(v.indent_date, ''), ':Indent Date:Y:D:') AS indent_date,
    concat(ifnull(v.product_material_stock_unit_name, ''), ':Material Unit Name:O:N:') AS product_material_stock_unit_name,
    concat(ifnull(v.product_material_po_quantity, ''), ':Material Po Quantity:O:N:') AS product_material_po_quantity,
    concat(ifnull(v.product_material_po_weight, ''), ':Material Po Weight:O:N:') AS product_material_po_weight,
    concat(ifnull(v.material_rate, ''), ':Material Rate:O:N:') AS material_rate,
    concat(ifnull(v.material_basic_amount, ''), ':Material Basic Amount:O:N:') AS material_basic_amount,
    concat(ifnull(v.material_discount_percent, ''), ':Material Discount Percent:O:N:') AS material_discount_percent,
    concat(ifnull(v.material_discount_amount, ''), ':Material Discount Amount:O:N:') AS material_discount_amount,
    concat(ifnull(v.material_taxable_amount, ''), ':Material Taxable Amount:O:N:') AS material_taxable_amount,
    concat(ifnull(v.material_cgst_percent, ''), ':Material Cgst Percent:O:N:') AS material_cgst_percent,
    concat(ifnull(v.material_cgst_total, ''), ':Material Cgst Total:O:N:') AS material_cgst_total,
    concat(ifnull(v.material_sgst_percent, ''), ':Material Sgst Percent:O:N:') AS material_sgst_percent,
    concat(ifnull(v.material_sgst_total, ''), ':Material Sgst Total:O:N:') AS material_sgst_total,
    concat(ifnull(v.material_igst_percent, ''), ':Material Igst Percent:O:N:') AS material_igst_percent,
    concat(ifnull(v.material_igst_total, ''), ':Material Igst Total:O:N:') AS material_igst_total,
    concat(ifnull(v.material_total_amount, ''), ':Material Total Amount:O:N:') AS material_total_amount,
    concat(ifnull(v.product_material_po_approved_quantity, ''), ':Material Po Approved Quantity:O:N:') AS product_material_po_approved_quantity,
    concat(ifnull(v.product_material_po_approved_weight, ''), ':Material Po Approved Weight:O:N:') AS product_material_po_approved_weight,
    concat(ifnull(v.product_material_po_rejected_quantity, ''), ':Material Po Rejected Quantity:O:N:') AS product_material_po_rejected_quantity,
    concat(ifnull(v.product_material_po_rejected_weight, ''), ':Material Po Rejected Weight:O:N:') AS product_material_po_rejected_weight,
    concat(ifnull(v.material_po_approval_remark, ''), ':Material Po Approval Remark:O:N:') AS material_po_approval_remark,
    concat(ifnull(v.purchase_order_mail_sent_status, ''), ':Purchase Order Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') AS purchase_order_mail_sent_status_desc,
    concat(ifnull(v.material_schedule_date, ''), ':Material Schedule Date:Y:D:') AS material_schedule_date,
    concat(ifnull(v.approved_date, ''), ':Approved Date:Y:D:') AS approved_date,
    concat(ifnull(v.approved_by_name, ''), ':Approved By:Y:C:cmv_employee_list:F') AS approved_by_name,
    concat(ifnull(v.department_name, ''), ':Department Name:Y:C:cmv_department:F') AS department_name,
    concat(ifnull(v.sub_department_name, ''), ':Sub Department Name:Y:C:cmv_department:F') AS sub_department_name,
    concat(ifnull(v.hsn_sac_code, ''), ':Hsn Sac Code:O:N:') AS hsn_sac_code,
    concat(ifnull(v.hsn_sac_rate, ''), ':Hsn Sac Rate:O:N:') AS hsn_sac_rate,
    concat(ifnull(v.pree_closed_quantity, ''), ':Pree Closed Quantity:O:N:') AS pree_closed_quantity,
    concat(ifnull(v.pree_closed_weight, ''), ':Pree Closed Weight:O:N:') AS pree_closed_weight,
    concat(ifnull(v.purchase_return_quantity, ''), ':Purchase Return Quantity:O:N:') AS purchase_return_quantity,
    concat(ifnull(v.purchase_return_weight, ''), ':Purchase Return Weight:O:N:') AS purchase_return_weight,
    concat(ifnull(v.pending_quantity, ''), ':Pending Quantity:O:N:') AS pending_quantity,
    concat(ifnull(v.pending_weight, ''), ':Pending Weight:O:N:') AS pending_weight,
    concat(ifnull(v.excess_quantity, ''), ':Excess Quantity:O:N:') AS excess_quantity,
    concat(ifnull(v.excess_weight, ''), ':Excess Weight:O:N:') AS excess_weight,
    concat(ifnull(v.production_issue_quantity, ''), ':Issue Quantity:O:N:') AS production_issue_quantity,
    concat(ifnull(v.production_issue_weight, ''), ':Issue Weight:O:N:') AS production_issue_weight,
    concat(ifnull(v.production_issue_return_quantity, ''), ':Issue Return Quantity:O:N:') AS production_issue_return_quantity,
    concat(ifnull(v.production_issue_return_weight, ''), ':Issue Return Weight:O:N:') AS production_issue_return_weight,
    concat(ifnull(v.production_issue_rejection_quantity, ''), ':Issue Rejection Quantity:O:N:') AS production_issue_rejection_quantity,
    concat(ifnull(v.production_issue_rejection_weight, ''), ':Issue Rejection Weight:O:N:') AS production_issue_rejection_weight,
    concat(ifnull(v.assembly_production_issue_quantity, ''), ':Assembly Production Issue Quantity:O:N:') AS assembly_production_issue_quantity,
    concat(ifnull(v.assembly_production_issue_weight, ''), ':Assembly Production Issue Weight:O:N:') AS assembly_production_issue_weight,
    concat(ifnull(v.sales_quantity, ''), ':Sales Quantity:O:N:') AS sales_quantity,
    concat(ifnull(v.sales_weight, ''), ':Sales Weight:O:N:') AS sales_weight,
    concat(ifnull(v.sales_return_quantity, ''), ':Sales Return Quantity:O:N:') AS sales_return_quantity,
    concat(ifnull(v.sales_return_weight, ''), ':Sales Return Weight:O:N:') AS sales_return_weight,
    concat(ifnull(v.sales_rejection_quantity, ''), ':Sales Rejection Quantity:O:N:') AS sales_rejection_quantity,
    concat(ifnull(v.sales_rejection_weight, ''), ':Sales Rejection Weight:O:N:') AS sales_rejection_weight,
    concat(ifnull(v.transfer_issue_quantity, ''), ':Transfer Issue Quantity:O:N:') AS transfer_issue_quantity,
    concat(ifnull(v.transfer_issue_weight, ''), ':Transfer Issue Weight:O:N:') AS transfer_issue_weight,
    concat(ifnull(v.transfer_receipt_quantity, ''), ':Transfer Receipt Quantity:O:N:') AS transfer_receipt_quantity,
    concat(ifnull(v.transfer_receipt_weight, ''), ':Transfer Receipt Weight:O:N:') AS transfer_receipt_weight,
    concat(ifnull(v.outsources_out_quantity, ''), ':Outsources Out Quantity:O:N:') AS outsources_out_quantity,
    concat(ifnull(v.outsources_out_weight, ''), ':Outsourcess Out Weight:O:N:') AS outsources_out_weight,
    concat(ifnull(v.outsources_in_quantity, ''), ':Outsources In Quantity:O:N:') AS outsources_in_quantity,
    concat(ifnull(v.outsources_in_weight, ''), ':Outsources In Weight:O:N:') AS outsources_in_weight,
    concat(ifnull(v.outsources_rejection_quantity, ''), ':Outsources Rejection Quantity:O:N:') AS outsources_rejection_quantity,
    concat(ifnull(v.outsources_rejection_weight, ''), ':Outsources Rejection Weight:O:N:') AS outsources_rejection_weight,
    concat(ifnull(v.loan_receipt_quantity, ''), ':Loan Receipt Quantity:O:N:') AS loan_receipt_quantity,
    concat(ifnull(v.loan_receipt_weight, ''), ':Loan Receipt Weight:O:N:') AS loan_receipt_weight,
    concat(ifnull(v.loan_issue_quantity, ''), ':Loan Issue Quantity:O:N:') AS loan_issue_quantity,
    concat(ifnull(v.loan_issue_weight, ''), ':Loan Issue Weight:O:N:') AS loan_issue_weight,
    concat(ifnull(v.cancel_quantity, ''), ':Cancel Quantity:O:N:') AS cancel_quantity,
    concat(ifnull(v.cancel_weight, ''), ':Cancel Weight:O:N:') AS cancel_weight,
    concat(ifnull(v.prev_grn_quantity, ''), ':Prev GRN Quantity:O:N:') AS prev_grn_quantity,
    concat(ifnull(v.prev_grn_weight, ''), ':Prev GRN Quantity:O:N:') AS prev_grn_weight,
    concat(ifnull(v.difference_quantity, ''), ':Difference Quantity:O:N:') AS difference_quantity,
    concat(ifnull(v.difference_weight, ''), ':Difference Weight:O:N:') AS difference_weight,
    concat(ifnull(v.lead_time, ''), ':Lead Time:O:N:') AS lead_time,
    concat(ifnull(v.supplier_name, ''), ':Supplier Name:O:N:') AS supplier_name,
    concat(ifnull(v.supplier_state_name, ''), ':Supplier State Name:O:N:') AS supplier_state_name,
    concat(ifnull(v.customer_name, ''), ':Customer Name:O:N:') AS customer_name,
    concat(ifnull(v.indent_version, ''), ':Indent Version:O:N:') AS indent_version,
    concat(ifnull(v.indented_by_name, ''), ':Indented By:Y:C:cmv_employee_list:F') AS indented_by_name,
    concat(ifnull(v.sr_no, ''), ':Sr No:O:N:') AS sr_no,
    concat(ifnull(v.so_sr_no, ''), ':So Sr No:O:N:') AS so_sr_no,
    concat(ifnull(v.product_type_short_name, ''), ':Product Type Short Name:O:N:') AS product_type_short_name,
    concat(ifnull(v.product_type_group, ''), ':Product Type Group:O:N:') AS product_type_group,
    concat(ifnull(v.product_material_print_name, ''), ':Material Print Name:O:N:') AS product_material_print_name,
    concat(ifnull(v.product_material_tech_spect, ''), ':Material Tech Spect:O:N:') AS product_material_tech_spect,
    concat(ifnull(v.product_packing_name, ''), ':Product Packing Name:O:N:') AS product_packing_name,
    concat(ifnull(v.hsn_sac_type, ''), ':Hsn Sac Type:O:N:') AS hsn_sac_type,
    concat(ifnull(v.hsn_sac_description, ''), ':Hsn Sac Description:O:N:') AS hsn_sac_description,
    concat(ifnull(v.product_material_conversion_factor, ''), ':Material Conversion Factor:O:N:') AS product_material_conversion_factor,
    concat(ifnull(v.purchase_order_status, ''), ':Purchase Order Status:O:N:') AS purchase_order_status,
    concat(ifnull(v.purchase_order_item_status, ''), ':Purchase Order Item Status:O:N:') AS purchase_order_item_status,
    concat(ifnull(v.purchase_order_mail_sent_status, ''), ':Purchase Order Mail Sent Status:O:N:') AS purchase_order_mail_sent_status,
    concat(ifnull(v.remark, ''), ':Remark:O:N:') AS remark,
    concat(ifnull(v.city_name, ''), ':City Name:O:N:') AS city_name,
    concat(ifnull(v.district_name, ''), ':District Name:O:N:') AS district_name,
    concat(ifnull(v.company_name, ''), ':Company Name:Y:C:cmv_company_summary:F') AS company_name,
    concat(ifnull(v.company_branch_name, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS company_branch_name,
    concat(ifnull(v.financial_year, ''), ':Financial Year:Y:C:amv_financial_year:F') AS financial_year,
    concat(case when v.is_active = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS Active,
    concat(case when v.is_delete = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS Deleted,
    concat(ifnull(v.created_by, ''), ':Created By:O:N:') AS created_by,
    concat(ifnull(v.created_on, ''), ':Modified On:O:N:') AS created_on,
    concat(ifnull(v.modified_by, ''), ':Modified By:O:N:') AS modified_by,
    concat(ifnull(v.modified_on, ''), ':Modified On:O:N:') AS modified_on,
    concat(ifnull(v.deleted_by, ''), ':Deleted By:O:N:') AS deleted_by,
    concat(ifnull(v.deleted_on, ''), ':Deleted On:O:N:') AS deleted_on,
    concat(ifnull(v.company_id, ''), ':Company Id:N:N:') AS company_id,
    concat(ifnull(v.company_branch_id, ''), ':Company Branch Id:N:N:') AS company_branch_id,
    concat(ifnull(v.supplier_id, ''), ':Supplier Id:N:N:') AS supplier_id,
    concat(ifnull(v.supplier_state_id, ''), ':Supplier State Id:N:N:') AS supplier_state_id,
    concat(ifnull(v.supplier_city_id, ''), ':Supplier City Id:N:N:') AS supplier_city_id,
    concat(ifnull(v.supplier_contacts_ids, ''), ':Supplier Contacts Ids:N:N:') AS supplier_contacts_ids,
    concat(ifnull(v.purchase_order_type_id, ''), ':Purchase Order Type Id:N:N:') AS purchase_order_type_id,
    concat(ifnull(v.purchase_order_master_transaction_id, ''), ':Purchase Order Master Transaction Id:O:N:') AS purchase_order_master_transaction_id,
    concat(ifnull(v.purchase_order_details_transaction_id, ''), ':Purchase Order Details Transaction_id:N:N:') AS purchase_order_details_transaction_id,
    concat(ifnull(v.product_material_id, ''), ':Product Material Id:N:N:') AS product_material_id,
    concat(ifnull(v.product_material_unit_id, ''), ':Product Material Unit Id:N:N:') AS product_material_unit_id,
    concat(ifnull(v.product_material_packing_id, ''), ':Product Material Packing Id:N:N:') AS product_material_packing_id,
    concat(ifnull(v.product_material_hsn_code_id, ''), ':Product Material Hsn Code Id:N:N:') AS product_material_hsn_code_id,
    concat(ifnull(v.department_id, ''), ':Department Id:N:N:') AS department_id,
    concat(ifnull(v.indented_by_id, ''), ':Indented By Id:N:N:') AS indented_by_id,
    concat(ifnull(v.approved_by_id, ''), ':Approved By Id:N:N:') AS approved_by_id
from
    ERP_PASHUPATI_PROD_1_0.ptv_purchase_order_details v
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary_rpt` AS
select
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:C:ptv_goods_receipt_summary:O') AS `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_date`, ''), ':Goods Receipt Date:Y:D:') AS `goods_receipt_date`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt version:O:N:') AS `goods_receipt_version`,
    concat(ifnull(`v`.`goods_receipt_type`, ''), ':Goods Receipt Type:O:N:') AS `goods_receipt_type`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:Y:H:(GRN Done,QC Done,Rejected,Partial Receipt,Completed,Canceled,GRN)') AS `goods_receipt_status_desc`,
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') AS `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') AS `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') AS `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:N:(Close,Open)') AS `purchase_order_life_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') AS `supplier_name`,
    concat(ifnull(`v`.`supplier_challan_no`, ''), ':Supplier Challan No:O:N:') AS `supplier_challan_no`,
    concat(ifnull(`v`.`supplier_challan_date`, ''), ':Supplier Challan Date:Y:D:') AS `supplier_challan_date`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') AS `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') AS `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') AS `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') AS `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') AS `packing_amount`,
    concat(ifnull(`v`.`goods_receipt_discount_percent`, ''), ':Discount Percent:O:N:') AS `goods_receipt_discount_percent`,
    concat(ifnull(`v`.`goods_receipt_discount_amount`, ''), ':Discount Amount:O:N:') AS `goods_receipt_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') AS `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') AS `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':Cgst Total:O:N:') AS `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':Sgst Total:O:N:') AS `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':Igst Total:O:N:') AS `igst_total`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') AS `grand_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':Roundoff:O:N:') AS `roundoff`,
    concat(ifnull(`v`.`supplier_invoice_no`, ''), ':Supplier Invoice No:O:N:') AS `supplier_invoice_no`,
    concat(ifnull(`v`.`supplier_invoice_date`, ''), ':Supplier Invoice Date:Y:D:') AS `supplier_invoice_Date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`qa_by_name`, ''), ':QA By:Y:C:cmv_employee_list:F') AS `qa_by_name`,
    concat(ifnull(`v`.`qa_date`, ''), ':QA Date:Y:D:') AS `qa_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`lr_no`, ''), ':LR No:O:N:') AS `lr_no`,
    concat(ifnull(`v`.`lr_date`, ''), ':LR Date:Y:D:') AS `lr_date`,
    concat(ifnull(`v`.`vehicle_no`, ''), ':Vehicle No:O:N:') AS `vehicle_no`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') AS `other_terms_conditions`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') AS `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') AS `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:O:N:') AS `agent_paid_status`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:Y:C:cmv_state:F') AS `supplier_state_name`,
    concat(ifnull(`v`.`supplier_city_name`, ''), ':Supplier City Name:Y:C:cmv_city:F') AS `supplier_city_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:O:N:') AS `goods_receipt_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`goods_receipt_master_transaction_id`, ''), ':Goods Receipt Master Transaction Id:O:N:') AS `goods_receipt_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') AS `agent_id`,
    concat(ifnull(`v`.`qa_by_id`, ''), ':QA By Id:N:N:') AS `qa_by_id`,
    concat(ifnull(`v`.`indent_by_id`, ''), ':Indent By Id:N:N:') AS `indent_by_id`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:N:N:') AS `purchase_order_life`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:N:N:') AS `approved_by_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') AS `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') AS `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') AS `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') AS `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') AS `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') AS `expected_branch_city_id`,
    concat(ifnull(`v`.`goods_receipt_type_id`, ''), ':Goods Receipt Type Id:N:N:') AS `goods_receipt_type_id`,
    concat(ifnull(`v`.`payment_term_id`, ''), ':Payment Term Id:N:N:') AS `payment_term_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`ptv_goods_receipt_summary` `v`
limit 1;


-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details_rpt` AS
select
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(ifnull(`v`.`issue_date`, ''), ':Issue Date:Y:D:') AS `issue_date`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version:O:N:') AS `issue_version`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') AS `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') AS `indent_version`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indented By Name:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T:') AS `product_material_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:O:N:') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:O:N:') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`issue_item_status_desc`, ''), ':Issue Status:Y:H:(Pending,Completed)') AS `issue_item_status_desc`,
    concat(ifnull(`v`.`product_material_indent_quantity`, ''), ':Material Requisition Quantity:Y:T:') AS `product_material_indent_quantity`,
    concat(ifnull(`v`.`product_material_indent_weight`, ''), ':Material Requisition Weight:Y:T:') AS `product_material_indent_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:Y:T:') AS `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:Y:T:') AS `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:Y:T:') AS `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:Y:T:') AS `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:Y:T:') AS `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:Y:T:') AS `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_issue_return_quantity`, ''), ':Material Issue Return Quantity:Y:T:') AS `product_material_issue_return_quantity`,
    concat(ifnull(`v`.`product_material_issue_return_weight`, ''), ':Material Return Weight:Y:T:)') AS `product_material_issue_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:Y:T:)') AS `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:Y:T:)') AS `product_material_receipt_weight`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`material_batch_rate`, ''), ':Material Rate:Y:T:') AS `material_batch_rate`,
    concat(ifnull(`v`.`material_issue_amount`, ''), ':Material Issue Amount:Y:T:') AS `material_issue_amount`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_state_name`, ''), ':State Name:O:N:') AS `customer_state_name`,
    concat(ifnull(`v`.`cust_branch_gst_no`, ''), ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`issue_remark`, ''), ':Remark:O:N:') AS `issue_remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`issue_master_transaction_id`, ''), ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(ifnull(`v`.`issue_details_transaction_id`, ''), ':Issue Details Transaction_Id:O:N:') AS `issue_details_transaction_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') AS `product_material_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_1_0`.`stv_indent_material_issue_details` `v`
limit 1;


-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_summary_rpt` AS
select
    concat(ifnull(`v`.`issue_group_type`, ''), ':Issue Group Type:Y:P:IssueGroupTypes') AS `issue_group_type`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(ifnull(`v`.`issue_date`, ''), ':Issue Date:Y:D:') AS `issue_date`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version:O:N:') AS `issue_version`,
    concat(ifnull(`v`.`issue_status_desc`, ''), ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Approved,Pending)') AS `issue_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(ifnull(`v`.`requisition_by_name`, ''), ':Requisition By Name:Y:C:cmv_employee:F') AS `requisition_by_name`,
    concat(ifnull(`v`.`requisition_date`, ''), ':Requisition Date:Y:D:') AS `requisition_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By Name:Y:C:cmv_employee:F') AS `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issue By Name:Y:C:cmv_employee:F') AS `issued_by_name`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_state_name`, ''), ':Customer State Name:O:N:') AS `customer_state_name`,
    concat(ifnull(`v`.`cust_branch_gst_no`, ''), ':Customer Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`issue_status`, ''), ':Issue Status:O:N:') AS `issue_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`issue_master_transaction_id`, ''), ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version Id:N:N:') AS `field_id`
from
    `stv_indent_material_issue_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_details_rpt` AS
select
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(ifnull(`v`.`issue_date`, ''), ':Issue Date:Y:D:') AS `issue_date`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version:O:N:') AS `issue_version`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T:') AS `product_material_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:O:N:') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:O:N:') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`issue_item_status_desc`, ''), ':Issue Status:Y:H:(Pending,Completed)') AS `issue_item_status_desc`,
    concat(ifnull(`v`.`product_material_indent_quantity`, ''), ':Material Requisition Quantity:O:N:') AS `product_material_indent_quantity`,
    concat(ifnull(`v`.`product_material_indent_weight`, ''), ':Material Requisition Weight:O:N:') AS `product_material_indent_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') AS `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') AS `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_issue_return_quantity`, ''), ':Material Issue Return Quantity:O:N:') AS `product_material_issue_return_quantity`,
    concat(ifnull(`v`.`product_material_issue_return_weight`, ''), ':Material Return Weight:O:N:)') AS `product_material_issue_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:)') AS `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:)') AS `product_material_receipt_weight`,
    concat(ifnull(`v`.`material_batch_rate`, ''), ':Material Rate:Y:T:') AS `material_batch_rate`,
    concat(ifnull(`v`.`material_issue_amount`, ''), ':Material Issue Amount:Y:T:') AS `material_issue_amount`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indented By Name:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_state_name`, ''), ':State Name:O:N:') AS `customer_state_name`,
    concat(ifnull(`v`.`cust_branch_gst_no`, ''), ':Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`issue_remark`, ''), ':Remark:O:N:') AS `issue_remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`issue_master_transaction_id`, ''), ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(ifnull(`v`.`issue_details_transaction_id`, ''), ':Issue Details Transaction_Id:O:N:') AS `issue_details_transaction_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') AS `product_material_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version Id:N:N:') AS `field_id`
from
    `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `e`.`email_id1` AS `indented_by_email`,
    `e1`.`email_id1` AS `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`st_indent_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`company_id` = `st`.`company_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_PASHUPATI_PROD_1_0.sm_product_stock_adjustment_details ADD godown_section_id BIGINT(20) NULL;
ALTER TABLE ERP_PASHUPATI_PROD_1_0.sm_product_stock_adjustment_details CHANGE godown_section_id godown_section_id BIGINT(20) NULL AFTER godown_id;
ALTER TABLE ERP_PASHUPATI_PROD_1_0.sm_product_stock_adjustment_details ADD godown_section_beans_id BIGINT(20) NULL;
ALTER TABLE ERP_PASHUPATI_PROD_1_0.sm_product_stock_adjustment_details CHANGE godown_section_beans_id godown_section_beans_id BIGINT(20) NULL AFTER godown_section_id;

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_PROD_1_0.smv_product_stock_adjustment_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_stock_adjustment_details` AS
select
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `sm`.`stock_adjustment_type` AS `stock_adjustment_type`,
    `sm`.`stock_quantity` AS `stock_quantity`,
    `sm`.`stock_weight` AS `stock_weight`,
    `sm`.`stock_adjustment_quantity` AS `stock_adjustment_quantity`,
    `sm`.`stock_adjustment_weight` AS `stock_adjustment_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`stock_date` AS `stock_date`,
    `sa`.`adjustment_by` AS `adjustment_by`,
    `sa`.`adjustment_reason` AS `adjustment_reason`,
    `sa`.`approved_by` AS `approved_by`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`stock_adjustment_transaction_id` AS `stock_adjustment_transaction_id`,
    `sm`.`stock_adjustment_details_transaction_id` AS `stock_adjustment_details_transaction_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_material_id` AS `product_material_id`
from
    (((((`sm_product_stock_adjustment_details` `sm`
left join `sm_product_stock_adjustment_master` `sa` on
    (`sa`.`stock_adjustment_transaction_id` = `sm`.`stock_adjustment_transaction_id`
        and `sa`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `sm`.`product_material_id`
        and `rm_fg_sr`.`company_id` = `sm`.`company_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`));

-------------------------------------------------------------------------------------------------------------------------------
16-07-24

-- mtv_sales_order_details_services source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_details_services` AS
select
    `mtm`.`sales_order_type` AS `sales_order_type`,
    case
        `mtm`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mtm`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mtm`.`sales_order_no` AS `sales_order_no`,
    `mtm`.`sales_order_date` AS `sales_order_date`,
    `mtm`.`sales_order_version` AS `sales_order_version`,
    `vp`.`department_name` AS `department_name`,
    case
        `mtm`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    case
        `mtm`.`sales_order_acceptance_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mtm`.`sales_order_mail_sent_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`product_type` AS `product_type`,
    `sr`.`product_sr_name` AS `product_material_name`,
    `sr`.`product_sr_std_price` AS `product_std_price`,
    `sr`.`product_sr_std_hours` AS `product_std_hours`,
    `sr`.`product_sr_std_profit_percent` AS `product_std_profit_percent`,
    `sr`.`process_duration` AS `process_duration`,
    `mt`.`product_material_print_name` AS `product_material_print_name`,
    `mt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `mt`.`sr_no` AS `sr_no`,
    `mt`.`so_sr_no` AS `so_sr_no`,
    `u`.`product_unit_name` AS `product_material_unit_name`,
    `h`.`hsn_sac_code` AS `product_material_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `mt`.`quotation_rate` AS `quotation_rate`,
    `mt`.`material_rate` AS `material_rate`,
    `mt`.`so_rate` AS `so_rate`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`material_basic_amount` AS `material_basic_amount`,
    `mt`.`material_discount_percent` AS `material_discount_percent`,
    `mt`.`material_discount_amount` AS `material_discount_amount`,
    `mt`.`material_taxable_amount` AS `material_taxable_amount`,
    `mt`.`material_cgst_percent` AS `material_cgst_percent`,
    `mt`.`material_cgst_total` AS `material_cgst_total`,
    `mt`.`material_sgst_percent` AS `material_sgst_percent`,
    `mt`.`material_sgst_total` AS `material_sgst_total`,
    `mt`.`material_igst_percent` AS `material_igst_percent`,
    `mt`.`material_igst_total` AS `material_igst_total`,
    `mt`.`material_total_amount` AS `material_total_amount`,
    `mt`.`material_schedule_date` AS `material_schedule_date`,
    case
        `mt`.`sales_order_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_item_status_desc`,
    `mt`.`sales_order_item_status` AS `sales_order_item_status`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`dispatch_note_nos` AS `dispatch_note_nos`,
    `mt`.`dispatch_challan_nos` AS `dispatch_challan_nos`,
    `mt`.`invoice_nos` AS `invoice_nos`,
    `mtm`.`sales_order_life` AS `sales_order_life`,
    `mtm`.`sales_order_status` AS `sales_order_status`,
    `mtm`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mtm`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `mtm`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`remark` AS `remark`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`,
    `mt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `mt`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_details_services` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_services` `mtm` on
    (`mtm`.`sales_order_master_transaction_id` = `mt`.`sales_order_master_transaction_id`
        and `mtm`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `mtm`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mtm`.`company_id`
        and `c`.`company_branch_id` = `mtm`.`company_branch_id`
        and `c`.`customer_id` = `mtm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mtm`.`company_id`
        and `cc`.`company_branch_id` = `mtm`.`company_branch_id`
        and `cc`.`customer_id` = `mtm`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_sr` `sr` on
    (`sr`.`company_branch_id` = `mt`.`company_branch_id`
        and `sr`.`company_id` = `mt`.`company_id`
        and `sr`.`product_sr_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `mt`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `mt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_projects_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_projects_summary` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `c`.`country_name` AS `customer_country_name`,
    `cc`.`country_name` AS `consignee_country_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_projects` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_services_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_services_summary` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mt`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`country_name` AS `customer_country_name`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`country_name` AS `consignee_country_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `mt`.`sales_order_life` AS `sales_order_life`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_services` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`
        and `mt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_trading_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` AS
select
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mt`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Order Accepted'
        when 'X' then 'Order Cancelled'
        else 'Aceptance Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `cc`.`cust_branch_gst_no` AS `consignee_gst_no`,
    `cc`.`cust_branch_pan_no` AS `consignee_pan_no`,
    `cc`.`cust_branch_phone_no` AS `consignee_phone_no`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`sales_order_type` AS `sales_order_type`,
    `mt`.`sales_order_life` AS `sales_order_life`,
    `mt`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_pincode` AS `company_pincode`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`state_name` AS `company_branch_state`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`mt`.`sales_order_type_id` = `pt`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`
        and `vp`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_works_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_works_summary` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`country_name` AS `consignee_country_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`country_name` AS `customer_country_name`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_works` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`
        and `mt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`
        and `vp`.`company_branch_id` = `mt`.`company_branch_id`
        and `vp`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_works_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_works_summary` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`state_name` AS `customer_state_name`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`country_name` AS `consignee_country_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`country_name` AS `customer_country_name`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    ((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_works` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`
        and `mt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_product_dynamic_parameters source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_product_dynamic_parameters` AS
select
    `b`.`sales_order_no` AS `sales_order_no`,
    `b`.`sales_order_date` AS `sales_order_date`,
    `rm_fg_sr`.`product_type_name` AS `product_type_name`,
    `rm_fg_sr`.`product_type_group` AS `product_type_group`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `b`.`product_parameter_name` AS `product_parameter_name`,
    `b`.`product_parameter_value` AS `product_parameter_value`,
    `b`.`product_parameter_actual_value` AS `product_parameter_actual_value`,
    `b`.`product_parameter_prefix` AS `product_parameter_prefix`,
    `b`.`product_parameter_sufix` AS `product_parameter_sufix`,
    `b`.`product_parameter_calculation_type` AS `product_parameter_calculation_type`,
    `b`.`product_parameter_from_value` AS `product_parameter_from_value`,
    `b`.`product_parameter_to_value` AS `product_parameter_to_value`,
    `b`.`product_parameter_formula` AS `product_parameter_formula`,
    `b`.`so_sr_no` AS `so_sr_no`,
    `b`.`customer_order_no` AS `customer_order_no`,
    `b`.`remark` AS `remark`,
    `d`.`control_master` AS `control_master`,
    `d`.`control_type` AS `control_type`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`sales_order_version` AS `sales_order_version`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`company_branch_id` AS `company_branch_id`,
    `b`.`product_id` AS `product_id`,
    `b`.`product_type_id` AS `product_type_id`,
    `b`.`sales_order_parameter_id` AS `sales_order_parameter_id`,
    `b`.`product_parameter_id` AS `product_parameter_id`,
    `b`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `b`.`sales_order_parameter_id` AS `field_id`,
    `b`.`product_parameter_name` AS `field_name`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_product_dynamic_parameters` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `b`.`company_id`
        and `v`.`company_branch_id` = `b`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_dynamic_parameters` `d` on
    (`d`.`product_parameter_id` = `b`.`product_parameter_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `b`.`product_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_tax_summary_services source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_tax_summary_services` AS
select
    `mt`.`sales_order_type` AS `sales_order_type`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `cb`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`state_name` AS `expected_branch_state_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`summary_taxable_amount` AS `summary_taxable_amount`,
    `mt`.`summary_cgst_percent` AS `summary_cgst_percent`,
    `mt`.`summary_cgst_total` AS `summary_cgst_total`,
    `mt`.`summary_sgst_percent` AS `summary_sgst_percent`,
    `mt`.`summary_sgst_total` AS `summary_sgst_total`,
    `mt`.`summary_igst_percent` AS `summary_igst_percent`,
    `mt`.`summary_igst_total` AS `summary_igst_total`,
    `mt`.`summary_total_amount` AS `summary_total_amount`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_tax_summary_transaction_id` AS `sales_order_tax_summary_transaction_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`expected_branch_id` AS `expected_branch_id`,
    `mt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `mt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `mt`.`hsn_code_id` AS `hsn_code_id`
from
    (((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_tax_summary_services` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `mt`.`company_branch_id`
        and `cb`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`is_delete` = 0
        and `hsn`.`hsn_sac_id` = `mt`.`hsn_code_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_quotation_details_services source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_quotation_details_services` AS
select
    `mt`.`financial_year` AS `financial_year`,
    `mt`.`quotation_type` AS `quotation_type`,
    case
        `mt`.`quotation_transaction_type` when 'E' then 'Enquiry Based'
        else 'Mannual'
    end AS `quotation_transaction_type_desc`,
    `mt`.`quotation_transaction_type` AS `quotation_transaction_type`,
    `mt`.`quotation_no` AS `quotation_no`,
    `mt`.`quotation_version` AS `quotation_version`,
    `mt`.`quotation_date` AS `quotation_date`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `dp`.`department_name` AS `department_name`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `eq`.`employee_name` AS `quotation_by_name`,
    `e`.`employee_name` AS `enquiry_by_name`,
    `e1`.`employee_name` AS `assign_to_head_name`,
    `e2`.`employee_name` AS `assign_to_name`,
    `e3`.`employee_name` AS `approved_by_name`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    `mt`.`quotation_material_cost` AS `quotation_material_cost`,
    `mt`.`quotation_process_cost` AS `quotation_process_cost`,
    `mt`.`quotation_labour_cost` AS `quotation_labour_cost`,
    `mt`.`quotation_other_cost` AS `quotation_other_cost`,
    `mt`.`quotation_other_cost_remark` AS `quotation_other_cost_remark`,
    `mt`.`quotation_administration_percent` AS `quotation_administration_percent`,
    `mt`.`quotation_administration_cost` AS `quotation_administration_cost`,
    `mt`.`quotation_profit_percent` AS `quotation_profit_percent`,
    `mt`.`quotation_profit_cost` AS `quotation_profit_cost`,
    `mt`.`quotation_discount_percent` AS `quotation_discount_percent`,
    `mt`.`quotation_discount_cost` AS `quotation_discount_cost`,
    `mt`.`quotation_taxable_cost` AS `quotation_taxable_cost`,
    `mt`.`quotation_cgst_cost` AS `quotation_cgst_cost`,
    `mt`.`quotation_sgst_cost` AS `quotation_sgst_cost`,
    `mt`.`quotation_igst_cost` AS `quotation_igst_cost`,
    `mt`.`quotation_total_cost` AS `quotation_total_cost`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    case
        `mt`.`quotation_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'Q' then 'Quotaion'
        when 'O' then 'Order Confirm'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `quotation_status_desc`,
    `mt`.`quotation_status` AS `quotation_status`,
    `mtd`.`enquiry_no` AS `enquiry_no`,
    `mtd`.`enquiry_date` AS `enquiry_date`,
    `mtd`.`enquiry_version` AS `enquiry_version`,
    `mtd`.`sr_no` AS `sr_no`,
    `mtd`.`product_type_short_name` AS `product_type_short_name`,
    `sr`.`product_type_name` AS `product_type_name`,
    `sr`.`product_sr_code` AS `product_sr_code`,
    `sr`.`product_sr_name` AS `product_sr_name`,
    `sr`.`product_sr_tech_spect` AS `product_sr_tech_spect`,
    `sr`.`product_sr_std_hours` AS `product_sr_std_hours`,
    `h`.`hsn_sac_code` AS `product_sr_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_sr_hsn_sac_rate`,
    `mtd`.`hsn_sac_percent` AS `hsn_sac_percent`,
    `mtd`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `mtd`.`product_material_print_name` AS `product_material_print_name`,
    `u`.`product_unit_name` AS `product_material_unit_name`,
    `mtd`.`process_duration` AS `process_duration`,
    `mtd`.`product_material_quotation_quantity` AS `product_material_quotation_quantity`,
    `mtd`.`product_material_quotation_weight` AS `product_material_quotation_weight`,
    `mtd`.`product_material_moq_quantity` AS `product_material_moq_quantity`,
    `mtd`.`material_std_rate` AS `material_std_rate`,
    `mtd`.`product_material_notes` AS `product_material_notes`,
    `mtd`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `mtd`.`expected_lead_time` AS `expected_lead_time`,
    `mtd`.`material_expected_schedule_date` AS `material_expected_schedule_date`,
    `mtd`.`product_fg_bom_no` AS `product_fg_bom_no`,
    `mtd`.`product_fg_bom_version` AS `product_fg_bom_version`,
    `mtd`.`product_costing_no` AS `product_costing_no`,
    `mtd`.`item_material_cost` AS `item_material_cost`,
    `mtd`.`item_process_cost` AS `item_process_cost`,
    `mtd`.`item_labour_cost` AS `item_labour_cost`,
    `mtd`.`item_administration_percent` AS `item_administration_percent`,
    `mtd`.`item_administration_cost` AS `item_administration_cost`,
    `mtd`.`item_profit_percent` AS `item_profit_percent`,
    `mtd`.`item_profit_cost` AS `item_profit_cost`,
    `mtd`.`item_other_cost` AS `item_other_cost`,
    `mtd`.`item_other_cost_remark` AS `item_other_cost_remark`,
    `mtd`.`item_discount_percent` AS `item_discount_percent`,
    `mtd`.`item_discount_cost` AS `item_discount_cost`,
    `mtd`.`item_taxable_cost` AS `item_taxable_cost`,
    `mtd`.`item_cgst_percent` AS `item_cgst_percent`,
    `mtd`.`item_cgst_cost` AS `item_cgst_cost`,
    `mtd`.`item_sgst_percent` AS `item_sgst_percent`,
    `mtd`.`item_sgst_cost` AS `item_sgst_cost`,
    `mtd`.`item_igst_percent` AS `item_igst_percent`,
    `mtd`.`item_igst_cost` AS `item_igst_cost`,
    `mtd`.`item_total_cost` AS `item_total_cost`,
    case
        `mtd`.`quotation_item_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'F' then 'FollowUp'
        when 'S' then 'Sales Order Receipt'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `quotation_item_status_desc`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `mtd`.`quotation_item_status` AS `quotation_item_status`,
    `mtd`.`material_item_approval_remark` AS `material_item_approval_remark`,
    `mtd`.`item_dispatch_note_nos` AS `item_dispatch_note_nos`,
    `mtd`.`item_dispatch_challan_nos` AS `item_dispatch_challan_nos`,
    `mtd`.`item_invoice_nos` AS `item_invoice_nos`,
    `mtd`.`item_terms_conditions` AS `item_terms_conditions`,
    `mtd`.`item_remark` AS `item_remark`,
    case
        `mtd`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `mtd`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mtd`.`is_active` AS `is_active`,
    `mtd`.`is_delete` AS `is_delete`,
    `mtd`.`created_by` AS `created_by`,
    `mtd`.`created_on` AS `created_on`,
    `mtd`.`modified_by` AS `modified_by`,
    `mtd`.`modified_on` AS `modified_on`,
    `mtd`.`deleted_by` AS `deleted_by`,
    `mtd`.`deleted_on` AS `deleted_on`,
    `mtd`.`quotation_details_transaction_id` AS `quotation_details_transaction_id`,
    `mtd`.`quotation_master_transaction_id` AS `quotation_master_transaction_id`,
    `mtd`.`company_id` AS `company_id`,
    `mtd`.`company_branch_id` AS `company_branch_id`,
    `mtd`.`quotation_type_id` AS `quotation_type_id`,
    `mtd`.`department_id` AS `department_id`,
    `mtd`.`product_material_id` AS `product_material_id`,
    `mtd`.`hsn_sac_id` AS `hsn_sac_id`,
    `sr`.`product_type_id` AS `product_type_id`,
    `mtd`.`product_material_unit_id` AS `product_material_unit_id`,
    `mtd`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_quotation_details_services` `mtd`
left join `ERP_PASHUPATI_DEV_1_0`.`mt_sales_quotation_master_services` `mt` on
    (`mt`.`company_branch_id` = `mtd`.`company_branch_id`
        and `mt`.`company_id` = `mtd`.`company_id`
        and `mt`.`quotation_master_transaction_id` = `mtd`.`quotation_master_transaction_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_branch_summary` `cb` on
    (`cb`.`company_branch_id` = `mt`.`company_branch_id`
        and `cb`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `dp` on
    (`dp`.`is_delete` = 0
        and `dp`.`department_id` = `mt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`company_branch_id` = `mt`.`company_branch_id`
        and `e`.`company_id` = `mt`.`company_id`
        and `e`.`employee_id` = `mt`.`enquiry_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `eq` on
    (`eq`.`company_branch_id` = `mt`.`company_branch_id`
        and `eq`.`company_id` = `mt`.`company_id`
        and `eq`.`employee_id` = `mt`.`quotation_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e1` on
    (`e1`.`company_branch_id` = `mt`.`company_branch_id`
        and `e1`.`company_id` = `mt`.`company_id`
        and `e1`.`employee_id` = `mt`.`assign_to_head_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e2` on
    (`e2`.`company_branch_id` = `mt`.`company_branch_id`
        and `e2`.`company_id` = `mt`.`company_id`
        and `e2`.`employee_id` = `mt`.`assign_to_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e3` on
    (`e3`.`company_branch_id` = `mt`.`company_branch_id`
        and `e3`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_sr` `sr` on
    (`sr`.`product_sr_id` = `mtd`.`product_material_id`
        and `sr`.`company_id` = `mtd`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `h` on
    (`h`.`is_delete` = 0
        and `h`.`hsn_sac_id` = `mtd`.`hsn_sac_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`is_delete` = 0
        and `u`.`product_unit_id` = `mtd`.`product_material_unit_id`))
where
    `mtd`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- mtv_sales_order_master_trading_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`mtv_sales_order_master_trading_summary` AS
select
    case
        `mt`.`sales_order_life` when 'C' then 'Closed'
        when 'O' then 'Open'
    end AS `sales_order_life_desc`,
    case
        `mt`.`sales_order_creation_type` when 'M' then 'Mannual'
        when 'Q' then 'Quotation Based'
    end AS `sales_order_creation_type_desc`,
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`sales_quotation_no` AS `sales_quotation_no`,
    case
        `mt`.`sales_order_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Issue'
        when 'Z' then 'PreeClosed'
        else 'Pending'
    end AS `sales_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    case
        `mt`.`sales_order_acceptance_status` when 'A' then 'Order Accepted'
        when 'X' then 'Order Cancelled'
        else 'Aceptance Pending'
    end AS `sales_order_acceptance_status_desc`,
    case
        `mt`.`sales_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `sales_order_mail_sent_status_desc`,
    `mt`.`overall_schedule_date` AS `overall_schedule_date`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `cc`.`customer_name` AS `consignee_name`,
    `cc`.`state_name` AS `consignee_state_name`,
    `cc`.`cust_branch_gst_no` AS `consignee_gst_no`,
    `cc`.`cust_branch_pan_no` AS `consignee_pan_no`,
    `cc`.`cust_branch_phone_no` AS `consignee_phone_no`,
    `cc`.`cust_branch_address1` AS `consignee_address1`,
    `e`.`employee_name` AS `approved_by_name`,
    `mt`.`approved_date` AS `approved_date`,
    `mt`.`basic_total` AS `basic_total`,
    `mt`.`transport_amount` AS `transport_amount`,
    `mt`.`freight_amount` AS `freight_amount`,
    `mt`.`packing_amount` AS `packing_amount`,
    `mt`.`discount_percent` AS `discount_percent`,
    `mt`.`discount_amount` AS `discount_amount`,
    `mt`.`other_amount` AS `other_amount`,
    `mt`.`taxable_total` AS `taxable_total`,
    `mt`.`cgst_percent` AS `cgst_percent`,
    `mt`.`cgst_total` AS `cgst_total`,
    `mt`.`sgst_percent` AS `sgst_percent`,
    `mt`.`sgst_total` AS `sgst_total`,
    `mt`.`igst_percent` AS `igst_percent`,
    `mt`.`igst_total` AS `igst_total`,
    `mt`.`roundoff` AS `roundoff`,
    `mt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `mt`.`agent_percent` AS `agent_percent`,
    case
        `mt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    `mt`.`sales_order_type` AS `sales_order_type`,
    `mt`.`sales_order_life` AS `sales_order_life`,
    `mt`.`sales_order_creation_type` AS `sales_order_creation_type`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `mt`.`status_remark` AS `status_remark`,
    `mt`.`sales_order_status` AS `sales_order_status`,
    `mt`.`agent_paid_status` AS `agent_paid_status`,
    `mt`.`other_terms_conditions` AS `other_terms_conditions`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_pincode` AS `company_pincode`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`state_name` AS `company_branch_state`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `mt`.`financial_year` AS `financial_year`,
    `c`.`cust_branch_EmailId` AS `customer_email`,
    `c`.`city_name` AS `customer_city_name`,
    `c`.`district_name` AS `customer_district_name`,
    `cc`.`city_name` AS `consignee_city_name`,
    `cc`.`district_name` AS `consignee_district_name`,
    `mt`.`is_freight_taxable` AS `is_freight_taxable`,
    `mt`.`sales_quotation_date` AS `sales_quotation_date`,
    `mt`.`sales_order_acceptance_status` AS `sales_order_acceptance_status`,
    `mt`.`sales_order_mail_sent_status` AS `sales_order_mail_sent_status`,
    case
        when `mt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `mt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_type_id` AS `sales_order_type_id`,
    `mt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `mt`.`customer_id` AS `customer_id`,
    `mt`.`customer_state_id` AS `customer_state_id`,
    `mt`.`customer_city_id` AS `customer_city_id`,
    `mt`.`consignee_id` AS `consignee_id`,
    `mt`.`consignee_state_id` AS `consignee_state_id`,
    `mt`.`consignee_city_id` AS `consignee_city_id`,
    `mt`.`department_id` AS `department_id`,
    `mt`.`sub_department_id` AS `sub_department_id`,
    `mt`.`approved_by_id` AS `approved_by_id`,
    `mt`.`agent_id` AS `agent_id`,
    `mt`.`customer_contacts_ids` AS `customer_contacts_ids`
from
    (((((((((`ERP_PASHUPATI_DEV_1_0`.`mt_sales_order_master_trading` `mt`
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_type` `pt` on
    (`mt`.`sales_order_type_id` = `pt`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer_summary` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `mt`.`department_id`
        and `vp`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `mt`.`sub_department_id`
        and `sd`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_employee` `e` on
    (`e`.`employee_id` = `mt`.`approved_by_id`
        and `e`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`company_id` = `mt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `mt`.`freight_hsn_code_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_packing source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` AS
select
    `b`.`product_packing_name` AS `product_packing_name`,
    `b`.`quantity_per_packing` AS `quantity_per_packing`,
    `b`.`weight_per_packing` AS `weight_per_packing`,
    `u`.`product_unit_name` AS `product_unit_name`,
    `v`.`company_legal_name` AS `company_name`,
    `b`.`remark` AS `remark`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `b`.`is_active` AS `is_active`,
    `b`.`is_delete` AS `is_delete`,
    `b`.`created_by` AS `created_by`,
    `b`.`created_on` AS `created_on`,
    `b`.`modified_by` AS `modified_by`,
    `b`.`modified_on` AS `modified_on`,
    `b`.`deleted_by` AS `deleted_by`,
    `b`.`deleted_on` AS `deleted_on`,
    `b`.`company_id` AS `company_id`,
    `b`.`product_packing_id` AS `product_packing_id`,
    `b`.`product_unit_id` AS `product_unit_id`,
    `b`.`product_packing_name` AS `field_name`,
    `b`.`product_packing_id` AS `field_id`
from
    ((`ERP_PASHUPATI_DEV_1_0`.`sm_product_packing` `b`
left join `ERP_PASHUPATI_DEV_1_0`.`sm_product_unit` `u` on
    (`u`.`is_delete` = 0
        and `u`.`product_unit_id` = `b`.`product_unit_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_company` `v` on
    (`v`.`company_id` = `b`.`company_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sdp`.`department_name` AS `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `pom`.`state_name` AS `supplier_state_name`,
    `c`.`customer_name` AS `customer_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
    `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_address1` AS `company_address1`,
    `v`.`company_address2` AS `company_address2`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`sub_department_id` AS `sub_department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    ((((((((((((((`ERP_PASHUPATI_DEV_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_customer` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown` `g` on
    (`g`.`company_id` = `pt`.`company_id`
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section` `gs` on
    (`gs`.`company_id` = `pt`.`company_id`
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`company_id` = `pt`.`company_id`
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_1_0`.`cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_PASHUPATI_DEV_TESTING_1_0.sm_product_stock_adjustment_details ADD goods_receipt_no varchar(100) NULL;
ALTER TABLE ERP_PASHUPATI_DEV_TESTING_1_0.sm_product_stock_adjustment_details ADD batch_expiry_date DATE NULL;

-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_stock_adjustment_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_stock_adjustment_details` AS
select
    `rm_fg_sr`.`product_material_code` AS `product_material_code`,
    `rm_fg_sr`.`product_material_name` AS `product_material_name`,
    `sm`.`stock_adjustment_type` AS `stock_adjustment_type`,
    `sm`.`stock_quantity` AS `stock_quantity`,
    `sm`.`stock_weight` AS `stock_weight`,
    `sm`.`stock_adjustment_quantity` AS `stock_adjustment_quantity`,
    `sm`.`stock_adjustment_weight` AS `stock_adjustment_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`stock_date` AS `stock_date`,
    `sa`.`adjustment_by` AS `adjustment_by`,
    `sa`.`adjustment_reason` AS `adjustment_reason`,
    `sa`.`approved_by` AS `approved_by`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`stock_adjustment_transaction_id` AS `stock_adjustment_transaction_id`,
    `sm`.`stock_adjustment_details_transaction_id` AS `stock_adjustment_details_transaction_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_material_id` AS `product_material_id`
from
    (((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_stock_adjustment_details` `sm`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_stock_adjustment_master` `sa` on
    (`sa`.`stock_adjustment_transaction_id` = `sm`.`stock_adjustment_transaction_id`
        and `sa`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `sm`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`));
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_stock_adjustment_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_stock_adjustment_details_rpt` AS
select
    concat(ifnull(`v`.`product_material_code`, ''), ':Product Material Code:Y:C:smv_product_stock_adjustment_details:O:') AS `product_material_code`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Product Material Name:Y:C:smv_product_stock_adjustment_details:O:') AS `product_material_name`,
    concat(ifnull(`v`.`stock_adjustment_type`, ''), ':Stock Adjustment Type:O:N:') AS `stock_adjustment_type`,
    concat(ifnull(`v`.`stock_quantity`, ''), ':Stock Quantity:Y:T:') AS `stock_quantity`,
    concat(ifnull(`v`.`stock_weight`, ''), ':Stock Weight:Y:T:') AS `stock_weight`,
    concat(ifnull(`v`.`stock_adjustment_quantity`, ''), ':Stock Adjustment Quantity:Y:T:') AS `stock_adjustment_quantity`,
    concat(ifnull(`v`.`stock_adjustment_weight`, ''), ':Stock Adjustment Weight:Y:T:') AS `stock_adjustment_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`stock_date`, ''), ':Stock Date:Y:D:') AS `stock_date`,
    concat(ifnull(`v`.`adjustment_by`, ''), ':Adjustment By:O:N:') AS `adjustment_by`,
    concat(ifnull(`v`.`adjustment_reason`, ''), ':Adjustment Reason:O:N:') AS `adjustment_reason`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:O:N:') AS `approved_by`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') AS `godown_name`,
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:C:smv_product_stock_adjustment_details:O:') AS `goods_receipt_no`,
	concat(ifnull(`v`.`batch_expiry_date`, ''), ':Expiry Date:Y:D:') AS `batch_expiry_date`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(ifnull(`v`.`is_delete`, ''), ':Is Delete:O:N:') AS `is_delete`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_adjustment_transaction_id`, ''), ':Stock Adjustment Transaction Id:O:N:') AS `stock_adjustment_transaction_id`,
    concat(ifnull(`v`.`stock_adjustment_details_transaction_id`, ''), ':Stock Adjustment Details Transaction Id:N:N:') AS `stock_adjustment_details_transaction_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') AS `product_material_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`
from
    `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_stock_adjustment_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
22-07-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    and `ptdetails`.`godown_id` = `st`.`godown_id`
    and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    and `ptdetails`.`godown_id` = `st`.`godown_id`
    and `ptdetails`.`company_id` = `st`.`company_id`
    ), 0) AS `product_material_stock_weight`,
     coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    and `ptdetails`.`godown_id` = `st`.`godown_id`
    ), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    and `ptdetails`.`godown_id` = `st`.`godown_id`
    ), 0) AS `product_Rawmaterial_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `st`.`material_batch_rate` AS `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` AS `material_issue_amount`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `v`.`indent_issue_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `v`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    ), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `st`.`product_material_id`
    ), 0) AS `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_details` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `parent` on
    (`parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` AS
select
	`pt`.`purchase_order_type` AS `purchase_order_type`,
	`pt`.`purchase_order_no` AS `purchase_order_no`,
	`pt`.`purchase_order_date` AS `purchase_order_date`,
	`pt`.`purchase_order_version` AS `purchase_order_version`,
	`pt`.`indent_no` AS `indent_no`,
	`pt`.`indent_date` AS `indent_date`,
	`pt`.`indent_version` AS `indent_version`,
	case
		`pom`.`purchase_order_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'Z' then 'Pree Closed'
		when 'B' then 'Bill Booked'
		else 'Pending'
	end AS `purchase_order_status_desc`,
	`vp`.`department_name` AS `department_name`,
	`sdp`.`department_name` AS `sub_department_name`,
	case
		`pt`.`purchase_order_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'Z' then 'Pree Closed'
		when 'B' then 'Bill Booked'
		else 'Pending'
	end AS `purchase_order_item_status_desc`,
	case
		`pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
		when 'F' then 'Email Failed'
		else 'Email Pending'
	end AS `purchase_order_mail_sent_status_desc`,
	`pom`.`supplier_name` AS `supplier_name`,
	`pom`.`state_name` AS `supplier_state_name`,
	`c`.`customer_name` AS `customer_name`,
	`e1`.`employee_name` AS `indented_by_name`,
	`e`.`employee_name` AS `approved_by_name`,
	`pt`.`sr_no` AS `sr_no`,
	`pt`.`so_sr_no` AS `so_sr_no`,
	`p`.`product_type_name` AS `product_type_name`,
	`p`.`product_type_short_name` AS `product_type_short_name`,
	`p`.`product_type_group` AS `product_type_group`,
	`rmfgsr`.`product_material_code` AS `product_material_code`,
	`rmfgsr`.`product_material_name` AS `product_material_name`,
	`pt`.`product_material_print_name` AS `product_material_print_name`,
	`pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
	`pt`.`lead_time` AS `lead_time`,
	--     `rmfgsr`.`stock_quantity` AS `available_stock_quantity`,
	--     `rmfgsr`.`stock_weight` AS `available_stock_weight`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_quantity`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    and `ptdetails`.`company_id` = `pt`.`company_id`
    ), 0) AS `available_stock_weight`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    ), 0) AS `available_Rawmaterial_stock_quantity`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    ), 0) AS `available_Rawmaterial_stock_weight`,
	`rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
	`rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
	`pp`.`product_packing_name` AS `product_packing_name`,
	`pp`.`quantity_per_packing` AS `quantity_per_packing`,
	`hsn`.`hsn_sac_type` AS `hsn_sac_type`,
	`hsn`.`hsn_sac_code` AS `hsn_sac_code`,
	`hsn`.`hsn_sac_description` AS `hsn_sac_description`,
	`hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
	`rmfgsr`.`product_type_group` AS `product_material_type_group`,
	`rmfgsr`.`product_material_make_name` AS `product_make_name`,
	`rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
	`rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
	`rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
	`rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
	`rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
	`rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
	`rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
	`rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
	`rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
	`rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
	`rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
	`rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
	`g`.`godown_name` AS `godown_name`,
	`g`.`godown_short_name` AS `godown_short_name`,
	`g`.`godown_area` AS `godown_area`,
	`gs`.`godown_section_name` AS `godown_section_name`,
	`gs`.`godown_section_short_name` AS `godown_section_short_name`,
	`gs`.`godown_section_area` AS `godown_section_area`,
	`gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
	`gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
	`gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
	`pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
	`pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
	`pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
	`pt`.`product_material_po_weight` AS `product_material_po_weight`,
	`pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
	`pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
	`pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
	`pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
	`pt`.`customer_id` AS `customer_id`,
	`pt`.`customer_order_no` AS `customer_order_no`,
	`pt`.`customer_order_Date` AS `customer_order_Date`,
	`pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
	`pt`.`pree_closed_weight` AS `pree_closed_weight`,
	`pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
	`pt`.`purchase_return_weight` AS `purchase_return_weight`,
	`pt`.`material_rate` AS `material_rate`,
	`pt`.`material_basic_amount` AS `material_basic_amount`,
	`pt`.`material_discount_percent` AS `material_discount_percent`,
	`pt`.`material_discount_amount` AS `material_discount_amount`,
	`pt`.`material_taxable_amount` AS `material_taxable_amount`,
	`pt`.`material_cgst_percent` AS `material_cgst_percent`,
	`pt`.`material_cgst_total` AS `material_cgst_total`,
	`pt`.`material_sgst_percent` AS `material_sgst_percent`,
	`pt`.`material_sgst_total` AS `material_sgst_total`,
	`pt`.`material_igst_percent` AS `material_igst_percent`,
	`pt`.`material_igst_total` AS `material_igst_total`,
	`pt`.`material_total_amount` AS `material_total_amount`,
	`pt`.`material_schedule_date` AS `material_schedule_date`,
	`pt`.`material_freight_amount` AS `material_freight_amount`,
	`pt`.`pending_quantity` AS `pending_quantity`,
	`pt`.`pending_weight` AS `pending_weight`,
	`pt`.`excess_quantity` AS `excess_quantity`,
	`pt`.`excess_weight` AS `excess_weight`,
	`pt`.`production_issue_quantity` AS `production_issue_quantity`,
	`pt`.`production_issue_weight` AS `production_issue_weight`,
	`pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
	`pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
	`pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
	`pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
	`pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
	`pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
	`pt`.`sales_quantity` AS `sales_quantity`,
	`pt`.`sales_weight` AS `sales_weight`,
	`pt`.`sales_return_quantity` AS `sales_return_quantity`,
	`pt`.`sales_return_weight` AS `sales_return_weight`,
	`pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
	`pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
	`pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
	`pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
	`pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
	`pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
	`pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
	`pt`.`outsources_out_weight` AS `outsources_out_weight`,
	`pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
	`pt`.`outsources_in_weight` AS `outsources_in_weight`,
	`pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
	`pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
	`pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
	`pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
	`pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
	`pt`.`loan_issue_weight` AS `loan_issue_weight`,
	`pt`.`cancel_quantity` AS `cancel_quantity`,
	`pt`.`cancel_weight` AS `cancel_weight`,
	`pt`.`difference_quantity` AS `difference_quantity`,
	`pt`.`difference_weight` AS `difference_weight`,
	`pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
	`pom`.`purchase_order_status` AS `purchase_order_status`,
	`pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
	`pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
	`pt`.`approved_date` AS `approved_date`,
	`pt`.`remark` AS `remark`,
	`v`.`company_legal_name` AS `company_name`,
	`v`.`company_branch_name` AS `company_branch_name`,
	`v`.`company_address1` AS `company_address1`,
	`v`.`company_address2` AS `company_address2`,
	`v`.`company_cell_no` AS `company_cell_no`,
	`v`.`company_phone_no` AS `company_phone_no`,
	`v`.`company_EmailId` AS `company_EmailId`,
	`v`.`company_website` AS `company_website`,
	`v`.`company_gst_no` AS `company_gst_no`,
	`v`.`company_pan_no` AS `company_pan_no`,
	`v`.`company_state` AS `company_state`,
	`v`.`company_pincode` AS `company_pincode`,
	`pt`.`financial_year` AS `financial_year`,
	`pom`.`city_name` AS `city_name`,
	`pom`.`district_name` AS `district_name`,
	`pom`.`country_name` AS `country_name`,
	case
		`pt`.`is_active` when 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		`pt`.`is_delete` when 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`pt`.`is_active` AS `is_active`,
	`pt`.`is_delete` AS `is_delete`,
	`pt`.`created_by` AS `created_by`,
	`pt`.`created_on` AS `created_on`,
	`pt`.`modified_by` AS `modified_by`,
	`pt`.`modified_on` AS `modified_on`,
	`pt`.`deleted_by` AS `deleted_by`,
	`pt`.`deleted_on` AS `deleted_on`,
	`pt`.`company_id` AS `company_id`,
	`pt`.`company_branch_id` AS `company_branch_id`,
	`pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
	`pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
	`pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
	`pom`.`supplier_id` AS `supplier_id`,
	`pom`.`supplier_state_id` AS `supplier_state_id`,
	`pom`.`supplier_city_id` AS `supplier_city_id`,
	`pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
	`pom`.`expected_branch_id` AS `expected_branch_id`,
	`pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
	`pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
	`pt`.`cost_center_id` AS `cost_center_id`,
	`rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
	`rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
	`rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
	`rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
	`rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
	`rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
	`rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
	`rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
	`rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
	`rmfgsr`.`godown_id` AS `godown_id`,
	`rmfgsr`.`godown_section_id` AS `godown_section_id`,
	`rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
	`pt`.`product_material_id` AS `product_material_id`,
	`pt`.`product_material_unit_id` AS `product_material_unit_id`,
	`pt`.`product_material_packing_id` AS `product_material_packing_id`,
	`pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
	`pt`.`department_id` AS `department_id`,
	`pt`.`sub_department_id` AS `sub_department_id`,
	`pt`.`indented_by_id` AS `indented_by_id`,
	`pt`.`approved_by_id` AS `approved_by_id`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
	((((((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_master_summary` `pom` on
	(`pom`.`company_branch_id` = `pt`.`company_branch_id`
		and `pom`.`company_id` = `pt`.`company_id`
		and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
		and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
		and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
	(`v`.`company_branch_id` = `pt`.`company_branch_id`
		and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_type` `p` on
	(`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
	(`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_packing` `pp` on
	(`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
	(`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `vp` on
	(`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e` on
	(`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e1` on
	(`e1`.`employee_id` = `pt`.`indented_by_id`
		and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_customer` `c` on
	(`c`.`company_id` = `pt`.`company_id`
		and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `g` on
	(`g`.`company_id` = `pt`.`company_id`
		and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gs` on
	(`gs`.`company_id` = `pt`.`company_id`
		and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gsb` on
	(`gsb`.`company_id` = `pt`.`company_id`
		and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `sdp` on
	(`sdp`.`department_id` = `pt`.`sub_department_id`))
where
	`pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
23-07-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` AS
select
	`pt`.`purchase_order_type` AS `purchase_order_type`,
	`pt`.`purchase_order_no` AS `purchase_order_no`,
	`pt`.`purchase_order_date` AS `purchase_order_date`,
	`pt`.`purchase_order_version` AS `purchase_order_version`,
	`pt`.`indent_no` AS `indent_no`,
	`pt`.`indent_date` AS `indent_date`,
	`pt`.`indent_version` AS `indent_version`,
	case
		`pom`.`purchase_order_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'Z' then 'Pree Closed'
		when 'B' then 'Bill Booked'
		else 'Pending'
	end AS `purchase_order_status_desc`,
	`vp`.`department_name` AS `department_name`,
	`sdp`.`department_name` AS `sub_department_name`,
	case
		`pt`.`purchase_order_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'Z' then 'Pree Closed'
		when 'B' then 'Bill Booked'
		else 'Pending'
	end AS `purchase_order_item_status_desc`,
	case
		`pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
		when 'F' then 'Email Failed'
		else 'Email Pending'
	end AS `purchase_order_mail_sent_status_desc`,
	`pom`.`supplier_name` AS `supplier_name`,
	`pom`.`state_name` AS `supplier_state_name`,
	`c`.`customer_name` AS `customer_name`,
	`e1`.`employee_name` AS `indented_by_name`,
	`e`.`employee_name` AS `approved_by_name`,
	`pt`.`sr_no` AS `sr_no`,
	`pt`.`so_sr_no` AS `so_sr_no`,
	`p`.`product_type_name` AS `product_type_name`,
	`p`.`product_type_short_name` AS `product_type_short_name`,
	`p`.`product_type_group` AS `product_type_group`,
	`rmfgsr`.`product_material_code` AS `product_material_code`,
	`rmfgsr`.`product_material_name` AS `product_material_name`,
	`pt`.`product_material_print_name` AS `product_material_print_name`,
	`pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
	`pt`.`lead_time` AS `lead_time`,
    coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_quantity`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    and `ptdetails`.`company_id` = `pt`.`company_id`
    ), 0) AS `available_stock_weight`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_quantity`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    ), 0) AS `available_rawmaterial_stock_quantity`,
	coalesce((
    select sum(`ptdetails`.`closing_balance_weight`)
    from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails`
    where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`
    ), 0) AS `available_rawmaterial_stock_weight`,
	`rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
	`rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
	`pp`.`product_packing_name` AS `product_packing_name`,
	`pp`.`quantity_per_packing` AS `quantity_per_packing`,
	`hsn`.`hsn_sac_type` AS `hsn_sac_type`,
	`hsn`.`hsn_sac_code` AS `hsn_sac_code`,
	`hsn`.`hsn_sac_description` AS `hsn_sac_description`,
	`hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
	`rmfgsr`.`product_type_group` AS `product_material_type_group`,
	`rmfgsr`.`product_material_make_name` AS `product_make_name`,
	`rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
	`rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
	`rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
	`rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
	`rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
	`rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
	`rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
	`rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
	`rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
	`rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
	`rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
	`rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
	`g`.`godown_name` AS `godown_name`,
	`g`.`godown_short_name` AS `godown_short_name`,
	`g`.`godown_area` AS `godown_area`,
	`gs`.`godown_section_name` AS `godown_section_name`,
	`gs`.`godown_section_short_name` AS `godown_section_short_name`,
	`gs`.`godown_section_area` AS `godown_section_area`,
	`gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
	`gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
	`gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
	`pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
	`pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
	`pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
	`pt`.`product_material_po_weight` AS `product_material_po_weight`,
	`pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
	`pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
	`pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
	`pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
	`pt`.`customer_id` AS `customer_id`,
	`pt`.`customer_order_no` AS `customer_order_no`,
	`pt`.`customer_order_Date` AS `customer_order_Date`,
	`pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
	`pt`.`pree_closed_weight` AS `pree_closed_weight`,
	`pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
	`pt`.`purchase_return_weight` AS `purchase_return_weight`,
	`pt`.`material_rate` AS `material_rate`,
	`pt`.`material_basic_amount` AS `material_basic_amount`,
	`pt`.`material_discount_percent` AS `material_discount_percent`,
	`pt`.`material_discount_amount` AS `material_discount_amount`,
	`pt`.`material_taxable_amount` AS `material_taxable_amount`,
	`pt`.`material_cgst_percent` AS `material_cgst_percent`,
	`pt`.`material_cgst_total` AS `material_cgst_total`,
	`pt`.`material_sgst_percent` AS `material_sgst_percent`,
	`pt`.`material_sgst_total` AS `material_sgst_total`,
	`pt`.`material_igst_percent` AS `material_igst_percent`,
	`pt`.`material_igst_total` AS `material_igst_total`,
	`pt`.`material_total_amount` AS `material_total_amount`,
	`pt`.`material_schedule_date` AS `material_schedule_date`,
	`pt`.`material_freight_amount` AS `material_freight_amount`,
	`pt`.`pending_quantity` AS `pending_quantity`,
	`pt`.`pending_weight` AS `pending_weight`,
	`pt`.`excess_quantity` AS `excess_quantity`,
	`pt`.`excess_weight` AS `excess_weight`,
	`pt`.`production_issue_quantity` AS `production_issue_quantity`,
	`pt`.`production_issue_weight` AS `production_issue_weight`,
	`pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
	`pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
	`pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
	`pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
	`pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
	`pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
	`pt`.`sales_quantity` AS `sales_quantity`,
	`pt`.`sales_weight` AS `sales_weight`,
	`pt`.`sales_return_quantity` AS `sales_return_quantity`,
	`pt`.`sales_return_weight` AS `sales_return_weight`,
	`pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
	`pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
	`pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
	`pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
	`pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
	`pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
	`pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
	`pt`.`outsources_out_weight` AS `outsources_out_weight`,
	`pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
	`pt`.`outsources_in_weight` AS `outsources_in_weight`,
	`pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
	`pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
	`pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
	`pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
	`pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
	`pt`.`loan_issue_weight` AS `loan_issue_weight`,
	`pt`.`cancel_quantity` AS `cancel_quantity`,
	`pt`.`cancel_weight` AS `cancel_weight`,
	`pt`.`difference_quantity` AS `difference_quantity`,
	`pt`.`difference_weight` AS `difference_weight`,
	`pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
	`pom`.`purchase_order_status` AS `purchase_order_status`,
	`pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
	`pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
	`pt`.`approved_date` AS `approved_date`,
	`pt`.`remark` AS `remark`,
	`v`.`company_legal_name` AS `company_name`,
	`v`.`company_branch_name` AS `company_branch_name`,
-- 	`v`.`company_address1` AS `company_address1`,
-- 	`v`.`company_address2` AS `company_address2`,
	`v`.`company_cell_no` AS `company_cell_no`,
	`v`.`company_phone_no` AS `company_phone_no`,
	`v`.`company_EmailId` AS `company_EmailId`,
	`v`.`company_website` AS `company_website`,
	`v`.`company_gst_no` AS `company_gst_no`,
	`v`.`company_pan_no` AS `company_pan_no`,
	`v`.`company_state` AS `company_state`,
	`v`.`company_pincode` AS `company_pincode`,
	`pt`.`financial_year` AS `financial_year`,
	`pom`.`city_name` AS `city_name`,
	`pom`.`district_name` AS `district_name`,
	`pom`.`country_name` AS `country_name`,
	case
		`pt`.`is_active` when 1 then 'Active'
		else 'In Active'
	end AS `Active`,
	case
		`pt`.`is_delete` when 1 then 'Yes'
		else 'No'
	end AS `Deleted`,
	`pt`.`is_active` AS `is_active`,
	`pt`.`is_delete` AS `is_delete`,
	`pt`.`created_by` AS `created_by`,
	`pt`.`created_on` AS `created_on`,
	`pt`.`modified_by` AS `modified_by`,
	`pt`.`modified_on` AS `modified_on`,
	`pt`.`deleted_by` AS `deleted_by`,
	`pt`.`deleted_on` AS `deleted_on`,
	`pt`.`company_id` AS `company_id`,
	`pt`.`company_branch_id` AS `company_branch_id`,
	`pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
	`pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
	`pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
	`pom`.`supplier_id` AS `supplier_id`,
	`pom`.`supplier_state_id` AS `supplier_state_id`,
	`pom`.`supplier_city_id` AS `supplier_city_id`,
	`pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
	`pom`.`expected_branch_id` AS `expected_branch_id`,
	`pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
	`pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
	`pt`.`cost_center_id` AS `cost_center_id`,
	`rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
	`rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
	`rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
	`rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
	`rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
	`rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
	`rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
	`rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
	`rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
	`rmfgsr`.`godown_id` AS `godown_id`,
	`rmfgsr`.`godown_section_id` AS `godown_section_id`,
	`rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
	`pt`.`product_material_id` AS `product_material_id`,
	`pt`.`product_material_unit_id` AS `product_material_unit_id`,
	`pt`.`product_material_packing_id` AS `product_material_packing_id`,
	`pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
	`pt`.`department_id` AS `department_id`,
	`pt`.`sub_department_id` AS `sub_department_id`,
	`pt`.`indented_by_id` AS `indented_by_id`,
	`pt`.`approved_by_id` AS `approved_by_id`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
	((((((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_master_summary` `pom` on
	(`pom`.`company_branch_id` = `pt`.`company_branch_id`
		and `pom`.`company_id` = `pt`.`company_id`
		and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
		and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
		and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
	(`v`.`company_branch_id` = `pt`.`company_branch_id`
		and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_type` `p` on
	(`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
	(`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_packing` `pp` on
	(`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
	(`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `vp` on
	(`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e` on
	(`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e1` on
	(`e1`.`employee_id` = `pt`.`indented_by_id`
		and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_customer` `c` on
	(`c`.`company_id` = `pt`.`company_id`
		and `c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `g` on
	(`g`.`company_id` = `pt`.`company_id`
		and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gs` on
	(`gs`.`company_id` = `pt`.`company_id`
		and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gsb` on
	(`gsb`.`company_id` = `pt`.`company_id`
		and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `sdp` on
	(`sdp`.`department_id` = `pt`.`sub_department_id`))
where
	`pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    `rmfgsr`.`lead_time` AS `product_lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_Rawmaterial_stock_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `st`.`material_batch_rate` AS `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` AS `material_issue_amount`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `v`.`indent_issue_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `st`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `v`.`cost_center_id` AS `cost_center_id`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    ((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_details` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `parent` on
    (`parent`.`product_material_id` = `st`.`product_fg_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
26-07-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`issue_group_type` AS `issue_group_type`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fm`.`cost_center_name` AS `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_source` As `issue_source`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_material_issue_master` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_customer_summary` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`
        and `ae`.`company_id` = `st`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
27-07-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.stv_indent_material_issue_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_details` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end AS `issue_item_status_desc`,
    `e`.`employee_name` AS `indented_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `rmfgsr`.`product_type_group` AS `product_type_group`,
    `st`.`product_material_id` AS `product_material_id`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `st`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` AS `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` AS `product_type_name`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    `rmfgsr`.`lead_time` AS `product_lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `product_Rawmaterial_stock_weight`,
    coalesce((select sum(`ptdetails`.`reserve_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `reserve_quantity`,
    coalesce((select sum(`ptdetails`.`reserve_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) AS `reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `v`.`customer_state_name` AS `customer_state_name`,
    `v`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`product_std_weight` AS `product_std_weight`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    `st`.`issue_item_status` AS `issue_item_status`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `st`.`material_batch_rate` AS `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` AS `material_issue_amount`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_remark` AS `issue_remark`,
    `gd`.`godown_name` AS `godown_name`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `v`.`issued_by_id` AS `issued_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `v`.`indent_issue_type_id` AS `product_type_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` AS `product_material_packing_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`issue_details_transaction_id` AS `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `v`.`issue_no` AS `field_name`,
    `v`.`issue_version` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`st_indent_material_issue_details` `st`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
27-07-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sdp`.`department_name` AS `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `pom`.`state_name` AS `supplier_state_name`,
    `c`.`customer_name` AS `customer_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) AS `available_rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) AS `available_rawmaterial_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`sub_department_id` AS `sub_department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    ((((((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `g` on
    (`g`.`is_delete` = 0
        and `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gs` on
    (`gs`.`is_delete` = 0
        and `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`is_delete` = 0
        and `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_master_summary` AS
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end AS `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end AS `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `s`.`supplier_name` AS `supplier_name`,
    `st`.`state_name` AS `state_name`,
    `s`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `st1`.`state_name` AS `expected_branch_state_name`,
    `e`.`employee_name` AS `approved_by`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`expected_schedule_date` AS `expected_schedule_date`,
    `pt`.`basic_total` AS `basic_total`,
    `pt`.`transport_amount` AS `transport_amount`,
    `pt`.`freight_amount` AS `freight_amount`,
    `pt`.`is_freight_taxable` AS `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
    `pt`.`packing_amount` AS `packing_amount`,
    `pt`.`po_discount_percent` AS `po_discount_percent`,
    `pt`.`po_discount_amount` AS `po_discount_amount`,
    `pt`.`other_amount` AS `other_amount`,
    `pt`.`taxable_total` AS `taxable_total`,
    `pt`.`cgst_total` AS `cgst_total`,
    `pt`.`sgst_total` AS `sgst_total`,
    `pt`.`igst_total` AS `igst_total`,
    `pt`.`roundoff` AS `roundoff`,
    `pt`.`grand_total` AS `grand_total`,
    `a`.`agent_name` AS `agent_name`,
    `pt`.`agent_percent` AS `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end AS `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` AS `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`status_remark` AS `status_remark`,
    `pt`.`other_terms_conditions` AS `other_terms_conditions`,
    `s`.`supplier_type` AS `supplier_type`,
    `s`.`supplier_code` AS `supplier_code`,
    `s`.`supplier_short_name` AS `supplier_short_name`,
    `s`.`supp_branch_address1` AS `supp_branch_address1`,
    `s`.`supp_branch_pincode` AS `supp_branch_pincode`,
    `ct`.`city_name` AS `city_name`,
    `s`.`district_name` AS `district_name`,
    `s`.`country_name` AS `country_name`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `ct1`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`purchase_process_entry` AS `purchase_process_entry`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `pt`.`purchase_order_life` AS `purchase_order_life`,
    `pt`.`purchase_order_status` AS `purchase_order_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end AS `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` AS `purchase_order_creation_type`,
    `pt`.`gate_pass_no` AS `gate_pass_no`,
    `pt`.`gate_pass_date` AS `gate_pass_date`,
    `pt`.`vehicale_no` AS `vehicale_no`,
    `pt`.`vehicale_type` AS `vehicale_type`,
    `pt`.`gross_weight` AS `gross_weight`,
    `pt`.`tare_weight` AS `tare_weight`,
    `pt`.`net_weight` AS `net_weight`,
    `pt`.`variation_weight` AS `variation_weight`,
    `pt`.`deduction1_name` AS `deduction1_name`,
    `pt`.`deduction1_percent` AS `deduction1_percent`,
    `pt`.`deduction1_amount` AS `deduction1_amount`,
    `pt`.`deduction2_name` AS `deduction2_name`,
    `pt`.`deduction2_percent` AS `deduction2_percent`,
    `pt`.`deduction2_amount` AS `deduction2_amount`,
    `pt`.`deduction3_name` AS `deduction3_name`,
    `pt`.`deduction3_percent` AS `deduction3_percent`,
    `pt`.`deduction3_amount` AS `deduction3_amount`,
    `pt`.`deduction4_name` AS `deduction4_name`,
    `pt`.`deduction4_percent` AS `deduction4_percent`,
    `pt`.`deduction4_amount` AS `deduction4_amount`,
    `pt`.`deduction5_name` AS `deduction5_name`,
    `pt`.`deduction5_percent` AS `deduction5_percent`,
    `pt`.`deduction5_amount` AS `deduction5_amount`,
    `e1`.`employee_name` AS `grader_by_name`,
    `pt`.`remark` AS `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    `pt`.`agent_id` AS `agent_id`,
    `cc`.`supplier_name` AS `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` AS `supp_consignee_address1`,
    `cc`.`supp_branch_address2` AS `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` AS `supp_consignee_pincode`,
    `cc`.`city_name` AS `supp_consignee_city_name`,
    `cc`.`district_name` AS `supp_consignee_district_name`,
    `cc`.`state_name` AS `supp_consignee_state_name`,
    `pt`.`consignee_id` AS `consignee_id`,
    `pt`.`consignee_state_id` AS `consignee_state_id`,
    `pt`.`consignee_city_id` AS `consignee_city_id`,
    `pt`.`grader_by_id` AS `grader_by_id`,
    `pt`.`deduction5_id` AS `deduction5_id`,
    `pt`.`deduction4_id` AS `deduction4_id`,
    `pt`.`deduction3_id` AS `deduction3_id`,
    `pt`.`deduction2_id` AS `deduction2_id`,
    `pt`.`deduction1_id` AS `deduction1_id`,
    `pt`.`agent_paid_status` AS `agent_paid_status`
from
    (((((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_master` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_supplier` `s` on
    (`s`.`supplier_id` = `pt`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_supplier_branch` `cc` on
    (`cc`.`supplier_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_tax_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_tax_summary` AS
select
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `s`.`supplier_type` AS `supplier_type`,
    `s`.`supplier_code` AS `supplier_code`,
    `s`.`supplier_name` AS `supplier_name`,
    `s`.`supplier_short_name` AS `supplier_short_name`,
    `s`.`supp_branch_address1` AS `supp_branch_address1`,
    `s`.`supp_branch_pincode` AS `supp_branch_pincode`,
    `s`.`city_name` AS `supplier_city_name`,
    `s`.`district_name` AS `supplier_district_name`,
    `s`.`state_name` AS `supplier_state_name`,
    `s`.`country_name` AS `supplier_country_name`,
    `s`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
    `cb`.`company_branch_name` AS `expected_branch_name`,
    `cb`.`branch_short_name` AS `expected_branch_short_name`,
    `cb`.`branch_address1` AS `expected_branch_address1`,
    `cb`.`branch_pincode` AS `expected_branch_pincode`,
    `cb`.`city_name` AS `expected_branch_city_name`,
    `cb`.`district_name` AS `expected_branch_district_name`,
    `cb`.`state_name` AS `expected_branch_state_name`,
    `cb`.`country_name` AS `expected_branch_country_name`,
    `cb`.`branch_phone_no` AS `expected_branch_phone_no`,
    `cb`.`branch_EmailId` AS `expected_branch_EmailId`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`summary_taxable_amount` AS `summary_taxable_amount`,
    `pt`.`summary_cgst_percent` AS `summary_cgst_percent`,
    `pt`.`summary_cgst_total` AS `summary_cgst_total`,
    `pt`.`summary_sgst_percent` AS `summary_sgst_percent`,
    `pt`.`summary_sgst_total` AS `summary_sgst_total`,
    `pt`.`summary_igst_percent` AS `summary_igst_percent`,
    `pt`.`summary_igst_total` AS `summary_igst_total`,
    `pt`.`summary_total_amount` AS `summary_total_amount`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`purchase_order_tax_summary_transaction_id` AS `purchase_order_tax_summary_transaction_id`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`supplier_id` AS `supplier_id`,
    `pt`.`supplier_state_id` AS `supplier_state_id`,
    `pt`.`supplier_city_id` AS `supplier_city_id`,
    `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pt`.`expected_branch_id` AS `expected_branch_id`,
    `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`hsn_code_id` AS `hsn_code_id`
from
    ((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_tax_summary` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_supplier` `s` on
    (`s`.`supplier_id` = `pt`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`hsn_code_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
31-07-2024


-- ERP_PASHUPATI_DEV_TESTING_1_0.mt_sales_order_raw_material definition

CREATE or REPLACE TABLE `mt_sales_order_raw_material` (
  `mt_sales_order_rm_transaction_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '* read only back end auto generated *',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*combo box with cmv_company_branch  and set default backend from session  *',
  `sales_order_master_transaction_id` bigint(20) NOT NULL COMMENT '* read only back end auto generated from master id *',
  `sales_order_no` varchar(50) NOT NULL COMMENT '*read only text box Combination of Company Short name/FyearShort name/ProductType_group / SO0000Last ID ',
  `sales_order_date` date NOT NULL COMMENT '* DTPpicker Data Entry',
  `sales_order_version` bigint(20) NOT NULL DEFAULT 1 COMMENT '* read only text box auto generated next Version *',
  `customer_order_no` varchar(500) DEFAULT NULL COMMENT 'combo box with mtv_sales_order_summary with customer id filter ',
  `customer_order_Date` date DEFAULT NULL COMMENT '* DTPpicker Data Entry',
  `product_type_id` bigint(20) DEFAULT 2 COMMENT ' * Data Grid Entry  with Export/Import combo box with cmv_product_type show only services,- save product type',
  `product_type` varchar(100) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format  text box with all Material name shows ing grids for selected Product Type ',
  `product_material_id` varchar(20) DEFAULT NULL COMMENT '* Data Grid Entry  with Export/Import excel format  combo box with cmv_product_rm/cmv_product_fg/cmv_product_sr with all technical parameter shows ing grids for selected material ',
  `product_material_unit_id` bigint(20) DEFAULT NULL COMMENT '* Data Grid  with Export/Import excel format Entry combo box with cmv_unit ',
  `material_quantity` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `weight_per_unit` decimal(18,4) DEFAULT 1.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `material_weight` decimal(18,4) DEFAULT 0.0000 COMMENT '* Data Grid  with Export/Import excel format Entry txtbox data entry with validation ',
  `remark` varchar(255) DEFAULT NULL,
  `is_active` bit(1) DEFAULT b'1',
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT NULL,
  PRIMARY KEY (`mt_sales_order_rm_transaction_id`))


-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE ERP_PASHUPATI_DEV_TESTING_1_0.mt_sales_order_raw_material ADD count_type varchar(50) NULL COMMENT 'combobox for count type ("warp_count", "weft_count")';
ALTER TABLE ERP_PASHUPATI_DEV_TESTING_1_0.mt_sales_order_raw_material CHANGE count_type count_type varchar(50) NULL COMMENT 'combobox for count type ("warp_count", "weft_count")' AFTER product_material_id;


-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.mtv_sales_order_raw_material source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`mtv_sales_order_raw_material` AS
select
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`weight_per_unit` AS `weight_per_unit`,
    `mt`.`count_type` AS `count_type`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`mt_sales_order_rm_transaction_id` AS `mt_sales_order_rm_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`
from
    ((`ERP_PASHUPATI_DEV_TESTING_1_0`.`mt_sales_order_raw_material` `mt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.mtv_sales_order_raw_material source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`mtv_sales_order_raw_material` AS
select
    `mt`.`sales_order_no` AS `sales_order_no`,
    `mt`.`sales_order_date` AS `sales_order_date`,
    `mt`.`sales_order_version` AS `sales_order_version`,
    `mt`.`customer_order_no` AS `customer_order_no`,
    `mt`.`customer_order_Date` AS `customer_order_Date`,
    `mt`.`product_type` AS `product_type`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `rmfgsr`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_unit_name`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_technical_name` AS `product_material_technical_name`,
    `mt`.`material_quantity` AS `material_quantity`,
    `mt`.`material_weight` AS `material_weight`,
    `mt`.`weight_per_unit` AS `weight_per_unit`,
    `mt`.`count_type` AS `count_type`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `mt`.`product_material_id` ), 0) AS `stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `mt`.`product_material_id` ), 0) AS `stock_weight`,
    `mt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `mt`.`is_active` AS `is_active`,
    `mt`.`is_delete` AS `is_delete`,
    `mt`.`created_by` AS `created_by`,
    `mt`.`created_on` AS `created_on`,
    `mt`.`modified_by` AS `modified_by`,
    `mt`.`modified_on` AS `modified_on`,
    `mt`.`deleted_by` AS `deleted_by`,
    `mt`.`deleted_on` AS `deleted_on`,
    `mt`.`mt_sales_order_rm_transaction_id` AS `mt_sales_order_rm_transaction_id`,
    `mt`.`company_id` AS `company_id`,
    `mt`.`company_branch_id` AS `company_branch_id`,
    `mt`.`sales_order_master_transaction_id` AS `sales_order_master_transaction_id`,
    `mt`.`product_type_id` AS `product_type_id`,
    `mt`.`product_material_id` AS `product_material_id`,
    `mt`.`product_material_unit_id` AS `product_material_unit_id`
from
    ((`ERP_PASHUPATI_DEV_TESTING_1_0`.`mt_sales_order_raw_material` `mt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `mt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `mt`.`company_branch_id`
        and `v`.`company_id` = `mt`.`company_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_rm_fg_sr source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` AS
select
    `rmt`.`product_type_group` AS `product_type_group`,
    `rmt`.`product_type_name` AS `product_type_name`,
    `rmt`.`product_category1_name` AS `product_material_category1_name`,
    `rm`.`product_rm_id` AS `product_material_id`,
    `rm`.`product_rm_code` AS `product_material_code`,
    `rm`.`product_rm_name` AS `product_material_name`,
    `rm`.`product_rm_short_name` AS `product_material_short_name`,
    `rm`.`product_rm_tech_spect` AS `product_material_tech_spect`,
    `u3`.`product_unit_name` AS `product_material_stock_unit_name`,
    ifnull(NULL, 0) AS `stock_quantity`,
    ifnull(NULL, 0) AS `stock_weight`,
    ifnull(NULL, 0) AS `customer_stock_quantity`,
    ifnull(NULL, 0) AS `customer_stock_weight`,
    `rmc`.`lead_time` AS `lead_time`,
    `rmc`.`product_rm_moq` AS `product_material_moq`,
    `rmc`.`product_rm_mrp` AS `product_material_mrp`,
    `rmc`.`product_rm_landed_price` AS `product_material_landed_price`,
    `rmt`.`product_rm_technical_name` AS `product_material_technical_name`,
    `rmt`.`product_type_short_name` AS `product_material_type_short_name`,
    `rmt`.`product_category2_name` AS `product_material_category2_name`,
    `rmt`.`product_category3_name` AS `product_material_category3_name`,
    `rmt`.`product_category4_name` AS `product_material_category4_name`,
    `rmt`.`product_category5_name` AS `product_material_category5_name`,
    `p1`.`product_packing_name` AS `product_material_packing_name`,
    `rmt`.`product_make_name` AS `product_material_make_name`,
    `rmt`.`product_material_type_name` AS `product_material_type_name`,
    `rmt`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmt`.`product_material_shape_name` AS `product_material_shape_name`,
    `rm`.`product_rm_oem_part_code` AS `product_material_oem_part_code`,
    `rm`.`product_rm_our_part_code` AS `product_material_our_part_code`,
    `rmt`.`product_rm_drawing_no` AS `product_material_drawing_no`,
    `rmc`.`product_rm_std_weight` AS `product_material_std_weight`,
    1 AS `product_material_std_hours`,
    1 AS `process_duration`,
    0 AS `product_std_profit_percent`,
    0 AS `product_std_discount_percent`,
    case
        `rm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `rm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `g`.`godown_name` AS `godown_name`,
    `g`.`godown_short_name` AS `godown_short_name`,
    `g`.`godown_area` AS `godown_area`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gs`.`godown_section_short_name` AS `godown_section_short_name`,
    `gs`.`godown_section_area` AS `godown_section_area`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `h`.`hsn_sac_code` AS `product_material_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `rm`.`product_category1_id` AS `product_material_category1_id`,
    `rm`.`product_type_id` AS `product_type_id`,
    `rm`.`product_rm_stock_unit_id` AS `product_material_stock_unit_id`,
    `rm`.`product_rm_packing_id` AS `product_material_packing_id`,
    `rm`.`product_rm_hsn_sac_code_id` AS `product_material_hsn_sac_code_id`,
    `rmt`.`product_category2_id` AS `product_material_category2_id`,
    `rmt`.`product_category3_id` AS `product_material_category3_id`,
    `rmt`.`product_category4_id` AS `product_material_category4_id`,
    `rmt`.`product_category5_id` AS `product_material_category5_id`,
    `rmt`.`product_make_id` AS `product_material_make_id`,
    `rmt`.`product_material_type_id` AS `product_material_type_id`,
    `rmt`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmt`.`product_material_shape_id` AS `product_material_shape_id`,
    `rm`.`company_id` AS `company_id`,
    `rm`.`company_branch_id` AS `company_branch_id`,
    `rm`.`godown_id` AS `godown_id`,
    `rm`.`godown_section_id` AS `godown_section_id`,
    `rm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    'No' AS `bom_applicable`,
    `rm`.`is_active` AS `is_active`,
    `rm`.`is_delete` AS `is_delete`,
    `rmc`.`cost_center_id` AS `cost_center_id`,
    `rm`.`product_rm_name` AS `field_name`,
    `rm`.`product_rm_id` AS `field_id`
from
    (((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm` `rm`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `rm`.`company_id`
        and `v`.`company_branch_id` = `rm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_unit` `u3` on
    (`u3`.`product_unit_id` = `rm`.`product_rm_stock_unit_id`
        and `u3`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_packing` `p1` on
    (`p1`.`product_packing_id` = `rm`.`product_rm_packing_id`
        and `p1`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `rm`.`product_rm_hsn_sac_code_id`
        and `h`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_technical` `rmt` on
    (`rmt`.`is_delete` = 0
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_commercial` `rmc` on
    (`rmc`.`is_delete` = 0
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `g` on
    (`g`.`godown_id` = `rm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gs` on
    (`gs`.`godown_section_id` = `rm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `rm`.`godown_section_beans_id`))
where
    `rm`.`is_delete` = 0
union all
select
    `fgt`.`product_type_group` AS `product_type_group`,
    `fgt`.`product_type_name` AS `product_type_name`,
    `fgt`.`product_category1_name` AS `product_material_category1_name`,
    `fg`.`product_fg_id` AS `product_material_id`,
    `fg`.`product_fg_code` AS `product_material_code`,
    `fg`.`product_fg_name` AS `product_material_name`,
    `fg`.`product_fg_short_name` AS `product_material_short_name`,
    `fg`.`product_fg_tech_spect` AS `product_material_tech_spect`,
    `u3`.`product_unit_name` AS `product_material_stock_unit_name`,
    ifnull(NULL, 0) AS `stock_quantity`,
    ifnull(NULL, 0) AS `stock_weight`,
    ifnull(NULL, 0) AS `customer_stock_quantity`,
    ifnull(NULL, 0) AS `customer_stock_weight`,
    0 AS `lead_time`,
    0 AS `product_material_moq`,
    0 AS `product_material_mrp`,
    0 AS `product_material_landed_price`,
    `fgt`.`product_fg_technical_name` AS `product_material_technical_name`,
    `fgt`.`product_type_short_name` AS `product_material_type_short_name`,
    `fgt`.`product_category2_name` AS `product_material_category2_name`,
    `fgt`.`product_category3_name` AS `product_material_category3_name`,
    `fgt`.`product_category4_name` AS `product_material_category4_name`,
    `fgt`.`product_category5_name` AS `product_material_category5_name`,
    `p`.`product_packing_name` AS `product_material_packing_name`,
    'NA' AS `product_material_make_name`,
    `fgt`.`product_material_type_name` AS `product_material_type_name`,
    `fgt`.`product_material_grade_name` AS `product_material_grade_name`,
    `fgt`.`product_material_shape_name` AS `product_material_shape_name`,
    `fg`.`product_fg_oem_part_code` AS `product_material_oem_part_code`,
    `fg`.`product_fg_our_part_code` AS `product_material_our_part_code`,
    `fgt`.`product_fg_drawing_no` AS `product_material_drawing_no`,
    `fgc`.`product_fg_std_weight` AS `product_material_std_weight`,
    1 AS `product_material_std_hours`,
    1 AS `process_duration`,
    0 AS `product_std_profit_percent`,
    0 AS `product_std_discount_percent`,
    case
        `fg`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `fg`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    'NA' AS `godown_name`,
    'NA' AS `godown_short_name`,
    'NA' AS `godown_area`,
    'NA' AS `godown_section_name`,
    'NA' AS `godown_section_short_name`,
    'NA' AS `godown_section_area`,
    'NA' AS `godown_section_beans_name`,
    'NA' AS `godown_section_beans_short_name`,
    'NA' AS `godown_section_beans_area`,
    `h`.`hsn_sac_code` AS `product_material_hsn_sac_code`,
    `h`.`hsn_sac_rate` AS `product_material_hsn_sac_rate`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `fgt`.`product_category1_id` AS `product_material_category1_id`,
    `fgt`.`product_type_id` AS `product_type_id`,
    `fg`.`product_fg_stock_unit_id` AS `product_material_stock_unit_id`,
    1 AS `product_material_packing_id`,
    `fg`.`product_fg_hsn_sac_code_id` AS `product_material_hsn_sac_code_id`,
    `fgt`.`product_category2_id` AS `product_material_category2_id`,
    `fgt`.`product_category3_id` AS `product_material_category3_id`,
    `fgt`.`product_category4_id` AS `product_material_category4_id`,
    `fgt`.`product_category5_id` AS `product_material_category5_id`,
    1 AS `product_material_make_id`,
    `fgt`.`product_material_type_id` AS `product_material_type_id`,
    `fgt`.`product_material_grade_id` AS `product_material_grade_id`,
    `fgt`.`product_material_shape_id` AS `product_material_shape_id`,
    `fg`.`company_id` AS `company_id`,
    `fg`.`company_branch_id` AS `company_branch_id`,
    '1' AS `godown_id`,
    '1' AS `godown_section_id`,
    '1' AS `godown_section_beans_id`,
    `fg`.`bom_applicable` AS `bom_applicable`,
    `fg`.`is_active` AS `is_active`,
    `fg`.`is_delete` AS `is_delete`,
    `fgc`.`cost_center_id` AS `cost_center_id`,
    `fg`.`product_fg_name` AS `field_name`,
    `fg`.`product_fg_id` AS `field_id`
from
    ((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_fg` `fg`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_id` = `fg`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_unit` `u3` on
    (`u3`.`product_unit_id` = `fg`.`product_fg_stock_unit_id`
        and `u3`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `h` on
    (`h`.`hsn_sac_id` = `fg`.`product_fg_hsn_sac_code_id`
        and `h`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_packing` `p` on
    (`p`.`product_packing_id` = `fg`.`product_fg_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_fg_technical` `fgt` on
    (`fgt`.`company_id` = `fg`.`company_id`
        and `fgt`.`product_fg_id` = `fg`.`product_fg_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_fg_commercial` `fgc` on
    (`fgc`.`product_fg_id` = `fg`.`product_fg_id`
        and `fgc`.`is_delete` = 0))
where
    `fg`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `so`.`sales_order_no` as `sales_order_no`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    `po`.`indented_by_name` AS `indented_by_name`,
    `po`.`approved_by_name` AS `po_approved_by_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indent_by_id`
from
    ((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `d` on
    (`d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`mt_sales_order_master_trading` `so` on
    (`so`.`company_id` = `pt`.`company_id`
        and `so`.`customer_order_no` = `pt`.`customer_order_no`))
where
    `pt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
02-8-24

-- ERP_PASHUPATI_PROD_1_0.stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `e`.`email_id1` AS `indented_by_email`,
    `e1`.`email_id1` AS `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`st_indent_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;


DONE ALL chnages 05-08-2024
-------------------------------------------------------------------------------------------------------------------------------
05-08-2024

-- ERP_PASHUPATI_DEV_TESTING_1_0.smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_material_code` AS `product_rm_code`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `rm`.`product_material_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_material_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_material_stock_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`batch_rate` * `sm`.`closing_balance_quantity` AS `closing_amount`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`
from
    ((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_details` `sm`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_customer` `cm` on
    (`cm`.`is_delete` = 0
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_supplier` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;


-------------------------------------------------------------------------------------------------------------------------------
12-08-24



-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_purchase_order_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` AS
select
    `pt`.`purchase_order_type` AS `purchase_order_type`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    `pt`.`indent_no` AS `indent_no`,
    `pt`.`indent_date` AS `indent_date`,
    `pt`.`indent_version` AS `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    `vp`.`department_name` AS `department_name`,
    `sdp`.`department_name` AS `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end AS `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` AS `supplier_name`,
    `pom`.`state_name` AS `supplier_state_name`,
    `c`.`customer_name` AS `customer_name`,
    `e1`.`employee_name` AS `indented_by_name`,
    `e`.`employee_name` AS `approved_by_name`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`so_sr_no` AS `so_sr_no`,
    `p`.`product_type_name` AS `product_type_name`,
    `p`.`product_type_short_name` AS `product_type_short_name`,
    `p`.`product_type_group` AS `product_type_group`,
    `rmfgsr`.`product_material_code` AS `product_material_code`,
    `rmfgsr`.`product_material_name` AS `product_material_name`,
    `pt`.`product_material_print_name` AS `product_material_print_name`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `available_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) AS `available_rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) AS `available_rawmaterial_stock_weight`,
    `rmfgsr`.`product_material_std_weight` AS `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `hsn`.`hsn_sac_type` AS `hsn_sac_type`,
    `hsn`.`hsn_sac_code` AS `hsn_sac_code`,
    `hsn`.`hsn_sac_description` AS `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` AS `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` AS `product_make_name`,
    `rmfgsr`.`product_material_category1_name` AS `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` AS `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` AS `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` AS `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` AS `product_category5_name`,
    `rmfgsr`.`product_material_type_name` AS `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` AS `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` AS `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `rmfgsr`.`godown_name` AS `godown_name`,
    `rmfgsr`.`godown_short_name` AS `godown_short_name`,
    `rmfgsr`.`godown_area` AS `godown_area`,
    `rmfgsr`.`godown_section_name` AS `godown_section_name`,
    `rmfgsr`.`godown_section_short_name` AS `godown_section_short_name`,
    `rmfgsr`.`godown_section_area` AS `godown_section_area`,
    `rmfgsr`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `rmfgsr`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `rmfgsr`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` AS `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` AS `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` AS `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` AS `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` AS `product_material_po_rejected_weight`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `pt`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `pt`.`pree_closed_weight` AS `pree_closed_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`pending_quantity` AS `pending_quantity`,
    `pt`.`pending_weight` AS `pending_weight`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`material_po_approval_remark` AS `material_po_approval_remark`,
    `pom`.`purchase_order_status` AS `purchase_order_status`,
    `pt`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `pom`.`purchase_order_mail_sent_status` AS `purchase_order_mail_sent_status`,
    `pt`.`approved_date` AS `approved_date`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`company_cell_no` AS `company_cell_no`,
    `v`.`company_phone_no` AS `company_phone_no`,
    `v`.`company_EmailId` AS `company_EmailId`,
    `v`.`company_website` AS `company_website`,
    `v`.`company_gst_no` AS `company_gst_no`,
    `v`.`company_pan_no` AS `company_pan_no`,
    `v`.`company_state` AS `company_state`,
    `v`.`company_pincode` AS `company_pincode`,
    `pt`.`financial_year` AS `financial_year`,
    `pom`.`city_name` AS `city_name`,
    `pom`.`district_name` AS `district_name`,
    `pom`.`country_name` AS `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`purchase_order_type_id` AS `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` AS `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` AS `supplier_id`,
    `pom`.`supplier_state_id` AS `supplier_state_id`,
    `pom`.`supplier_city_id` AS `supplier_city_id`,
    `pom`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `pom`.`expected_branch_id` AS `expected_branch_id`,
    `pom`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `pt`.`cost_center_id` AS `cost_center_id`,
    `rmfgsr`.`product_material_type_id` AS `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` AS `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` AS `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` AS `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` AS `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` AS `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` AS `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` AS `product_category5_id`,
    `rmfgsr`.`godown_id` AS `godown_id`,
    `rmfgsr`.`godown_section_id` AS `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`sub_department_id` AS `sub_department_id`,
    `pt`.`indented_by_id` AS `indented_by_id`,
    `pt`.`approved_by_id` AS `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) AS `prev_grn_weight`
from
    (((((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_purchase_order_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;



-------------------------------------------------------------------------------------------------------------------------------
-- ERP_PASHUPATI_DEV_TESTING_1_0.ptv_goods_receipt_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_goods_receipt_details` AS
select
    `pt`.`goods_receipt_no` AS `goods_receipt_no`,
    `pt`.`goods_receipt_date` AS `goods_receipt_date`,
    `pt`.`goods_receipt_version` AS `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end AS `grn_item_status_desc`,
    `d`.`department_name` AS `department_name`,
    `pt`.`purchase_order_no` AS `purchase_order_no`,
    `pt`.`purchase_order_date` AS `purchase_order_date`,
    `pt`.`purchase_order_version` AS `purchase_order_version`,
    case
        `po`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_status_desc`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end AS `purchase_order_item_status_desc`,
    `po`.`customer_name` AS `customer_name`,
    `pt`.`customer_order_no` AS `customer_order_no`,
    `pt`.`customer_order_Date` AS `customer_order_Date`,
    `grm`.`purchase_order_life` AS `purchase_order_life`,
    `grm`.`supplier_challan_no` AS `supplier_challan_no`,
    `grm`.`supplier_challan_date` AS `supplier_challan_date`,
    `grm`.`supplier_name` AS `supplier_name`,
    `grm`.`supplier_city_name` AS `supplier_city_name`,
    `grm`.`supplier_state_name` AS `supplier_state_name`,
    `pt`.`item_qa_by_id` AS `item_qa_by_id`,
    `pt`.`item_qa_date` AS `item_qa_date`,
    `pt`.`goods_receipt_type` AS `goods_receipt_type`,
    `pt`.`product_material_tech_spect` AS `product_material_tech_spect`,
    `pt`.`lead_time` AS `lead_time`,
    `pt`.`sr_no` AS `sr_no`,
    `pt`.`batch_no` AS `batch_no`,
    `po`.`purchase_order_status` AS `purchase_order_status`,
    `po`.`purchase_order_item_status` AS `purchase_order_item_status`,
    `po`.`product_material_name` AS `product_material_name`,
    `po`.`product_material_stock_unit_name` AS `product_material_stock_unit_name`,
    `po`.`product_material_std_weight` AS `product_material_std_weight`,
    `po`.`product_material_type_group` AS `product_material_type_group`,
    `po`.`product_type_name` AS `product_type_name`,
    `po`.`product_type_short_name` AS `product_type_short_name`,
    `po`.`product_make_name` AS `product_make_name`,
    `po`.`product_category1_name` AS `product_category1_name`,
    `po`.`product_category2_name` AS `product_category2_name`,
    `po`.`product_category3_name` AS `product_category3_name`,
    `po`.`product_category4_name` AS `product_category4_name`,
    `po`.`product_category5_name` AS `product_category5_name`,
    `po`.`product_material_type_name` AS `product_material_type_name`,
    `po`.`product_material_grade_name` AS `product_material_grade_name`,
    `po`.`product_material_shape_name` AS `product_material_shape_name`,
    `po`.`product_material_oem_part_code` AS `product_material_oem_part_code`,
    `po`.`product_material_our_part_code` AS `product_material_our_part_code`,
    `po`.`product_material_drawing_no` AS `product_material_drawing_no`,
    `po`.`product_packing_name` AS `product_packing_name`,
    `po`.`product_material_hsn_sac_code` AS `product_material_hsn_sac_code`,
    `po`.`hsn_sac_type` AS `hsn_sac_type`,
    `po`.`hsn_sac_code` AS `hsn_sac_code`,
    `po`.`hsn_sac_description` AS `hsn_sac_description`,
    `po`.`hsn_sac_rate` AS `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` AS `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` AS `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` AS `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` AS `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` AS `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` AS `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` AS `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` AS `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` AS `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` AS `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) AS `prev_grn_weight`,
    `so`.`sales_order_no` AS `sales_order_no`,
    `pt`.`product_material_grn_accepted_quantity` AS `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` AS `product_material_prev_accepted_weight`,
    `pt`.`material_rate` AS `material_rate`,
    `pt`.`material_basic_amount` AS `material_basic_amount`,
    `pt`.`material_freight_amount` AS `material_freight_amount`,
    `pt`.`material_discount_percent` AS `material_discount_percent`,
    `pt`.`material_discount_amount` AS `material_discount_amount`,
    `pt`.`material_taxable_amount` AS `material_taxable_amount`,
    `pt`.`material_cgst_percent` AS `material_cgst_percent`,
    `pt`.`material_cgst_total` AS `material_cgst_total`,
    `pt`.`material_sgst_percent` AS `material_sgst_percent`,
    `pt`.`material_sgst_total` AS `material_sgst_total`,
    `pt`.`material_igst_percent` AS `material_igst_percent`,
    `pt`.`material_igst_total` AS `material_igst_total`,
    `pt`.`material_total_amount` AS `material_total_amount`,
    `pt`.`material_schedule_date` AS `material_schedule_date`,
    `pt`.`grn_item_status` AS `grn_item_status`,
    `pt`.`excess_quantity` AS `excess_quantity`,
    `pt`.`excess_weight` AS `excess_weight`,
    `pt`.`pree_closed_grn_quantity` AS `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` AS `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `pt`.`purchase_return_weight` AS `purchase_return_weight`,
    `pt`.`production_issue_quantity` AS `production_issue_quantity`,
    `pt`.`production_issue_weight` AS `production_issue_weight`,
    `pt`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `pt`.`sales_quantity` AS `sales_quantity`,
    `pt`.`sales_weight` AS `sales_weight`,
    `pt`.`sales_return_quantity` AS `sales_return_quantity`,
    `pt`.`sales_return_weight` AS `sales_return_weight`,
    `pt`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `pt`.`outsources_out_weight` AS `outsources_out_weight`,
    `pt`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `pt`.`outsources_in_weight` AS `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `pt`.`loan_issue_weight` AS `loan_issue_weight`,
    `pt`.`cancel_quantity` AS `cancel_quantity`,
    `pt`.`cancel_weight` AS `cancel_weight`,
    `pt`.`difference_quantity` AS `difference_quantity`,
    `pt`.`difference_weight` AS `difference_weight`,
    `pt`.`total_box_weight` AS `total_box_weight`,
    `pt`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `pt`.`weight_per_box_item` AS `weight_per_box_item`,
    `pt`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`financial_year` AS `financial_year`,
    `pt`.`expiry_date` AS `expiry_date`,
    `po`.`indent_no` AS `indent_no`,
    `po`.`indented_by_name` AS `indented_by_name`,
    `po`.`approved_by_name` AS `po_approved_by_name`,
    `g`.`godown_name` AS `godown_name`,
    `gs`.`godown_section_name` AS `godown_section_name`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `pt`.`is_active` AS `is_active`,
    `pt`.`is_delete` AS `is_delete`,
    `pt`.`created_by` AS `created_by`,
    `pt`.`created_on` AS `created_on`,
    `pt`.`modified_by` AS `modified_by`,
    `pt`.`modified_on` AS `modified_on`,
    `pt`.`deleted_by` AS `deleted_by`,
    `pt`.`deleted_on` AS `deleted_on`,
    `pt`.`company_id` AS `company_id`,
    `pt`.`company_branch_id` AS `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` AS `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` AS `purchase_order_details_transaction_id`,
    `pt`.`department_id` AS `department_id`,
    `pt`.`product_material_unit_id` AS `product_material_unit_id`,
    `pt`.`product_material_packing_id` AS `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` AS `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
    `pt`.`customer_id` AS `customer_id`,
    `pt`.`product_material_rejection_reason_id` AS `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` AS `goods_receipt_status`,
    `grm`.`supplier_id` AS `supplier_id`,
    `grm`.`approved_by_id` AS `approved_by_id`,
    `grm`.`supplier_state_id` AS `supplier_state_id`,
    `grm`.`supplier_city_id` AS `supplier_city_id`,
    `grm`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
    `grm`.`expected_branch_id` AS `expected_branch_id`,
    `grm`.`expected_branch_state_id` AS `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` AS `expected_branch_city_id`,
    `grm`.`payment_term_id` AS `payment_term_id`,
    `grm`.`agent_id` AS `agent_id`,
    `po`.`purchase_order_type_id` AS `product_type_id`,
    `pt`.`product_material_id` AS `product_material_id`,
    `pt`.`godown_id` AS `godown_id`,
    `pt`.`godown_section_id` AS `godown_section_id`,
    `pt`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `po`.`product_material_type_id` AS `product_material_type_id`,
    `po`.`product_material_stock_unit_id` AS `product_material_stock_unit_id`,
    `po`.`product_material_grade_id` AS `product_material_grade_id`,
    `po`.`product_material_shape_id` AS `product_material_shape_id`,
    `po`.`product_category1_id` AS `product_category1_id`,
    `po`.`product_category2_id` AS `product_category2_id`,
    `po`.`product_category3_id` AS `product_category3_id`,
    `po`.`product_category4_id` AS `product_category4_id`,
    `po`.`product_category5_id` AS `product_category5_id`,
    `po`.`indented_by_id` AS `indent_by_id`
from
    (((((((((`ERP_PASHUPATI_DEV_TESTING_1_0`.`pt_goods_receipt_details` `pt`
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`ptv_goods_receipt_summary` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cmv_department` `d` on
    (`d`.`department_id` = `pt`.`department_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`mt_sales_order_master_trading` `so` on
    (`so`.`company_id` = `pt`.`company_id`
        and `so`.`customer_order_no` = `pt`.`customer_order_no`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown` `g` on
    ( `g`.`godown_id` = `pt`.`godown_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section` `gs` on
    ( `gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `ERP_PASHUPATI_DEV_TESTING_1_0`.`cm_godown_section_beans` `gsb` on
    ( `gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
13-08-2024

CREATE
    ALGORITHM = UNDEFINED
    DEFINER = `root`@`localhost`
    SQL SECURITY DEFINER
VIEW `smv_product_rm_supplier` AS
    SELECT
        `sup`.`supplier_name` AS `supplier_name`,
         `sup`.`supplier_code` AS `supplier_code`,
        `sup`.`supp_branch_payment_terms` AS `supplier_payment_terms`,
        `sup`.`supp_branch_rating` AS `supp_branch_rating`,
        `sup`.`city_name` AS `city_name`,
        `sup`.`state_name` AS `state_name`,
        `sup`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
        `sup`.`supp_branch_cell_no` AS `supp_branch_cell_no`,
        `sup`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
        `sup`.`supp_branch_website` AS `supp_branch_website`,
        `sup`.`supp_branch_gst_no` AS `supp_branch_gst_no`,
        `v`.`supplier_id` AS `supplier_id`,
        `v`.`product_rm_id` AS `product_rm_id`,
        `v`.`product_rm_supplier_id` AS `product_rm_supplier_id`,
        `v`.`company_id` AS `company_id`,
        `v`.`product_rm_supplier_id` AS `field_id`,
        `sup`.`supplier_name` AS `field_name`
    FROM
        (`sm_product_rm_supplier` `v`
        LEFT JOIN `cmv_supplier_summary` `sup` ON (((`sup`.`supplier_id` = `v`.`supplier_id`)
            AND (`v`.`is_delete` = 0))))
    WHERE
        (`v`.`is_delete` = 0)
    ORDER BY `v`.`product_rm_id` DESC , `sup`.`supplier_name`
-------------------------------------------------------------------------------------------------------------------------------
14-08-24

ALTER TABLE `pashupati_dev`.`pt_goods_receipt_master`
ADD COLUMN `ev_bill_no` VARCHAR(50) NULL AFTER `supplier_invoice_date`,
ADD COLUMN `ev_bill_date` DATE NULL AFTER `ev_bill_no`;

-------------------------------------------------------------------------------------------------------------------------------
CREATE
    ALGORITHM = UNDEFINED
    DEFINER = `root`@`localhost`
    SQL SECURITY DEFINER
VIEW `ptv_goods_receipt_summary` AS
    SELECT
        `sup`.`supplier_name` AS `supplier_name`,
        `pt`.`goods_receipt_no` AS `goods_receipt_no`,
        `pt`.`goods_receipt_date` AS `goods_receipt_date`,
        `pt`.`goods_receipt_version` AS `goods_receipt_version`,
        CASE `pt`.`goods_receipt_status`
            WHEN 'G' THEN 'GRN Done'
            WHEN 'Q' THEN 'QC Done'
            WHEN 'R' THEN 'Rejected'
            WHEN 'I' THEN 'Partial Receipt'
            WHEN 'C' THEN 'Completed'
            WHEN 'X' THEN 'Canceled'
            WHEN 'B' THEN 'Bill Booked'
            ELSE 'GRN'
        END AS `goods_receipt_status_desc`,
        CASE `pt`.`purchase_order_life`
            WHEN 'C' THEN 'Close'
            ELSE 'Open'
        END AS `purchase_order_life_desc`,
        (SELECT DISTINCT
                `po1`.`indented_by_id`
            FROM
                `pt_purchase_order_details` `po1`
            WHERE
                `po1`.`purchase_order_no` IN (SELECT DISTINCT
                        `pd1`.`purchase_order_no`
                    FROM
                        `pt_goods_receipt_details` `pd1`
                    WHERE
                        `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`)) AS `indent_by_id`,
        (SELECT DISTINCT
                `pd1`.`purchase_order_no`
            FROM
                `pt_goods_receipt_details` `pd1`
            WHERE
                `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
            LIMIT 1) AS `purchase_order_no`,
        (SELECT DISTINCT
                `pd1`.`purchase_order_date`
            FROM
                `pt_goods_receipt_details` `pd1`
            WHERE
                `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
            LIMIT 1) AS `purchase_order_date`,
        `pt`.`purchase_order_version` AS `purchase_order_version`,
        `pt`.`goods_receipt_type` AS `goods_receipt_type`,
        `pt`.`supplier_invoice_no` AS `supplier_invoice_no`,
        `pt`.`supplier_invoice_date` AS `supplier_invoice_date`,
        `pt`.`supplier_challan_no` AS `supplier_challan_no`,
        `pt`.`supplier_challan_date` AS `supplier_challan_date`,
        `pt`.`expected_schedule_date` AS `expected_schedule_date`,
        `a`.`agent_name` AS `agent_name`,
        `pt`.`agent_percent` AS `agent_percent`,
        `pt`.`agent_paid_status` AS `agent_paid_status`,
        `e1`.`employee_name` AS `qa_by_name`,
        `e`.`employee_name` AS `approved_by_name`,
        `pt`.`approved_date` AS `approved_date`,
        `pt`.`qa_date` AS `qa_date`,
        `pt`.`basic_total` AS `basic_total`,
        `pt`.`transport_amount` AS `transport_amount`,
        `pt`.`freight_amount` AS `freight_amount`,
        `pt`.`is_freight_taxable` AS `is_freight_taxable`,
        `pt`.`packing_amount` AS `packing_amount`,
        `pt`.`goods_receipt_discount_percent` AS `goods_receipt_discount_percent`,
        `pt`.`goods_receipt_discount_amount` AS `goods_receipt_discount_amount`,
        `pt`.`other_amount` AS `other_amount`,
        `pt`.`taxable_total` AS `taxable_total`,
        `pt`.`cgst_total` AS `cgst_total`,
        `pt`.`sgst_total` AS `sgst_total`,
        `pt`.`igst_total` AS `igst_total`,
        `pt`.`grand_total` AS `grand_total`,
        `pt`.`roundoff` AS `roundoff`,
        `pt`.`goods_receipt_status` AS `goods_receipt_status`,
        `pt`.`lr_no` AS `lr_no`,
        `pt`.`lr_date` AS `lr_date`,
        `pt`.`vehicle_no` AS `vehicle_no`,
        `pt`.`other_terms_conditions` AS `other_terms_conditions`,
        `sup`.`supp_branch_phone_no` AS `supp_branch_phone_no`,
        `sup`.`supp_branch_EmailId` AS `supp_branch_EmailId`,
        `sup`.`supp_branch_address1` AS `supp_branch_address1`,
        `sup`.`supp_branch_pincode` AS `supp_branch_pincode`,
        `sup`.`supp_branch_gst_no` AS `supp_branch_gst_no`,
        `sup`.`supp_branch_pan_no` AS `supp_branch_pan_no`,
		`pt`.`ev_bill_no` AS `ev_bill_no`,
        `pt`.`ev_bill_date` AS `ev_bill_date`,
        `pt`.`remark` AS `remark`,
        `cb`.`is_sez` AS `is_sez`,
        `cb`.`company_name` AS `company_name`,
        `cb`.`company_branch_name` AS `company_branch_name`,
        `cb`.`branch_pincode` AS `company_pincode`,
        `cb`.`branch_phone_no` AS `company_phone_no`,
        `cb`.`state_name` AS `company_branch_state`,
        `cb`.`city_name` AS `company_branch_city`,
        `cb`.`branch_cell_no` AS `company_cell_no`,
        `cb`.`branch_EmailId` AS `company_EmailId`,
        `cb`.`branch_gst_no` AS `company_gst_no`,
        `cb`.`branch_pan_no` AS `company_pan_no`,
        `cb`.`branch_address1` AS `company_address1`,
        `cb`.`branch_address2` AS `company_address2`,
        `ct`.`city_name` AS `supplier_city_name`,
        `s`.`state_name` AS `supplier_state_name`,
        `pt`.`financial_year` AS `financial_year`,
        CASE
            WHEN `pt`.`is_active` = 1 THEN 'Active'
            ELSE 'In Active'
        END AS `Active`,
        CASE
            WHEN `pt`.`is_delete` = 1 THEN 'Yes'
            ELSE 'No'
        END AS `Deleted`,
        `pt`.`is_active` AS `is_active`,
        `pt`.`is_delete` AS `is_delete`,
        `pt`.`is_preeclosed` AS `is_preeclosed`,
        `pt`.`purchase_order_life` AS `purchase_order_life`,
        `pt`.`created_by` AS `created_by`,
        `pt`.`created_on` AS `created_on`,
        `pt`.`modified_by` AS `modified_by`,
        `pt`.`modified_on` AS `modified_on`,
        `pt`.`deleted_by` AS `deleted_by`,
        `pt`.`deleted_on` AS `deleted_on`,
        `pt`.`company_id` AS `company_id`,
        `pt`.`company_branch_id` AS `company_branch_id`,
        `pt`.`goods_receipt_master_transaction_id` AS `goods_receipt_master_transaction_id`,
        `pt`.`qa_by_id` AS `qa_by_id`,
        `pt`.`agent_id` AS `agent_id`,
        `pt`.`supplier_id` AS `supplier_id`,
        `pt`.`approved_by_id` AS `approved_by_id`,
        `pt`.`supplier_state_id` AS `supplier_state_id`,
        `pt`.`supplier_city_id` AS `supplier_city_id`,
        `pt`.`supplier_contacts_ids` AS `supplier_contacts_ids`,
        `pt`.`expected_branch_id` AS `expected_branch_id`,
        `pt`.`expected_branch_state_id` AS `expected_branch_state_id`,
        `pt`.`expected_branch_city_id` AS `expected_branch_city_id`,
        `pt`.`goods_receipt_type_id` AS `goods_receipt_type_id`,
        `pt`.`freight_hsn_code_id` AS `freight_hsn_code_id`,
        `sup`.`payment_term_id` AS `payment_term_id`
    FROM
        ((((((((`pt_goods_receipt_master` `pt`
        LEFT JOIN `cm_company_branch` `v` ON (`v`.`company_branch_id` = `pt`.`company_branch_id`
            AND `v`.`company_id` = `pt`.`company_id`
            AND `pt`.`is_delete` = 0))
        LEFT JOIN `cmv_supplier` `sup` ON (`sup`.`supplier_id` = `pt`.`supplier_id`
            AND `pt`.`is_delete` = 0))
        LEFT JOIN `cm_employee` `e` ON (`e`.`employee_id` = `pt`.`approved_by_id`))
        LEFT JOIN `cm_employee` `e1` ON (`e1`.`employee_id` = `pt`.`qa_by_id`))
        LEFT JOIN `cm_city` `ct` ON (`ct`.`city_id` = `pt`.`supplier_city_id`))
        LEFT JOIN `cm_state` `s` ON (`s`.`state_id` = `pt`.`supplier_state_id`))
        LEFT JOIN `cm_agent` `a` ON (`a`.`agent_id` = `pt`.`agent_id`
            AND `a`.`company_id` = `pt`.`company_id`))
        LEFT JOIN `cmv_company_branch_summary` `cb` ON (`cb`.`company_branch_id` = `pt`.`expected_branch_id`
            AND `cb`.`company_id` = `pt`.`company_id`))
    WHERE
        `pt`.`is_delete` = 0
-------------------------------------------------------------------------------------------------------------------------------
15-08-24

ALTER TABLE `pashupati_dev`.`pt_goods_receipts_notes_tax_summary`
CHANGE COLUMN `purchase_order_no` `purchase_order_no` VARCHAR(50) NULL COMMENT '*read only text box Combination of Company Short name/FyearShort name/ProductType_group / SO0000Last ID ' ,
CHANGE COLUMN `purchase_order_date` `purchase_order_date` DATE NULL COMMENT '* DTPpicker Data Entry' ,
CHANGE COLUMN `purchase_order_version` `purchase_order_version` BIGINT(20) NULL DEFAULT 1 COMMENT '* read only text box auto generated next Version *' ;

-------------------------------------------------------------------------------------------------------------------------------
17-08-2024

-- smv_product_rm_stock_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_stock_summary` AS
select
    `sm`.`financial_year` AS `financial_year`,
    `sup`.`supplier_name` AS `supplier_name`,
    `cust`.`customer_name` AS `customer_name`,
    `pt`.`product_type_name` AS `product_type_name`,
    `sm`.`product_type_group` AS `product_type_group`,
    `rm`.`product_material_code` AS `product_rm_code`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `rm`.`product_material_category1_name` AS `product_material_category1_name`,
    `rm`.`product_material_category2_name` AS `product_material_category2_name`,
    `pu`.`product_unit_name` AS `product_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `sm`.`remark` AS `remark`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `pt`.`product_type_short_name` AS `product_type_short_name`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `rm`.`product_material_category1_id` AS `product_material_category1_id`,
    `rm`.`product_material_category2_id` AS `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_summary` `sm`
left join `cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_stock_summary_rpt` AS
select
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:Y:C:smv_product_type:F') AS `product_type_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section:F') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans:F') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`product_material_category1_name`, ''), ':Catergory1 Name:Y:C:smv_product_category1:F') AS `product_material_category1_name`,
    concat(ifnull(`v`.`product_material_category2_name`, ''), ':Catergory2 Name:Y:C:smv_product_category2:F') AS `product_material_category2_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Production Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Production Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Production Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Production Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') AS `product_type_short_name`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`product_unit_name`, ''), ':Product Unit Name:Y:C:smv_product_unit:F') AS `product_unit_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`
from
    `smv_product_rm_stock_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_stock_details` AS
select
    `sm`.`stock_date` AS `stock_date`,
    `sm`.`day_closed` AS `day_closed`,
    `sm`.`batch_no` AS `batch_no`,
    `supp`.`supplier_code` AS `supplier_code`,
    `supp`.`supplier_name` AS `supplier_name`,
    `sm`.`batch_expiry_date` AS `batch_expiry_date`,
    `sm`.`goods_receipt_no` AS `goods_receipt_no`,
    `sm`.`goods_receipt_version` AS `goods_receipt_version`,
    `cm`.`customer_code` AS `customer_code`,
    `cm`.`customer_name` AS `customer_name`,
    `sm`.`sales_order_no` AS `sales_order_no`,
    `sm`.`sales_order_version` AS `sales_order_version`,
    `sm`.`customer_goods_receipt_no` AS `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` AS `customer_goods_receipt_version`,
    `sm`.`so_sr_no` AS `so_sr_no`,
    `sm`.`customer_order_no` AS `customer_order_no`,
    `rm`.`product_material_code` AS `product_rm_code`,
    `rm`.`product_material_name` AS `product_rm_name`,
    `rm`.`product_material_technical_name` AS `product_rm_technical_name`,
    `rm`.`product_type_name` AS `product_type_name`,
    `rm`.`product_material_category1_name` AS `product_material_category1_name`,
    `rm`.`product_material_category2_name` AS `product_material_category2_name`,
    `rm`.`product_material_short_name` AS `product_rm_short_name`,
    `su`.`product_unit_name` AS `product_material_unit_name`,
    `rm`.`product_material_stock_unit_name` AS `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` AS `product_packing_name`,
    `sm`.`batch_rate` AS `batch_rate`,
    `sm`.`order_quantity` AS `order_quantity`,
    `sm`.`order_weight` AS `order_weight`,
    `sm`.`pending_quantity` AS `pending_quantity`,
    `sm`.`pending_weight` AS `pending_weight`,
    `sm`.`opening_quantity` AS `opening_quantity`,
    `sm`.`opening_weight` AS `opening_weight`,
    `sm`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `sm`.`closing_balance_weight` AS `closing_balance_weight`,
    `sm`.`batch_rate` * `sm`.`closing_balance_quantity` AS `closing_amount`,
    `sm`.`reserve_quantity` AS `reserve_quantity`,
    `sm`.`reserve_weight` AS `reserve_weight`,
    `sm`.`excess_quantity` AS `excess_quantity`,
    `sm`.`excess_weight` AS `excess_weight`,
    `sm`.`pree_closed_quantity` AS `pree_closed_quantity`,
    `sm`.`pree_closed_weight` AS `pree_closed_weight`,
    `sm`.`purchase_quantity` AS `purchase_quantity`,
    `sm`.`purchase_weight` AS `purchase_weight`,
    `sm`.`purchase_return_quantity` AS `purchase_return_quantity`,
    `sm`.`purchase_return_weight` AS `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` AS `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` AS `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` AS `jobcard_quantity`,
    `sm`.`jobcard_weight` AS `jobcard_weight`,
    `sm`.`production_issue_quantity` AS `production_issue_quantity`,
    `sm`.`production_issue_weight` AS `production_issue_weight`,
    `sm`.`production_issue_return_quantity` AS `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` AS `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` AS `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` AS `production_issue_rejection_weight`,
    `sm`.`production_quantity` AS `production_quantity`,
    `sm`.`production_weight` AS `production_weight`,
    `sm`.`production_return_quantity` AS `production_return_quantity`,
    `sm`.`production_return_weight` AS `production_return_weight`,
    `sm`.`production_rejection_quantity` AS `production_rejection_quantity`,
    `sm`.`production_rejection_weight` AS `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` AS `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` AS `assembly_production_issue_weight`,
    `sm`.`sales_quantity` AS `sales_quantity`,
    `sm`.`sales_weight` AS `sales_weight`,
    `sm`.`sales_return_quantity` AS `sales_return_quantity`,
    `sm`.`sales_return_weight` AS `sales_return_weight`,
    `sm`.`sales_rejection_quantity` AS `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` AS `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` AS `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` AS `customer_receipt_weight`,
    `sm`.`customer_return_quantity` AS `customer_return_quantity`,
    `sm`.`customer_return_weight` AS `customer_return_weight`,
    `sm`.`customer_rejection_quantity` AS `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` AS `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` AS `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` AS `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` AS `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` AS `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` AS `outsources_out_quantity`,
    `sm`.`outsources_out_weight` AS `outsources_out_weight`,
    `sm`.`outsources_in_quantity` AS `outsources_in_quantity`,
    `sm`.`outsources_in_weight` AS `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` AS `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` AS `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` AS `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` AS `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` AS `loan_issue_quantity`,
    `sm`.`loan_issue_weight` AS `loan_issue_weight`,
    `sm`.`cancel_quantity` AS `cancel_quantity`,
    `sm`.`cancel_weight` AS `cancel_weight`,
    `sm`.`difference_quantity` AS `difference_quantity`,
    `sm`.`difference_weight` AS `difference_weight`,
    `sm`.`total_box_weight` AS `total_box_weight`,
    `sm`.`total_quantity_in_box` AS `total_quantity_in_box`,
    `sm`.`weight_per_box_item` AS `weight_per_box_item`,
    `gd`.`godown_name` AS `godown_name`,
    `gd`.`godown_short_name` AS `godown_short_name`,
    `gd`.`godown_area` AS `godown_area`,
    `gd`.`godown_section_count` AS `godown_section_count`,
    `gds`.`godown_section_name` AS `godown_section_name`,
    `gds`.`godown_section_short_name` AS `godown_section_short_name`,
    `gds`.`godown_section_area` AS `godown_section_area`,
    `gdsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` AS `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` AS `godown_section_beans_area`,
    `pp`.`quantity_per_packing` AS `quantity_per_packing`,
    `pp`.`weight_per_packing` AS `weight_per_packing`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `sm`.`financial_year` AS `financial_year`,
    `sm`.`product_type_group` AS `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `sm`.`is_active` AS `is_active`,
    `sm`.`is_delete` AS `is_delete`,
    `sm`.`created_by` AS `created_by`,
    `sm`.`created_on` AS `created_on`,
    `sm`.`modified_by` AS `modified_by`,
    `sm`.`modified_on` AS `modified_on`,
    `sm`.`deleted_by` AS `deleted_by`,
    `sm`.`deleted_on` AS `deleted_on`,
    `sm`.`company_id` AS `company_id`,
    `sm`.`company_branch_id` AS `company_branch_id`,
    `sm`.`stock_transaction_id` AS `stock_transaction_id`,
    `sm`.`product_rm_id` AS `product_rm_id`,
    `sm`.`customer_id` AS `customer_id`,
    `sm`.`godown_id` AS `godown_id`,
    `sm`.`supplier_id` AS `supplier_id`,
    `sm`.`godown_section_id` AS `godown_section_id`,
    `sm`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `sm`.`product_type_id` AS `product_type_id`,
    `sm`.`product_material_unit_id` AS `product_material_unit_id`,
    `sm`.`product_material_packing_id` AS `product_material_packing_id`,
    `rm`.`product_material_category1_id` AS `product_material_category1_id`,
    `rm`.`product_material_category2_id` AS `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_details` `sm`
left join `cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `cm_customer` `cm` on
    (`cm`.`is_delete` = 0
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `cm_supplier` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `smv_product_rm_stock_details_rpt` AS
select
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') AS `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section') AS `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans') AS `godown_section_beans_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material Name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_code`, ''), ':Material Code:Y:T') AS `product_rm_code`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:O:N:') AS `product_type_name`,
    concat(ifnull(`v`.`product_material_category1_name`, ''), ':Catergory1 Name:Y:C:smv_product_category1:F') AS `product_material_category1_name`,
    concat(ifnull(`v`.`product_material_category2_name`, ''), ':Catergory2 Name:Y:C:smv_product_category2:F') AS `product_material_category2_name`,
    concat(ifnull(`v`.`stock_date`, ''), ':Stock Date:Y:D:') AS `stock_date`,
    concat(ifnull(`v`.`day_closed`, ''), ':Day Closed:O:N:') AS `day_closed`,
    concat(ifnull(`v`.`batch_no`, ''), ':Batch No:O:N:') AS `batch_no`,
    concat(ifnull(`v`.`batch_expiry_date`, ''), ':Batch Expiry Date:Y:D:') AS `batch_expiry_date`,
    concat(ifnull(`v`.`sales_order_no`, ''), ':Sales Order No:O:N:') AS `sales_order_no`,
    concat(ifnull(`v`.`sales_order_version`, ''), ':Sales Order Version:O:N:') AS `sales_order_version`,
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:O:N:') AS `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') AS `goods_receipt_version`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt No:O:N:') AS `customer_goods_receipt_no`,
    concat(ifnull(`v`.`customer_goods_receipt_no`, ''), ':Customer Goods Receipt Version:O:N:') AS `customer_goods_receipt_version`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') AS `customer_order_no`,
    concat(ifnull(`v`.`order_quantity`, ''), ':Order Quantity:O:N:') AS `order_quantity`,
    concat(ifnull(`v`.`order_weight`, ''), ':Order Weight:O:N:') AS `order_weight`,
    concat(ifnull(`v`.`batch_rate`, ''), ':Batch Rate:Y:T:') AS `batch_rate`,
    concat(ifnull(`v`.`closing_amount`, ''), ':Closing Amount:Y:T:') AS `closing_amount`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') AS `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') AS `pending_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Quantity:O:N:') AS `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Weight:O:N:') AS `opening_weight`,
    concat(ifnull(`v`.`reserve_quantity`, ''), ':Reserve Quantity:O:N:') AS `reserve_quantity`,
    concat(ifnull(`v`.`reserve_weight`, ''), ':Reserve Weight:O:N:') AS `reserve_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') AS `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') AS `excess_weight`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree Closed Quantity:O:N:') AS `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree Closed Weight:O:N:') AS `pree_closed_weight`,
    concat(ifnull(`v`.`purchase_quantity`, ''), ':Purchase Quantity:O:N:') AS `purchase_quantity`,
    concat(ifnull(`v`.`purchase_weight`, ''), ':Purchase Weight:O:N:') AS `purchase_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') AS `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') AS `purchase_return_weight`,
    concat(ifnull(`v`.`purchase_rejection_quantity`, ''), ':Purchase Rejection Quantity:O:N:') AS `purchase_rejection_quantity`,
    concat(ifnull(`v`.`purchase_rejection_weight`, ''), ':Purchase Rejection Weight:O:N:') AS `purchase_rejection_weight`,
    concat(ifnull(`v`.`jobcard_quantity`, ''), ':Jobcard Quantity:O:N:') AS `jobcard_quantity`,
    concat(ifnull(`v`.`jobcard_weight`, ''), ':Jobcard Weight:O:N:') AS `jobcard_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') AS `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') AS `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') AS `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') AS `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') AS `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Production Issue Rejection Weight:O:N:') AS `production_issue_rejection_weight`,
    concat(ifnull(`v`.`production_quantity`, ''), ':Production Quantity:O:N:') AS `production_quantity`,
    concat(ifnull(`v`.`production_weight`, ''), ':Production Weight:O:N:') AS `production_weight`,
    concat(ifnull(`v`.`production_return_quantity`, ''), ':Return Quantity:O:N:') AS `production_return_quantity`,
    concat(ifnull(`v`.`production_return_weight`, ''), ':Return Weight:O:N:') AS `production_return_weight`,
    concat(ifnull(`v`.`production_rejection_quantity`, ''), ':Rejection Quantity:O:N:') AS `production_rejection_quantity`,
    concat(ifnull(`v`.`production_rejection_weight`, ''), ':Rejection Weight:O:N:') AS `production_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') AS `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') AS `assembly_production_issue_weight`,
    concat(ifnull(`v`.`customer_receipt_quantity`, ''), ':Customer Receipt Quantity:O:N:') AS `customer_receipt_quantity`,
    concat(ifnull(`v`.`customer_return_quantity`, ''), ':Customer Return Quantity:O:N:') AS `customer_return_quantity`,
    concat(ifnull(`v`.`customer_receipt_weight`, ''), ':Customer Receipt Weight:O:N:') AS `customer_receipt_weight`,
    concat(ifnull(`v`.`customer_return_weight`, ''), ':Customer Return Weight:O:N:') AS `customer_return_weight`,
    concat(ifnull(`v`.`customer_rejection_weight`, ''), ':Customer Rejection Weight:O:N:') AS `customer_rejection_weight`,
    concat(ifnull(`v`.`customer_rejection_quantity`, ''), ':Customer Rejection Quantity:O:N:') AS `customer_rejection_quantity`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') AS `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') AS `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') AS `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') AS `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') AS `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') AS `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') AS `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') AS `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') AS `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') AS `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') AS `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') AS `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') AS `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') AS `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') AS `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') AS `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') AS `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') AS `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') AS `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') AS `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') AS `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') AS `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') AS `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') AS `difference_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') AS `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') AS `closing_balance_weight`,
    concat(ifnull(`v`.`product_rm_technical_name`, ''), ':Raw Material Technical Name:O:N:') AS `product_rm_technical_name`,
    concat(ifnull(`v`.`product_rm_short_name`, ''), ':Raw Material Short Name:O:N:') AS `product_rm_short_name`,
    concat(ifnull(`v`.`product_rm_purchase_unit_name`, ''), 'Raw Material Purchase Unit Name:O:N:') AS `product_rm_purchase_unit_name`,
    concat(ifnull(`v`.`customer_code`, ''), ':Customer Code:O:N:') AS `customer_code`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`godown_short_name`, ''), ':Godown Short Name:O:N:') AS `godown_short_name`,
    concat(ifnull(`v`.`godown_area`, ''), ':Godown Area:O:N:') AS `godown_area`,
    concat(ifnull(`v`.`godown_section_count`, ''), ':Godown Section Count:O:N:') AS `godown_section_count`,
    concat(ifnull(`v`.`godown_section_short_name`, ''), ':Godown Section Short Name:O:N:') AS `godown_section_short_name`,
    concat(ifnull(`v`.`godown_section_area`, ''), ':Godown Section Area:O:N:') AS `godown_section_area`,
    concat(ifnull(`v`.`godown_section_beans_short_name`, ''), ':Godown Section Beans Short Name:O:N:') AS `godown_section_beans_short_name`,
    concat(ifnull(`v`.`godown_section_beans_area`, ''), ':Godown Section Beans Area:O:N:') AS `godown_section_beans_area`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:Y:C:smv_product_packing:F') AS `product_packing_name`,
    concat(ifnull(`v`.`quantity_per_packing`, ''), ':Quantity Per Packing:O:N:') AS `quantity_per_packing`,
    concat(ifnull(`v`.`weight_per_packing`, ''), ':Weight Per Packing:O:N:') AS `weight_per_packing`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') AS `supplier_code`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') AS `supplier_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') AS `financial_year`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') AS `product_type_group`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch:F') AS `company_branch_name`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`stock_transaction_id`, ''), ':Stock Transaction Id:O:N:') AS `stock_transaction_id`,
    concat(ifnull(`v`.`product_rm_id`, ''), ':Product Rm Id:O:N:') AS `product_rm_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:O:N:') AS `customer_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') AS `godown_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') AS `supplier_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') AS `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') AS `godown_section_beans_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit_id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') AS `product_material_packing_id`
from
    `smv_product_rm_stock_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
19-08-24

-- stv_indent_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_details` AS
select
    `v`.`indent_no` AS `indent_no`,
    `v`.`indent_date` AS `indent_date`,
    `v`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_item_status_desc`,
    `v`.`indent_source_desc` AS `indent_source_desc`,
    `v`.`department_name` AS `department_name`,
    `v`.`sub_department_name` AS `sub_department_name`,
    `v`.`indented_by_name` AS `indented_by_name`,
    `v`.`approved_by_name` AS `approved_by_name`,
    `v`.`customer_name` AS `customer_name`,
    `v`.`customer_order_date` AS `customer_order_date`,
    `v`.`expected_schedule_date` AS `expected_schedule_date`,
    `v`.`indent_status_desc` AS `indent_status_desc`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`so_sr_no` AS `so_sr_no`,
    `st`.`sales_order_details_transaction_id` AS `sales_order_details_transaction_id`,
    `st`.`remark` AS `remark`,
    `parent`.`product_material_name` AS `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` AS `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` AS `product_fg_material_weight`,
    `child`.`product_material_name` AS `product_rm_name`,
    `child`.`product_material_drawing_no` AS `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` AS `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` AS `product_rm_stock_unit_name`,
    `child`.`product_type_name` AS `product_type_name`,
    `child`.`product_material_category1_name` AS `product_category1_name`,
    `child`.`product_material_oem_part_code` AS `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` AS `product_rm_our_part_code`,
    `child`.`product_material_category2_name` AS `product_category2_name`,
    `child`.`product_material_category3_name` AS `product_category3_name`,
    `child`.`product_material_category4_name` AS `product_category4_name`,
    `child`.`product_material_category5_name` AS `product_category5_name`,
    `child`.`product_material_make_name` AS `product_make_name`,
    `child`.`product_material_type_name` AS `product_material_type_name`,
    `child`.`product_material_grade_name` AS `product_material_grade_name`,
    `child`.`product_material_std_weight` AS `product_rm_std_weight`,
    `child`.`product_material_packing_name` AS `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` AS `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` AS `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` AS `product_material_quantity`,
    `st`.`product_material_weight` AS `product_material_weight`,
    `st`.`lead_time` AS `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) AS `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) AS `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` AS `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` AS `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` AS `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` AS `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` AS `product_material_return_quantity`,
    `st`.`product_material_return_weight` AS `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` AS `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` AS `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` AS `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` AS `product_child_bom_weight`,
    `st`.`approval_remark` AS `approval_remark`,
    `e1`.`employee_name` AS `issued_by_name`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`issued_date` AS `issued_date`,
    `st`.`indent_item_status` AS `indent_item_status`,
    `v`.`indent_source` AS `indent_source`,
    `v`.`company_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `v`.`financial_year` AS `financial_year`,
    `child`.`product_type_group` AS `product_type_group`,
    `child`.`product_material_type_short_name` AS `indent_type_short_name`,
    `v`.`indent_type` AS `indent_type`,
    `v`.`indent_status` AS `indent_status`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`indent_details_id` AS `indent_details_id`,
    `st`.`product_fg_id` AS `product_fg_id`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`product_material_unit_id` AS `product_material_unit_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `fm`.`cost_center_name` AS `cost_center_name`,
    `v`.`indent_transaction_type` AS `indent_transaction_type`,
    `v`.`indent_master_id` AS `indent_master_id`,
    `v`.`indent_type_id` AS `indent_type_id`,
    `v`.`customer_id` AS `customer_id`,
    `v`.`department_id` AS `department_id`,
    `v`.`sub_department_id` AS `sub_department_id`,
    `v`.`indented_by_id` AS `indented_by_id`,
    `v`.`company_id` AS `company_id`,
    `v`.`company_branch_id` AS `company_branch_id`,
    `child`.`product_type_id` AS `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` AS `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` AS `product_rm_packing_id`,
    `child`.`product_material_category1_id` AS `product_category1_id`,
    `child`.`product_material_category2_id` AS `product_category2_id`,
    `child`.`product_material_category3_id` AS `product_category3_id`,
    `child`.`product_material_category4_id` AS `product_category4_id`,
    `child`.`product_material_category5_id` AS `product_category5_id`,
    `child`.`product_material_make_id` AS `product_make_id`,
    `child`.`product_material_type_id` AS `product_material_type_id`,
    `child`.`product_material_grade_id` AS `product_material_grade_id`
from
    (((((`st_indent_details` `st`
left join `stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `parent` on
    (`parent`.`product_material_id` = `st`.`product_fg_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_details_rpt` AS
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') AS `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') AS `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated, Partial PO Genreated, Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') AS `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') AS `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') AS `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') AS `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') AS `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') AS `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') AS `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') AS `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') AS `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') AS `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') AS `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') AS `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') AS `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') AS `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:') AS `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:') AS `product_material_receipt_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') AS `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') AS `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') AS `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') AS `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') AS `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') AS `product_child_bom_weight`,
    concat(ifnull(`v`.`product_parent_fg_name`, ''), ':Parent Finish Goods Name:O:N:') AS `product_parent_fg_name`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') AS `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') AS `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') AS `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') AS `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') AS `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') AS `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') AS `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') AS `product_category2_name`,
    concat(ifnull(`v`.`product_category3_name`, ''), ':Product Category3 Name:O:N:') AS `product_category3_name`,
    concat(ifnull(`v`.`product_category4_name`, ''), ':Product Category4 Name:O:N:') AS `product_category4_name`,
    concat(ifnull(`v`.`product_category5_name`, ''), ':Product Category5 Name:O:N:') AS `product_category5_name`,
    concat(ifnull(`v`.`product_make_name`, ''), ':Product Make Name:O:N:') AS `product_make_name`,
    concat(ifnull(`v`.`product_material_type_name`, ''), ':Material Type Name:O:N:') AS `product_material_type_name`,
    concat(ifnull(`v`.`product_material_grade_name`, ''), ':Material Grade Name:O:N:') AS `product_material_grade_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') AS `lead_time`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') AS `so_sr_no`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:C:cmv_employee_list:F') AS `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') AS `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') AS `indent_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') AS `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') AS `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') AS `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') AS `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') AS `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') AS `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') AS `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') AS `product_category2_id`,
    concat(ifnull(`v`.`product_category3_id`, ''), ':Product Category3 Id:N:N:') AS `product_category3_id`,
    concat(ifnull(`v`.`product_category4_id`, ''), ':Product Category4 Id:N:N:') AS `product_category4_id`,
    concat(ifnull(`v`.`product_category5_id`, ''), ':Product Category5 Id:N:N:') AS `product_category5_id`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') AS `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') AS `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') AS `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') AS `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') AS `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`
from
    `stv_indent_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_master_summary` AS
select
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `e`.`employee_name` AS `indented_by_name`,
    `e1`.`employee_name` AS `approved_by_name`,
    `e2`.`employee_name` AS `accepted_by_name`,
    `st`.`approved_date` AS `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end AS `indent_status_desc`,
    `c`.`customer_name` AS `customer_name`,
    `c`.`state_name` AS `customer_state_name`,
    `c`.`cust_branch_phone_no` AS `cust_branch_phone_no`,
    `c`.`cust_branch_address1` AS `cust_branch_address1`,
    `c`.`cust_branch_EmailId` AS `cust_branch_EmailId`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_Date` AS `customer_order_date`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fc`.`cost_center_name` AS `cost_center_name`,
    `e`.`email_id1` AS `indented_by_email`,
    `e1`.`email_id1` AS `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end AS `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`remark` AS `remark`,
    `st`.`indent_no` AS `field_name`,
    `st`.`indent_version` AS `field_id`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`indent_master_id` AS `indent_master_id`,
    `st`.`indent_type_id` AS `indent_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` AS `cust_branch_pan_no`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`indented_by_id` AS `indented_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`accepted_by_id` AS `accepted_by_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`indent_status` AS `indent_status`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`indent_transaction_type` AS `indent_transaction_type`,
    `st`.`Indent_type` AS `indent_type`,
    `p`.`product_type_short_name` AS `indent_type_short_name`,
    `st`.`indent_source` AS `indent_source`
from
    (((((((((`st_indent_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_master_summary_rpt` AS
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') AS `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') AS `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') AS `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') AS `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled,Purchse Order Genreated, Partial PO Genreated ,Goods Receipts,Partial Goods Receipts,Partial Issue)') AS `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') AS `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') AS `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') AS `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') AS `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') AS `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') AS `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') AS `indent_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') AS `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') AS `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') AS `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') AS `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
20-08-24


ALTER TABLE st_indent_master ADD po_status varchar(3) DEFAULT 'P' NULL COMMENT 'purchase order status for the indent master';
ALTER TABLE st_indent_master CHANGE po_status po_status varchar(3) DEFAULT 'P' NULL COMMENT 'purchase order status for the indent master' AFTER indent_status;
ALTER TABLE st_indent_master ADD grn_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the Indent master';
ALTER TABLE st_indent_master CHANGE grn_status grn_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the Indent master' AFTER po_status;
ALTER TABLE st_indent_master ADD issue_status varchar(3) DEFAULT 'P' NULL COMMENT 'issue_status for the Indent master';
ALTER TABLE st_indent_master CHANGE issue_status issue_status varchar(3) DEFAULT 'P' NULL COMMENT 'issue_status for the Indent master' AFTER grn_status;



ALTER TABLE st_indent_details ADD po_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'purchase order status for the indent master';
ALTER TABLE st_indent_details CHANGE po_item_status po_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'purchase order status for the indent master' AFTER indent_item_status;
ALTER TABLE st_indent_details ADD grn_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the Indent master';
ALTER TABLE st_indent_details CHANGE grn_item_status grn_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the Indent master' AFTER po_item_status;
ALTER TABLE st_indent_details ADD issue_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'issue_item_status for the Indent master';
ALTER TABLE st_indent_details CHANGE issue_item_status issue_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'issue_item_status for the Indent master' AFTER grn_item_status;


-------------------------------------------------------------------------------------------------------------------------------
20-08-24

-- stv_indent_details source

create or replace
algorithm = UNDEFINED view `stv_indent_details` as
select
	`v`.`indent_no` as `indent_no`,
	`v`.`indent_date` as `indent_date`,
	`v`.`indent_version` as `indent_version`,
	case
		`st`.`indent_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'C' then 'Completed'
		when 'X' then 'Cenceled'
		else 'Pending'
	end as `indent_item_status_desc`,
	`v`.`indent_source_desc` as `indent_source_desc`,
	`v`.`department_name` as `department_name`,
	`v`.`sub_department_name` as `sub_department_name`,
	`v`.`indented_by_name` as `indented_by_name`,
	`v`.`approved_by_name` as `approved_by_name`,
	`v`.`customer_name` as `customer_name`,
	`v`.`customer_order_date` as `customer_order_date`,
	`v`.`expected_schedule_date` as `expected_schedule_date`,
	`v`.`indent_status_desc` as `indent_status_desc`,
	`st`.`customer_order_no` as `customer_order_no`,
	`st`.`so_sr_no` as `so_sr_no`,
	`st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
	`st`.`remark` as `remark`,
	`parent`.`product_material_name` as `product_parent_fg_name`,
	`st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
	`st`.`product_fg_material_weight` as `product_fg_material_weight`,
	`child`.`product_material_name` as `product_rm_name`,
	`child`.`product_material_drawing_no` as `product_rm_drawing_no`,
	`child`.`product_material_tech_spect` as `product_rm_tech_spect`,
	`child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
	`child`.`product_type_name` as `product_type_name`,
	`child`.`product_material_category1_name` as `product_category1_name`,
	`child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
	`child`.`product_material_our_part_code` as `product_rm_our_part_code`,
	`child`.`product_material_category2_name` as `product_category2_name`,
	`child`.`product_material_category3_name` as `product_category3_name`,
	`child`.`product_material_category4_name` as `product_category4_name`,
	`child`.`product_material_category5_name` as `product_category5_name`,
	`child`.`product_material_make_name` as `product_make_name`,
	`child`.`product_material_type_name` as `product_material_type_name`,
	`child`.`product_material_grade_name` as `product_material_grade_name`,
	`child`.`product_material_std_weight` as `product_rm_std_weight`,
	`child`.`product_material_packing_name` as `product_rm_packing_name`,
	`child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
	`child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
	`st`.`product_material_quantity` as `product_material_quantity`,
	`st`.`product_material_weight` as `product_material_weight`,
	`st`.`lead_time` as `lead_time`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_weight`,
	`st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
	`st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
	`st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
	`st`.`product_material_approved_weight` as `product_material_approved_weight`,
	`st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
	`st`.`product_material_issue_weight` as `product_material_issue_weight`,
	`st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
	`st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
	`st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
	`st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
	`st`.`product_material_return_quantity` as `product_material_return_quantity`,
	`st`.`product_material_return_weight` as `product_material_return_weight`,
	`st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
	`st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
	`st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
	`st`.`product_child_bom_weight` as `product_child_bom_weight`,
	`st`.`approval_remark` as `approval_remark`,
	`e1`.`employee_name` as `issued_by_name`,
	`st`.`issued_by_id` as `issued_by_id`,
	`st`.`issued_date` as `issued_date`,
	`st`.`indent_item_status` as `indent_item_status`,
	`st`.`po_item_status` as `po_item_status`,
	`st`.`grn_item_status` as `grn_item_status`,
	`st`.`issue_item_status` as `issue_item_status`,
	`v`.`indent_source` as `indent_source`,
	`v`.`company_name` as `company_name`,
	`v`.`company_branch_name` as `company_branch_name`,
	`v`.`financial_year` as `financial_year`,
	`child`.`product_type_group` as `product_type_group`,
	`child`.`product_material_type_short_name` as `indent_type_short_name`,
	`v`.`indent_type` as `indent_type`,
	`v`.`indent_status` as `indent_status`,
	`st`.`indent_no` as `field_name`,
	`st`.`indent_version` as `field_id`,
	case
		when `st`.`is_active` = 1 then 'Active'
		else 'In Active'
	end as `Active`,
	case
		when `st`.`is_delete` = 1 then 'Yes'
		else 'No'
	end as `Deleted`,
	`v`.`is_active` as `is_active`,
	`st`.`is_delete` as `is_delete`,
	`st`.`created_by` as `created_by`,
	`st`.`created_on` as `created_on`,
	`st`.`modified_by` as `modified_by`,
	`st`.`modified_on` as `modified_on`,
	`st`.`deleted_by` as `deleted_by`,
	`st`.`deleted_on` as `deleted_on`,
	`st`.`indent_details_id` as `indent_details_id`,
	`st`.`product_fg_id` as `product_fg_id`,
	`st`.`product_material_id` as `product_material_id`,
	`st`.`product_material_unit_id` as `product_material_unit_id`,
	`st`.`cost_center_id` as `cost_center_id`,
	`fm`.`cost_center_name` as `cost_center_name`,
	`v`.`indent_transaction_type` as `indent_transaction_type`,
	`v`.`indent_master_id` as `indent_master_id`,
	`v`.`indent_type_id` as `indent_type_id`,
	`v`.`customer_id` as `customer_id`,
	`v`.`department_id` as `department_id`,
	`v`.`sub_department_id` as `sub_department_id`,
	`v`.`indented_by_id` as `indented_by_id`,
	`v`.`company_id` as `company_id`,
	`v`.`company_branch_id` as `company_branch_id`,
	`child`.`product_type_id` as `product_type_id`,
	`child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
	`child`.`product_material_packing_id` as `product_rm_packing_id`,
	`child`.`product_material_category1_id` as `product_category1_id`,
	`child`.`product_material_category2_id` as `product_category2_id`,
	`child`.`product_material_category3_id` as `product_category3_id`,
	`child`.`product_material_category4_id` as `product_category4_id`,
	`child`.`product_material_category5_id` as `product_category5_id`,
	`child`.`product_material_make_id` as `product_make_id`,
	`child`.`product_material_type_id` as `product_material_type_id`,
	`child`.`product_material_grade_id` as `product_material_grade_id`
from
	(((((`st_indent_details` `st`
left join `stv_indent_master_summary` `v` on
	(`st`.`company_branch_id` = `v`.`company_branch_id`
		and `st`.`company_id` = `v`.`company_id`
		and `st`.`indent_no` = `v`.`indent_no`
		and `st`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `child` on
	(`child`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e1` on
	(`e1`.`employee_id` = `st`.`issued_by_id`
		and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `parent` on
	(`parent`.`product_material_id` = `st`.`product_fg_id`))
left join `fm_cost_center` `fm` on
	(`fm`.`company_id` = `st`.`company_id`
		and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
	`st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

create or replace
algorithm = UNDEFINED view `stv_indent_master_summary` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        else 'Pending'
    end as `indent_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `c`.`state_name` as `customer_state_name`,
    `c`.`cust_branch_phone_no` as `cust_branch_phone_no`,
    `c`.`cust_branch_address1` as `cust_branch_address1`,
    `c`.`cust_branch_EmailId` as `cust_branch_EmailId`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `c`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` as `cust_branch_pan_no`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`
from
    (((((((((`st_indent_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or replace
algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

create or replace
algorithm = UNDEFINED view `stv_indent_details_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_item_status_desc`, ''), ':Indent Item Status:Y:H:(Pending,Approved,Rejected,Completed,Cancel)') as `indent_item_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') as `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') as `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') as `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') as `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') as `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') as `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') as `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') as `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') as `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') as `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') as `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') as `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') as `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:') as `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:') as `product_material_receipt_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') as `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') as `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') as `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') as `product_child_bom_weight`,
    concat(ifnull(`v`.`product_parent_fg_name`, ''), ':Parent Finish Goods Name:O:N:') as `product_parent_fg_name`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') as `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') as `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') as `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`product_category3_name`, ''), ':Product Category3 Name:O:N:') as `product_category3_name`,
    concat(ifnull(`v`.`product_category4_name`, ''), ':Product Category4 Name:O:N:') as `product_category4_name`,
    concat(ifnull(`v`.`product_category5_name`, ''), ':Product Category5 Name:O:N:') as `product_category5_name`,
    concat(ifnull(`v`.`product_make_name`, ''), ':Product Make Name:O:N:') as `product_make_name`,
    concat(ifnull(`v`.`product_material_type_name`, ''), ':Material Type Name:O:N:') as `product_material_type_name`,
    concat(ifnull(`v`.`product_material_grade_name`, ''), ':Material Grade Name:O:N:') as `product_material_grade_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') as `so_sr_no`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:C:cmv_employee_list:F') as `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') as `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') as `indent_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') as `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`product_category3_id`, ''), ':Product Category3 Id:N:N:') as `product_category3_id`,
    concat(ifnull(`v`.`product_category4_id`, ''), ':Product Category4 Id:N:N:') as `product_category4_id`,
    concat(ifnull(`v`.`product_category5_id`, ''), ':Product Category5 Id:N:N:') as `product_category5_id`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') as `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') as `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') as `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') as `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') as `issued_by_id`
from
    `stv_indent_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
21-08-2024

ALTER TABLE pt_purchase_order_master ADD grn_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the purchase order master';
ALTER TABLE pt_purchase_order_master CHANGE grn_status grn_status varchar(3) DEFAULT 'P' NULL COMMENT 'GRN status for the purchase order master' AFTER deduction4_percent;
ALTER TABLE pt_purchase_order_master CHANGE grn_status grn_status varchar(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT 'P' NULL COMMENT 'GRN status for the purchase order master' AFTER purchase_order_status;

ALTER TABLE pt_purchase_order_details ADD grn_item_status varchar(3) DEFAULT 'P' NULL COMMENT 'grn item status for the po item status';
ALTER TABLE pt_purchase_order_details  CHANGE grn_item_status grn_item_status varchar(3) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT 'P' NULL COMMENT 'GRN item status for the purchase order item details' AFTER purchase_order_item_status;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supplier_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supplier_type` as `supplier_type`,
    `s`.`supplier_code` as `supplier_code`,
    `s`.`supplier_short_name` as `supplier_short_name`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `s`.`district_name` as `district_name`,
    `s`.`country_name` as `country_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`district_name` as `expected_branch_district_name`,
    `cb`.`country_name` as `expected_branch_country_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supplier_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `cc`.`city_name` as `supp_consignee_city_name`,
    `cc`.`district_name` as `supp_consignee_district_name`,
    `cc`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((`pt_purchase_order_master` `pt`
left join `cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier` `s` on
    (`s`.`supplier_id` = `pt`.`supplier_id`))
left join `cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `cmv_supplier_branch` `cc` on
    (`cc`.`supplier_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_details` as
select
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`indent_no` as `indent_no`,
    `pt`.`indent_date` as `indent_date`,
    `pt`.`indent_version` as `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_status_desc`,
    `vp`.`department_name` as `department_name`,
    `sdp`.`department_name` as `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'Pending'
    end as `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` as `supplier_name`,
    `pom`.`state_name` as `supplier_state_name`,
    `c`.`customer_name` as `customer_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`sr_no` as `sr_no`,
    `pt`.`so_sr_no` as `so_sr_no`,
    `p`.`product_type_name` as `product_type_name`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `p`.`product_type_group` as `product_type_group`,
    `rmfgsr`.`product_material_code` as `product_material_code`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `pt`.`product_material_print_name` as `product_material_print_name`,
    `pt`.`product_material_tech_spect` as `product_material_tech_spect`,
    `pt`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_weight`,
    `rmfgsr`.`product_material_std_weight` as `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_stock_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` as `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_category1_name` as `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` as `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` as `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` as `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` as `product_category5_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` as `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` as `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` as `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` as `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` as `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` as `product_material_hsn_sac_code`,
    `rmfgsr`.`godown_name` as `godown_name`,
    `rmfgsr`.`godown_short_name` as `godown_short_name`,
    `rmfgsr`.`godown_area` as `godown_area`,
    `rmfgsr`.`godown_section_name` as `godown_section_name`,
    `rmfgsr`.`godown_section_short_name` as `godown_section_short_name`,
    `rmfgsr`.`godown_section_area` as `godown_section_area`,
    `rmfgsr`.`godown_section_beans_name` as `godown_section_beans_name`,
    `rmfgsr`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `rmfgsr`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` as `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` as `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` as `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` as `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` as `product_material_po_rejected_weight`,
    `pt`.`customer_id` as `customer_id`,
    `pt`.`customer_order_no` as `customer_order_no`,
    `pt`.`customer_order_Date` as `customer_order_Date`,
    `pt`.`pree_closed_quantity` as `pree_closed_quantity`,
    `pt`.`pree_closed_weight` as `pree_closed_weight`,
    `pt`.`purchase_return_quantity` as `purchase_return_quantity`,
    `pt`.`purchase_return_weight` as `purchase_return_weight`,
    `pt`.`material_rate` as `material_rate`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`pending_quantity` as `pending_quantity`,
    `pt`.`pending_weight` as `pending_weight`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`production_issue_quantity` as `production_issue_quantity`,
    `pt`.`production_issue_weight` as `production_issue_weight`,
    `pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` as `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `pt`.`sales_quantity` as `sales_quantity`,
    `pt`.`sales_weight` as `sales_weight`,
    `pt`.`sales_return_quantity` as `sales_return_quantity`,
    `pt`.`sales_return_weight` as `sales_return_weight`,
    `pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` as `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` as `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` as `outsources_out_quantity`,
    `pt`.`outsources_out_weight` as `outsources_out_weight`,
    `pt`.`outsources_in_quantity` as `outsources_in_quantity`,
    `pt`.`outsources_in_weight` as `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` as `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` as `loan_issue_quantity`,
    `pt`.`loan_issue_weight` as `loan_issue_weight`,
    `pt`.`cancel_quantity` as `cancel_quantity`,
    `pt`.`cancel_weight` as `cancel_weight`,
    `pt`.`difference_quantity` as `difference_quantity`,
    `pt`.`difference_weight` as `difference_weight`,
    `pt`.`material_po_approval_remark` as `material_po_approval_remark`,
    `pom`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`purchase_order_item_status` as `purchase_order_item_status`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pom`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `v`.`company_cell_no` as `company_cell_no`,
    `v`.`company_phone_no` as `company_phone_no`,
    `v`.`company_EmailId` as `company_EmailId`,
    `v`.`company_website` as `company_website`,
    `v`.`company_gst_no` as `company_gst_no`,
    `v`.`company_pan_no` as `company_pan_no`,
    `v`.`company_state` as `company_state`,
    `v`.`company_pincode` as `company_pincode`,
    `pt`.`financial_year` as `financial_year`,
    `pom`.`city_name` as `city_name`,
    `pom`.`district_name` as `district_name`,
    `pom`.`country_name` as `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` as `supplier_id`,
    `pom`.`supplier_state_id` as `supplier_state_id`,
    `pom`.`supplier_city_id` as `supplier_city_id`,
    `pom`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pom`.`expected_branch_id` as `expected_branch_id`,
    `pom`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`cost_center_id` as `cost_center_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` as `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` as `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` as `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` as `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` as `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` as `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` as `product_category5_id`,
    `rmfgsr`.`godown_id` as `godown_id`,
    `rmfgsr`.`godown_section_id` as `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` as `godown_section_beans_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`sub_department_id` as `sub_department_id`,
    `pt`.`indented_by_id` as `indented_by_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_weight`
from
    (((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))
left join `cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

create or replace
algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `rmfgsr`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` as `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` as `product_type_name`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_unit_name`,
    `rmfgsr`.`lead_time` as `product_lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `product_Rawmaterial_stock_weight`,
    coalesce((select sum(`ptdetails`.`reserve_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `reserve_quantity`,
    coalesce((select sum(`ptdetails`.`reserve_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `v`.`customer_state_name` as `customer_state_name`,
    `v`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`issue_no` as `field_name`,
    `v`.`issue_version` as `field_id`
from
    (((((((`st_indent_material_issue_details` `st`
left join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
22-08-2024 pending

ALTER TABLE pt_purchase_order_master ADD quotation_no varchar(50) NULL COMMENT 'Quotation No./Reference PI No. data entry field';
ALTER TABLE pt_purchase_order_master CHANGE quotation_no quotation_no varchar(50) NULL COMMENT 'Quotation No./Reference PI No. data entry field' AFTER consignee_city_id;
ALTER TABLE pt_purchase_order_master ADD quotation_date DATE NULL COMMENT 'Quotation Date data entry';
ALTER TABLE pt_purchase_order_master CHANGE quotation_date quotation_date DATE NULL COMMENT 'Quotation Date data entry' AFTER quotation_no;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supplier_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`quotation_no` as `quotation_no`,
    `pt`.`quotation_date` as `quotation_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supplier_type` as `supplier_type`,
    `s`.`supplier_code` as `supplier_code`,
    `s`.`supplier_short_name` as `supplier_short_name`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `s`.`district_name` as `district_name`,
    `s`.`country_name` as `country_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`district_name` as `expected_branch_district_name`,
    `cb`.`country_name` as `expected_branch_country_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supplier_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `cc`.`city_name` as `supp_consignee_city_name`,
    `cc`.`district_name` as `supp_consignee_district_name`,
    `cc`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((`pt_purchase_order_master` `pt`
left join `cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier` `s` on
    (`s`.`supplier_id` = `pt`.`supplier_id`))
left join `cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `cmv_supplier_branch` `cc` on
    (`cc`.`supplier_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary_rpt source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') as `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') as `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') as `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`quotation_no`, ''), ':Quotation No:Y:T') as `quotation_no`,
    concat(ifnull(`v`.`quotation_date`, ''), ':Quotation Date:Y:D:') as `quotation_date`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') as `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_process_entry_desc`, ''), ':Purchase Process Entry:Y:H:(Manual,Open)') as `purchase_process_entry_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') as `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') as `status_remark`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') as `supplier_code`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') as `supplier_type`,
    concat(ifnull(`v`.`supplier_short_name`, ''), ':Supplier Short Name:O:N:') as `supplier_short_name`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Branch Address1:O:N:') as `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`district_name`, ''), ':District Name:O:N:') as `district_name`,
    concat(ifnull(`v`.`state_name`, ''), ':State Name:O:N:') as `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Branch Name:O:N:') as `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Branch Short Name:O:N:') as `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Branch Address1:O:N:') as `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Branch Pincode:O:N:') as `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Branch City Name:O:N:') as `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_district_name`, ''), ':Branch District Name:O:N:') as `expected_branch_district_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Branch State Name:O:N:') as `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Expected Branch EmailId:O:N:') as `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') as `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') as `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_description`, ''), ':Hsn Sac Description:O:N:') as `hsn_sac_description`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') as `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`purchase_process_entry`, ''), ':Purchase Process Entry:O:N:') as `purchase_process_entry`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') as `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') as `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') as `expected_branch_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:N:N:') as `purchase_order_mail_sent_status`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:N:N:') as `purchase_order_acceptance_status`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') as `agent_id`
from
    `ptv_purchase_order_master_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_purchase_order_details ADD indent_remark varchar(500) NULL COMMENT 'indent_remark data entry indent extra material info';
ALTER TABLE pt_purchase_order_details CHANGE indent_remark indent_remark varchar(500) NULL COMMENT 'indent_remark data entry indent extra material info' AFTER remark;

-------------------------------------------------------------------------------------------------------------------------------
31-08-2024

-- ptv_purchase_order_master_summary_rpt source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') as `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') as `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') as `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`quotation_no`, ''), ':Quotation No:Y:T') as `quotation_no`,
    concat(ifnull(`v`.`quotation_date`, ''), ':Quotation Date:Y:D:') as `quotation_date`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') as `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_process_entry_desc`, ''), ':Purchase Process Entry:Y:H:(Manual,Open)') as `purchase_process_entry_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') as `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') as `status_remark`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') as `supplier_code`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') as `supplier_type`,
    concat(ifnull(`v`.`supplier_short_name`, ''), ':Supplier Short Name:O:N:') as `supplier_short_name`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Branch Address1:O:N:') as `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`district_name`, ''), ':District Name:O:N:') as `district_name`,
    concat(ifnull(`v`.`state_name`, ''), ':State Name:O:N:') as `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Branch Name:O:N:') as `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Branch Short Name:O:N:') as `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Branch Address1:O:N:') as `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Branch Pincode:O:N:') as `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Branch City Name:O:N:') as `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_district_name`, ''), ':Branch District Name:O:N:') as `expected_branch_district_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Branch State Name:O:N:') as `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Expected Branch EmailId:O:N:') as `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') as `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') as `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_description`, ''), ':Hsn Sac Description:O:N:') as `hsn_sac_description`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') as `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`purchase_process_entry`, ''), ':Purchase Process Entry:O:N:') as `purchase_process_entry`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') as `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') as `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') as `expected_branch_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:N:N:') as `purchase_order_mail_sent_status`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:N:N:') as `purchase_order_acceptance_status`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') as `agent_id`
from
    `ptv_purchase_order_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
02-09-2024


-- ptv_goods_receipt_details_rpt source

create or replace
algorithm = UNDEFINED view `ptv_goods_receipt_details_rpt` as
select
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:C:ptv_goods_receipt_details:O') as `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_date`, ''), ':Goods Receipt Date:Y:D:') as `goods_receipt_date`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') as `goods_receipt_version`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':Grn Item Status:Y:H:(GRN,Done,Rejected,Partial Receipt,Completed,Canceled,Pree Closed)') as `grn_item_status_desc`,
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending,Pree Closed)') as `purchase_order_item_status_desc`,
    concat(ifnull(`v`.`supplier_challan_no`, ''), ':Supplier Challan No:Y:C:ptv_goods_receipt_summary:O') as `supplier_challan_no`,
    concat(ifnull(`v`.`supplier_challan_date`, ''), ':Supplier Challan Date:Y:D:') as `supplier_challan_date`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:O:N:') as `product_material_name`,
    concat(ifnull(`v`.`product_material_std_weight`, ''), ':Product Std Weight:O:N:') as `product_material_std_weight`,
    concat(ifnull(`v`.`product_material_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_material_stock_unit_name`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') as `supplier_name`,
    concat(ifnull(`v`.`supplier_city_name`, ''), ':Supplier City Name:O:N:') as `supplier_city_name`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:Y:C:cmv_state:F') as `supplier_state_name`,
 	concat(ifnull(`v`.`product_material_po_approved_quantity`, ''), ':Material Po Approved Quantity:O:N:') as `product_material_po_approved_quantity`,
    concat(ifnull(`v`.`product_material_po_approved_weight`, ''), ':Material Po Approved Weight:O:N:') as `product_material_po_approved_weight`,
    concat(ifnull(`v`.`product_material_grn_quantity`, ''), ':Material GRN Quantity:O:N:') as `product_material_grn_quantity`,
    concat(ifnull(`v`.`product_material_grn_weight`, ''), ':Material GRN Weight:O:N:') as `product_material_grn_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':Material GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':Material GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`material_rate`, ''), ':Material Rate:O:N:') as `material_rate`,
    concat(ifnull(`v`.`material_basic_amount`, ''), ':Material Basic Amount:O:N:') as `material_basic_amount`,
    concat(ifnull(`v`.`material_discount_percent`, ''), ':Material Discount Percent:O:N:') as `material_discount_percent`,
    concat(ifnull(`v`.`material_discount_amount`, ''), ':Material Discount Amount:O:N:') as `material_discount_amount`,
    concat(ifnull(`v`.`material_taxable_amount`, ''), ':Material Taxable Amount:O:N:') as `material_taxable_amount`,
    concat(ifnull(`v`.`material_cgst_percent`, ''), ':Material Cgst Percent:O:N:') as `material_cgst_percent`,
    concat(ifnull(`v`.`material_cgst_total`, ''), ':Material Cgst Total:O:N:') as `material_cgst_total`,
    concat(ifnull(`v`.`material_sgst_percent`, ''), ':Material Sgst Percent:O:N:') as `material_sgst_percent`,
    concat(ifnull(`v`.`material_sgst_total`, ''), ':Material Sgst Total:O:N:') as `material_sgst_total`,
    concat(ifnull(`v`.`material_igst_percent`, ''), ':Material Igst Percent:O:N:') as `material_igst_percent`,
    concat(ifnull(`v`.`material_igst_total`, ''), ':Material Igst Total:O:N:') as `material_igst_total`,
    concat(ifnull(`v`.`material_total_amount`, ''), ':Material Total Amount:O:N:') as `material_total_amount`,
    concat(ifnull(`v`.`item_qa_by_id`, ''), ':Item QA By Id:O:N:') as `item_qa_by_id`,
    concat(ifnull(`v`.`item_qa_date`, ''), ':Item QA Date:Y:D:') as `item_qa_date`,
    concat(ifnull(`v`.`product_material_tech_spect`, ''), ':Product Material Tech Spect:O:N:') as `product_material_tech_spect`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:O') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_Date`, ''), ':Customer Order Date:Y:D:') as `customer_order_Date`,
    concat(ifnull(`v`.`material_schedule_date`, ''), ':Material Schedule Date:Y:D:') as `material_schedule_date`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Packing Name:O:N:') as `product_packing_name`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Material Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Material Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`product_material_oem_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_material_oem_part_code`,
    concat(ifnull(`v`.`product_material_our_part_code`, ''), ':Material Our Part Code:O:N:') as `product_material_our_part_code`,
    concat(ifnull(`v`.`product_material_drawing_no`, ''), ':Material Drawing No:O:N:') as `product_material_drawing_no`,
    concat(ifnull(`v`.`product_material_hsn_sac_code`, ''), ':Material Hsn Sac Code:O:N:') as `product_material_hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') as `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(`v`.`prev_grn_quantity`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_quantity`,
    concat(ifnull(`v`.`prev_grn_weight`, ''), ':Prev GRN Weight:O:N:') as `prev_grn_weight`,
    concat(ifnull(`v`.`product_material_prev_accepted_quantity`, ''), ':Material Prev Accepted Quantity:O:N:') as `product_material_prev_accepted_quantity`,
    concat(ifnull(`v`.`product_material_prev_accepted_weight`, ''), ':Material Prev Accepted Weight:O:N:') as `product_material_prev_accepted_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') as `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') as `excess_weight`,
    concat(ifnull(`v`.`pree_closed_grn_quantity`, ''), ':Pree Closed Grn Quantity:O:N:') as `pree_closed_grn_quantity`,
    concat(ifnull(`v`.`pree_closed_grn_weight`, ''), ':Pree Closed Grn Weight:O:N:') as `pree_closed_grn_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') as `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') as `purchase_return_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') as `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue weight:O:N:') as `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') as `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') as `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') as `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') as `production_issue_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') as `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') as `assembly_production_issue_weight`,
 	concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') as `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') as `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') as `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') as `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') as `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') as `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') as `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') as `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') as `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') as `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') as `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') as `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') as `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') as `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') as `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') as `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') as `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') as `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') as `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') as `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') as `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') as `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') as `difference_weight`,
    concat(ifnull(`v`.`expiry_date`, ''), ':Expiry Date:Y:D:') as `expiry_date`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:O:N:') as `indent_no`,
    concat(ifnull(`v`.`remark`, ''), ':remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_name`, ''), ':Product Type Name:O:N:') as `product_type_name`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':Grn Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:O:N:') as `purchase_order_item_status`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`goods_receipt_details_transaction_id`, ''), 'goods_receipt_details_transaction_id:N:N:') as `goods_receipt_details_transaction_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit_id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing_id:N:N:') as `product_material_packing_id`,
    concat(ifnull(`v`.`product_material_hsn_code_id`, ''), ':Product Material Hsn Code_id:N:N:') as `product_material_hsn_code_id`,
    concat(ifnull(`v`.`goods_receipt_type_id`, ''), ':Goods Receipt Type Id:N:N:') as `goods_receipt_type_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By:N:N:') as `approved_by_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') as `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') as `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') as `expected_branch_city_id`,
    concat(ifnull(`v`.`payment_term_id`, ''), ':Payment Term Id:N:N:') as `payment_term_id`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') as `agent_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`v`.`product_material_stock_unit_id`, ''), ':Material Stock Unit Id:N:N:') as `product_material_stock_unit_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`indent_by_id`, ''), ':Indent By Id:N:N:') as `indent_by_id`
from
    `ptv_goods_receipt_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_summary_rpt source

create or replace
algorithm = UNDEFINED view `ptv_goods_receipt_summary_rpt` as
select
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:C:ptv_goods_receipt_summary:O') as `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_date`, ''), ':Goods Receipt Date:Y:D:') as `goods_receipt_date`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt version:O:N:') as `goods_receipt_version`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:Y:H:(GRN Done,QC Done,Rejected,Partial Receipt,Completed,Canceled,GRN)') as `goods_receipt_status_desc`,
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:C:ptv_purchase_order_master_summary:O') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') as `supplier_name`,
    concat(ifnull(`v`.`supplier_challan_no`, ''), ':Supplier Challan No:Y:C:ptv_goods_receipt_summary:O') as `supplier_challan_no`,
    concat(ifnull(`v`.`supplier_challan_date`, ''), ':Supplier Challan Date:Y:D:') as `supplier_challan_date`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`goods_receipt_discount_percent`, ''), ':Discount Percent:O:N:') as `goods_receipt_discount_percent`,
    concat(ifnull(`v`.`goods_receipt_discount_amount`, ''), ':Discount Amount:O:N:') as `goods_receipt_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':Cgst Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':Sgst Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':Igst Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':Roundoff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`supplier_invoice_no`, ''), ':Supplier Invoice No:O:N:') as `supplier_invoice_no`,
    concat(ifnull(`v`.`supplier_invoice_date`, ''), ':Supplier Invoice Date:Y:D:') as `supplier_invoice_Date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`qa_by_name`, ''), ':QA By:Y:C:cmv_employee_list:F') as `qa_by_name`,
    concat(ifnull(`v`.`qa_date`, ''), ':QA Date:Y:D:') as `qa_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`lr_no`, ''), ':LR No:O:N:') as `lr_no`,
    concat(ifnull(`v`.`lr_date`, ''), ':LR Date:Y:D:') as `lr_date`,
    concat(ifnull(`v`.`vehicle_no`, ''), ':Vehicle No:O:N:') as `vehicle_no`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:O:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:O:N:') as `supplier_state_name`,
    concat(ifnull(`v`.`supplier_city_name`, ''), ':Supplier City Name:O:N:') as `supplier_city_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:O:N:') as `goods_receipt_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`goods_receipt_master_transaction_id`, ''), ':Goods Receipt Master Transaction Id:O:N:') as `goods_receipt_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') as `agent_id`,
    concat(ifnull(`v`.`qa_by_id`, ''), ':QA By Id:N:N:') as `qa_by_id`,
    concat(ifnull(`v`.`indent_by_id`, ''), ':Indent By Id:N:N:') as `indent_by_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:N:N:') as `approved_by_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') as `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') as `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') as `expected_branch_city_id`,
    concat(ifnull(`v`.`goods_receipt_type_id`, ''), ':Goods Receipt Type Id:N:N:') as `goods_receipt_type_id`,
    concat(ifnull(`v`.`payment_term_id`, ''), ':Payment Term Id:N:N:') as `payment_term_id`
from
    `ptv_goods_receipt_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- cmv_supplier_rpt source

create or replace
algorithm = UNDEFINED view `cmv_supplier_rpt` as
select
    concat(`v`.`supplier_name`, ':Supplier Name:Y:T:') as `supplier_name`,
    concat(`v`.`supplier_short_name`, ':Supplier Short Name:O:N:') as `supplier_short_name`,
    concat(`v`.`supplier_sector`, ':Supplier Sector:O:N:') as `supplier_sector`,
    concat(`v`.`supplier_type`, ':Supplier Type:Y:C:cmv_supplier:O') as `supplier_type`,
    concat(`v`.`supplier_code`, ':Supplier Code:O:N:') as `supplier_code`,
    concat(`v`.`nature_of_business`, ':Nature Of Business:O:N:') as `nature_of_business`,
    concat(`v`.`supplier_payment_terms`, ':Payment Terms:Y:P:PaymentTermDays:') as `supplier_payment_terms`,
    concat(`v`.`supplier_rating`, ':Supplier Rating:Y:T:') as `supplier_rating`,
    concat(`v`.`supplier_gl_codes`, ':Supplier Gl Codes:O:N:') as `supplier_gl_codes`,
    concat(`v`.`supplier_history`, ':Supplier History:O:N:') as `supplier_history`,
    concat(`v`.`supp_branch_short_name`, ':Branch Short Name:O:N:') as `supp_branch_short_name`,
    concat(`v`.`supp_branch_address1`, ':Branch Address1:O:N:') as `supp_branch_address1`,
    concat(`v`.`supp_branch_address2`, ':Branch Address2:O:N:') as `supp_branch_address2`,
    concat(`v`.`supp_branch_pincode`, ':Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(`v`.`city_name`, ':City:Y:C:cmv_city:F') as `city_name`,
    concat(`v`.`district_name`, ':District:Y:C:cmv_district:F') as `district_name`,
    concat(`v`.`state_name`, ':State:Y:C:cmv_state:O') as `state_name`,
    concat(`v`.`country_name`, ':Country:Y:C:cmv_country:F') as `country_name`,
    concat(`v`.`supp_branch_region`, ':Branch Region:Y:P:Regions') as `supp_branch_region`,
    concat(`v`.`supp_branch_phone_no`, ':Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(`v`.`supp_branch_cell_no`, ':Branch Cell No:O:N:') as `supp_branch_cell_no`,
    concat(`v`.`supp_branch_EmailId`, ':Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(`v`.`supp_branch_website`, ':Branch Website:O:N:') as `supp_branch_website`,
    concat(`v`.`supp_branch_linkedin_profile`, ':Branch Linkedin Profile:O:N:') as `supp_branch_linkedin_profile`,
    concat(`v`.`supp_branch_twitter_profile`, ':Branch Twitter Profile:O:N:') as `supp_branch_twitter_profile`,
    concat(`v`.`supp_branch_facebook_profile`, ':Branch Facebook Profile:O:N:') as `supp_branch_facebook_profile`,
    concat(`v`.`supp_branch_gst_no`, ':Branch Gst No:O:N:') as `supp_branch_gst_no`,
    concat(`v`.`supp_branch_gst_division`, ':branch Gst Division:O:N:') as `supp_branch_gst_division`,
    concat(`v`.`supp_branch_gst_range`, ':Branch Gst Range:O:N:') as `supp_branch_gst_range`,
    concat(`v`.`supp_branch_pan_no`, ':Branch Pan No:O:N:') as `supp_branch_pan_no`,
    concat(`v`.`supp_branch_udyog_adhar_no`, ':Branch Udyog Adhar_no:O:N:') as `supp_branch_udyog_adhar_no`,
    concat(`v`.`supp_branch_vat_no`, ':Branch Vat No:O:N:') as `supp_branch_vat_no`,
    concat(`v`.`supp_branch_service_tax_no`, ':Branch Service Tax No:O:N:') as `supp_branch_service_tax_no`,
    concat(`v`.`supp_branch_excise_no`, ':Branch Excise No:O:N:') as `supp_branch_excise_no`,
    concat(`v`.`supp_branch_cst_no`, ':Branch Cst_no:O:N:') as `supp_branch_cst_no`,
    concat(`v`.`supp_branch_bst_no`, ':Branch Bst No:O:N:') as `supp_branch_bst_no`,
    concat(`v`.`supp_branch_tally_id`, ':Branch Tally_id:O:N:') as `supp_branch_tally_id`,
    concat(`v`.`supp_branch_rating`, ':Branch Rating:O:N:') as `supp_branch_rating`,
    concat(`v`.`supp_branch_gl_codes`, ':Branch Gl Codes:O:N:') as `supp_branch_gl_codes`,
    concat(`v`.`supp_branch_accounts_id`, ':Branch Accounts Id:O:N:') as `supp_branch_accounts_id`,
    concat(`v`.`is_sez`, ':Is Sez:Y:H:(Yes,No)') as `is_sez`,
    concat(`v`.`sez_name`, ':Sez Name:O:N:') as `sez_name`,
    concat(`v`.`company_name`, ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(`v`.`company_branch_name`, ':Company Branch Name:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(`v`.`remark`, ':Remark:O:N:') as `remark`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') as `Deleted`,
    concat(`v`.`created_by`, ':Created By:O:N:') as `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') as `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') as `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') as `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') as `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') as `deleted_on`,
    concat(`v`.`company_id`, ':Company Id:N:N:') as `company_id`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(`v`.`supplier_accounts_id`, ':Supplier Accounts Id:N:N:') as `supplier_accounts_id`,
    concat(`v`.`supplier_id`, ':Supplier Id:O:N:') as `supplier_id`,
    concat(`v`.`supp_branch_city_id`, ':Supp Branch City Id:N:N:') as `supp_branch_city_id`,
    concat(`v`.`supp_branch_district_id`, ':Supp Branch District Id:N:N:') as `supp_branch_district_id`,
    concat(`v`.`supp_branch_state_id`, ':Supp Branch State Id:N:N:') as `supp_branch_state_id`,
    concat(`v`.`supp_branch_country_id`, ':Supp Branch Country Id:N:N:') as `supp_branch_country_id`,
    concat(`v`.`supplier_id`, ':Supplier Id:N:N:') as `field_id`,
    concat(`v`.`supplier_name`, ':Supplier Name:N:N:') as `field_name`
from
    `cmv_supplier` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
04-09-2024


-- ptv_purchase_order_details source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_details` as
select
	`pt`.`purchase_order_type` as `purchase_order_type`,
	`pt`.`purchase_order_no` as `purchase_order_no`,
	`pt`.`purchase_order_date` as `purchase_order_date`,
	`pt`.`purchase_order_version` as `purchase_order_version`,
	`pt`.`indent_no` as `indent_no`,
	`pt`.`indent_date` as `indent_date`,
	`pt`.`indent_version` as `indent_version`,
	case
		`pom`.`purchase_order_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'X' then 'Canceled'
		else 'Pending'
	end as `purchase_order_status_desc`,
	`vp`.`department_name` as `department_name`,
	`sdp`.`department_name` as `sub_department_name`,
	case
		`pt`.`purchase_order_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'I' then 'Partial Receipt'
		when 'C' then 'Completed'
		when 'X' then 'Canceled'
		when 'Z' then 'Pree Closed'
		when 'B' then 'Bill Booked'
		else 'Pending'
	end as `purchase_order_item_status_desc`,
	case
		`pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
		when 'F' then 'Email Failed'
		else 'Email Pending'
	end as `purchase_order_mail_sent_status_desc`,
	`pom`.`supplier_name` as `supplier_name`,
	`pom`.`state_name` as `supplier_state_name`,
	`c`.`customer_name` as `customer_name`,
	`e1`.`employee_name` as `indented_by_name`,
	`e`.`employee_name` as `approved_by_name`,
	`pt`.`sr_no` as `sr_no`,
	`pt`.`so_sr_no` as `so_sr_no`,
	`p`.`product_type_name` as `product_type_name`,
	`p`.`product_type_short_name` as `product_type_short_name`,
	`p`.`product_type_group` as `product_type_group`,
	`rmfgsr`.`product_material_code` as `product_material_code`,
	`rmfgsr`.`product_material_name` as `product_material_name`,
	`pt`.`product_material_print_name` as `product_material_print_name`,
	`pt`.`product_material_tech_spect` as `product_material_tech_spect`,
	`pt`.`lead_time` as `lead_time`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_weight`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_weight`,
	`rmfgsr`.`product_material_std_weight` as `product_material_std_weight`,
	`rmfgsr`.`product_material_stock_unit_name` as `product_material_stock_unit_name`,
	`pp`.`product_packing_name` as `product_packing_name`,
	`pp`.`quantity_per_packing` as `quantity_per_packing`,
	`hsn`.`hsn_sac_type` as `hsn_sac_type`,
	`hsn`.`hsn_sac_code` as `hsn_sac_code`,
	`hsn`.`hsn_sac_description` as `hsn_sac_description`,
	`hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
	`rmfgsr`.`product_type_group` as `product_material_type_group`,
	`rmfgsr`.`product_material_make_name` as `product_make_name`,
	`rmfgsr`.`product_material_category1_name` as `product_category1_name`,
	`rmfgsr`.`product_material_category2_name` as `product_category2_name`,
	`rmfgsr`.`product_material_category3_name` as `product_category3_name`,
	`rmfgsr`.`product_material_category4_name` as `product_category4_name`,
	`rmfgsr`.`product_material_category5_name` as `product_category5_name`,
	`rmfgsr`.`product_material_type_name` as `product_material_type_name`,
	`rmfgsr`.`product_material_grade_name` as `product_material_grade_name`,
	`rmfgsr`.`product_material_shape_name` as `product_material_shape_name`,
	`rmfgsr`.`product_material_oem_part_code` as `product_material_oem_part_code`,
	`rmfgsr`.`product_material_our_part_code` as `product_material_our_part_code`,
	`rmfgsr`.`product_material_drawing_no` as `product_material_drawing_no`,
	`rmfgsr`.`product_material_hsn_sac_code` as `product_material_hsn_sac_code`,
	`rmfgsr`.`godown_name` as `godown_name`,
	`rmfgsr`.`godown_short_name` as `godown_short_name`,
	`rmfgsr`.`godown_area` as `godown_area`,
	`rmfgsr`.`godown_section_name` as `godown_section_name`,
	`rmfgsr`.`godown_section_short_name` as `godown_section_short_name`,
	`rmfgsr`.`godown_section_area` as `godown_section_area`,
	`rmfgsr`.`godown_section_beans_name` as `godown_section_beans_name`,
	`rmfgsr`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
	`rmfgsr`.`godown_section_beans_area` as `godown_section_beans_area`,
	`pt`.`product_material_po_quantity_qunital` as `product_material_po_quantity_qunital`,
	`pt`.`product_material_po_quantity` as `product_material_po_quantity`,
	`pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
	`pt`.`product_material_po_weight` as `product_material_po_weight`,
	`pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
	`pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
	`pt`.`product_material_po_rejected_quantity` as `product_material_po_rejected_quantity`,
	`pt`.`product_material_po_rejected_weight` as `product_material_po_rejected_weight`,
	`pt`.`customer_id` as `customer_id`,
	`pt`.`customer_order_no` as `customer_order_no`,
	`pt`.`customer_order_Date` as `customer_order_Date`,
	`pt`.`pree_closed_quantity` as `pree_closed_quantity`,
	`pt`.`pree_closed_weight` as `pree_closed_weight`,
	`pt`.`purchase_return_quantity` as `purchase_return_quantity`,
	`pt`.`purchase_return_weight` as `purchase_return_weight`,
	`pt`.`material_rate` as `material_rate`,
	`pt`.`material_basic_amount` as `material_basic_amount`,
	`pt`.`material_discount_percent` as `material_discount_percent`,
	`pt`.`material_discount_amount` as `material_discount_amount`,
	`pt`.`material_taxable_amount` as `material_taxable_amount`,
	`pt`.`material_cgst_percent` as `material_cgst_percent`,
	`pt`.`material_cgst_total` as `material_cgst_total`,
	`pt`.`material_sgst_percent` as `material_sgst_percent`,
	`pt`.`material_sgst_total` as `material_sgst_total`,
	`pt`.`material_igst_percent` as `material_igst_percent`,
	`pt`.`material_igst_total` as `material_igst_total`,
	`pt`.`material_total_amount` as `material_total_amount`,
	`pt`.`material_schedule_date` as `material_schedule_date`,
	`pt`.`material_freight_amount` as `material_freight_amount`,
	`pt`.`pending_quantity` as `pending_quantity`,
	`pt`.`pending_weight` as `pending_weight`,
	`pt`.`excess_quantity` as `excess_quantity`,
	`pt`.`excess_weight` as `excess_weight`,
	`pt`.`production_issue_quantity` as `production_issue_quantity`,
	`pt`.`production_issue_weight` as `production_issue_weight`,
	`pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
	`pt`.`production_issue_return_weight` as `production_issue_return_weight`,
	`pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
	`pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
	`pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
	`pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
	`pt`.`sales_quantity` as `sales_quantity`,
	`pt`.`sales_weight` as `sales_weight`,
	`pt`.`sales_return_quantity` as `sales_return_quantity`,
	`pt`.`sales_return_weight` as `sales_return_weight`,
	`pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
	`pt`.`sales_rejection_weight` as `sales_rejection_weight`,
	`pt`.`transfer_issue_quantity` as `transfer_issue_quantity`,
	`pt`.`transfer_issue_weight` as `transfer_issue_weight`,
	`pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
	`pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
	`pt`.`outsources_out_quantity` as `outsources_out_quantity`,
	`pt`.`outsources_out_weight` as `outsources_out_weight`,
	`pt`.`outsources_in_quantity` as `outsources_in_quantity`,
	`pt`.`outsources_in_weight` as `outsources_in_weight`,
	`pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
	`pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
	`pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
	`pt`.`loan_receipt_weight` as `loan_receipt_weight`,
	`pt`.`loan_issue_quantity` as `loan_issue_quantity`,
	`pt`.`loan_issue_weight` as `loan_issue_weight`,
	`pt`.`cancel_quantity` as `cancel_quantity`,
	`pt`.`cancel_weight` as `cancel_weight`,
	`pt`.`difference_quantity` as `difference_quantity`,
	`pt`.`difference_weight` as `difference_weight`,
	`pt`.`material_po_approval_remark` as `material_po_approval_remark`,
	`pom`.`purchase_order_status` as `purchase_order_status`,
	`pt`.`purchase_order_item_status` as `purchase_order_item_status`,
	`pt`.`grn_item_status` as `grn_item_status`,
	`pom`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
	`pt`.`approved_date` as `approved_date`,
	`pt`.`remark` as `remark`,
	`v`.`company_legal_name` as `company_name`,
	`v`.`company_branch_name` as `company_branch_name`,
	`v`.`company_cell_no` as `company_cell_no`,
	`v`.`company_phone_no` as `company_phone_no`,
	`v`.`company_EmailId` as `company_EmailId`,
	`v`.`company_website` as `company_website`,
	`v`.`company_gst_no` as `company_gst_no`,
	`v`.`company_pan_no` as `company_pan_no`,
	`v`.`company_state` as `company_state`,
	`v`.`company_pincode` as `company_pincode`,
	`pt`.`financial_year` as `financial_year`,
	`pom`.`city_name` as `city_name`,
	`pom`.`district_name` as `district_name`,
	`pom`.`country_name` as `country_name`,
	case
		`pt`.`is_active` when 1 then 'Active'
		else 'In Active'
	end as `Active`,
	case
		`pt`.`is_delete` when 1 then 'Yes'
		else 'No'
	end as `Deleted`,
	`pt`.`is_active` as `is_active`,
	`pt`.`is_delete` as `is_delete`,
	`pt`.`created_by` as `created_by`,
	`pt`.`created_on` as `created_on`,
	`pt`.`modified_by` as `modified_by`,
	`pt`.`modified_on` as `modified_on`,
	`pt`.`deleted_by` as `deleted_by`,
	`pt`.`deleted_on` as `deleted_on`,
	`pt`.`company_id` as `company_id`,
	`pt`.`company_branch_id` as `company_branch_id`,
	`pt`.`purchase_order_type_id` as `purchase_order_type_id`,
	`pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
	`pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
	`pom`.`supplier_id` as `supplier_id`,
	`pom`.`supplier_state_id` as `supplier_state_id`,
	`pom`.`supplier_city_id` as `supplier_city_id`,
	`pom`.`supplier_contacts_ids` as `supplier_contacts_ids`,
	`pom`.`expected_branch_id` as `expected_branch_id`,
	`pom`.`expected_branch_state_id` as `expected_branch_state_id`,
	`pom`.`expected_branch_city_id` as `expected_branch_city_id`,
	`pt`.`cost_center_id` as `cost_center_id`,
	`rmfgsr`.`product_material_type_id` as `product_material_type_id`,
	`rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
	`rmfgsr`.`product_material_shape_id` as `product_material_shape_id`,
	`rmfgsr`.`product_material_stock_unit_id` as `product_material_stock_unit_id`,
	`rmfgsr`.`product_material_category1_id` as `product_category1_id`,
	`rmfgsr`.`product_material_category2_id` as `product_category2_id`,
	`rmfgsr`.`product_material_category3_id` as `product_category3_id`,
	`rmfgsr`.`product_material_category4_id` as `product_category4_id`,
	`rmfgsr`.`product_material_category5_id` as `product_category5_id`,
	`rmfgsr`.`godown_id` as `godown_id`,
	`rmfgsr`.`godown_section_id` as `godown_section_id`,
	`rmfgsr`.`godown_section_beans_id` as `godown_section_beans_id`,
	`pt`.`product_material_id` as `product_material_id`,
	`pt`.`product_material_unit_id` as `product_material_unit_id`,
	`pt`.`product_material_packing_id` as `product_material_packing_id`,
	`pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
	`pt`.`department_id` as `department_id`,
	`pt`.`sub_department_id` as `sub_department_id`,
	`pt`.`indented_by_id` as `indented_by_id`,
	`pt`.`approved_by_id` as `approved_by_id`,
	coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id`  and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` != ''), 0) as `prev_po_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id`  and `ptdetails`.`is_active` = 1  and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` != ''), 0) as `prev_po_weight`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_weight`
from
	(((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
	(`pom`.`company_branch_id` = `pt`.`company_branch_id`
		and `pom`.`company_id` = `pt`.`company_id`
		and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
		and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
		and `pom`.`is_delete` = 0))
left join `cmv_company_summary` `v` on
	(`v`.`company_branch_id` = `pt`.`company_branch_id`
		and `v`.`company_id` = `pt`.`company_id`))
left join `smv_product_type` `p` on
	(`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `smv_product_rm_fg_sr` `rmfgsr` on
	(`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `smv_product_packing` `pp` on
	(`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `cm_hsn_sac` `hsn` on
	(`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `cmv_department` `vp` on
	(`vp`.`department_id` = `pt`.`department_id`))
left join `cmv_employee` `e` on
	(`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
	(`e1`.`employee_id` = `pt`.`indented_by_id`
		and `e1`.`company_id` = `pt`.`company_id`))
left join `cmv_customer` `c` on
	(`c`.`customer_id` = `pt`.`customer_id`))
left join `cmv_department` `sdp` on
	(`sdp`.`department_id` = `pt`.`sub_department_id`))

where
	`pt`.`is_delete` = 0;



-- stv_indent_details source

create or replace
algorithm = UNDEFINED view `stv_indent_details` as
select
    `v`.`indent_no` as `indent_no`,
    `v`.`indent_date` as `indent_date`,
    `v`.`indent_version` as `indent_version`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_item_status_desc`,
    `v`.`indent_source_desc` as `indent_source_desc`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    `v`.`indented_by_name` as `indented_by_name`,
    `v`.`approved_by_name` as `approved_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`customer_order_date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `v`.`indent_status_desc` as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `parent`.`product_material_name` as `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_category3_name` as `product_category3_name`,
    `child`.`product_material_category4_name` as `product_category4_name`,
    `child`.`product_material_category5_name` as `product_category5_name`,
    `child`.`product_material_make_name` as `product_make_name`,
    `child`.`product_material_type_name` as `product_material_type_name`,
    `child`.`product_material_grade_name` as `product_material_grade_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e1`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `v`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_category3_id` as `product_category3_id`,
    `child`.`product_material_category4_id` as `product_category4_id`,
    `child`.`product_material_category5_id` as `product_category5_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id`  and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id` ), 0) as `prev_po_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id`  and `ptdetails`.`is_active` = 1  and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((`st_indent_details` `st`
left join `stv_indent_master_summary` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `parent` on
    (`parent`.`product_material_id` = `st`.`product_fg_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- cmv_supplier source

create or replace
algorithm = UNDEFINED view `cmv_supplier` as
select
    `c`.`supplier_name` as `supplier_name`,
    `c`.`supplier_short_name` as `supplier_short_name`,
    `c`.`supplier_sector` as `supplier_sector`,
    `c`.`supplier_type` as `supplier_type`,
    `c`.`supplier_code` as `supplier_code`,
    `c`.`nature_of_business` as `nature_of_business`,
    `c`.`supplier_accounts_id` as `supplier_accounts_id`,
    `p1`.`property_name` as `supplier_payment_terms`,
    `c`.`supplier_rating` as `supplier_rating`,
    `c`.`supplier_gl_codes` as `supplier_gl_codes`,
    `c`.`supplier_history` as `supplier_history`,
    `b`.`supp_branch_name` as `supp_branch_name`,
    `b`.`supp_branch_short_name` as `supp_branch_short_name`,
    `b`.`supp_branch_address1` as `supp_branch_address1`,
    `b`.`supp_branch_address2` as `supp_branch_address2`,
    `b`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `d`.`district_name` as `district_name`,
    `s`.`state_name` as `state_name`,
    `c1`.`country_name` as `country_name`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `b`.`supp_branch_region` as `supp_branch_region`,
    `b`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `b`.`supp_branch_cell_no` as `supp_branch_cell_no`,
    `b`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `b`.`supp_branch_website` as `supp_branch_website`,
    `b`.`supp_branch_linkedin_profile` as `supp_branch_linkedin_profile`,
    `b`.`supp_branch_twitter_profile` as `supp_branch_twitter_profile`,
    `b`.`supp_branch_facebook_profile` as `supp_branch_facebook_profile`,
    `b`.`supp_branch_gst_no` as `supp_branch_gst_no`,
    `b`.`supp_branch_gst_division` as `supp_branch_gst_division`,
    `b`.`supp_branch_gst_range` as `supp_branch_gst_range`,
    `b`.`supp_branch_pan_no` as `supp_branch_pan_no`,
    `b`.`supp_branch_udyog_adhar_no` as `supp_branch_udyog_adhar_no`,
    `b`.`supp_branch_vat_no` as `supp_branch_vat_no`,
    `b`.`supp_branch_service_tax_no` as `supp_branch_service_tax_no`,
    `b`.`supp_branch_excise_no` as `supp_branch_excise_no`,
    `b`.`supp_branch_cst_no` as `supp_branch_cst_no`,
    `b`.`supp_branch_bst_no` as `supp_branch_bst_no`,
    `b`.`supp_branch_tally_id` as `supp_branch_tally_id`,
    `b`.`supp_branch_rating` as `supp_branch_rating`,
    `b`.`supp_branch_gl_codes` as `supp_branch_gl_codes`,
    `b`.`supp_branch_accounts_id` as `supp_branch_accounts_id`,
    `b`.`is_sez` as `is_sez`,
    `b`.`sez_name` as `sez_name`,
    `c`.`username` as `supplier_username`,
    `c`.`password` as `supplier_password`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `c`.`remark` as `remark`,
    `b`.`is_active` as `is_active`,
    `b`.`is_delete` as `is_delete`,
    `b`.`created_by` as `created_by`,
    `b`.`created_on` as `created_on`,
    `b`.`modified_by` as `modified_by`,
    `b`.`modified_on` as `modified_on`,
    `b`.`deleted_by` as `deleted_by`,
    `b`.`deleted_on` as `deleted_on`,
    `c`.`company_id` as `company_id`,
    `c`.`company_branch_id` as `company_branch_id`,
    `c`.`supplier_id` as `supplier_id`,
    `c`.`payment_term_id` as `payment_term_id`,
    `b`.`supp_branch_city_id` as `supp_branch_city_id`,
    `b`.`supp_branch_district_id` as `supp_branch_district_id`,
    `b`.`supp_branch_state_id` as `supp_branch_state_id`,
    `b`.`supp_branch_country_id` as `supp_branch_country_id`,
    `b`.`supp_branch_id` as `supp_branch_id`,
    `c`.`supplier_id` as `field_id`,
    `c`.`supplier_name` as `field_name`
from
    (((((((`cm_supplier` `c`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `c`.`company_branch_id`
        and `v`.`company_id` = `c`.`company_id`))
left join `amv_properties` `p1` on
    (`p1`.`properties_master_name` = 'PaymentTermDays'
        and `p1`.`property_id` = `c`.`payment_term_id`))
left join `cm_supplier_branch` `b` on
    (`b`.`branch_type` = 'Main'
        and `c`.`supplier_id` = `b`.`supplier_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `b`.`supp_branch_city_id`))
left join `cm_district` `d` on
    (`d`.`district_id` = `b`.`supp_branch_district_id`))
left join `cm_state` `s` on
    (`s`.`state_id` = `b`.`supp_branch_state_id`))
left join `cm_country` `c1` on
    (`c1`.`country_id` = `b`.`supp_branch_country_id`))
where
    `c`.`is_delete` = 0;
--------------------------------------------------------------------------------------------------------------------------------------------------------

   -- cmv_supplier_branch source

create or replace
algorithm = UNDEFINED view `cmv_supplier_branch` as
select
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `c`.`supplier_name` as `supplier_name`,
    `c`.`supplier_short_name` as `supplier_short_name`,
    `c`.`supplier_type` as `supplier_type`,
    `c`.`supplier_code` as `supplier_code`,
    `c`.`supplier_sector` as `supplier_sector`,
    `c`.`nature_of_business` as `nature_of_business`,
    `p1`.`property_name` as `supplier_payment_terms`,
    `c`.`supplier_rating` as `supplier_rating`,
    `c`.`supplier_gl_codes` as `supplier_gl_codes`,
    `c`.`supplier_accounts_id` as `supplier_accounts_id`,
    `c`.`supplier_history` as `supplier_history`,
    `b`.`supp_branch_name` as `supp_branch_name`,
    `b`.`supp_branch_short_name` as `supp_branch_short_name`,
    `b`.`supp_branch_vendor_code` as `supp_branch_vendor_code`,
    `b`.`branch_type` as `branch_type`,
    `b`.`supp_branch_type` as `supp_branch_type`,
    `p3`.`property_name` as `supp_branch_payment_terms`,
    `b`.`supp_branch_address1` as `supp_branch_address1`,
    `b`.`supp_branch_address2` as `supp_branch_address2`,
    `b`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `d`.`district_name` as `district_name`,
    `s`.`state_name` as `state_name`,
    `c1`.`country_name` as `country_name`,
    `b`.`supp_branch_region` as `supp_branch_region`,
    `b`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `b`.`supp_branch_cell_no` as `supp_branch_cell_no`,
    `b`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `b`.`supp_branch_website` as `supp_branch_website`,
    `b`.`supp_branch_linkedin_profile` as `supp_branch_linkedin_profile`,
    `b`.`supp_branch_twitter_profile` as `supp_branch_twitter_profile`,
    `b`.`supp_branch_facebook_profile` as `supp_branch_facebook_profile`,
    `b`.`supp_branch_gst_no` as `supp_branch_gst_no`,
    `b`.`supp_branch_gst_division` as `supp_branch_gst_division`,
    `b`.`supp_branch_gst_range` as `supp_branch_gst_range`,
    `b`.`supp_branch_pan_no` as `supp_branch_pan_no`,
    `b`.`supp_branch_udyog_adhar_no` as `supp_branch_udyog_adhar_no`,
    `b`.`supp_branch_vat_no` as `supp_branch_vat_no`,
    `b`.`supp_branch_service_tax_no` as `supp_branch_service_tax_no`,
    `b`.`supp_branch_excise_no` as `supp_branch_excise_no`,
    `b`.`supp_branch_cst_no` as `supp_branch_cst_no`,
    `b`.`supp_branch_bst_no` as `supp_branch_bst_no`,
    `b`.`supp_branch_tally_id` as `supp_branch_tally_id`,
    `b`.`supp_branch_rating` as `supp_branch_rating`,
    `b`.`supp_branch_gl_codes` as `supp_branch_gl_codes`,
    `b`.`supp_branch_city_id` as `supp_branch_city_id`,
    `b`.`supp_branch_district_id` as `supp_branch_district_id`,
    `b`.`supp_branch_state_id` as `supp_branch_state_id`,
    `b`.`supp_branch_country_id` as `supp_branch_country_id`,
    `b`.`supp_branch_accounts_id` as `supp_branch_accounts_id`,
    `b`.`supp_branch_blocked` as `supp_branch_blocked`,
    `b`.`supp_branch_blocked_remark` as `supp_branch_blocked_remark`,
    `b`.`supp_branch_payment_blocked` as `supp_branch_payment_blocked`,
    `b`.`supp_branch_payment_blocked_remark` as `supp_branch_payment_blocked_remark`,
    `b`.`is_sez` as `is_sez`,
    `b`.`sez_name` as `sez_name`,
    case
        `b`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `b`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `b`.`is_active` as `is_active`,
    `b`.`is_delete` as `is_delete`,
    `b`.`created_by` as `created_by`,
    `b`.`created_on` as `created_on`,
    `b`.`modified_by` as `modified_by`,
    `b`.`modified_on` as `modified_on`,
    `b`.`deleted_by` as `deleted_by`,
    `b`.`deleted_on` as `deleted_on`,
    `b`.`supp_branch_id` as `supp_branch_id`,
    `b`.`supplier_id` as `supplier_id`,
    `b`.`company_id` as `company_id`,
    `b`.`company_branch_id` as `company_branch_id`,
    `b`.`supp_branch_payment_term_id` as `supp_branch_payment_term_id`,
    `c`.`payment_term_id` as `payment_term_id`,
    `b`.`supp_branch_id` as `field_id`,
    `b`.`supp_branch_name` as `field_name`
from
    ((((((((`cm_supplier` `c`
left join `cm_supplier_branch` `b` on
    (`c`.`supplier_id` = `b`.`supplier_id`))
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `b`.`company_branch_id`
        and `v`.`company_id` = `b`.`company_id`))
left join `amv_properties` `p1` on
    (`p1`.`properties_master_name` = 'PaymentTermDays'
        and `p1`.`property_id` = `c`.`payment_term_id`))
left join `amv_properties` `p3` on
    (`p3`.`properties_master_name` = 'PaymentTermDays'
        and `p3`.`property_id` = `b`.`supp_branch_payment_term_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `b`.`supp_branch_city_id`))
left join `cm_district` `d` on
    (`d`.`district_id` = `b`.`supp_branch_district_id`))
left join `cm_state` `s` on
    (`s`.`state_id` = `b`.`supp_branch_state_id`))
left join `cm_country` `c1` on
    (`c1`.`country_id` = `b`.`supp_branch_country_id`))
where
    `b`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary source

create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supp_branch_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`quotation_no` as `quotation_no`,
    `pt`.`quotation_date` as `quotation_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supplier_type` as `supplier_type`,
    `s`.`supplier_code` as `supplier_code`,
    `s`.`supplier_short_name` as `supplier_short_name`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `s`.`district_name` as `district_name`,
    `s`.`country_name` as `country_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`district_name` as `expected_branch_district_name`,
    `cb`.`country_name` as `expected_branch_country_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supp_branch_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `cc`.`city_name` as `supp_consignee_city_name`,
    `cc`.`district_name` as `supp_consignee_district_name`,
    `cc`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((`pt_purchase_order_master` `pt`
left join `cmv_company` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
left join `cmv_supplier_branch` `s` on
    (`s`.`supp_branch_id` = `pt`.`supplier_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `cmv_supplier_branch` `cc` on
    (`cc`.`supp_branch_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_goods_receipt_summary source

create or replace
algorithm = UNDEFINED view `ptv_goods_receipt_summary` as
select
    `sup`.`supp_branch_name` as `supplier_name`,
    `pt`.`goods_receipt_no` as `goods_receipt_no`,
    `pt`.`goods_receipt_date` as `goods_receipt_date`,
    `pt`.`goods_receipt_version` as `goods_receipt_version`,
    case
        `pt`.`goods_receipt_status` when 'G' then 'GRN Done'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end as `goods_receipt_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    (
    select
        distinct `po1`.`indented_by_id`
    from
        `pt_purchase_order_details` `po1`
    where
        `po1`.`purchase_order_no` in (
        select
            distinct `pd1`.`purchase_order_no`
        from
            `pt_goods_receipt_details` `pd1`
        where
            `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`)) as `indent_by_id`,
    (
    select
        distinct `pd1`.`purchase_order_no`
    from
        `pt_goods_receipt_details` `pd1`
    where
        `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
    limit 1) as `purchase_order_no`,
    (
    select
        distinct `pd1`.`purchase_order_date`
    from
        `pt_goods_receipt_details` `pd1`
    where
        `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
    limit 1) as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`goods_receipt_type` as `goods_receipt_type`,
    `pt`.`supplier_invoice_no` as `supplier_invoice_no`,
    `pt`.`supplier_invoice_date` as `supplier_invoice_date`,
    `pt`.`supplier_challan_no` as `supplier_challan_no`,
    `pt`.`supplier_challan_date` as `supplier_challan_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    `pt`.`agent_paid_status` as `agent_paid_status`,
    `e1`.`employee_name` as `qa_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`qa_date` as `qa_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`goods_receipt_discount_percent` as `goods_receipt_discount_percent`,
    `pt`.`goods_receipt_discount_amount` as `goods_receipt_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`grand_total` as `grand_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`goods_receipt_status` as `goods_receipt_status`,
    `pt`.`lr_no` as `lr_no`,
    `pt`.`lr_date` as `lr_date`,
    `pt`.`vehicle_no` as `vehicle_no`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `sup`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `sup`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `sup`.`supp_branch_address1` as `supp_branch_address1`,
    `sup`.`supp_branch_pincode` as `supp_branch_pincode`,
    `sup`.`supp_branch_gst_no` as `supp_branch_gst_no`,
    `sup`.`supp_branch_pan_no` as `supp_branch_pan_no`,
    `pt`.`ev_bill_no` as `ev_bill_no`,
    `pt`.`ev_bill_date` as `ev_bill_date`,
    `pt`.`remark` as `remark`,
    `cb`.`is_sez` as `is_sez`,
    `cb`.`company_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_pincode` as `company_pincode`,
    `cb`.`branch_phone_no` as `company_phone_no`,
    `cb`.`state_name` as `company_branch_state`,
    `cb`.`city_name` as `company_branch_city`,
    `cb`.`branch_cell_no` as `company_cell_no`,
    `cb`.`branch_EmailId` as `company_EmailId`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`,
    `cb`.`branch_address1` as `company_address1`,
    `cb`.`branch_address2` as `company_address2`,
    `ct`.`city_name` as `supplier_city_name`,
    `s`.`state_name` as `supplier_state_name`,
    `pt`.`financial_year` as `financial_year`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`is_preeclosed` as `is_preeclosed`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`goods_receipt_master_transaction_id` as `goods_receipt_master_transaction_id`,
    `pt`.`qa_by_id` as `qa_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`goods_receipt_type_id` as `goods_receipt_type_id`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `sup`.`payment_term_id` as `payment_term_id`
from
    ((((((((`pt_goods_receipt_master` `pt`
left join `cm_company_branch` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `cmv_supplier_branch` `sup` on
    (`sup`.`supp_branch_id` = `pt`.`supplier_id`
        and `pt`.`is_delete` = 0))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`qa_by_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_state` `s` on
    (`s`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cmv_company_branch_summary` `cb` on
    (`cb`.`company_branch_id` = `pt`.`expected_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
09-09-2024
-- erp_development_2.smv_product_stock_adjustment_details_rpt source

create or replace
algorithm = UNDEFINED view `smv_product_stock_adjustment_details_rpt` as
select
    concat(ifnull(`v`.`product_material_code`, ''), ':Product Material Code:Y:T:') as `product_material_code`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Product Material Name:Y:T:') as `product_material_name`,
    concat(ifnull(`v`.`stock_adjustment_type`, ''), ':Stock Adjustment Type:O:N:') as `stock_adjustment_type`,
    concat(ifnull(`v`.`stock_quantity`, ''), ':Stock Quantity:Y:T:') as `stock_quantity`,
    concat(ifnull(`v`.`stock_weight`, ''), ':Stock Weight:Y:T:') as `stock_weight`,
    concat(ifnull(`v`.`stock_adjustment_quantity`, ''), ':Stock Adjustment Quantity:Y:T:') as `stock_adjustment_quantity`,
    concat(ifnull(`v`.`stock_adjustment_weight`, ''), ':Stock Adjustment Weight:Y:T:') as `stock_adjustment_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') as `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') as `closing_balance_weight`,
    concat(ifnull(`v`.`stock_date`, ''), ':Adjustment Date:Y:D:') as `stock_date`,
    concat(ifnull(`v`.`adjustment_by`, ''), ':Adjustment By:O:N:') as `adjustment_by`,
    concat(ifnull(`v`.`adjustment_reason`, ''), ':Adjustment Reason:O:N:') as `adjustment_reason`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:O:N:') as `approved_by`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') as `godown_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(ifnull(`v`.`is_delete`, ''), ':Is Delete:O:N:') as `is_delete`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`stock_adjustment_transaction_id`, ''), ':Stock Adjustment Transaction Id:O:N:') as `stock_adjustment_transaction_id`,
    concat(ifnull(`v`.`stock_adjustment_details_transaction_id`, ''), ':Stock Adjustment Details Transaction Id:N:N:') as `stock_adjustment_details_transaction_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') as `godown_id`
from
    `smv_product_stock_adjustment_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
11-09-24

-- stv_indent_material_issue_summary source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_summary` AS
select
    `st`.`issue_no` AS `issue_no`,
    `st`.`issue_date` AS `issue_date`,
    `st`.`issue_version` AS `issue_version`,
    `st`.`issue_group_type` AS `issue_group_type`,
    `st`.`indent_issue_type` AS `indent_issue_type`,
    `st`.`indent_no` AS `indent_no`,
    `st`.`indent_date` AS `indent_date`,
    `st`.`indent_version` AS `indent_version`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end AS `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end AS `indent_source_desc`,
    `vp`.`department_name` AS `department_name`,
    `sd`.`department_name` AS `sub_department_name`,
    `re`.`employee_name` AS `requisition_by_name`,
    `ae`.`employee_name` AS `approved_by_name`,
    `ie`.`employee_name` AS `issued_by_name`,
    `c`.`customer_name` AS `customer_name`,
    `st`.`customer_order_no` AS `customer_order_no`,
    `st`.`customer_order_date` AS `customer_order_date`,
    `c`.`state_name` AS `customer_state_name`,
    `st`.`expected_schedule_date` AS `expected_schedule_date`,
    `fm`.`cost_center_name` AS `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `v`.`company_legal_name` AS `company_name`,
    `v`.`company_branch_name` AS `company_branch_name`,
    `c`.`cust_branch_gst_no` AS `cust_branch_gst_no`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`remark` AS `remark`,
    `st`.`indent_issue_type_id` AS `indent_issue_type_id`,
    `st`.`customer_id` AS `customer_id`,
    `st`.`department_id` AS `department_id`,
    `st`.`sub_department_id` AS `sub_department_id`,
    `st`.`issued_by_id` AS `issued_by_id`,
    `st`.`approved_by_id` AS `approved_by_id`,
    `st`.`requisition_by_id` AS `requisition_by_id`,
    `st`.`requisition_date` AS `requisition_date`,
    `st`.`approved_date` AS `approved_date`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `st`.`issue_master_transaction_id` AS `issue_master_transaction_id`,
    `st`.`cost_center_id` AS `cost_center_id`,
    `st`.`issue_status` AS `issue_status`,
    `st`.`issue_source` AS `issue_source`,
    `st`.`issue_no` AS `field_name`,
    `st`.`issue_version` AS `field_id`
from
    ((((((((`st_indent_material_issue_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cmv_customer_summary` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`))
left join `cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- 11-09-2024 --
ALTER TABLE st_indent_master ADD indent_priority varchar(1) DEFAULT 'L' NULL COMMENT 'radio button for indent priority L-Low-priority , H- High-priority';

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

create or replace
algorithm = UNDEFINED view `stv_indent_master_summary` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `c`.`state_name` as `customer_state_name`,
    `c`.`cust_branch_phone_no` as `cust_branch_phone_no`,
    `c`.`cust_branch_address1` as `cust_branch_address1`,
    `c`.`cust_branch_EmailId` as `cust_branch_EmailId`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `c`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `c`.`cust_branch_pan_no` as `cust_branch_pan_no`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`,
    `st`.`indent_priority` as `indent_priority`

from
    (((((((((`st_indent_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fmv_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or replace
algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`indent_priority`, ''), ':Priority:O:N:') as `indent_priority`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
12-08-2024

ALTER TABLE sm_product_stock_adjustment_details ADD opening_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'material opening_quantity of opening balance will be store in this column';
ALTER TABLE sm_product_stock_adjustment_details CHANGE opening_quantity opening_quantity DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'material opening_quantity of opening balance will be store in this column' AFTER stock_weight;
ALTER TABLE sm_product_stock_adjustment_details ADD opening_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'material opening_weight of opening balance will be store in this column';
ALTER TABLE sm_product_stock_adjustment_details CHANGE opening_weight opening_weight DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'material opening_weight of opening balance will be store in this column' AFTER opening_quantity;


-------------------------------------------------------------------------------------------------------------------------------


-- smv_product_stock_adjustment_details source

create or replace
algorithm = UNDEFINED view `smv_product_stock_adjustment_details` as
select
    `rm_fg_sr`.`product_material_code` as `product_material_code`,
    `rm_fg_sr`.`product_material_name` as `product_material_name`,
    `sm`.`stock_adjustment_type` as `stock_adjustment_type`,
    `sm`.`stock_quantity` as `stock_quantity`,
    `sm`.`stock_weight` as `stock_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`stock_adjustment_quantity` as `stock_adjustment_quantity`,
    `sm`.`stock_adjustment_weight` as `stock_adjustment_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`stock_date` as `stock_date`,
    `sa`.`adjustment_by` as `adjustment_by`,
    `sa`.`adjustment_reason` as `adjustment_reason`,
    `sa`.`approved_by` as `approved_by`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `sm`.`goods_receipt_no` as `goods_receipt_no`,
    `sm`.`batch_expiry_date` as `batch_expiry_date`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`financial_year` as `financial_year`,
    `sm`.`stock_adjustment_transaction_id` as `stock_adjustment_transaction_id`,
    `sm`.`stock_adjustment_details_transaction_id` as `stock_adjustment_details_transaction_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `sm`.`product_material_id` as `product_material_id`
from
    (((((`sm_product_stock_adjustment_details` `sm`
left join `sm_product_stock_adjustment_master` `sa` on
    (`sa`.`stock_adjustment_transaction_id` = `sm`.`stock_adjustment_transaction_id`
        and `sa`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `sm`.`product_material_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`));
-------------------------------------------------------------------------------------------------------------------------------

   -- smv_product_stock_adjustment_details_rpt source

create or replace
algorithm = UNDEFINED view `smv_product_stock_adjustment_details_rpt` as
select
    concat(ifnull(`v`.`product_material_code`, ''), ':Product Material Code:Y:T:') as `product_material_code`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Product Material Name:Y:T:') as `product_material_name`,
    concat(ifnull(`v`.`stock_adjustment_type`, ''), ':Stock Adjustment Type:O:N:') as `stock_adjustment_type`,
    concat(ifnull(`v`.`stock_quantity`, ''), ':Stock Quantity:Y:T:') as `stock_quantity`,
    concat(ifnull(`v`.`stock_weight`, ''), ':Stock Weight:Y:T:') as `stock_weight`,
    concat(ifnull(`v`.`opening_quantity`, ''), ':Opening Balance Quantity:Y:T:') as `opening_quantity`,
    concat(ifnull(`v`.`opening_weight`, ''), ':Opening Balance Weight:Y:T:') as `opening_weight`,
    concat(ifnull(`v`.`stock_adjustment_quantity`, ''), ':Stock Adjustment Quantity:Y:T:') as `stock_adjustment_quantity`,
    concat(ifnull(`v`.`stock_adjustment_weight`, ''), ':Stock Adjustment Weight:Y:T:') as `stock_adjustment_weight`,
    concat(ifnull(`v`.`closing_balance_quantity`, ''), ':Closing Balance Quantity:O:N:') as `closing_balance_quantity`,
    concat(ifnull(`v`.`closing_balance_weight`, ''), ':Closing Balance Weight:O:N:') as `closing_balance_weight`,
    concat(ifnull(`v`.`stock_date`, ''), ':Adjustment Date:Y:D:') as `stock_date`,
    concat(ifnull(`v`.`adjustment_by`, ''), ':Adjustment By:O:N:') as `adjustment_by`,
    concat(ifnull(`v`.`adjustment_reason`, ''), ':Adjustment Reason:O:N:') as `adjustment_reason`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:O:N:') as `approved_by`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') as `godown_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(ifnull(`v`.`is_delete`, ''), ':Is Delete:O:N:') as `is_delete`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`stock_adjustment_transaction_id`, ''), ':Stock Adjustment Transaction Id:O:N:') as `stock_adjustment_transaction_id`,
    concat(ifnull(`v`.`stock_adjustment_details_transaction_id`, ''), ':Stock Adjustment Details Transaction Id:N:N:') as `stock_adjustment_details_transaction_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') as `godown_id`
from
    `smv_product_stock_adjustment_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
17-09-24

ALTER TABLE st_indent_material_issue_details ADD profit_center_id BIGINT(20) NOT NULL COMMENT 'profit center combobox from fmv_profit_centre';
ALTER TABLE st_indent_material_issue_details CHANGE profit_center_id profit_center_id BIGINT(20) NOT NULL COMMENT 'profit center combobox from fmv_profit_centre' AFTER cost_center_id;
ALTER TABLE st_indent_material_issue_details ADD routing_code varchar(100) NULL COMMENT 'combination of profit and cost center short names';
ALTER TABLE st_indent_material_issue_details CHANGE routing_code routing_code varchar(100) NULL COMMENT 'combination of profit and cost center short names' AFTER profit_center_id;
ALTER TABLE st_indent_material_issue_details CHANGE cost_center_id cost_center_id bigint(20) NOT NULL AFTER material_batch_rate;
ALTER TABLE st_indent_material_issue_details CHANGE customer_order_no customer_order_no varchar(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL NULL AFTER issue_remark;
ALTER TABLE st_indent_material_issue_details CHANGE issue_batch_no issue_batch_no varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL NULL AFTER customer_order_no;
ALTER TABLE st_indent_material_issue_details CHANGE material_batch_rate material_batch_rate double(18,4) DEFAULT 0.0000 NULL COMMENT 'fill when material get issue update rate while issue from stock table' AFTER issue_batch_no;
ALTER TABLE st_indent_material_issue_details CHANGE indent_details_id indent_details_id bigint(20) DEFAULT 0 NULL COMMENT 'indent details transaction id' AFTER routing_code;




-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

create or replace
algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `rmfgsr`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` as `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` as `product_type_name`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_unit_name`,
    `rmfgsr`.`lead_time` as `product_lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `product_Rawmaterial_stock_weight`,
    coalesce((select sum(`ptdetails`.`reserve_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `reserve_quantity`,
    coalesce((select sum(`ptdetails`.`reserve_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`godown_id` = `st`.`godown_id`), 0) as `reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `v`.`customer_state_name` as `customer_state_name`,
    `v`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fmp`.`profit_center_name` as `profit_center_name`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `st`.`routing_code` as `routing_code`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`issue_no` as `field_name`,
    `v`.`issue_version` as `field_id`
from
    ((((((((`st_indent_material_issue_details` `st`
left join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`is_delete` = 0
        and `e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `st`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `st`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`is_delete` = 0
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `fm_profit_center` `fmp` on
    (`fmp`.`is_delete` = 0
        and `fmp`.`profit_center_id` = `st`.`profit_center_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
26-09-24

--ptv_goods_receipt_summary source

create or REPLACE algorithm = UNDEFINED view`ptv_goods_receipt_summary` as
select
    `sup`.`supp_branch_name` as `supplier_name`,
    `pt`.`goods_receipt_no` as `goods_receipt_no`,
    `pt`.`goods_receipt_date` as `goods_receipt_date`,
    `pt`.`goods_receipt_version` as `goods_receipt_version`,
    case
        `pt`.`goods_receipt_status` when 'G' then 'GRN Done'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end as `goods_receipt_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    (
    select
        distinct `po1`.`indent_no`
    from
       `pt_purchase_order_details` `po1`
    where
        `po1`.`purchase_order_no` in (
        select
            distinct `pd1`.`purchase_order_no`
        from
           `pt_goods_receipt_details` `pd1`
        where
            `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`)) as `indent_no`,
    (
    select
        distinct `po1`.`indented_by_id`
    from
       `pt_purchase_order_details` `po1`
    where
        `po1`.`purchase_order_no` in (
        select
            distinct `pd1`.`purchase_order_no`
        from
           `pt_goods_receipt_details` `pd1`
        where
            `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`)) as `indent_by_id`,
    (
    select
        distinct `pd1`.`purchase_order_no`
    from
       `pt_goods_receipt_details` `pd1`
    where
        `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
    limit 1) as `purchase_order_no`,
    (
    select
        distinct `pd1`.`purchase_order_date`
    from
       `pt_goods_receipt_details` `pd1`
    where
        `pd1`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
    limit 1) as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`goods_receipt_type` as `goods_receipt_type`,
    `pt`.`supplier_invoice_no` as `supplier_invoice_no`,
    `pt`.`supplier_invoice_date` as `supplier_invoice_date`,
    `pt`.`supplier_challan_no` as `supplier_challan_no`,
    `pt`.`supplier_challan_date` as `supplier_challan_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    `pt`.`agent_paid_status` as `agent_paid_status`,
    `e1`.`employee_name` as `qa_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`qa_date` as `qa_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`goods_receipt_discount_percent` as `goods_receipt_discount_percent`,
    `pt`.`goods_receipt_discount_amount` as `goods_receipt_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`grand_total` as `grand_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`goods_receipt_status` as `goods_receipt_status`,
    `pt`.`lr_no` as `lr_no`,
    `pt`.`lr_date` as `lr_date`,
    `pt`.`vehicle_no` as `vehicle_no`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `sup`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `sup`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `sup`.`supp_branch_address1` as `supp_branch_address1`,
    `sup`.`supp_branch_pincode` as `supp_branch_pincode`,
    `sup`.`supp_branch_gst_no` as `supp_branch_gst_no`,
    `sup`.`supp_branch_pan_no` as `supp_branch_pan_no`,
    `pt`.`ev_bill_no` as `ev_bill_no`,
    `pt`.`ev_bill_date` as `ev_bill_date`,
    `pt`.`remark` as `remark`,
    `cb`.`is_sez` as `is_sez`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `ct`.`city_name` as `supplier_city_name`,
    `s`.`state_name` as `supplier_state_name`,
    `pt`.`financial_year` as `financial_year`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`is_preeclosed` as `is_preeclosed`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`goods_receipt_master_transaction_id` as `goods_receipt_master_transaction_id`,
    `pt`.`qa_by_id` as `qa_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`goods_receipt_type_id` as `goods_receipt_type_id`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `sup`.`supp_branch_payment_term_id` as `payment_term_id`
from
    ((((((((`pt_goods_receipt_master` `pt`
left join`cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`is_delete` = 0))
left join`cm_supplier_branch` `sup` on
    (`sup`.`supp_branch_id` = `pt`.`supplier_id`
        and `pt`.`is_delete` = 0))
left join`cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join`cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`qa_by_id`))
left join`cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join`cm_state` `s` on
    (`s`.`state_id` = `pt`.`supplier_state_id`))
left join`cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join`cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`expected_branch_id`
        and `cb`.`is_delete` = 0))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
--ptv_goods_receipt_details source

create or REPLACE algorithm = UNDEFINED view`ptv_goods_receipt_details` as
select
    `pt`.`goods_receipt_no` as `goods_receipt_no`,
    `pt`.`goods_receipt_date` as `goods_receipt_date`,
    `pt`.`goods_receipt_version` as `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        else 'GRN'
    end as `grn_item_status_desc`,
    `d`.`department_name` as `department_name`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        `po`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_item_status_desc`,
    `cu`.`customer_name` as `customer_name`,
    `pt`.`customer_order_no` as `customer_order_no`,
    `pt`.`customer_order_Date` as `customer_order_Date`,
    `grm`.`purchase_order_life` as `purchase_order_life`,
    `grm`.`supplier_challan_no` as `supplier_challan_no`,
    `grm`.`supplier_challan_date` as `supplier_challan_date`,
    `sup`.`supp_branch_name` as `supplier_name`,
    `ct`.`city_name` as `supplier_city_name`,
    `ss`.`state_name` as `supplier_state_name`,
    `pt`.`item_qa_by_id` as `item_qa_by_id`,
    `pt`.`item_qa_date` as `item_qa_date`,
    `pt`.`goods_receipt_type` as `goods_receipt_type`,
    `pt`.`product_material_tech_spect` as `product_material_tech_spect`,
    `pt`.`lead_time` as `lead_time`,
    `pt`.`sr_no` as `sr_no`,
    `pt`.`batch_no` as `batch_no`,
    `po`.`purchase_order_item_status` as `purchase_order_item_status`,
    `rm_fg`.`product_material_name` as `product_material_name`,
    `u`.`product_unit_name` as `product_material_stock_unit_name`,
    `rm_fg`.`product_material_std_weight` as `product_material_std_weight`,
    `rm_fg`.`product_material_category1_name` as `product_category1_name`,
    `rm_fg`.`product_material_category2_name` as `product_category2_name`,
    `pk`.`product_packing_name` as `product_packing_name`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` as `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` as `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` as `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` as `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` as `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` as `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` as `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from`pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) as `prev_grn_weight`,
    `so`.`sales_order_no` as `sales_order_no`,
    `pt`.`product_material_grn_accepted_quantity` as `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` as `product_material_prev_accepted_weight`,
    `pt`.`material_rate` as `material_rate`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`pree_closed_grn_quantity` as `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` as `pree_closed_grn_weight`,
    `pt`.`purchase_return_quantity` as `purchase_return_quantity`,
    `pt`.`purchase_return_weight` as `purchase_return_weight`,
    `pt`.`production_issue_quantity` as `production_issue_quantity`,
    `pt`.`production_issue_weight` as `production_issue_weight`,
    `pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` as `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `pt`.`sales_quantity` as `sales_quantity`,
    `pt`.`sales_weight` as `sales_weight`,
    `pt`.`sales_return_quantity` as `sales_return_quantity`,
    `pt`.`sales_return_weight` as `sales_return_weight`,
    `pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` as `sales_rejection_weight`,
    `pt`.`transfer_issue_weight` as `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` as `outsources_out_quantity`,
    `pt`.`outsources_out_weight` as `outsources_out_weight`,
    `pt`.`outsources_in_quantity` as `outsources_in_quantity`,
    `pt`.`outsources_in_weight` as `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` as `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` as `loan_issue_quantity`,
    `pt`.`loan_issue_weight` as `loan_issue_weight`,
    `pt`.`cancel_quantity` as `cancel_quantity`,
    `pt`.`cancel_weight` as `cancel_weight`,
    `pt`.`difference_quantity` as `difference_quantity`,
    `pt`.`difference_weight` as `difference_weight`,
    `pt`.`total_box_weight` as `total_box_weight`,
    `pt`.`total_quantity_in_box` as `total_quantity_in_box`,
    `pt`.`weight_per_box_item` as `weight_per_box_item`,
    `pt`.`remark` as `remark`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`expiry_date` as `expiry_date`,
    `po`.`indent_no` as `indent_no`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `g`.`godown_name` as `godown_name`,
    `gs`.`godown_section_name` as `godown_section_name`,
    `gsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `pdt`.`product_type_group` as `product_material_type_group`,
    `pdt`.`product_type_name` as `product_type_name`,
    `pdt`.`product_type_short_name` as `product_type_short_name`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`goods_receipt_details_transaction_id` as `goods_receipt_details_transaction_id`,
    `pt`.`goods_receipt_master_transaction_id` as `goods_receipt_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` as `goods_receipt_type_id`,
    `pt`.`customer_id` as `customer_id`,
    `pt`.`product_material_rejection_reason_id` as `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` as `goods_receipt_status`,
    `grm`.`supplier_id` as `supplier_id`,
    `grm`.`approved_by_id` as `approved_by_id`,
    `grm`.`supplier_state_id` as `supplier_state_id`,
    `grm`.`supplier_city_id` as `supplier_city_id`,
    `grm`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `grm`.`expected_branch_id` as `expected_branch_id`,
    `grm`.`expected_branch_state_id` as `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` as `expected_branch_city_id`,
    `sup`.`supp_branch_payment_term_id` as `payment_term_id`,
    `grm`.`agent_id` as `agent_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`godown_id` as `godown_id`,
    `pt`.`godown_section_id` as `godown_section_id`,
    `pt`.`godown_section_beans_id` as `godown_section_beans_id`,
    `po`.`purchase_order_type_id` as `product_type_id`,
    `rm_fg`.`product_material_category1_id` as `product_category1_id`,
    `rm_fg`.`product_material_category2_id` as `product_category2_id`,
    `po`.`indented_by_id` as `indent_by_id`
from
    (((((((((((((((((((((`pt_goods_receipt_details` `pt`
left join`cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join`cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join`pt_goods_receipt_master` `grm` on
    (`grm`.`goods_receipt_master_transaction_id` = `pt`.`goods_receipt_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join`cm_supplier_branch` `sup` on
    (`sup`.`supp_branch_id` = `grm`.`supplier_id`
        and `pt`.`is_delete` = 0))
left join`cm_city` `ct` on
    (`ct`.`city_id` = `grm`.`supplier_city_id`))
left join`cm_state` `ss` on
    (`ss`.`state_id` = `grm`.`supplier_state_id`))
left join`pt_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join`sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `pt`.`is_delete` = 0))
left join`smv_product_rm_fg_sr` `rm_fg` on
    (`rm_fg`.`product_material_id` = `pt`.`product_material_id`))
left join`sm_product_type` `pdt` on
    (`pdt`.`product_type_id` = `po`.`purchase_order_type_id`
        and `pdt`.`is_delete` = 0))
left join`sm_product_packing` `pk` on
    (`pk`.`product_packing_id` = `pt`.`product_material_packing_id`
        and `pk`.`is_delete` = 0))
left join`cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`
        and `hsn`.`is_delete` = 0))
left join`cm_employee` `e1` on
    (`e1`.`employee_id` = `po`.`indented_by_id`
        and `e1`.`is_delete` = 0))
left join`cm_employee` `e2` on
    (`e2`.`employee_id` = `grm`.`approved_by_id`
        and `e2`.`is_delete` = 0))
left join`cm_customer` `cu` on
    (`cu`.`customer_id` = `po`.`customer_id`
        and `cu`.`is_delete` = 0))
left join`cm_department` `d` on
    (`d`.`department_id` = `pt`.`department_id`))
left join`sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
left join`mt_sales_order_master_trading` `so` on
    (`so`.`company_id` = `pt`.`company_id`
        and `so`.`customer_order_no` = `pt`.`customer_order_no`))
left join`cm_godown` `g` on
    (`g`.`godown_id` = `pt`.`godown_id`))
left join`cm_godown_section` `gs` on
    (`gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join`cm_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
--ptv_goods_receipt_summary_rpt source

create or REPLACE algorithm = UNDEFINED view`ptv_goods_receipt_summary_rpt` as
select
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:T') as `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_date`, ''), ':Goods Receipt Date:Y:D:') as `goods_receipt_date`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt version:O:N:') as `goods_receipt_version`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:Y:H:(GRN Done,QC Done,Rejected,Partial Receipt,Completed,Canceled,GRN)') as `goods_receipt_status_desc`,
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier_summary:F') as `supplier_name`,
    concat(ifnull(`v`.`supplier_challan_no`, ''), ':Supplier Challan No:Y:C:ptv_goods_receipt_summary:O') as `supplier_challan_no`,
    concat(ifnull(`v`.`supplier_challan_date`, ''), ':Supplier Challan Date:Y:D:') as `supplier_challan_date`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`goods_receipt_discount_percent`, ''), ':Discount Percent:O:N:') as `goods_receipt_discount_percent`,
    concat(ifnull(`v`.`goods_receipt_discount_amount`, ''), ':Discount Amount:O:N:') as `goods_receipt_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':Cgst Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':Sgst Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':Igst Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':Roundoff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`supplier_invoice_no`, ''), ':Supplier Invoice No:O:N:') as `supplier_invoice_no`,
    concat(ifnull(`v`.`supplier_invoice_date`, ''), ':Supplier Invoice Date:Y:D:') as `supplier_invoice_Date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`qa_by_name`, ''), ':QA By:Y:C:cmv_employee_list:F') as `qa_by_name`,
    concat(ifnull(`v`.`qa_date`, ''), ':QA Date:Y:D:') as `qa_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`lr_no`, ''), ':LR No:O:N:') as `lr_no`,
    concat(ifnull(`v`.`lr_date`, ''), ':LR Date:Y:D:') as `lr_date`,
    concat(ifnull(`v`.`vehicle_no`, ''), ':Vehicle No:O:N:') as `vehicle_no`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:O:N:') as `supplier_state_name`,
    concat(ifnull(`v`.`supplier_city_name`, ''), ':Supplier City Name:O:N:') as `supplier_city_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:O:N:') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:O:N:') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') as `financial_year`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`goods_receipt_status`, ''), ':Goods Receipt Status:O:N:') as `goods_receipt_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`goods_receipt_master_transaction_id`, ''), ':Goods Receipt Master Transaction Id:O:N:') as `goods_receipt_master_transaction_id`,
    concat(ifnull(`v`.`indent_by_id`, ''), ':Indent By Id:N:N:') as `indent_by_id`
from
   `ptv_goods_receipt_summary` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
--ptv_goods_receipt_details_rpt source

create or REPLACE algorithm = UNDEFINED view`ptv_goods_receipt_details_rpt` as
select
    concat(ifnull(`v`.`goods_receipt_no`, ''), ':Goods Receipt No:Y:T') as `goods_receipt_no`,
    concat(ifnull(`v`.`goods_receipt_date`, ''), ':Goods Receipt Date:Y:D:') as `goods_receipt_date`,
    concat(ifnull(`v`.`goods_receipt_version`, ''), ':Goods Receipt Version:O:N:') as `goods_receipt_version`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':Grn Item Status:Y:H:(GRN,Done,Rejected,Partial Receipt,Completed,Canceled,Pree Closed)') as `grn_item_status_desc`,
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending,Pree Closed)') as `purchase_order_item_status_desc`,
    concat(ifnull(`v`.`supplier_challan_no`, ''), ':Supplier Challan No:Y:C:ptv_goods_receipt_summary:O') as `supplier_challan_no`,
    concat(ifnull(`v`.`supplier_challan_date`, ''), ':Supplier Challan Date:Y:D:') as `supplier_challan_date`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T') as `product_material_name`,
    concat(ifnull(`v`.`product_material_std_weight`, ''), ':Material Std Weight:O:N:') as `product_material_std_weight`,
    concat(ifnull(`v`.`product_material_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_material_stock_unit_name`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:C:cmv_supplier:F') as `supplier_name`,
    concat(ifnull(`v`.`supplier_city_name`, ''), ':Supplier City Name:O:N:') as `supplier_city_name`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:Y:C:cmv_state:F') as `supplier_state_name`,
    concat(ifnull(`v`.`product_material_po_approved_quantity`, ''), ':Material Po Approved Quantity:O:N:') as `product_material_po_approved_quantity`,
    concat(ifnull(`v`.`product_material_po_approved_weight`, ''), ':Material Po Approved Weight:O:N:') as `product_material_po_approved_weight`,
    concat(ifnull(`v`.`product_material_grn_quantity`, ''), ':Material GRN Quantity:O:N:') as `product_material_grn_quantity`,
    concat(ifnull(`v`.`product_material_grn_weight`, ''), ':Material GRN Weight:O:N:') as `product_material_grn_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':Material GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':Material GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`material_rate`, ''), ':Material Rate:O:N:') as `material_rate`,
    concat(ifnull(`v`.`material_basic_amount`, ''), ':Material Basic Amount:O:N:') as `material_basic_amount`,
    concat(ifnull(`v`.`material_discount_percent`, ''), ':Material Discount Percent:O:N:') as `material_discount_percent`,
    concat(ifnull(`v`.`material_discount_amount`, ''), ':Material Discount Amount:O:N:') as `material_discount_amount`,
    concat(ifnull(`v`.`material_taxable_amount`, ''), ':Material Taxable Amount:O:N:') as `material_taxable_amount`,
    concat(ifnull(`v`.`material_cgst_percent`, ''), ':Material Cgst Percent:O:N:') as `material_cgst_percent`,
    concat(ifnull(`v`.`material_cgst_total`, ''), ':Material Cgst Total:O:N:') as `material_cgst_total`,
    concat(ifnull(`v`.`material_sgst_percent`, ''), ':Material Sgst Percent:O:N:') as `material_sgst_percent`,
    concat(ifnull(`v`.`material_sgst_total`, ''), ':Material Sgst Total:O:N:') as `material_sgst_total`,
    concat(ifnull(`v`.`material_igst_percent`, ''), ':Material Igst Percent:O:N:') as `material_igst_percent`,
    concat(ifnull(`v`.`material_igst_total`, ''), ':Material Igst Total:O:N:') as `material_igst_total`,
    concat(ifnull(`v`.`material_total_amount`, ''), ':Material Total Amount:O:N:') as `material_total_amount`,
    concat(ifnull(`v`.`item_qa_by_id`, ''), ':Item QA By Id:O:N:') as `item_qa_by_id`,
    concat(ifnull(`v`.`item_qa_date`, ''), ':Item QA Date:Y:D:') as `item_qa_date`,
    concat(ifnull(`v`.`product_material_tech_spect`, ''), ':Product Material Tech Spect:O:N:') as `product_material_tech_spect`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer:O') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_Date`, ''), ':Customer Order Date:Y:D:') as `customer_order_Date`,
    concat(ifnull(`v`.`material_schedule_date`, ''), ':Material Schedule Date:Y:D:') as `material_schedule_date`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Packing Name:O:N:') as `product_packing_name`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Material Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Material Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Material Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(`v`.`prev_grn_quantity`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_quantity`,
    concat(ifnull(`v`.`prev_grn_weight`, ''), ':Prev GRN Weight:O:N:') as `prev_grn_weight`,
    concat(ifnull(`v`.`product_material_prev_accepted_quantity`, ''), ':Material Prev Accepted Quantity:O:N:') as `product_material_prev_accepted_quantity`,
    concat(ifnull(`v`.`product_material_prev_accepted_weight`, ''), ':Material Prev Accepted Weight:O:N:') as `product_material_prev_accepted_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') as `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') as `excess_weight`,
    concat(ifnull(`v`.`pree_closed_grn_quantity`, ''), ':Pree Closed Grn Quantity:O:N:') as `pree_closed_grn_quantity`,
    concat(ifnull(`v`.`pree_closed_grn_weight`, ''), ':Pree Closed Grn Weight:O:N:') as `pree_closed_grn_weight`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') as `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') as `purchase_return_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') as `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue weight:O:N:') as `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') as `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') as `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') as `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') as `production_issue_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') as `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') as `assembly_production_issue_weight`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') as `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') as `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') as `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') as `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') as `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') as `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') as `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') as `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') as `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') as `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsources Out Weight:O:N:') as `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') as `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') as `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') as `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') as `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') as `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') as `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') as `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') as `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') as `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') as `cancel_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') as `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') as `difference_weight`,
    concat(ifnull(`v`.`expiry_date`, ''), ':Expiry Date:Y:D:') as `expiry_date`,
    concat(ifnull(`v`.`remark`, ''), ':remark:O:N:') as `remark`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':Grn Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:O:N:') as `purchase_order_item_status`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`goods_receipt_details_transaction_id`, ''), 'goods_receipt_details_transaction_id:N:N:') as `goods_receipt_details_transaction_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing_id:N:N:') as `product_material_packing_id`,
    concat(ifnull(`v`.`product_material_hsn_code_id`, ''), ':Product Material Hsn Code_id:N:N:') as `product_material_hsn_code_id`,
    concat(ifnull(`v`.`goods_receipt_type_id`, ''), ':Goods Receipt Type Id:N:N:') as `goods_receipt_type_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By:N:N:') as `approved_by_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`expected_branch_id`, ''), ':Expected Branch Id:N:N:') as `expected_branch_id`,
    concat(ifnull(`v`.`expected_branch_state_id`, ''), ':Expected Branch State Id:N:N:') as `expected_branch_state_id`,
    concat(ifnull(`v`.`expected_branch_city_id`, ''), ':Expected Branch City Id:N:N:') as `expected_branch_city_id`,
    concat(ifnull(`v`.`payment_term_id`, ''), ':Payment Term Id:N:N:') as `payment_term_id`,
    concat(ifnull(`v`.`agent_id`, ''), ':Agent Id:N:N:') as `agent_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`indent_by_id`, ''), ':Indent By Id:N:N:') as `indent_by_id`
from
   `ptv_goods_receipt_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------

	ALTER TABLE sm_product_stock_adjustment_details ADD material_rate DOUBLE(18,4) DEFAULT 0 NULL COMMENT 'material can be update from stock adjustment';


-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_stock_adjustment_details source

create or REPLACE algorithm = UNDEFINED view `smv_product_stock_adjustment_details` as
select
    `rm_fg_sr`.`product_material_code` as `product_material_code`,
    `rm_fg_sr`.`product_material_name` as `product_material_name`,
    `sm`.`stock_adjustment_type` as `stock_adjustment_type`,
    `sm`.`stock_quantity` as `stock_quantity`,
    `sm`.`stock_weight` as `stock_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`stock_adjustment_quantity` as `stock_adjustment_quantity`,
    `sm`.`stock_adjustment_weight` as `stock_adjustment_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`material_rate` as `material_rate`,
    `sm`.`stock_date` as `stock_date`,
    `sa`.`adjustment_by` as `adjustment_by`,
    `sa`.`adjustment_reason` as `adjustment_reason`,
    `sa`.`approved_by` as `approved_by`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `sm`.`goods_receipt_no` as `goods_receipt_no`,
    `sm`.`batch_expiry_date` as `batch_expiry_date`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`financial_year` as `financial_year`,
    `sm`.`stock_adjustment_transaction_id` as `stock_adjustment_transaction_id`,
    `sm`.`stock_adjustment_details_transaction_id` as `stock_adjustment_details_transaction_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `sm`.`product_material_id` as `product_material_id`
from
    (((((`sm_product_stock_adjustment_details` `sm`
left join `sm_product_stock_adjustment_master` `sa` on
    (`sa`.`stock_adjustment_transaction_id` = `sm`.`stock_adjustment_transaction_id`
        and `sa`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm_fg_sr` on
    (`rm_fg_sr`.`product_material_id` = `sm`.`product_material_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`));
-------------------------------------------------------------------------------------------------------------------------------
 01-10-2024 pending


--  stv_indent_master_summary source

create or REPLACE algorithm = UNDEFINED view  `stv_indent_master_summary` as

select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`,
    `st`.`indent_priority` as `indent_priority`
from
    (((((((((( `st_indent_master` `st`
left join  `cm_company` `v` on
    (`v`.`company_id` = `st`.`company_id`
        and `v`.`is_delete` = 0))
left join  `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join  `cm_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join  `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join  `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join  `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join  `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join  `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join  `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join  `fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:O:N:') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:O:N:') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as

select
	`st`.`indent_no` as `indent_no`,
	`st`.`indent_date` as `indent_date`,
	`st`.`indent_version` as `indent_version`,
	case
		`v`.`indent_priority` when 'H' then 'High-Priority'
		else 'Low-Priority'
	end as `indent_priority_desc`,
	case
		`st`.`indent_item_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'C' then 'Completed'
		when 'X' then 'Cenceled'
		when 'O' then 'Purchse Order Genreated'
		when 'IPO' then 'Partial PO Genreated'
		when 'POA' then 'Purchse Order Approved'
		when 'G' then 'Goods Receipts'
		when 'IG' then 'Partial Goods Receipts'
		when 'I' then 'Partial Issue'
		else 'Pending'
	end as `indent_item_status_desc`,
	case
		`v`.`indent_source` when 'S' then 'SO Based'
		when 'O' then 'Direct'
		else 'Internal'
	end as `indent_source_desc`,
	`d`.`department_name` as `department_name`,
	`sd`.`department_name` as `sub_department_name`,
	`e1`.`employee_name` as `indented_by_name`,
	`e2`.`employee_name` as `approved_by_name`,
	`cs`.`customer_name` as `customer_name`,
	`v`.`customer_order_date` as `customer_order_date`,
	`v`.`expected_schedule_date` as `expected_schedule_date`,
	case
		`v`.`indent_status` when 'A' then 'Approved'
		when 'R' then 'Rejected'
		when 'C' then 'Completed'
		when 'X' then 'Cenceled'
		when 'O' then 'Purchse Order Genreated'
		when 'IPO' then 'Partial PO Genreated'
		when 'POA' then 'Purchse Order Approved'
		when 'G' then 'Goods Receipts'
		when 'IG' then 'Partial Goods Receipts'
		when 'I' then 'Partial Issue'
		else 'Pending'
	end as `indent_status_desc`,
	`st`.`customer_order_no` as `customer_order_no`,
	`st`.`so_sr_no` as `so_sr_no`,
	`st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
	`st`.`remark` as `remark`,
	--     `parent`.`product_material_name` as `product_parent_fg_name`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
	`st`.`product_fg_material_weight` as `product_fg_material_weight`,
	`child`.`product_material_name` as `product_rm_name`,
	`child`.`product_material_drawing_no` as `product_rm_drawing_no`,
	`child`.`product_material_tech_spect` as `product_rm_tech_spect`,
	`child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
	`child`.`product_type_name` as `product_type_name`,
	`child`.`product_material_category1_name` as `product_category1_name`,
	`child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
	`child`.`product_material_our_part_code` as `product_rm_our_part_code`,
	`child`.`product_material_category2_name` as `product_category2_name`,
	`child`.`product_material_category3_name` as `product_category3_name`,
	`child`.`product_material_category4_name` as `product_category4_name`,
	`child`.`product_material_category5_name` as `product_category5_name`,
	`child`.`product_material_make_name` as `product_make_name`,
	`child`.`product_material_type_name` as `product_material_type_name`,
	`child`.`product_material_grade_name` as `product_material_grade_name`,
	`child`.`product_material_std_weight` as `product_rm_std_weight`,
	`child`.`product_material_packing_name` as `product_rm_packing_name`,
	`child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
	`child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
	`st`.`product_material_quantity` as `product_material_quantity`,
	`st`.`product_material_weight` as `product_material_weight`,
	`st`.`lead_time` as `lead_time`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
	coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_quantity`,
	coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_weight`,
	`st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
	`st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
	`st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
	`st`.`product_material_approved_weight` as `product_material_approved_weight`,
	`st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
	`st`.`product_material_issue_weight` as `product_material_issue_weight`,
	`st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
	`st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
	`st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
	`st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
	`st`.`product_material_return_quantity` as `product_material_return_quantity`,
	`st`.`product_material_return_weight` as `product_material_return_weight`,
	`st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
	`st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
	`st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
	`st`.`product_child_bom_weight` as `product_child_bom_weight`,
	`st`.`approval_remark` as `approval_remark`,
	`e3`.`employee_name` as `issued_by_name`,
	`st`.`issued_by_id` as `issued_by_id`,
	`st`.`issued_date` as `issued_date`,
	`st`.`indent_item_status` as `indent_item_status`,
	`st`.`po_item_status` as `po_item_status`,
	`st`.`grn_item_status` as `grn_item_status`,
	`st`.`issue_item_status` as `issue_item_status`,
	`v`.`indent_source` as `indent_source`,
	`c`.`company_legal_name` as `company_name`,
	`cb`.`company_branch_name` as `company_branch_name`,
	`st`.`financial_year` as `financial_year`,
	`child`.`product_type_group` as `product_type_group`,
	`child`.`product_material_type_short_name` as `indent_type_short_name`,
	`v`.`indent_type` as `indent_type`,
	`v`.`indent_status` as `indent_status`,
	`st`.`indent_no` as `field_name`,
	`st`.`indent_version` as `field_id`,
	case
		when `st`.`is_active` = 1 then 'Active'
		else 'In Active'
	end as `Active`,
	case
		when `st`.`is_delete` = 1 then 'Yes'
		else 'No'
	end as `Deleted`,
	`v`.`is_active` as `is_active`,
	`st`.`is_delete` as `is_delete`,
	`st`.`created_by` as `created_by`,
	`st`.`created_on` as `created_on`,
	`st`.`modified_by` as `modified_by`,
	`st`.`modified_on` as `modified_on`,
	`st`.`deleted_by` as `deleted_by`,
	`st`.`deleted_on` as `deleted_on`,
	`st`.`indent_details_id` as `indent_details_id`,
	`st`.`product_fg_id` as `product_fg_id`,
	`st`.`product_material_id` as `product_material_id`,
	`st`.`product_material_unit_id` as `product_material_unit_id`,
	`st`.`cost_center_id` as `cost_center_id`,
	`fm`.`cost_center_name` as `cost_center_name`,
	`v`.`indent_transaction_type` as `indent_transaction_type`,
	`v`.`indent_master_id` as `indent_master_id`,
	`v`.`indent_type_id` as `indent_type_id`,
	`v`.`customer_id` as `customer_id`,
	`v`.`department_id` as `department_id`,
	`v`.`sub_department_id` as `sub_department_id`,
	`v`.`indented_by_id` as `indented_by_id`,
	`st`.`company_id` as `company_id`,
	`st`.`company_branch_id` as `company_branch_id`,
	`child`.`product_type_id` as `product_type_id`,
	`child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
	`child`.`product_material_packing_id` as `product_rm_packing_id`,
	`child`.`product_material_category1_id` as `product_category1_id`,
	`child`.`product_material_category2_id` as `product_category2_id`,
	`child`.`product_material_category3_id` as `product_category3_id`,
	`child`.`product_material_category4_id` as `product_category4_id`,
	`child`.`product_material_category5_id` as `product_category5_id`,
	`child`.`product_material_make_id` as `product_make_id`,
	`child`.`product_material_type_id` as `product_material_type_id`,
	`child`.`product_material_grade_id` as `product_material_grade_id`,
	coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
	coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
	(((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
	(`c`.`company_id` = `st`.`company_id`
		and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
	(`cb`.`company_branch_id` = `st`.`company_branch_id`
		and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
	(`st`.`company_branch_id` = `v`.`company_branch_id`
		and `st`.`company_id` = `v`.`company_id`
		and `st`.`indent_no` = `v`.`indent_no`
		and `st`.`is_delete` = 0))
left join `cm_department` `d` on
	(`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
	(`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
	(`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
	(`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
	(`e3`.`employee_id` = `st`.`issued_by_id`
		and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
	(`child`.`product_material_id` = `st`.`product_material_id`))
	-- left join `smv_product_rm_fg_sr` `parent` on
	--     (`parent`.`product_material_id` = `st`.`product_fg_id`))
left join `fm_cost_center` `fm` on
	(`fm`.`company_id` = `st`.`company_id`
		and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
	(`cs`.`customer_id` = `v`.`customer_id`))
where
	`st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_item_status_desc`, ''), ':Indent Item Status:Y:H:(Pending,Approved,Rejected,Completed,Cancel)') as `indent_item_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') as `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') as `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') as `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') as `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') as `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') as `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') as `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') as `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') as `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') as `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') as `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') as `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') as `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:') as `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:') as `product_material_receipt_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') as `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') as `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') as `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') as `product_child_bom_weight`,
--     concat(ifnull(`v`.`product_parent_fg_name`, ''), ':Parent Finish Goods Name:O:N:') as `product_parent_fg_name`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') as `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') as `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:C:cmv_employee_list:F') as `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') as `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`product_category3_name`, ''), ':Product Category3 Name:O:N:') as `product_category3_name`,
    concat(ifnull(`v`.`product_category4_name`, ''), ':Product Category4 Name:O:N:') as `product_category4_name`,
    concat(ifnull(`v`.`product_category5_name`, ''), ':Product Category5 Name:O:N:') as `product_category5_name`,
    concat(ifnull(`v`.`product_make_name`, ''), ':Product Make Name:O:N:') as `product_make_name`,
    concat(ifnull(`v`.`product_material_type_name`, ''), ':Material Type Name:O:N:') as `product_material_type_name`,
    concat(ifnull(`v`.`product_material_grade_name`, ''), ':Material Grade Name:O:N:') as `product_material_grade_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') as `so_sr_no`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:C:cmv_employee_list:F') as `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') as `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') as `indent_item_status`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':GRN Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') as `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`product_category3_id`, ''), ':Product Category3 Id:N:N:') as `product_category3_id`,
    concat(ifnull(`v`.`product_category4_id`, ''), ':Product Category4 Id:N:N:') as `product_category4_id`,
    concat(ifnull(`v`.`product_category5_id`, ''), ':Product Category5 Id:N:N:') as `product_category5_id`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') as `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') as `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') as `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') as `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') as `issued_by_id`
from
    `stv_indent_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------


-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_purchase_order_details ADD pre_closed_remark varchar(250) NULL COMMENT 'text box for pre closed remark';
ALTER TABLE pt_purchase_order_details CHANGE pre_closed_remark pre_closed_remark varchar(250) NULL COMMENT 'text box for pre closed remark' AFTER pree_closed_weight;

-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_master_summary_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:T') as `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') as `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') as `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`quotation_no`, ''), ':Quotation No:Y:T') as `quotation_no`,
    concat(ifnull(`v`.`quotation_date`, ''), ':Quotation Date:Y:D:') as `quotation_date`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') as `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') as `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') as `status_remark`,
    concat(ifnull(`v`.`supplier_code`, ''), ':Supplier Code:O:N:') as `supplier_code`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') as `supplier_type`,
    concat(ifnull(`v`.`supplier_short_name`, ''), ':Supplier Short Name:O:N:') as `supplier_short_name`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Branch Address1:O:N:') as `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`district_name`, ''), ':District Name:O:N:') as `district_name`,
    concat(ifnull(`v`.`state_name`, ''), ':State Name:O:N:') as `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Branch Name:O:N:') as `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Branch Short Name:O:N:') as `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Branch Address1:O:N:') as `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Branch Pincode:O:N:') as `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Branch City Name:O:N:') as `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_district_name`, ''), ':Branch District Name:O:N:') as `expected_branch_district_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Branch State Name:O:N:') as `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Branch Phone No:O:N:') as `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Expected Branch EmailId:O:N:') as `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') as `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Freight Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Freight Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') as `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`
from
    `ptv_purchase_order_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_details` as
select
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`indent_no` as `indent_no`,
    `pt`.`indent_date` as `indent_date`,
    `pt`.`indent_version` as `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_status_desc`,
    `vp`.`department_name` as `department_name`,
    `sdp`.`department_name` as `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` as `supplier_name`,
    `pom`.`state_name` as `supplier_state_name`,
    `c`.`customer_name` as `customer_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`sr_no` as `sr_no`,
    `pt`.`so_sr_no` as `so_sr_no`,
    `p`.`product_type_name` as `product_type_name`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `p`.`product_type_group` as `product_type_group`,
    `rmfgsr`.`product_material_code` as `product_material_code`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `pt`.`product_material_print_name` as `product_material_print_name`,
    `pt`.`product_material_tech_spect` as `product_material_tech_spect`,
    `pt`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_weight`,
    `rmfgsr`.`product_material_std_weight` as `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_stock_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `rmfgsr`.`product_type_group` as `product_material_type_group`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_category1_name` as `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` as `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` as `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` as `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` as `product_category5_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` as `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` as `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` as `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` as `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` as `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` as `product_material_hsn_sac_code`,
    `rmfgsr`.`godown_name` as `godown_name`,
    `rmfgsr`.`godown_short_name` as `godown_short_name`,
    `rmfgsr`.`godown_area` as `godown_area`,
    `rmfgsr`.`godown_section_name` as `godown_section_name`,
    `rmfgsr`.`godown_section_short_name` as `godown_section_short_name`,
    `rmfgsr`.`godown_section_area` as `godown_section_area`,
    `rmfgsr`.`godown_section_beans_name` as `godown_section_beans_name`,
    `rmfgsr`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `rmfgsr`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` as `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` as `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` as `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` as `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` as `product_material_po_rejected_weight`,
    `pt`.`customer_id` as `customer_id`,
    `pt`.`customer_order_no` as `customer_order_no`,
    `pt`.`customer_order_Date` as `customer_order_Date`,
    `pt`.`pree_closed_quantity` as `pree_closed_quantity`,
    `pt`.`pree_closed_weight` as `pree_closed_weight`,
    `pt`.`pre_closed_remark` as `pre_closed_remark`,
    `pt`.`purchase_return_quantity` as `purchase_return_quantity`,
    `pt`.`purchase_return_weight` as `purchase_return_weight`,
    `pt`.`material_rate` as `material_rate`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`pending_quantity` as `pending_quantity`,
    `pt`.`pending_weight` as `pending_weight`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`production_issue_quantity` as `production_issue_quantity`,
    `pt`.`production_issue_weight` as `production_issue_weight`,
    `pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` as `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `pt`.`sales_quantity` as `sales_quantity`,
    `pt`.`sales_weight` as `sales_weight`,
    `pt`.`sales_return_quantity` as `sales_return_quantity`,
    `pt`.`sales_return_weight` as `sales_return_weight`,
    `pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` as `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` as `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` as `outsources_out_quantity`,
    `pt`.`outsources_out_weight` as `outsources_out_weight`,
    `pt`.`outsources_in_quantity` as `outsources_in_quantity`,
    `pt`.`outsources_in_weight` as `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` as `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` as `loan_issue_quantity`,
    `pt`.`loan_issue_weight` as `loan_issue_weight`,
    `pt`.`cancel_quantity` as `cancel_quantity`,
    `pt`.`cancel_weight` as `cancel_weight`,
    `pt`.`difference_quantity` as `difference_quantity`,
    `pt`.`difference_weight` as `difference_weight`,
    `pt`.`material_po_approval_remark` as `material_po_approval_remark`,
    `pom`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`purchase_order_item_status` as `purchase_order_item_status`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pom`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `v`.`company_cell_no` as `company_cell_no`,
    `v`.`company_phone_no` as `company_phone_no`,
    `v`.`company_EmailId` as `company_EmailId`,
    `v`.`company_website` as `company_website`,
    `v`.`company_gst_no` as `company_gst_no`,
    `v`.`company_pan_no` as `company_pan_no`,
    `v`.`company_state` as `company_state`,
    `v`.`company_pincode` as `company_pincode`,
    `v`.`company_address1` as `company_address1`,
    `pt`.`financial_year` as `financial_year`,
    `pom`.`city_name` as `city_name`,
    `pom`.`district_name` as `district_name`,
    `pom`.`country_name` as `country_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` as `supplier_id`,
    `pom`.`supplier_state_id` as `supplier_state_id`,
    `pom`.`supplier_city_id` as `supplier_city_id`,
    `pom`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pom`.`expected_branch_id` as `expected_branch_id`,
    `pom`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`cost_center_id` as `cost_center_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` as `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` as `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` as `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` as `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` as `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` as `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` as `product_category5_id`,
    `rmfgsr`.`godown_id` as `godown_id`,
    `rmfgsr`.`godown_section_id` as `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` as `godown_section_beans_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`sub_department_id` as `sub_department_id`,
    `pt`.`indented_by_id` as `indented_by_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_weight`
from
    (((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `pt`.`company_branch_id`
        and `v`.`company_id` = `pt`.`company_id`))
left join `smv_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `smv_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `cmv_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `cmv_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cmv_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `cmv_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))
left join `cmv_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details_rpt source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_details_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Bill Booked)') as `purchase_order_item_status_desc`,
    concat(ifnull(`v`.`purchase_order_type`, ''), ':Purchase Order Type:O:N:') as `purchase_order_type`,
    concat(ifnull(`v`.`product_material_code`, ''), ':Material Code:Y:T') as `product_material_code`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T') as `product_material_name`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`product_material_stock_unit_name`, ''), ':Material Unit Name:O:N:') as `product_material_stock_unit_name`,
    concat(ifnull(`v`.`product_material_po_quantity`, ''), ':Material Po Quantity:O:N:') as `product_material_po_quantity`,
    concat(ifnull(`v`.`product_material_po_weight`, ''), ':Material Po Weight:O:N:') as `product_material_po_weight`,
    concat(ifnull(`v`.`material_rate`, ''), ':Material Rate:O:N:') as `material_rate`,
    concat(ifnull(`v`.`material_basic_amount`, ''), ':Material Basic Amount:O:N:') as `material_basic_amount`,
    concat(ifnull(`v`.`material_discount_percent`, ''), ':Material Discount Percent:O:N:') as `material_discount_percent`,
    concat(ifnull(`v`.`material_discount_amount`, ''), ':Material Discount Amount:O:N:') as `material_discount_amount`,
    concat(ifnull(`v`.`material_taxable_amount`, ''), ':Material Taxable Amount:O:N:') as `material_taxable_amount`,
    concat(ifnull(`v`.`material_cgst_percent`, ''), ':Material Cgst Percent:O:N:') as `material_cgst_percent`,
    concat(ifnull(`v`.`material_cgst_total`, ''), ':Material Cgst Total:O:N:') as `material_cgst_total`,
    concat(ifnull(`v`.`material_sgst_percent`, ''), ':Material Sgst Percent:O:N:') as `material_sgst_percent`,
    concat(ifnull(`v`.`material_sgst_total`, ''), ':Material Sgst Total:O:N:') as `material_sgst_total`,
    concat(ifnull(`v`.`material_igst_percent`, ''), ':Material Igst Percent:O:N:') as `material_igst_percent`,
    concat(ifnull(`v`.`material_igst_total`, ''), ':Material Igst Total:O:N:') as `material_igst_total`,
    concat(ifnull(`v`.`material_total_amount`, ''), ':Material Total Amount:O:N:') as `material_total_amount`,
    concat(ifnull(`v`.`product_material_po_approved_quantity`, ''), ':Material Po Approved Quantity:O:N:') as `product_material_po_approved_quantity`,
    concat(ifnull(`v`.`product_material_po_approved_weight`, ''), ':Material Po Approved Weight:O:N:') as `product_material_po_approved_weight`,
    concat(ifnull(`v`.`product_material_po_rejected_quantity`, ''), ':Material Po Rejected Quantity:O:N:') as `product_material_po_rejected_quantity`,
    concat(ifnull(`v`.`product_material_po_rejected_weight`, ''), ':Material Po Rejected Weight:O:N:') as `product_material_po_rejected_weight`,
    concat(ifnull(`v`.`material_po_approval_remark`, ''), ':Material Po Approval Remark:O:N:') as `material_po_approval_remark`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`material_schedule_date`, ''), ':Material Schedule Date:Y:D:') as `material_schedule_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree-Closed Quantity:O:N:') as `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree-Closed Weight:O:N:') as `pree_closed_weight`,
    concat(ifnull(`v`.`pre_closed_remark`, ''), ':Pree-Closed Remark:O:N:') as `pre_closed_remark`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') as `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') as `purchase_return_weight`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') as `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') as `pending_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') as `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') as `excess_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') as `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') as `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') as `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') as `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') as `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') as `production_issue_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') as `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') as `assembly_production_issue_weight`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') as `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') as `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') as `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') as `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') as `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') as `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') as `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') as `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') as `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') as `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') as `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsourcess Out Weight:O:N:') as `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') as `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') as `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') as `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') as `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') as `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') as `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') as `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') as `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') as `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') as `cancel_weight`,
    concat(ifnull(`v`.`prev_grn_quantity`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_quantity`,
    concat(ifnull(`v`.`prev_grn_weight`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') as `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') as `difference_weight`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:T') as `supplier_name`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:O:N:') as `supplier_state_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:N:') as `customer_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indented By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`sr_no`, ''), ':Sr No:O:N:') as `sr_no`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') as `so_sr_no`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') as `product_type_group`,
    concat(ifnull(`v`.`product_material_print_name`, ''), ':Material Print Name:O:N:') as `product_material_print_name`,
    concat(ifnull(`v`.`product_material_tech_spect`, ''), ':Material Tech Spect:O:N:') as `product_material_tech_spect`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:O:N:') as `product_packing_name`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') as `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_description`, ''), ':Hsn Sac Description:O:N:') as `hsn_sac_description`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:O:N:') as `purchase_order_item_status`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':GRN Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:O:N:') as `purchase_order_mail_sent_status`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`district_name`, ''), ':District Name:O:N:') as `district_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`purchase_order_type_id`, ''), ':Purchase Order Type Id:N:N:') as `purchase_order_type_id`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction Id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`purchase_order_details_transaction_id`, ''), ':Purchase Order Details Transaction_id:N:N:') as `purchase_order_details_transaction_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') as `product_material_packing_id`,
    concat(ifnull(`v`.`product_material_hsn_code_id`, ''), ':Product Material Hsn Code Id:N:N:') as `product_material_hsn_code_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`
from
    `ptv_purchase_order_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
08-10-2024


-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `v`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_item_status_desc`,
    case
        `v`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `d`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `cs`.`customer_name` as `customer_name`,
    `v`.`customer_order_Date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    case
        `v`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e3`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`Indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_category3_id` as `product_category3_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `cm_department` `d` on
    (`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
    (`e3`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
    (`cs`.`customer_id` = `v`.`customer_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_item_status_desc`, ''), ':Indent Item Status:Y:H:(Pending,Approved,Rejected,Completed,Cancel)') as `indent_item_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') as `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') as `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') as `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') as `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') as `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') as `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') as `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') as `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') as `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') as `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') as `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') as `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') as `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') as `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') as `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') as `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') as `product_child_bom_weight`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') as `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') as `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') as `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:T') as `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') as `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') as `indent_item_status`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':GRN Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') as `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') as `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') as `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') as `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') as `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') as `issued_by_id`
from
    `stv_indent_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`,
    `st`.`indent_priority` as `indent_priority`
from
    ((((((((((`st_indent_master` `st`
left join `cm_company` `v` on
    (`v`.`company_id` = `st`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:O:N:') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:O:N:') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
08-10-2024

-- stv_indent_schedules source

create or REPLACE algorithm = UNDEFINED view `stv_indent_schedules` as
select
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `v`.`financial_year` as `financial_year`,
    `v`.`indent_no` as `indent_no`,
    `v`.`indent_date` as `indent_date`,
    `v`.`indent_version` as `indent_version`,
    `v`.`indent_type` as `indent_type`,
    `v`.`indent_source` as `indent_source`,
    `v`.`department_name` as `department_name`,
    `v`.`indented_by_name` as `indented_by_name`,
    `v`.`approved_by_name` as `approved_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`customer_order_no` as `customer_order_no`,
    `v`.`customer_order_date` as `customer_order_date`,
    `v`.`indent_status` as `indent_status`,
    `v`.`indent_status_desc` as `indent_status_desc`,
    `v`.`remark` as `remark`,
    `st`.`is_active` as `is_active`,
    `v`.`product_material_id` as `product_material_id`,
    `v`.`product_rm_name` as `product_rm_name`,
    `v`.`product_material_quantity` as `product_material_quantity`,
    `v`.`product_material_weight` as `product_material_weight`,
    `v`.`lead_time` as `lead_time`,
    `v`.`product_material_stock_quantity` as `product_material_stock_quantity`,
    `v`.`product_material_stock_weight` as `product_material_stock_weight`,
    `v`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `v`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `v`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `v`.`product_material_approved_weight` as `product_material_approved_weight`,
    `v`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `v`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_schedule_quantity` as `product_material_schedule_quantity`,
    `st`.`product_material_schedule_weight` as `product_material_schedule_weight`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`material_receipt_date` as `material_receipt_date`,
    `st`.`material_quantity` as `material_quantity`,
    `st`.`material_weight` as `material_weight`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `v`.`issued_by_name` as `issued_by_name`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'A' then 'Approved'
        when 'I' then 'Partial Reciept'
        else 'Pending'
    end as `indent_item_status_desc`,
    `v`.`indent_no` as `field_name`,
    `v`.`indent_version` as `field_id`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_details_id` as `indent_details_id`,
    `st`.`indent_schedule_id` as `indent_schedule_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`
from
    (`st_indent_schedules` `st`
left join `stv_indent_details` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`indent_version` = `v`.`indent_version`
        and `st`.`product_material_id` = `v`.`product_material_id`
        and `st`.`so_sr_no` = `v`.`so_sr_no`
        and `st`.`customer_order_no` = `v`.`customer_order_no`
        and `v`.`is_delete` = 0
        and (`st`.`product_fg_id` is null
            or `st`.`product_fg_id` = `v`.`product_fg_id`)))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
08-10-2024 pending

-- ptv_purchase_order_master_summary source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supp_branch_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`quotation_no` as `quotation_no`,
    `pt`.`quotation_date` as `quotation_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supp_branch_type` as `supplier_type`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
     `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supp_branch_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `cc`.`city_name` as `supp_consignee_city_name`,
    `cc`.`district_name` as `supp_consignee_district_name`,
    `cc`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((`pt_purchase_order_master` `pt`
left join `cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_supplier_branch` `s` on
    (`s`.`supp_branch_id` = `pt`.`supplier_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `cmv_supplier_branch` `cc` on
    (`cc`.`supp_branch_id` = `pt`.`consignee_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_master_summary_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:T') as `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') as `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') as `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`quotation_no`, ''), ':Quotation No:Y:T') as `quotation_no`,
    concat(ifnull(`v`.`quotation_date`, ''), ':Quotation Date:Y:D:') as `quotation_date`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:T') as `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') as `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') as `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') as `status_remark`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') as `supplier_type`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Supplier Branch Address1:O:N:') as `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Supplier Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':Supplier City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`state_name`, ''), ':Supplier State Name:O:N:') as `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Supplier Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Supplier Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Company Branch Name:O:N:') as `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Company Branch Short Name:O:N:') as `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Company Branch Address1:O:N:') as `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Company Branch Pincode:O:N:') as `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Company Branch City Name:O:N:') as `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Company Branch State Name:O:N:') as `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Company Branch Phone No:O:N:') as `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Company Expected Branch EmailId:O:N:') as `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') as `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Freight Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Freight Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') as `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year :O:N:') as `financial_year`
from
    `ptv_purchase_order_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `v`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_item_status_desc`,
    case
        `v`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `d`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `cs`.`customer_name` as `customer_name`,
    `v`.`customer_order_Date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    case
        `v`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id`), 0) as `product_Rawmaterial_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e3`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`Indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `st`.`is_delete` = 0))
left join `cm_department` `d` on
    (`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
    (`e3`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
    (`cs`.`customer_id` = `v`.`customer_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
10-10-2024

-- ptv_purchase_order_master_summary source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supp_branch_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`quotation_no` as `quotation_no`,
    `pt`.`quotation_date` as `quotation_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supp_branch_type` as `supplier_type`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supp_branch_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `ct2`.`city_name` as `supp_consignee_city_name`,
    `st2`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((((`pt_purchase_order_master` `pt`
left join `cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`is_delete` = 0))

left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`is_delete` = 0))

left join `cm_supplier_branch` `s` on
    (`s`.`supp_branch_id` = `pt`.`supplier_id`))

left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))

left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))

left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))

left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))

left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))

left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))

left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))

left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))

left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))

left join `cm_supplier_branch` `cc` on
    (`cc`.`supp_branch_id` = `pt`.`consignee_id`))

left join `cm_city` `ct2` on
    (`ct2`.`city_id` = `pt`.`consignee_city_id`))

left join `cm_state` `st2` on
    (`st2`.`state_id` = `pt`.`consignee_state_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_master_summary_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Pending)') as `purchase_order_status_desc`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:T') as `supplier_name`,
    concat(ifnull(`v`.`basic_total`, ''), ':Basic Total:O:N:') as `basic_total`,
    concat(ifnull(`v`.`transport_amount`, ''), ':Transport Amount:O:N:') as `transport_amount`,
    concat(ifnull(`v`.`freight_amount`, ''), ':Freight Amount:O:N:') as `freight_amount`,
    concat(ifnull(`v`.`is_freight_taxable`, ''), ':Is Freight Taxable:O:N:') as `is_freight_taxable`,
    concat(ifnull(`v`.`packing_amount`, ''), ':Packing Amount:O:N:') as `packing_amount`,
    concat(ifnull(`v`.`po_discount_percent`, ''), ':PO Discount Percent:O:N:') as `po_discount_percent`,
    concat(ifnull(`v`.`po_discount_amount`, ''), ':PO Discount Amount:O:N:') as `po_discount_amount`,
    concat(ifnull(`v`.`other_amount`, ''), ':Other Amount:O:N:') as `other_amount`,
    concat(ifnull(`v`.`taxable_total`, ''), ':Taxable Total:O:N:') as `taxable_total`,
    concat(ifnull(`v`.`cgst_total`, ''), ':CGST Total:O:N:') as `cgst_total`,
    concat(ifnull(`v`.`sgst_total`, ''), ':SGST Total:O:N:') as `sgst_total`,
    concat(ifnull(`v`.`igst_total`, ''), ':IGST Total:O:N:') as `igst_total`,
    concat(ifnull(`v`.`roundoff`, ''), ':RoundOff:O:N:') as `roundoff`,
    concat(ifnull(`v`.`grand_total`, ''), ':Grand Total:O:N:') as `grand_total`,
    concat(ifnull(`v`.`quotation_no`, ''), ':Quotation No:Y:T') as `quotation_no`,
    concat(ifnull(`v`.`quotation_date`, ''), ':Quotation Date:Y:D:') as `quotation_date`,
    concat(ifnull(`v`.`approved_by`, ''), ':Approved By:Y:C:cmv_employee_list:F') as `approved_by`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`purchase_order_acceptance_status`, ''), ':Purchase Order Acceptance Status:Y:H:(Approved,Canceled,Pending)') as `purchase_order_acceptance_status_desc`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`purchase_order_creation_type_desc`, ''), ':Purchase Order Creation Type:Y:H:(Manual,Auto)') as `purchase_order_creation_type_desc`,
    concat(ifnull(`v`.`purchase_order_life_desc`, ''), ':Purchase Order Life:Y:H:(Close,Open)') as `purchase_order_life_desc`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:') as `status_remark`,
    concat(ifnull(`v`.`supplier_type`, ''), ':Supplier Type:O:N:') as `supplier_type`,
    concat(ifnull(`v`.`supp_branch_address1`, ''), ':Supplier Branch Address1:O:N:') as `supp_branch_address1`,
    concat(ifnull(`v`.`supp_branch_pincode`, ''), ':Supplier Branch Pincode:O:N:') as `supp_branch_pincode`,
    concat(ifnull(`v`.`city_name`, ''), ':Supplier City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`state_name`, ''), ':Supplier State Name:O:N:') as `state_name`,
    concat(ifnull(`v`.`supp_branch_phone_no`, ''), ':Supplier Branch Phone No:O:N:') as `supp_branch_phone_no`,
    concat(ifnull(`v`.`supp_branch_EmailId`, ''), ':Supplier Branch EmailId:O:N:') as `supp_branch_EmailId`,
    concat(ifnull(`v`.`expected_branch_name`, ''), ':Company Branch Name:O:N:') as `expected_branch_name`,
    concat(ifnull(`v`.`expected_branch_short_name`, ''), ':Company Branch Short Name:O:N:') as `expected_branch_short_name`,
    concat(ifnull(`v`.`expected_branch_address1`, ''), ':Company Branch Address1:O:N:') as `expected_branch_address1`,
    concat(ifnull(`v`.`expected_branch_pincode`, ''), ':Company Branch Pincode:O:N:') as `expected_branch_pincode`,
    concat(ifnull(`v`.`expected_branch_city_name`, ''), ':Company Branch City Name:O:N:') as `expected_branch_city_name`,
    concat(ifnull(`v`.`expected_branch_state_name`, ''), ':Company Branch State Name:O:N:') as `expected_branch_state_name`,
    concat(ifnull(`v`.`expected_branch_phone_no`, ''), ':Company Branch Phone No:O:N:') as `expected_branch_phone_no`,
    concat(ifnull(`v`.`expected_branch_EmailId`, ''), ':Company Expected Branch EmailId:O:N:') as `expected_branch_EmailId`,
    concat(ifnull(`v`.`agent_name`, ''), ':Agent Name:Y:C:cmv_agent:F') as `agent_name`,
    concat(ifnull(`v`.`agent_percent`, ''), ':Agent Percent:O:N:') as `agent_percent`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:Y:H:(Approved,Completed,Canceled,Pending)') as `agent_paid_status_desc`,
    concat(ifnull(`v`.`other_terms_conditions`, ''), ':Other Terms Conditions:O:N:') as `other_terms_conditions`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Freight Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Freight Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(ifnull(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction_id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`purchase_order_creation_type`, ''), ':Purchase Order Creation Type:N:N:') as `purchase_order_creation_type`,
    concat(ifnull(`v`.`purchase_order_life`, ''), ':Purchase Order Life:O:N:') as `purchase_order_life`,
    concat(ifnull(`v`.`agent_paid_status`, ''), ':Agent Paid Status:N:N:') as `agent_paid_status`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year :O:N:') as `financial_year`
from
    `ptv_purchase_order_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_details` as
select
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`indent_no` as `indent_no`,
    `pt`.`indent_date` as `indent_date`,
    `pt`.`indent_version` as `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_status_desc`,
    `vp`.`department_name` as `department_name`,
    `sdp`.`department_name` as `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` as `supplier_name`,
    `pom`.`state_name` as `supplier_state_name`,
    `c`.`customer_name` as `customer_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`sr_no` as `sr_no`,
    `pt`.`so_sr_no` as `so_sr_no`,
    `p`.`product_type_name` as `product_type_name`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `p`.`product_type_group` as `product_type_group`,
    `rmfgsr`.`product_material_code` as `product_material_code`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `pt`.`product_material_print_name` as `product_material_print_name`,
    `pt`.`product_material_tech_spect` as `product_material_tech_spect`,
    `pt`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `available_stock_weight`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id`), 0) as `available_rawmaterial_stock_weight`,
    `rmfgsr`.`product_material_std_weight` as `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_stock_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_category1_name` as `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` as `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` as `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` as `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` as `product_category5_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` as `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` as `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` as `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` as `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` as `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` as `product_material_hsn_sac_code`,
    `rmfgsr`.`godown_name` as `godown_name`,
    `rmfgsr`.`godown_short_name` as `godown_short_name`,
    `rmfgsr`.`godown_area` as `godown_area`,
    `rmfgsr`.`godown_section_name` as `godown_section_name`,
    `rmfgsr`.`godown_section_short_name` as `godown_section_short_name`,
    `rmfgsr`.`godown_section_area` as `godown_section_area`,
    `rmfgsr`.`godown_section_beans_name` as `godown_section_beans_name`,
    `rmfgsr`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `rmfgsr`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` as `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` as `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` as `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` as `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` as `product_material_po_rejected_weight`,
    `pt`.`customer_id` as `customer_id`,
    `pt`.`customer_order_no` as `customer_order_no`,
    `pt`.`customer_order_Date` as `customer_order_Date`,
    `pt`.`pree_closed_quantity` as `pree_closed_quantity`,
    `pt`.`pree_closed_weight` as `pree_closed_weight`,
    `pt`.`pre_closed_remark` as `pre_closed_remark`,
    `pt`.`purchase_return_quantity` as `purchase_return_quantity`,
    `pt`.`purchase_return_weight` as `purchase_return_weight`,
    `pt`.`material_rate` as `material_rate`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`pending_quantity` as `pending_quantity`,
    `pt`.`pending_weight` as `pending_weight`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`production_issue_quantity` as `production_issue_quantity`,
    `pt`.`production_issue_weight` as `production_issue_weight`,
    `pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` as `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `pt`.`sales_quantity` as `sales_quantity`,
    `pt`.`sales_weight` as `sales_weight`,
    `pt`.`sales_return_quantity` as `sales_return_quantity`,
    `pt`.`sales_return_weight` as `sales_return_weight`,
    `pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` as `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` as `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` as `outsources_out_quantity`,
    `pt`.`outsources_out_weight` as `outsources_out_weight`,
    `pt`.`outsources_in_quantity` as `outsources_in_quantity`,
    `pt`.`outsources_in_weight` as `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` as `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` as `loan_issue_quantity`,
    `pt`.`loan_issue_weight` as `loan_issue_weight`,
    `pt`.`cancel_quantity` as `cancel_quantity`,
    `pt`.`cancel_weight` as `cancel_weight`,
    `pt`.`difference_quantity` as `difference_quantity`,
    `pt`.`difference_weight` as `difference_weight`,
    `pt`.`material_po_approval_remark` as `material_po_approval_remark`,
    `pom`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`purchase_order_item_status` as `purchase_order_item_status`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pom`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`remark` as `remark`,
    `cm`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_cell_no` as `company_cell_no`,
    `cb`.`branch_phone_no` as `company_phone_no`,
    `cb`.`branch_EmailId` as `company_EmailId`,
    `cb`.`branch_website` as `company_website`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`,
    `cs`.`state_name` as `company_state`,
    `cb`.`branch_pincode` as `company_pincode`,
    `cb`.`branch_address1` as `company_address1`,
    `pt`.`financial_year` as `financial_year`,
    `pom`.`city_name` as `city_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` as `supplier_id`,
    `pom`.`supplier_state_id` as `supplier_state_id`,
    `pom`.`supplier_city_id` as `supplier_city_id`,
    `pom`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pom`.`expected_branch_id` as `expected_branch_id`,
    `pom`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`cost_center_id` as `cost_center_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` as `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` as `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` as `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` as `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` as `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` as `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` as `product_category5_id`,
    `rmfgsr`.`godown_id` as `godown_id`,
    `rmfgsr`.`godown_section_id` as `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` as `godown_section_beans_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`sub_department_id` as `sub_department_id`,
    `pt`.`indented_by_id` as `indented_by_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_weight`
from
    (((((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))

left join `cm_company` `cm` on
    (`cm`.`company_id` = `pt`.`company_id`
        and `cm`.`is_delete` = 0))

left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`is_delete` = 0))

left join `cm_state` `cs` on
    (`cs`.`state_id` = `cb`.`branch_state_id`
        and `cs`.`state_id` = 0))

left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`
    and `p`.`is_delete` = 0))

left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))

left join `sm_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))

left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))

left join `cm_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))

left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))

left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))

left join `cm_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))

left join `cm_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))

where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details_rpt source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_details_rpt` as
select
    concat(ifnull(`v`.`purchase_order_no`, ''), ':Purchase Order No:Y:T') as `purchase_order_no`,
    concat(ifnull(`v`.`purchase_order_date`, ''), ':Purchase Order Date:Y:D:') as `purchase_order_date`,
    concat(ifnull(`v`.`purchase_order_version`, ''), ':Purchase Order Version:O:N:') as `purchase_order_version`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:Y:H:(Approved,Rejected,Partial Receipt,Completed,Canceled,Pree Closed,Bill Booked)') as `purchase_order_item_status_desc`,
    concat(ifnull(`v`.`purchase_order_type`, ''), ':Purchase Order Type:O:N:') as `purchase_order_type`,
    concat(ifnull(`v`.`product_material_code`, ''), ':Material Code:Y:T') as `product_material_code`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T') as `product_material_name`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`product_material_stock_unit_name`, ''), ':Material Unit Name:O:N:') as `product_material_stock_unit_name`,
    concat(ifnull(`v`.`product_material_po_quantity`, ''), ':Material Po Quantity:O:N:') as `product_material_po_quantity`,
    concat(ifnull(`v`.`product_material_po_weight`, ''), ':Material Po Weight:O:N:') as `product_material_po_weight`,
    concat(ifnull(`v`.`material_rate`, ''), ':Material Rate:O:N:') as `material_rate`,
    concat(ifnull(`v`.`material_basic_amount`, ''), ':Material Basic Amount:O:N:') as `material_basic_amount`,
    concat(ifnull(`v`.`material_discount_percent`, ''), ':Material Discount Percent:O:N:') as `material_discount_percent`,
    concat(ifnull(`v`.`material_discount_amount`, ''), ':Material Discount Amount:O:N:') as `material_discount_amount`,
    concat(ifnull(`v`.`material_taxable_amount`, ''), ':Material Taxable Amount:O:N:') as `material_taxable_amount`,
    concat(ifnull(`v`.`material_cgst_percent`, ''), ':Material Cgst Percent:O:N:') as `material_cgst_percent`,
    concat(ifnull(`v`.`material_cgst_total`, ''), ':Material Cgst Total:O:N:') as `material_cgst_total`,
    concat(ifnull(`v`.`material_sgst_percent`, ''), ':Material Sgst Percent:O:N:') as `material_sgst_percent`,
    concat(ifnull(`v`.`material_sgst_total`, ''), ':Material Sgst Total:O:N:') as `material_sgst_total`,
    concat(ifnull(`v`.`material_igst_percent`, ''), ':Material Igst Percent:O:N:') as `material_igst_percent`,
    concat(ifnull(`v`.`material_igst_total`, ''), ':Material Igst Total:O:N:') as `material_igst_total`,
    concat(ifnull(`v`.`material_total_amount`, ''), ':Material Total Amount:O:N:') as `material_total_amount`,
    concat(ifnull(`v`.`product_material_po_approved_quantity`, ''), ':Material Po Approved Quantity:O:N:') as `product_material_po_approved_quantity`,
    concat(ifnull(`v`.`product_material_po_approved_weight`, ''), ':Material Po Approved Weight:O:N:') as `product_material_po_approved_weight`,
    concat(ifnull(`v`.`product_material_po_rejected_quantity`, ''), ':Material Po Rejected Quantity:O:N:') as `product_material_po_rejected_quantity`,
    concat(ifnull(`v`.`product_material_po_rejected_weight`, ''), ':Material Po Rejected Weight:O:N:') as `product_material_po_rejected_weight`,
    concat(ifnull(`v`.`material_po_approval_remark`, ''), ':Material Po Approval Remark:O:N:') as `material_po_approval_remark`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:Y:H:(Email Sent,Email Failed,Email Pending)') as `purchase_order_mail_sent_status_desc`,
    concat(ifnull(`v`.`material_schedule_date`, ''), ':Material Schedule Date:Y:D:') as `material_schedule_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`hsn_sac_code`, ''), ':Hsn Sac Code:O:N:') as `hsn_sac_code`,
    concat(ifnull(`v`.`hsn_sac_rate`, ''), ':Hsn Sac Rate:O:N:') as `hsn_sac_rate`,
    concat(ifnull(`v`.`pree_closed_quantity`, ''), ':Pree-Closed Quantity:O:N:') as `pree_closed_quantity`,
    concat(ifnull(`v`.`pree_closed_weight`, ''), ':Pree-Closed Weight:O:N:') as `pree_closed_weight`,
    concat(ifnull(`v`.`pre_closed_remark`, ''), ':Pree-Closed Remark:O:N:') as `pre_closed_remark`,
    concat(ifnull(`v`.`purchase_return_quantity`, ''), ':Purchase Return Quantity:O:N:') as `purchase_return_quantity`,
    concat(ifnull(`v`.`purchase_return_weight`, ''), ':Purchase Return Weight:O:N:') as `purchase_return_weight`,
    concat(ifnull(`v`.`pending_quantity`, ''), ':Pending Quantity:O:N:') as `pending_quantity`,
    concat(ifnull(`v`.`pending_weight`, ''), ':Pending Weight:O:N:') as `pending_weight`,
    concat(ifnull(`v`.`excess_quantity`, ''), ':Excess Quantity:O:N:') as `excess_quantity`,
    concat(ifnull(`v`.`excess_weight`, ''), ':Excess Weight:O:N:') as `excess_weight`,
    concat(ifnull(`v`.`production_issue_quantity`, ''), ':Issue Quantity:O:N:') as `production_issue_quantity`,
    concat(ifnull(`v`.`production_issue_weight`, ''), ':Issue Weight:O:N:') as `production_issue_weight`,
    concat(ifnull(`v`.`production_issue_return_quantity`, ''), ':Issue Return Quantity:O:N:') as `production_issue_return_quantity`,
    concat(ifnull(`v`.`production_issue_return_weight`, ''), ':Issue Return Weight:O:N:') as `production_issue_return_weight`,
    concat(ifnull(`v`.`production_issue_rejection_quantity`, ''), ':Issue Rejection Quantity:O:N:') as `production_issue_rejection_quantity`,
    concat(ifnull(`v`.`production_issue_rejection_weight`, ''), ':Issue Rejection Weight:O:N:') as `production_issue_rejection_weight`,
    concat(ifnull(`v`.`assembly_production_issue_quantity`, ''), ':Assembly Production Issue Quantity:O:N:') as `assembly_production_issue_quantity`,
    concat(ifnull(`v`.`assembly_production_issue_weight`, ''), ':Assembly Production Issue Weight:O:N:') as `assembly_production_issue_weight`,
    concat(ifnull(`v`.`sales_quantity`, ''), ':Sales Quantity:O:N:') as `sales_quantity`,
    concat(ifnull(`v`.`sales_weight`, ''), ':Sales Weight:O:N:') as `sales_weight`,
    concat(ifnull(`v`.`sales_return_quantity`, ''), ':Sales Return Quantity:O:N:') as `sales_return_quantity`,
    concat(ifnull(`v`.`sales_return_weight`, ''), ':Sales Return Weight:O:N:') as `sales_return_weight`,
    concat(ifnull(`v`.`sales_rejection_quantity`, ''), ':Sales Rejection Quantity:O:N:') as `sales_rejection_quantity`,
    concat(ifnull(`v`.`sales_rejection_weight`, ''), ':Sales Rejection Weight:O:N:') as `sales_rejection_weight`,
    concat(ifnull(`v`.`transfer_issue_quantity`, ''), ':Transfer Issue Quantity:O:N:') as `transfer_issue_quantity`,
    concat(ifnull(`v`.`transfer_issue_weight`, ''), ':Transfer Issue Weight:O:N:') as `transfer_issue_weight`,
    concat(ifnull(`v`.`transfer_receipt_quantity`, ''), ':Transfer Receipt Quantity:O:N:') as `transfer_receipt_quantity`,
    concat(ifnull(`v`.`transfer_receipt_weight`, ''), ':Transfer Receipt Weight:O:N:') as `transfer_receipt_weight`,
    concat(ifnull(`v`.`outsources_out_quantity`, ''), ':Outsources Out Quantity:O:N:') as `outsources_out_quantity`,
    concat(ifnull(`v`.`outsources_out_weight`, ''), ':Outsourcess Out Weight:O:N:') as `outsources_out_weight`,
    concat(ifnull(`v`.`outsources_in_quantity`, ''), ':Outsources In Quantity:O:N:') as `outsources_in_quantity`,
    concat(ifnull(`v`.`outsources_in_weight`, ''), ':Outsources In Weight:O:N:') as `outsources_in_weight`,
    concat(ifnull(`v`.`outsources_rejection_quantity`, ''), ':Outsources Rejection Quantity:O:N:') as `outsources_rejection_quantity`,
    concat(ifnull(`v`.`outsources_rejection_weight`, ''), ':Outsources Rejection Weight:O:N:') as `outsources_rejection_weight`,
    concat(ifnull(`v`.`loan_receipt_quantity`, ''), ':Loan Receipt Quantity:O:N:') as `loan_receipt_quantity`,
    concat(ifnull(`v`.`loan_receipt_weight`, ''), ':Loan Receipt Weight:O:N:') as `loan_receipt_weight`,
    concat(ifnull(`v`.`loan_issue_quantity`, ''), ':Loan Issue Quantity:O:N:') as `loan_issue_quantity`,
    concat(ifnull(`v`.`loan_issue_weight`, ''), ':Loan Issue Weight:O:N:') as `loan_issue_weight`,
    concat(ifnull(`v`.`cancel_quantity`, ''), ':Cancel Quantity:O:N:') as `cancel_quantity`,
    concat(ifnull(`v`.`cancel_weight`, ''), ':Cancel Weight:O:N:') as `cancel_weight`,
    concat(ifnull(`v`.`prev_grn_quantity`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_quantity`,
    concat(ifnull(`v`.`prev_grn_weight`, ''), ':Prev GRN Quantity:O:N:') as `prev_grn_weight`,
    concat(ifnull(`v`.`difference_quantity`, ''), ':Difference Quantity:O:N:') as `difference_quantity`,
    concat(ifnull(`v`.`difference_weight`, ''), ':Difference Weight:O:N:') as `difference_weight`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`supplier_name`, ''), ':Supplier Name:Y:T') as `supplier_name`,
    concat(ifnull(`v`.`supplier_state_name`, ''), ':Supplier State Name:O:N:') as `supplier_state_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:N:') as `customer_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indented By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`sr_no`, ''), ':Sr No:O:N:') as `sr_no`,
    concat(ifnull(`v`.`so_sr_no`, ''), ':So Sr No:O:N:') as `so_sr_no`,
    concat(ifnull(`v`.`product_type_short_name`, ''), ':Product Type Short Name:O:N:') as `product_type_short_name`,
    concat(ifnull(`v`.`product_type_group`, ''), ':Product Type Group:O:N:') as `product_type_group`,
    concat(ifnull(`v`.`product_material_print_name`, ''), ':Material Print Name:O:N:') as `product_material_print_name`,
    concat(ifnull(`v`.`product_material_tech_spect`, ''), ':Material Tech Spect:O:N:') as `product_material_tech_spect`,
    concat(ifnull(`v`.`product_packing_name`, ''), ':Product Packing Name:O:N:') as `product_packing_name`,
    concat(ifnull(`v`.`hsn_sac_type`, ''), ':Hsn Sac Type:O:N:') as `hsn_sac_type`,
    concat(ifnull(`v`.`hsn_sac_description`, ''), ':Hsn Sac Description:O:N:') as `hsn_sac_description`,
    concat(ifnull(`v`.`purchase_order_status`, ''), ':Purchase Order Status:O:N:') as `purchase_order_status`,
    concat(ifnull(`v`.`purchase_order_item_status`, ''), ':Purchase Order Item Status:O:N:') as `purchase_order_item_status`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':GRN Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`purchase_order_mail_sent_status`, ''), ':Purchase Order Mail Sent Status:O:N:') as `purchase_order_mail_sent_status`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`city_name`, ''), ':City Name:O:N:') as `city_name`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`supplier_id`, ''), ':Supplier Id:N:N:') as `supplier_id`,
    concat(ifnull(`v`.`supplier_state_id`, ''), ':Supplier State Id:N:N:') as `supplier_state_id`,
    concat(ifnull(`v`.`supplier_city_id`, ''), ':Supplier City Id:N:N:') as `supplier_city_id`,
    concat(ifnull(`v`.`supplier_contacts_ids`, ''), ':Supplier Contacts Ids:N:N:') as `supplier_contacts_ids`,
    concat(ifnull(`v`.`purchase_order_type_id`, ''), ':Purchase Order Type Id:N:N:') as `purchase_order_type_id`,
    concat(ifnull(`v`.`purchase_order_master_transaction_id`, ''), ':Purchase Order Master Transaction Id:O:N:') as `purchase_order_master_transaction_id`,
    concat(ifnull(`v`.`purchase_order_details_transaction_id`, ''), ':Purchase Order Details Transaction_id:N:N:') as `purchase_order_details_transaction_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_packing_id`, ''), ':Product Material Packing Id:N:N:') as `product_material_packing_id`,
    concat(ifnull(`v`.`product_material_hsn_code_id`, ''), ':Product Material Hsn Code Id:N:N:') as `product_material_hsn_code_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`approved_by_id`, ''), ':Approved By Id:O:N:') as `approved_by_id`
from
    `ptv_purchase_order_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------

INSERT INTO am_modules_forms (company_id,company_branch_id,module_id,sub_module_id,modules_menu_id,modules_sub_menu_id,modules_forms_name,display_sequence,display_name,menu_type,listing_component_name,listing_component_import_path,listing_navigation_url,form_component_name,form_component_import_path,form_navigation_url,icon_class,page_header,is_selected,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,is_protected,header,footer,url_parameter) VALUES
	 (1,1,1,16,6,27,'Outstanding materials Report',6,'Outstanding materials Report','Registers','<OutstandingMaterialsForPOReport />','import OutstandingMaterialsForPOReport from "./Transactions/TPurchaseReports/OutstandingMaterialsForPOReport";','/Transactions/TPurchaseReports/OutstandingMaterialsForPOReport','','','',NULL,NULL,0,1,0,NULL,NULL,NULL,NULL,NULL,NULL,0,1,1,'');


	INSERT INTO am_modules_forms_user_access (company_id,company_branch_id,user_type,user_id,modules_forms_id,module_id,sub_module_id,all_access,read_access,add_access,modify_access,delete_access,approve_access,special_access,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,access_control,user_code,company_access) VALUES
	 (1,1,'Administrators','1',658,1,3,1,1,1,1,1,1,1,1,0,'admin','2024-05-23 13:53:43',NULL,'2024-05-23 13:53:43',NULL,NULL,'Y:Y:Y:Y:Y:Y:Y','S0000','0'),
	 (1,1,'Employees','732',658,1,16,0,1,0,0,0,0,0,1,0,'dakshabhiadmin','2024-10-14 10:37:06',NULL,'2024-10-14 10:37:06',NULL,NULL,'N:Y:N:N:N:N:N','S10077','0');


-------------------------------------------------------------------------------------------------------------------------------


update am_modules_forms set url_parameter = ""
where modules_forms_id = 657;

update am_modules_forms set url_parameter = ""
where modules_forms_id = 646;
-------------------------------------------------------------------------------------------------------------------------------
-- 25-10-2024

ALTER TABLE sm_product_rm_stock_details ADD no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes quantity of materials';


ALTER TABLE sm_product_rm_stock_summary ADD no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes of materials';

-------------------------------------------------------------------------------------------------------------------------------
UPDATE sm_product_rm_stock_details AS st
LEFT JOIN pt_goods_receipt_details AS grn
ON grn.goods_receipt_no = st.goods_receipt_no
AND grn.product_material_id = st.product_rm_id
SET st.no_of_boxes = COALESCE(grn.no_of_boxes, st.no_of_boxes)
where st.product_type_id = 12
-------------------------------------------------------------------------------------------------------------------------------
pending 06-11-2024

ALTER TABLE sm_product_rm_stock_details ADD opening_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock';
ALTER TABLE sm_product_rm_stock_details CHANGE opening_no_of_boxes opening_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock' AFTER opening_quantity;
ALTER TABLE sm_product_rm_stock_details ADD reserve_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock';
ALTER TABLE sm_product_rm_stock_details CHANGE reserve_no_of_boxes reserve_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock' AFTER reserve_weight;
ALTER TABLE sm_product_rm_stock_details ADD purchase_no_of_boxes BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_details CHANGE purchase_no_of_boxes purchase_no_of_boxes BIGINT(20) DEFAULT 0 NULL AFTER purchase_weight;
ALTER TABLE sm_product_rm_stock_details ADD issue_no_of_boxes BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_details CHANGE issue_no_of_boxes issue_no_of_boxes BIGINT(20) DEFAULT 0 NULL AFTER production_issue_weight;
ALTER TABLE sm_product_rm_stock_details CHANGE no_of_boxes closing_no_of_boxes bigint(20) DEFAULT 0 NULL COMMENT 'no of boxes quantity of materials';
ALTER TABLE sm_product_rm_stock_details CHANGE closing_no_of_boxes closing_no_of_boxes bigint(20) DEFAULT 0 NULL COMMENT 'no of boxes quantity of materials' AFTER closing_balance_weight;

-------------------------------------------------------------------------------------------------------------------------------


ALTER TABLE sm_product_rm_stock_summary ADD opening_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock';
ALTER TABLE sm_product_rm_stock_summary CHANGE opening_no_of_boxes opening_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock' AFTER opening_quantity;
ALTER TABLE sm_product_rm_stock_summary ADD reserve_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock';
ALTER TABLE sm_product_rm_stock_summary CHANGE reserve_no_of_boxes reserve_no_of_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes for yarn stock' AFTER reserve_weight;
ALTER TABLE sm_product_rm_stock_summary ADD purchase_no_of_boxes BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_summary CHANGE purchase_no_of_boxes purchase_no_of_boxes BIGINT(20) DEFAULT 0 NULL AFTER purchase_weight;
ALTER TABLE sm_product_rm_stock_summary ADD issue_no_of_boxes BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_summary CHANGE issue_no_of_boxes issue_no_of_boxes BIGINT(20) DEFAULT 0 NULL AFTER production_issue_weight;
ALTER TABLE sm_product_rm_stock_summary CHANGE no_of_boxes closing_no_of_boxes bigint(20) DEFAULT 0 NULL COMMENT 'no of boxes quantity of materials';
ALTER TABLE sm_product_rm_stock_summary CHANGE closing_no_of_boxes closing_no_of_boxes bigint(20) DEFAULT 0 NULL COMMENT 'no of boxes quantity of materials' AFTER closing_balance_weight;



-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_summary` as
select
    `sm`.`financial_year` as `financial_year`,
    `sup`.`supplier_name` as `supplier_name`,
    `cust`.`customer_name` as `customer_name`,
    `pt`.`product_type_name` as `product_type_name`,
    `sm`.`product_type_group` as `product_type_group`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `pu`.`product_unit_name` as `product_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `sm`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `pt`.`product_type_short_name` as `product_type_short_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_summary` `sm`
left join `cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_details` as
select
    `sm`.`stock_date` as `stock_date`,
    `sm`.`day_closed` as `day_closed`,
    `sm`.`batch_no` as `batch_no`,
    `supp`.`supplier_code` as `supplier_code`,
    `supp`.`supplier_name` as `supplier_name`,
    `sm`.`batch_expiry_date` as `batch_expiry_date`,
    `sm`.`goods_receipt_no` as `goods_receipt_no`,
    `sm`.`goods_receipt_version` as `goods_receipt_version`,
    `cm`.`customer_code` as `customer_code`,
    `cm`.`customer_name` as `customer_name`,
    `sm`.`sales_order_no` as `sales_order_no`,
    `sm`.`sales_order_version` as `sales_order_version`,
    `sm`.`customer_goods_receipt_no` as `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` as `customer_goods_receipt_version`,
    `sm`.`so_sr_no` as `so_sr_no`,
    `sm`.`customer_order_no` as `customer_order_no`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_technical_name` as `product_rm_technical_name`,
    `rm`.`product_type_name` as `product_type_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `rm`.`product_material_short_name` as `product_rm_short_name`,
    `su`.`product_unit_name` as `product_material_unit_name`,
    `rm`.`product_material_stock_unit_name` as `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`batch_rate` as `batch_rate`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`batch_rate` * `sm`.`closing_balance_quantity` as `closing_amount`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_area` as `godown_area`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gds`.`godown_section_area` as `godown_section_area`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `pp`.`weight_per_packing` as `weight_per_packing`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `sm`.`financial_year` as `financial_year`,
    `sm`.`product_type_group` as `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_details` `sm`
left join `cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `cm_customer` `cm` on
    (`cm`.`is_delete` = 0
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `cm_supplier` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supplier_id` = `sm`.`supplier_id`))
left join `sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
call check_and_update_reschedule_stock_auto();
-------------------------------------------------------------------------------------------------------------------------------
--  to update no of boxes of opening
 UPDATE sm_product_rm_stock_details pt
SET pt.opening_no_of_boxes =  pt.closing_no_of_boxes
WHERE pt.product_type_id = 12;



--  to update no of boxes of purchase and opening
UPDATE sm_product_rm_stock_details pt
SET
    pt.opening_no_of_boxes = 0,
    pt.purchase_no_of_boxes = pt.closing_no_of_boxes
WHERE pt.product_type_id = 12
  AND EXISTS (
    SELECT 1
    FROM pt_goods_receipt_details gd
    WHERE gd.goods_receipt_date = pt.stock_date
      AND gd.goods_receipt_no = pt.goods_receipt_no
  );
-------------------------------------------------------------------------------------------------------------------------------
CREATE DEFINER=`root`@`localhost` PROCEDURE `reschedule_stock_issue`(
    IN goodsReceiptNo VARCHAR(50),
    IN issueDate DATE,
    IN material_id VARCHAR(30)
)
BEGIN
    DECLARE stockDate DATE;
    DECLARE currentDate DATE;
    DECLARE openQty DECIMAL(10,2);
    DECLARE openWeight DECIMAL(10,2);
    DECLARE openBoxes INT;
    DECLARE reserveQty DECIMAL(10,2);
    DECLARE reserveWeight DECIMAL(10,2);
    DECLARE reserveBoxes INT;
    DECLARE closingQty DECIMAL(10,2);
    DECLARE closingWeight DECIMAL(10,2);
    DECLARE closingBoxes INT;
    DECLARE issueQTY DECIMAL(10,2);
    DECLARE issueWeight DECIMAL(10,2);
    DECLARE issueBox INT;

  -- Get the current date
    SET currentDate = CURDATE();

    -- Loop through each day from the issueDate to the current date
    WHILE issueDate < currentDate DO
        -- Move to the next day
        SET stockDate = DATE_ADD(issueDate, INTERVAL 1 DAY);

       -- Get the previous day's data
        SELECT
             production_issue_quantity as issueQTY, production_issue_weight as issueWeight, issue_no_of_boxes as issueBox
        INTO issueQTY, issueWeight, issueBox
        FROM sm_product_rm_stock_details
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id;

        -- Get the previous day's data
        SELECT
             (closing_balance_quantity - issueQTY) as closingQty, (closing_balance_weight - issueWeight) as closingWeight
             , (closing_no_of_boxes - issueBox) as closingBoxes,
            reserve_quantity, reserve_weight, reserve_no_of_boxes,
            closing_balance_quantity AS openQty,
            closing_balance_weight AS openWeight,
            closing_no_of_boxes AS openBoxes
        INTO closingQty, closingWeight, closingBoxes, reserveQty, reserveWeight, reserveBoxes, openQty, openWeight, openBoxes
        FROM sm_product_rm_stock_details
        WHERE stock_date = DATE_SUB(stockDate, INTERVAL 1 DAY)
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id;


        -- Update the stock details for the current stockDate
        UPDATE sm_product_rm_stock_details
        SET
            opening_quantity = openQty,
            opening_weight = openWeight,
            opening_no_of_boxes = openBoxes,
            reserve_quantity = reserveQty,
            reserve_weight = reserveWeight,
            reserve_no_of_boxes = reserveBoxes,
            closing_balance_quantity = closingQty,
            closing_balance_weight = closingWeight,
            closing_no_of_boxes = closingBoxes
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id;

        -- Move the issueDate to the next day for the loop
        SET issueDate = stockDate;
    END WHILE;

end
-------------------------------------------------------------------------------------------------------------------------------



select
	COUNT(*) over() as total_count,
	st.product_rm_id as material_id,
	pt.product_type_name as product_type_name,
	ct1.product_category1_name as product_category1_name,
	ct2.product_category2_name as product_category2_name,
	rm.product_rm_code as material_code,
	rm.product_rm_name as material_name,
	SUM(CASE WHEN st.stock_date = :from_date THEN st.opening_quantity ELSE 0 END) AS opening_quantity,
	IFNULL(SUM(CASE WHEN st.stock_date = :from_date THEN st.opening_quantity * st.batch_rate ELSE 0 END) /
           NULLIF(SUM(CASE WHEN st.stock_date = :from_date THEN st.opening_quantity ELSE 0 END), 0), 0)
           AS opening_average_batch_rate,
	SUM(CASE WHEN st.stock_date = :from_date THEN st.opening_quantity * st.batch_rate ELSE 0 END) AS opening_total_material_value,
	SUM(st.purchase_quantity) AS purchase_quantity,
	ifnull (SUM(st.purchase_quantity * st.batch_rate) / SUM(st.purchase_quantity),
	0) AS purchase_average_batch_rate,
	ifnull (SUM(st.purchase_quantity * st.batch_rate),
	0) AS purchase_total_material_value,
	(
	select
		ifnull(ROUND(SUM(case when adj.stock_adjustment_type = 'Add' then adj.stock_adjustment_quantity else 0 end), 2), 0)
	from
		sm_product_stock_adjustment_details adj
	where
		adj.product_material_id = st.product_rm_id
		and adj.is_delete = 0
		and adj.stock_date between :from_date and :to_date ) as adjust_by_add,
	(
	select
		ifnull(ROUND(SUM(case when adj.stock_adjustment_type = 'Add' then ifnull (adj.stock_adjustment_quantity * adj.material_rate,
	0) else 0 end), 2),0)
	from
		sm_product_stock_adjustment_details adj
	where
		adj.product_material_id = st.product_rm_id
		and adj.is_delete = 0
		and adj.stock_date between :from_date and :to_date ) as adjust_by_add_value,
	(
	select
		ifnull(ROUND(SUM(case when adj.stock_adjustment_type = 'Reduce' then adj.stock_adjustment_quantity else 0 end), 2),0)
	from
		sm_product_stock_adjustment_details adj
	where
		adj.product_material_id = st.product_rm_id
		and adj.is_delete = 0
		and adj.stock_date between :from_date and :to_date ) as adjust_by_reduce,
	(
	select
			ifnull(ROUND(SUM(case when adj.stock_adjustment_type = 'Reduce' then ifnull (adj.stock_adjustment_quantity * adj.material_rate,
	0) else 0 end), 2),0)
	from
		sm_product_stock_adjustment_details adj
	where
		adj.product_material_id = st.product_rm_id
		and adj.is_delete = 0
		and adj.stock_date between :from_date and :to_date ) as adjust_by_reduce_value,
	SUM(st.production_issue_quantity) AS issue_quantity,
	ifnull(SUM(st.production_issue_quantity * st.batch_rate) / SUM(st.production_issue_quantity), 0) AS issue_average_batch_rate,
	ifnull(SUM(st.production_issue_quantity * st.batch_rate), 0) AS issue_total_material_value,
	SUM(case when st.stock_date = :to_date then st.closing_balance_quantity else 0 end) as closing_balance_quantity,
	ROUND(IFNULL(SUM(case when st.stock_date = :to_date then st.closing_balance_quantity * st.batch_rate else 0 end) /
 	nullif(SUM(case when st.stock_date = :to_date then st.closing_balance_quantity else 0 end), 0), 0), 2) as closing_average_batch_rate,
	ROUND(SUM(case when st.stock_date = :to_date then st.closing_balance_quantity * st.batch_rate else 0 end), 2) as closing_total_material_value
FROM
	sm_product_rm_stock_details AS st
LEFT JOIN sm_product_rm AS rm ON
	rm.product_rm_id = st.product_rm_id
	and rm.is_delete = 0
LEFT JOIN sm_product_type as pt on
	pt.product_type_id = st.product_type_id
	and pt.is_delete = 0
LEFT JOIN sm_product_category1 as ct1 ON
	ct1.product_category1_id = rm.product_category1_id
	and ct1.is_delete = 0
LEFT JOIN sm_product_rm_technical as rt ON
	rt.product_rm_id = st.product_rm_id
	and rt.is_delete = 0
LEFT JOIN sm_product_category2 as ct2 ON
	ct2.product_category2_id = rt.product_category2_id
	and ct2.is_delete = 0
WHERE
	st.stock_date BETWEEN :from_date AND :to_date
	AND st.is_delete = 0
	AND rm.product_type_id = :productTypeId
GROUP BY
	rm.product_rm_id,
	rm.product_rm_code
ORDER BY
	ct1.product_category1_name,
	ct2.product_category2_name


LIMIT 0,
50



UPDATE sm_product_stock_adjustment_details AS adj
JOIN sm_product_rm_stock_details AS st
ON st.stock_date = adj.stock_date
AND st.product_rm_id = adj.product_material_id
AND st.goods_receipt_no = 'Opening Balance'
SET adj.material_rate = st.batch_rate;

-------------------------------------------------------------------------------------------------------------------------------

CREATE TEMPORARY TABLE temp_batch_rates AS
SELECT product_rm_id, batch_rate
FROM sm_product_rm_stock_details
WHERE day_closed = 0
  AND goods_receipt_no = 'Opening Balance';


UPDATE sm_product_rm_stock_details AS t1
JOIN temp_batch_rates AS t2
ON t1.product_rm_id = t2.product_rm_id
SET t1.batch_rate = t2.batch_rate
WHERE t1.goods_receipt_no = 'Opening Balance'
  AND t1.day_closed = 1;


DROP TEMPORARY TABLE temp_batch_rates;
-------------------------------------------------------------------------------------------------------------------------------
 -- 28-11-2024

ALTER TABLE sm_product_rm_stock_summary MODIFY COLUMN supplier_return_quantity decimal(18,4) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_summary MODIFY COLUMN supplier_return_weight decimal(18,4) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_summary MODIFY COLUMN supplier_return_boxes bigint(20) DEFAULT 0 NULL;

ALTER TABLE sm_product_rm_stock_details MODIFY COLUMN supplier_return_quantity decimal(18,4) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_details MODIFY COLUMN supplier_return_weight decimal(18,4) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_details MODIFY COLUMN supplier_return_boxes bigint(20) DEFAULT 0 NULL;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE sm_product_rm_stock_summary ADD material_rate DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'aveage rate of total qunatity in stock';
ALTER TABLE sm_product_rm_stock_summary CHANGE material_rate material_rate DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'aveage rate of total qunatity in stock' AFTER product_material_packing_id;
ALTER TABLE sm_product_rm_stock_summary ADD stock_date DATE NULL COMMENT 'stock date for evry day';
ALTER TABLE sm_product_rm_stock_summary CHANGE stock_date stock_date DATE NULL COMMENT 'stock date for evry day' AFTER stock_transaction_id;
ALTER TABLE sm_product_rm_stock_summary ADD day_closed BIT(1) DEFAULT 0 NULL;
ALTER TABLE sm_product_rm_stock_summary CHANGE day_closed day_closed BIT(1) DEFAULT 0 NULL AFTER stock_date;
ALTER TABLE sm_product_rm_stock_summary CHANGE total_box_weight total_box_weight decimal(18,4) DEFAULT 0.0000 NULL COMMENT 'text box for total weight of box' AFTER is_active;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_summary` as
select
    `sm`.`financial_year` as `financial_year`,
    `sup`.`supplier_name` as `supplier_name`,
    `cust`.`customer_name` as `customer_name`,
    `pt`.`product_type_name` as `product_type_name`,
    `sm`.`product_type_group` as `product_type_group`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `pu`.`product_unit_name` as `product_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_return_boxes` as `production_issue_return_boxes`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `sm`.`supplier_return_quantity` as `supplier_return_quantity`,
    `sm`.`supplier_return_weight` as `supplier_return_weight`,
    `sm`.`supplier_return_boxes` as `supplier_return_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `sm`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `pt`.`product_type_short_name` as `product_type_short_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `sm`.`material_rate` as `material_rate`,
    `sm`.`stock_date` as `stock_date`,
    `sm`.`day_closed` as `day_closed`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_summary` `sm`
left join `cmv_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `cm_supplier` `sup` on
    (`sup`.`company_branch_id` = `sm`.`company_branch_id`
        and `sup`.`company_id` = `sm`.`company_id`
        and `sup`.`supplier_id` = `sm`.`supplier_id`
        and `sup`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `v`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_item_status_desc`,
    case
        `v`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `d`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `cs`.`customer_name` as `customer_name`,
    `v`.`customer_order_Date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    case
        `v`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id` and `ptdetails`.`day_closed` = 0), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id` and `ptdetails`.`day_closed` = 0), 0) as `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e3`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`Indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `st`.`company_id` as `company_id`,
    `v`.`approved_date` as `approved_date`,
    `st`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `v`.`is_delete` = 0))
left join `cm_department` `d` on
    (`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
    (`e3`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
    (`cs`.`customer_id` = `v`.`customer_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `rmfgsr`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `rmfgsr`.`actual_count` as `actual_count`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_issue_boxes` as `product_material_issue_boxes`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` as `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` as `product_type_name`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_unit_name`,
    `rmfgsr`.`lead_time` as `product_lead_time`,
    `ps`.`product_material_stock_quantity` as `product_material_stock_quantity`,
    `ps`.`product_material_stock_weight` as `product_material_stock_weight`,
    `ps`.`reserve_quantity` as `reserve_quantity`,
    `ps`.`reserve_weight` as `reserve_weight`,
    ifnull(`sd`.`closing_balance_quantity`, 0) as `closing_balance_quantity`,
    ifnull(`sd`.`closing_balance_weight`, 0) as `closing_balance_weight`,
    ifnull(`sd`.`weight_per_box_item`, 0) as `cone_per_wt`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `v`.`customer_state_name` as `customer_state_name`,
    `v`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `fmp`.`profit_center_name` as `profit_center_name`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `st`.`routing_code` as `routing_code`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`goods_receipt_no` as `goods_receipt_no`,
    `st`.`profit_center_id` as `profit_center_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'Inactive'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`issue_no` as `field_name`,
    `v`.`issue_version` as `field_id`
from
    ((((((((((`st_indent_material_issue_details` `st`
join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `st`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `st`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`
        and `fm`.`is_delete` = 0))
left join `fm_profit_center` `fmp` on
    (`fmp`.`profit_center_id` = `st`.`profit_center_id`
        and `fmp`.`is_delete` = 0))
left join (
    select
        `sm_product_rm_stock_summary`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_summary`.`company_id` as `company_id`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_quantity`) as `product_material_stock_quantity`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_weight`) as `product_material_stock_weight`,
        sum(`sm_product_rm_stock_summary`.`reserve_quantity`) as `reserve_quantity`,
        sum(`sm_product_rm_stock_summary`.`reserve_weight`) as `reserve_weight`
    from
        `sm_product_rm_stock_summary`
    group by
        `sm_product_rm_stock_summary`.`product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id`,
        `sm_product_rm_stock_summary`.`company_id`) `ps` on
    (`ps`.`product_rm_id` = `st`.`product_material_id`
        and `ps`.`godown_id` = `st`.`godown_id`
        and `ps`.`company_id` = `st`.`company_id`))
left join (
    select
        `sm_product_rm_stock_details`.`goods_receipt_no` as `goods_receipt_no`,
        `sm_product_rm_stock_details`.`batch_no` as `batch_no`,
        `sm_product_rm_stock_details`.`day_closed` as `day_closed`,
        `sm_product_rm_stock_details`.`closing_balance_quantity` as `closing_balance_quantity`,
        `sm_product_rm_stock_details`.`closing_balance_weight` as `closing_balance_weight`,
        `sm_product_rm_stock_details`.`weight_per_box_item` as `weight_per_box_item`
    from
        `sm_product_rm_stock_details`
    where
        `sm_product_rm_stock_details`.`day_closed` = 0) `sd` on
    (`sd`.`goods_receipt_no` = `st`.`goods_receipt_no`
        and `sd`.`batch_no` = `st`.`issue_batch_no`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_purchase_order_details source

create or REPLACE algorithm = UNDEFINED view `ptv_purchase_order_details` as
select
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`indent_no` as `indent_no`,
    `pt`.`indent_date` as `indent_date`,
    `pt`.`indent_version` as `indent_version`,
    case
        `pom`.`purchase_order_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_status_desc`,
    `vp`.`department_name` as `department_name`,
    `sdp`.`department_name` as `sub_department_name`,
    case
        `pt`.`purchase_order_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        when 'B' then 'Bill Booked'
        when 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_item_status_desc`,
    case
        `pom`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `pom`.`supplier_name` as `supplier_name`,
    `pom`.`state_name` as `supplier_state_name`,
    `c`.`customer_name` as `customer_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`sr_no` as `sr_no`,
    `pt`.`so_sr_no` as `so_sr_no`,
    `p`.`product_type_name` as `product_type_name`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `p`.`product_type_group` as `product_type_group`,
    `rmfgsr`.`product_material_code` as `product_material_code`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `pt`.`product_material_print_name` as `product_material_print_name`,
    `pt`.`product_material_tech_spect` as `product_material_tech_spect`,
    `pt`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id` and `ptdetails`.`day_closed` = 0), 0) as `available_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `sm_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `pt`.`product_material_id` and `ptdetails`.`company_id` = `pt`.`company_id` and `ptdetails`.`day_closed` = 0), 0) as `available_stock_weight`,
    `rmfgsr`.`product_material_std_weight` as `product_material_std_weight`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_stock_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_description` as `hsn_sac_description`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_category1_name` as `product_category1_name`,
    `rmfgsr`.`product_material_category2_name` as `product_category2_name`,
    `rmfgsr`.`product_material_category3_name` as `product_category3_name`,
    `rmfgsr`.`product_material_category4_name` as `product_category4_name`,
    `rmfgsr`.`product_material_category5_name` as `product_category5_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_grade_name` as `product_material_grade_name`,
    `rmfgsr`.`product_material_shape_name` as `product_material_shape_name`,
    `rmfgsr`.`product_material_oem_part_code` as `product_material_oem_part_code`,
    `rmfgsr`.`product_material_our_part_code` as `product_material_our_part_code`,
    `rmfgsr`.`product_material_drawing_no` as `product_material_drawing_no`,
    `rmfgsr`.`product_material_hsn_sac_code` as `product_material_hsn_sac_code`,
    `rmfgsr`.`godown_name` as `godown_name`,
    `rmfgsr`.`godown_short_name` as `godown_short_name`,
    `rmfgsr`.`godown_area` as `godown_area`,
    `rmfgsr`.`godown_section_name` as `godown_section_name`,
    `rmfgsr`.`godown_section_short_name` as `godown_section_short_name`,
    `rmfgsr`.`godown_section_area` as `godown_section_area`,
    `rmfgsr`.`godown_section_beans_name` as `godown_section_beans_name`,
    `rmfgsr`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `rmfgsr`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pt`.`product_material_po_quantity_qunital` as `product_material_po_quantity_qunital`,
    `pt`.`product_material_po_quantity` as `product_material_po_quantity`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_po_weight` as `product_material_po_weight`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_po_rejected_quantity` as `product_material_po_rejected_quantity`,
    `pt`.`product_material_po_rejected_weight` as `product_material_po_rejected_weight`,
    `pt`.`customer_id` as `customer_id`,
    `pt`.`customer_order_no` as `customer_order_no`,
    `pt`.`customer_order_Date` as `customer_order_Date`,
    `pt`.`pree_closed_quantity` as `pree_closed_quantity`,
    `pt`.`pree_closed_weight` as `pree_closed_weight`,
    `pt`.`pre_closed_remark` as `pre_closed_remark`,
    `pt`.`purchase_return_quantity` as `purchase_return_quantity`,
    `pt`.`purchase_return_weight` as `purchase_return_weight`,
    `pt`.`material_rate` as `material_rate`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`pending_quantity` as `pending_quantity`,
    `pt`.`pending_weight` as `pending_weight`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`production_issue_quantity` as `production_issue_quantity`,
    `pt`.`production_issue_weight` as `production_issue_weight`,
    `pt`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `pt`.`production_issue_return_weight` as `production_issue_return_weight`,
    `pt`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `pt`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `pt`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `pt`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `pt`.`sales_quantity` as `sales_quantity`,
    `pt`.`sales_weight` as `sales_weight`,
    `pt`.`sales_return_quantity` as `sales_return_quantity`,
    `pt`.`sales_return_weight` as `sales_return_weight`,
    `pt`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `pt`.`sales_rejection_weight` as `sales_rejection_weight`,
    `pt`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `pt`.`transfer_issue_weight` as `transfer_issue_weight`,
    `pt`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `pt`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `pt`.`outsources_out_quantity` as `outsources_out_quantity`,
    `pt`.`outsources_out_weight` as `outsources_out_weight`,
    `pt`.`outsources_in_quantity` as `outsources_in_quantity`,
    `pt`.`outsources_in_weight` as `outsources_in_weight`,
    `pt`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `pt`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `pt`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `pt`.`loan_receipt_weight` as `loan_receipt_weight`,
    `pt`.`loan_issue_quantity` as `loan_issue_quantity`,
    `pt`.`loan_issue_weight` as `loan_issue_weight`,
    `pt`.`cancel_quantity` as `cancel_quantity`,
    `pt`.`cancel_weight` as `cancel_weight`,
    `pt`.`difference_quantity` as `difference_quantity`,
    `pt`.`difference_weight` as `difference_weight`,
    `pt`.`material_po_approval_remark` as `material_po_approval_remark`,
    `pom`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`purchase_order_item_status` as `purchase_order_item_status`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pom`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`remark` as `remark`,
    `cm`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_cell_no` as `company_cell_no`,
    `cb`.`branch_phone_no` as `company_phone_no`,
    `cb`.`branch_EmailId` as `company_EmailId`,
    `cb`.`branch_website` as `company_website`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`,
    `cs`.`state_name` as `company_state`,
    `cb`.`branch_pincode` as `company_pincode`,
    `cb`.`branch_address1` as `company_address1`,
    `pt`.`financial_year` as `financial_year`,
    `pom`.`city_name` as `city_name`,
    case
        `pt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `pt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pom`.`supplier_id` as `supplier_id`,
    `pom`.`supplier_state_id` as `supplier_state_id`,
    `pom`.`supplier_city_id` as `supplier_city_id`,
    `pom`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pom`.`expected_branch_id` as `expected_branch_id`,
    `pom`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pom`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`cost_center_id` as `cost_center_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_shape_id` as `product_material_shape_id`,
    `rmfgsr`.`product_material_stock_unit_id` as `product_material_stock_unit_id`,
    `rmfgsr`.`product_material_category1_id` as `product_category1_id`,
    `rmfgsr`.`product_material_category2_id` as `product_category2_id`,
    `rmfgsr`.`product_material_category3_id` as `product_category3_id`,
    `rmfgsr`.`product_material_category4_id` as `product_category4_id`,
    `rmfgsr`.`product_material_category5_id` as `product_category5_id`,
    `rmfgsr`.`godown_id` as `godown_id`,
    `rmfgsr`.`godown_section_id` as `godown_section_id`,
    `rmfgsr`.`godown_section_beans_id` as `godown_section_beans_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`sub_department_id` as `sub_department_id`,
    `pt`.`indented_by_id` as `indented_by_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `pt`.`indent_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id` and `pt`.`indent_no` <> ''), 0) as `prev_po_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_goods_receipt_details` `ptdetails` where `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `pt`.`company_id`), 0) as `prev_grn_weight`
from
    (((((((((((((`pt_purchase_order_details` `pt`
left join `ptv_purchase_order_master_summary` `pom` on
    (`pom`.`company_branch_id` = `pt`.`company_branch_id`
        and `pom`.`company_id` = `pt`.`company_id`
        and `pom`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `pom`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `pom`.`is_delete` = 0))
left join `cm_company` `cm` on
    (`cm`.`company_id` = `pt`.`company_id`
        and `cm`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_state` `cs` on
    (`cs`.`state_id` = `cb`.`branch_state_id`
        and `cs`.`state_id` = 0))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`
        and `p`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `pt`.`product_material_id`))
left join `sm_product_packing` `pp` on
    (`pp`.`product_packing_id` = `pt`.`product_material_packing_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `pt`.`department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`indented_by_id`
        and `e1`.`company_id` = `pt`.`company_id`))
left join `cm_customer` `c` on
    (`c`.`customer_id` = `pt`.`customer_id`))
left join `cm_department` `sdp` on
    (`sdp`.`department_id` = `pt`.`sub_department_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_summary` as
select
    `sm`.`financial_year` as `financial_year`,
    `supp`.`supp_branch_name` as `supplier_name`,
    `cust`.`customer_name` as `customer_name`,
    `pt`.`product_type_name` as `product_type_name`,
    `sm`.`product_type_group` as `product_type_group`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `pu`.`product_unit_name` as `product_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_return_boxes` as `production_issue_return_boxes`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `sm`.`supplier_return_quantity` as `supplier_return_quantity`,
    `sm`.`supplier_return_weight` as `supplier_return_weight`,
    `sm`.`supplier_return_boxes` as `supplier_return_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `sm`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `pt`.`product_type_short_name` as `product_type_short_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `sm`.`material_rate` as `material_rate`,
    `sm`.`stock_date` as `stock_date`,
    `sm`.`day_closed` as `day_closed`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    (((((((((((`sm_product_rm_stock_summary` `sm`
left join `cm_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`is_delete` = 0))

left join `cm_company_branch` `cb` on
    (`cb`.`company_id` = `sm`.`company_id`
        and `cb`.`company_branch_id` = `sm`.`company_branch_id`
        and `v`.`is_delete` = 0))
-- left join `cm_supplier` `sup` on
--     (`sup`.`company_branch_id` = `sm`.`company_branch_id`
--         and `sup`.`company_id` = `sm`.`company_id`
--         and `sup`.`supplier_id` = `sm`.`supplier_id`
--         and `sup`.`is_delete` = 0))
left join `cm_supplier_branch` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supp_branch_id` = `sm`.`supplier_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`day_closed` = 0
    and `sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------

select
	COALESCE(SUM(st.closing_balance_quantity), 0) as closing_balance_quantity,
	ROUND(IFNULL(SUM(st.closing_balance_quantity * st.batch_rate) / nullif(SUM(st.closing_balance_quantity), 0), 0), 2) as closing_average_batch_rate,
	ROUND(COALESCE(SUM(st.closing_balance_quantity * st.batch_rate), 0), 2) as closing_total_material_value
from
	sm_product_rm_stock_details  as st
where
	st.product_rm_id = "RM07569"
	and st.company_id = 2
	and st.day_closed = 0
	and st.is_delete = 0


select
	COALESCE(SUM(st.closing_balance_quantity), 0) as closing_balance_quantity,
	ROUND(IFNULL(SUM(st.closing_balance_quantity * st.material_rate) / nullif(SUM(st.closing_balance_quantity), 0), 0), 2) as closing_average_batch_rate,
	ROUND(COALESCE(SUM(st.closing_balance_quantity * st.material_rate), 0), 2) as closing_total_material_value
from
	sm_product_rm_stock_summary as st
where
	st.product_rm_id = "RM07569"
	and st.company_id = 2
	and st.day_closed = 0
	and st.is_delete = 0
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------

 	UPDATE sm_product_rm_stock_details
SET supplier_return_quantity = 0

WHERE supplier_return_quantity IS NULL;


 	UPDATE sm_product_rm_stock_details
SET supplier_return_weight = 0
WHERE supplier_return_weight IS NULL;

UPDATE sm_product_rm_stock_details
SET supplier_return_boxes = 0
WHERE supplier_return_boxes IS NULL;

-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE  pt_material_transfer_details MODIFY COLUMN product_unit_id BIGINT(20) DEFAULT NULL NULL;

-------------------------------------------------------------------------------------------------------------------------------
pending

update  sm_product_rm_stock_summary set  stock_date =  current_date();

call getDetailsStockAndUpdateStockSummary();

---------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `rmfgsr`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `rmfgsr`.`actual_count` as `actual_count`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_issue_boxes` as `product_material_issue_boxes`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` as `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` as `product_type_name`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_unit_name`,
    `rmfgsr`.`lead_time` as `product_lead_time`,
    `ps`.`product_material_stock_quantity` as `product_material_stock_quantity`,
    `ps`.`product_material_stock_weight` as `product_material_stock_weight`,
    `ps`.`reserve_quantity` as `reserve_quantity`,
    `ps`.`reserve_weight` as `reserve_weight`,
    ifnull(`sd`.`closing_balance_quantity`, 0) as `closing_balance_quantity`,
    ifnull(`sd`.`closing_balance_weight`, 0) as `closing_balance_weight`,
    ifnull(`sd`.`weight_per_box_item`, 0) as `cone_per_wt`,
    ifnull(`sd`.`closing_no_of_boxes`, 0) as `closing_no_of_boxes`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `v`.`customer_state_name` as `customer_state_name`,
    `v`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `fmp`.`profit_center_name` as `profit_center_name`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `st`.`routing_code` as `routing_code`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`goods_receipt_no` as `goods_receipt_no`,
    `st`.`profit_center_id` as `profit_center_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'Inactive'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`issue_no` as `field_name`,
    `v`.`issue_version` as `field_id`
from
    ((((((((((`st_indent_material_issue_details` `st`
join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `st`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `st`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`
        and `fm`.`is_delete` = 0))
left join `fm_profit_center` `fmp` on
    (`fmp`.`profit_center_id` = `st`.`profit_center_id`
        and `fmp`.`is_delete` = 0))
left join (
    select
        `sm_product_rm_stock_summary`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_summary`.`company_id` as `company_id`,
        `sm_product_rm_stock_summary`.`day_closed` as `day_closed`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_quantity`) as `product_material_stock_quantity`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_weight`) as `product_material_stock_weight`,
        sum(`sm_product_rm_stock_summary`.`reserve_quantity`) as `reserve_quantity`,
        sum(`sm_product_rm_stock_summary`.`reserve_weight`) as `reserve_weight`
    from
        `sm_product_rm_stock_summary`
        where `sm_product_rm_stock_summary`.`day_closed` = 0
    group by
        `sm_product_rm_stock_summary`.`product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id`,
        `sm_product_rm_stock_summary`.`company_id`) `ps` on
    (`ps`.`product_rm_id` = `st`.`product_material_id`
        and `ps`.`godown_id` = `st`.`godown_id`
        and `ps`.`company_id` = `st`.`company_id` ))
       
left join (
    select
        `sm_product_rm_stock_details`.`goods_receipt_no` as `goods_receipt_no`,
        `sm_product_rm_stock_details`.`batch_no` as `batch_no`,
        `sm_product_rm_stock_details`.`day_closed` as `day_closed`,
        `sm_product_rm_stock_details`.`closing_balance_quantity` as `closing_balance_quantity`,
        `sm_product_rm_stock_details`.`closing_balance_weight` as `closing_balance_weight`,
        `sm_product_rm_stock_details`.`weight_per_box_item` as `weight_per_box_item`,
        `sm_product_rm_stock_details`.`closing_no_of_boxes` as `closing_no_of_boxes`
    from
        `sm_product_rm_stock_details`
    where
        `sm_product_rm_stock_details`.`day_closed` = 0) `sd` on
    (`sd`.`goods_receipt_no` = `st`.`goods_receipt_no`
        and `sd`.`batch_no` = `st`.`issue_batch_no`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE sm_product_rm_stock_summary DROP COLUMN stock_date;
ALTER TABLE sm_product_rm_stock_summary DROP COLUMN day_closed;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_summary` as
select
    `sm`.`financial_year` as `financial_year`,
    `supp`.`supp_branch_name` as `supplier_name`,
    `cust`.`customer_name` as `customer_name`,
    `pt`.`product_type_name` as `product_type_name`,
    `sm`.`product_type_group` as `product_type_group`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `pu`.`product_unit_name` as `product_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_return_boxes` as `production_issue_return_boxes`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `sm`.`supplier_return_quantity` as `supplier_return_quantity`,
    `sm`.`supplier_return_weight` as `supplier_return_weight`,
    `sm`.`supplier_return_boxes` as `supplier_return_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `sm`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `pt`.`product_type_short_name` as `product_type_short_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `sm`.`material_rate` as `material_rate`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    (((((((((((`sm_product_rm_stock_summary` `sm`
left join `cm_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_id` = `sm`.`company_id`
        and `cb`.`company_branch_id` = `sm`.`company_branch_id`
        and `v`.`is_delete` = 0))
left join `cm_supplier_branch` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supp_branch_id` = `sm`.`supplier_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
`sm`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
02-12-2024

-- stv_indent_master_summary source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        else 'Pending'
	end as `indent_status_desc`,
	case
		`st`.`po_status`  when 'POA' then 'Purchse Order Approved'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
		else 'Pending'
	end as `po_status_desc`,
    case
		`st`.`grn_status` when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
		else 'Pending'
	end as `grn_status_desc`,
	case
		`st`.`issue_status` when 'I' then 'Partial Issue'
		else 'Pending'
	end as `issue_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`,
    `st`.`indent_priority` as `indent_priority`
from
    ((((((((((`st_indent_master` `st`
left join `cm_company` `v` on
    (`v`.`company_id` = `st`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Cenceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`po_status_desc`, ''), ':PO Status:Y:H:(Pending,Purchse Order Genreated,Partial PO Genreated,Purchse Order Approved,Cenceled)') as `po_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:O:N:') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:O:N:') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;


-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `v`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        else 'Pending'
    end as `indent_item_status_desc`,
	case
		`st`.`po_item_status`  when 'POA' then 'Purchse Order Approved'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
		else 'Pending'
	end as `po_item_status_desc`,
    case
		`st`.`grn_item_status` when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
		else 'Pending'
	end as `grn_item_status_desc`,
	case
		`st`.`issue_item_status` when 'I' then 'Partial Issue'
		else 'Pending'
	end as `issue_item_status_desc`,

    case
        `v`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `d`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `cs`.`customer_name` as `customer_name`,
    `v`.`customer_order_Date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    case
        `v`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e3`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`Indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `st`.`company_id` as `company_id`,
    `v`.`approved_date` as `approved_date`,
    `st`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `v`.`is_delete` = 0))
left join `cm_department` `d` on
    (`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
    (`e3`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
    (`cs`.`customer_id` = `v`.`customer_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_item_status_desc`, ''), ':Indent Material Status:Y:H:(Pending,Approved,Rejected,Completed,Cancel)') as `indent_item_status_desc`,
    concat(ifnull(`v`.`po_item_status_desc`, ''), ':PO Material Status:Y:H:(Pending,Purchse Order Genreated,Partial PO Genreated,Purchse Order Approved,Cancel)') as `po_item_status_desc`,   
    concat(ifnull(`v`.`department_name`, ''), ':Department:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`product_rm_name`, ''), ':Material name:Y:T') as `product_rm_name`,
    concat(ifnull(`v`.`product_rm_stock_unit_name`, ''), ':Material Stock Unit Name:O:N:') as `product_rm_stock_unit_name`,
    concat(ifnull(`v`.`product_material_quantity`, ''), ':Material Quantity:O:N:') as `product_material_quantity`,
    concat(ifnull(`v`.`product_material_weight`, ''), ':Material Weight:O:N:') as `product_material_weight`,
    concat(ifnull(`v`.`product_material_stock_quantity`, ''), ':Material Stock Quantity:O:N:') as `product_material_stock_quantity`,
    concat(ifnull(`v`.`product_material_stock_weight`, ''), ':Material Stock Weight:O:N:') as `product_material_stock_weight`,
    concat(ifnull(`v`.`product_material_reserve_quantity`, ''), ':Material Reserve Quantity:O:N:') as `product_material_reserve_quantity`,
    concat(ifnull(`v`.`product_material_reserve_weight`, ''), ':Material Reserve Weight:O:N:') as `product_material_reserve_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') as `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') as `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') as `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') as `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_return_quantity`, ''), ':Material Return Quantity:O:N:') as `product_material_return_quantity`,
    concat(ifnull(`v`.`product_material_return_weight`, ''), ':Material Return Weight:O:N:') as `product_material_return_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') as `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') as `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_grn_accepted_quantity`, ''), ':GRN Accepted Quantity:O:N:') as `product_material_grn_accepted_quantity`,
    concat(ifnull(`v`.`product_material_grn_accepted_weight`, ''), ':GRN Accepted Weight:O:N:') as `product_material_grn_accepted_weight`,
    concat(ifnull(`v`.`product_child_bom_quantity`, ''), ':Product Child Bom Quantity:O:N:') as `product_child_bom_quantity`,
    concat(ifnull(`v`.`product_child_bom_weight`, ''), ':Product Child Bom Weight:O:N:') as `product_child_bom_weight`,
    concat(ifnull(`v`.`product_fg_material_quantity`, ''), ':Fg Material Quantity:O:N:') as `product_fg_material_quantity`,
    concat(ifnull(`v`.`product_fg_material_weight`, ''), ':Fg Material Weight:O:N:') as `product_fg_material_weight`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`product_rm_tech_spect`, ''), ':Material Tech spec:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`v`.`product_rm_drawing_no`, ''), ':Material Drawing No:O:N:') as `product_rm_drawing_no`,
    concat(ifnull(`v`.`product_rm_oem_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_oem_part_code`,
    concat(ifnull(`v`.`product_rm_our_part_code`, ''), ':Material Oem Part Code:O:N:') as `product_rm_our_part_code`,
    concat(ifnull(`v`.`product_category1_name`, ''), ':Product Category1 Name:O:N:') as `product_category1_name`,
    concat(ifnull(`v`.`product_category2_name`, ''), ':Product Category2 Name:O:N:') as `product_category2_name`,
    concat(ifnull(`v`.`lead_time`, ''), ':Lead Time:O:N:') as `lead_time`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issued By:Y:T') as `issued_by_name`,
    concat(ifnull(`v`.`issued_date`, ''), ':Issued Date:Y:D:') as `issued_date`,
    concat(ifnull(`v`.`indent_item_status`, ''), ':Indent Item Status:O:N:') as `indent_item_status`,
    concat(ifnull(`v`.`grn_item_status`, ''), ':GRN Item Status:O:N:') as `grn_item_status`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`remark`, ''), 'remark:O:N:') as `remark`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company_summary:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:Y:C:cmv_company_branch_summary:F') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`product_fg_id`, ''), ':Product Fg Id:N:N:') as `product_fg_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Material Unit Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_type_id`, ''), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`v`.`product_category1_id`, ''), ':Product Category1 Id:N:N:') as `product_category1_id`,
    concat(ifnull(`v`.`product_category2_id`, ''), ':Product Category2 Id:N:N:') as `product_category2_id`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`product_make_id`, ''), ':Product Make Id:N:N:') as `product_make_id`,
    concat(ifnull(`v`.`product_material_type_id`, ''), ':Product Material Type Id:N:N:') as `product_material_type_id`,
    concat(ifnull(`v`.`product_material_grade_id`, ''), ':Product Material Grade Id:N:N:') as `product_material_grade_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_details_id`, ''), ':Indent Details Id:N:N:') as `indent_details_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Indent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') as `issued_by_id`
from
    `stv_indent_details` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
05-12-2024



 delete from xt_beam_inwards_table  where beam_inward_type = 'RAPIER' or 'AIR JET' or 'T-190' or 'T-110';

 INSERT INTO am_properties (property_master_id,properties_master_name,company_id,property_name,property_value,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,property_group,remark) VALUES
	 (176,'SizedBeams',2,'IN-HOUSE','IN-HOUSE',1,0,'6260537025','2024-11-28 16:19:18',NULL,'2024-11-28 16:19:18',NULL,NULL,'BI','');


	-- Make sure prperty id of upper insert query passed to update in xt_beam_inwards_table
	update xt_beam_inwards_table set beam_type = 1031 where beam_inward_type like "%SPF%";

-------------------------------------------------------------------------------------------------------------------------------

-- xtv_beam_inwards_table_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `xtv_beam_inwards_table_rpt` AS
select
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:T:') AS `customer_name`,
    concat(ifnull(`v`.`beam_inwards_date`, ''), ':Beam Inwards Date:Y:D:') AS `beam_inwards_date`,
    concat(ifnull(`v`.`beam_inward_type`, ''), ':Beam Name:Y:T') AS `beam_inward_type`,
    concat(ifnull(`v`.`property_value`, ''), ':Beam Type:O:N:') AS `property_value`,
    concat(ifnull(`v`.`beam_no`, ''), ':Beam No:Y:C:amv_properties:F') AS `beam_no`,
    concat(ifnull(`v`.`section`, ''), ':Section:O:N:') AS `section`,
    concat(ifnull(`v`.`beam_width`, ''), ':Beam Width:Y:T') AS `beam_width`,
    concat(ifnull(`v`.`beam_status`, ''), ':Beam Status:Y:H:(Empty,Completed)') AS `beam_status_desc`,
    concat(ifnull(`v`.`customer_short_name`, ''), ':Customer Short Name:O:N:') AS `customer_short_name`,
    concat(case when ifnull(`v`.`is_delete`, 0) = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:O:N:') AS `customer_id`,
    concat(ifnull(`v`.`beam_inwards_id`, ''), ':Beam Inwards Id:N:N:') AS `beam_inwards_id`
from
    `xtv_beam_inwards_table` `v`
limit 1;



	update xt_beam_inwards_table set beam_no = beam_inward_type  where beam_type = 1031;

-------------------------------------------------------------------------------------------------------------------------------
-- 11-12-2024


-- stv_indent_master_summary source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `st`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e`.`employee_name` as `indented_by_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `e2`.`employee_name` as `accepted_by_name`,
    `st`.`approved_date` as `approved_date`,
    case
        `st`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `indent_status_desc`,
    case
        `st`.`po_status` when 'POA' then 'Purchse Order Approved'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        else 'Pending'
    end as `po_status_desc`,
    case
        `st`.`grn_status` when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        else 'Pending'
    end as `grn_status_desc`,
    case
        `st`.`issue_status` when 'I' then 'Partial Issue'
        else 'Pending'
    end as `issue_status_desc`,
    `c`.`customer_name` as `customer_name`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_Date` as `customer_order_date`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fc`.`cost_center_name` as `cost_center_name`,
    `e`.`email_id1` as `indented_by_email`,
    `e1`.`email_id1` as `approved_by_email`,
    case
        `st`.`indent_transaction_type` when 'A' then 'BOM Based'
        else 'Manual'
    end as `indent_transaction_type_desc`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`remark` as `remark`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`indent_master_id` as `indent_master_id`,
    `st`.`indent_type_id` as `indent_type_id`,
    `st`.`customer_id` as `customer_id`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`accepted_by_id` as `accepted_by_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`indent_status` as `indent_status`,
    `st`.`po_status` as `po_status`,
    `st`.`grn_status` as `grn_status`,
    `st`.`issue_status` as `issue_status`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`indent_transaction_type` as `indent_transaction_type`,
    `st`.`Indent_type` as `indent_type`,
    `p`.`product_type_short_name` as `indent_type_short_name`,
    `st`.`indent_source` as `indent_source`,
    `st`.`indent_priority` as `indent_priority`
from
    ((((((((((`st_indent_master` `st`
left join `cm_company` `v` on
    (`v`.`company_id` = `st`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_customer` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `st`.`accepted_by_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `st`.`indent_type_id`))
left join `fm_cost_center` `fc` on
    (`fc`.`cost_center_id` = `st`.`cost_center_id`
        and `fc`.`company_id` = `st`.`company_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`indent_no`,
    `st`.`indent_version`;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_details` as
select
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    case
        `v`.`indent_priority` when 'H' then 'High-Priority'
        else 'Low-Priority'
    end as `indent_priority_desc`,
    case
        `st`.`indent_item_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `indent_item_status_desc`,
    case
        `st`.`po_item_status` when 'POA' then 'Purchse Order Approved'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        else 'Pending'
    end as `po_item_status_desc`,
    case
        `st`.`grn_item_status` when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        else 'Pending'
    end as `grn_item_status_desc`,
    case
        `st`.`issue_item_status` when 'I' then 'Partial Issue'
        else 'Pending'
    end as `issue_item_status_desc`,
    case
        `v`.`indent_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `d`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `e1`.`employee_name` as `indented_by_name`,
    `e2`.`employee_name` as `approved_by_name`,
    `cs`.`customer_name` as `customer_name`,
    `v`.`customer_order_Date` as `customer_order_date`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    case
        `v`.`indent_status` when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Cenceled'
        when 'O' then 'Purchse Order Genreated'
        when 'IPO' then 'Partial PO Genreated'
        when 'POA' then 'Purchse Order Approved'
        when 'G' then 'Goods Receipts'
        when 'IG' then 'Partial Goods Receipts'
        when 'I' then 'Partial Issue'
        else 'Pending'
    end as `indent_status_desc`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`so_sr_no` as `so_sr_no`,
    `st`.`sales_order_details_transaction_id` as `sales_order_details_transaction_id`,
    `st`.`remark` as `remark`,
    `st`.`product_fg_material_quantity` as `product_fg_material_quantity`,
    `st`.`product_fg_material_weight` as `product_fg_material_weight`,
    `child`.`product_material_name` as `product_rm_name`,
    `child`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `child`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `child`.`product_material_stock_unit_name` as `product_rm_stock_unit_name`,
    `child`.`product_type_name` as `product_type_name`,
    `child`.`product_material_category1_name` as `product_category1_name`,
    `child`.`product_material_oem_part_code` as `product_rm_oem_part_code`,
    `child`.`product_material_our_part_code` as `product_rm_our_part_code`,
    `child`.`product_material_category2_name` as `product_category2_name`,
    `child`.`product_material_std_weight` as `product_rm_std_weight`,
    `child`.`product_material_packing_name` as `product_rm_packing_name`,
    `child`.`product_material_hsn_sac_code` as `product_rm_hsn_sac_code`,
    `child`.`product_material_hsn_sac_rate` as `product_rm_hsn_sac_rate`,
    `st`.`product_material_quantity` as `product_material_quantity`,
    `st`.`product_material_weight` as `product_material_weight`,
    `st`.`lead_time` as `lead_time`,
    coalesce((select sum(`ptdetails`.`closing_balance_quantity`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_quantity`,
    coalesce((select sum(`ptdetails`.`closing_balance_weight`) from `smv_product_rm_stock_summary` `ptdetails` where `ptdetails`.`product_rm_id` = `st`.`product_material_id` and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `product_material_stock_weight`,
    `st`.`product_material_reserve_quantity` as `product_material_reserve_quantity`,
    `st`.`product_material_reserve_weight` as `product_material_reserve_weight`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_return_quantity` as `product_material_return_quantity`,
    `st`.`product_material_return_weight` as `product_material_return_weight`,
    `st`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `st`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    `st`.`product_child_bom_quantity` as `product_child_bom_quantity`,
    `st`.`product_child_bom_weight` as `product_child_bom_weight`,
    `st`.`approval_remark` as `approval_remark`,
    `e3`.`employee_name` as `issued_by_name`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`issued_date` as `issued_date`,
    `st`.`indent_item_status` as `indent_item_status`,
    `st`.`po_item_status` as `po_item_status`,
    `st`.`grn_item_status` as `grn_item_status`,
    `st`.`issue_item_status` as `issue_item_status`,
    `v`.`indent_source` as `indent_source`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `child`.`product_type_group` as `product_type_group`,
    `child`.`product_material_type_short_name` as `indent_type_short_name`,
    `v`.`Indent_type` as `indent_type`,
    `v`.`indent_status` as `indent_status`,
    `st`.`indent_no` as `field_name`,
    `st`.`indent_version` as `field_id`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`indent_details_id` as `indent_details_id`,
    `st`.`product_fg_id` as `product_fg_id`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `v`.`indent_transaction_type` as `indent_transaction_type`,
    `v`.`indent_master_id` as `indent_master_id`,
    `v`.`indent_type_id` as `indent_type_id`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`indented_by_id` as `indented_by_id`,
    `st`.`company_id` as `company_id`,
    `v`.`approved_date` as `approved_date`,
    `st`.`company_branch_id` as `company_branch_id`,
    `child`.`product_type_id` as `product_type_id`,
    `child`.`product_material_hsn_sac_code_id` as `product_rm_hsn_sac_code_id`,
    `child`.`product_material_packing_id` as `product_rm_packing_id`,
    `child`.`product_material_category1_id` as `product_category1_id`,
    `child`.`product_material_category2_id` as `product_category2_id`,
    `child`.`product_material_make_id` as `product_make_id`,
    `child`.`product_material_type_id` as `product_material_type_id`,
    `child`.`product_material_grade_id` as `product_material_grade_id`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_quantity`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_po_approved_weight`) from `pt_purchase_order_details` `ptdetails` where `ptdetails`.`indent_no` = `st`.`indent_no` and `ptdetails`.`product_material_id` = `st`.`product_material_id` and `ptdetails`.`is_active` = 1 and `ptdetails`.`is_delete` = 0 and `ptdetails`.`company_id` = `st`.`company_id`), 0) as `prev_po_weight`
from
    (((((((((((`st_indent_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `st_indent_master` `v` on
    (`st`.`company_branch_id` = `v`.`company_branch_id`
        and `st`.`company_id` = `v`.`company_id`
        and `st`.`indent_no` = `v`.`indent_no`
        and `v`.`is_delete` = 0))
left join `cm_department` `d` on
    (`d`.`department_id` = `v`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `v`.`sub_department_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `v`.`indented_by_id`))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `v`.`approved_by_id`))
left join `cm_employee` `e3` on
    (`e3`.`employee_id` = `st`.`issued_by_id`
        and `e1`.`company_id` = `st`.`company_id`))
left join `smv_product_rm_fg_sr` `child` on
    (`child`.`product_material_id` = `st`.`product_material_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`company_id` = `st`.`company_id`
        and `fm`.`cost_center_id` = `st`.`cost_center_id`))
left join `cm_customer` `cs` on
    (`cs`.`customer_id` = `v`.`customer_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_master_summary_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_master_summary_rpt` as
select
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:T') as `indent_no`,
    concat(ifnull(`v`.`indent_date`, ''), ':Indent Date:Y:D:') as `indent_date`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`indent_priority_desc`, ''), ':Priority:Y:H:(Low-Priority,High-Priority)') as `indent_priority_desc`,
    concat(ifnull(`v`.`indent_status_desc`, ''), ':Indent Status:Y:H:(Pending,Approved,Rejected,Completed,Canceled)') as `indent_status_desc`,
    concat(ifnull(`v`.`po_status_desc`, ''), ':PO Status:Y:H:(Pending,Purchse Order Genreated,Partial PO Genreated,Purchse Order Approved,Cenceled)') as `po_status_desc`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`indent_type`, ''), ':Indent Type:Y:C:smv_product_type:F') as `indent_type`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Indent Source:Y:H:(SO Based,Direct,Internal)') as `indent_source_desc`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:Y:C:cmv_customer_summary:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:Y:C:stv_indent_master_summary:O') as `customer_order_no`,
    concat(ifnull(`v`.`customer_order_date`, ''), ':Customer Order Date:Y:D:') as `customer_order_date`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indent By:Y:T') as `indented_by_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Indent Approved By:Y:T') as `approved_by_name`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') as `remark`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:O:N:') as `indent_version`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:O:N:') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch:O:N:') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:O:N:') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Modified On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`indent_source`, ''), ':Indent Source:O:N:') as `indent_source`,
    concat(ifnull(`v`.`indent_status`, ''), ':Indent Status:O:N:') as `indent_status`,
    concat(ifnull(`v`.`grn_status`, ''), ':GRN Status:O:N:') as `grn_status`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`indent_master_id`, ''), ':Indent Master Id:O:N:') as `indent_master_id`,
    concat(ifnull(`v`.`indent_type_id`, ''), ':Intdent Type Id:N:N:') as `indent_type_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indeneted By Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:N:N:') as `field_name`,
    concat(ifnull(`v`.`indent_version`, ''), ':Indent Version:N:N:') as `field_id`
from
    `stv_indent_master_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
	ALTER TABLE st_indent_material_issue_return_details ADD creel_no varchar(100) NULL;

-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_return_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_material_issue_return_details` as
select
    `st`.`issue_return_details_transaction_id` as `issue_return_details_transaction_id`,
    `st`.`issue_return_master_transaction_id` as `issue_return_master_transaction_id`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`financial_year` as `financial_year`,
    `stm`.`issue_return_no` as `issue_return_no`,
    `p`.`product_rm_name` as `product_material_name`,
    `st`.`product_material_id` as `product_material_id`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `st`.`product_material_issue_return_boxes` as `product_material_issue_return_boxes`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `st`.`product_material_receipt_boxes` as `product_material_receipt_boxes`,
    `st`.`issue_return_item_status` as `issue_return_item_status`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`issue_return_remark` as `issue_return_remark`,
    `gsb`.`godown_name` as `godown_name`,
    `gsb`.`godown_section_name` as `godown_section_name`,
    `gsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `std`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `std`.`product_material_indent_weight` as `product_material_indent_weight`,
    `std`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `std`.`product_material_approved_weight` as `product_material_approved_weight`,
    `std`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `std`.`product_material_issue_weight` as `product_material_issue_weight`,
    `std`.`product_material_issue_boxes` as `product_material_issue_boxes`,
    `std`.`closing_balance_quantity` as `closing_balance_quantity`,
    `std`.`closing_balance_weight` as `closing_balance_weight`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`cone_per_wt` as `cone_per_wt`,
    `st`.`goods_receipt_no` as `goods_receipt_no`,
    `st`.`creel_no` as `creel_no`
from
    ((((`st_indent_material_issue_return_details` `st`
left join `st_indent_material_issue_return_master` `stm` on
    (`stm`.`issue_return_master_transaction_id` = `st`.`issue_return_master_transaction_id`))
left join `stv_indent_material_issue_details` `std` on
    (`std`.`issue_no` = `stm`.`issue_no`
        and `std`.`product_material_id` = `st`.`product_material_id`
        and `st`.`issue_batch_no` = `std`.`issue_batch_no`
        and `st`.`goods_receipt_no` = `std`.`goods_receipt_no`
        and `std`.`is_delete` = 0))
left join `cmv_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
left join `sm_product_rm` `p` on
    (`p`.`product_rm_id` = `st`.`product_material_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------

-- 31-12-2024


ALTER TABLE sm_product_rm_stock_summary ADD loan_issue_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes issue to department';
ALTER TABLE sm_product_rm_stock_summary CHANGE loan_issue_boxes loan_issue_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes issue to department' AFTER loan_issue_weight;
ALTER TABLE sm_product_rm_stock_summary ADD loan_receipt_boxes varchar(100) DEFAULT '0' NULL COMMENT 'loan receipt boxes to department';
ALTER TABLE sm_product_rm_stock_summary CHANGE loan_receipt_boxes loan_receipt_boxes varchar(100) DEFAULT '0' NULL COMMENT 'loan receipt boxes to department' AFTER loan_receipt_weight;


ALTER TABLE sm_product_rm_stock_details ADD loan_issue_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes issue to department';
ALTER TABLE sm_product_rm_stock_details CHANGE loan_issue_boxes loan_issue_boxes BIGINT(20) DEFAULT 0 NULL COMMENT 'no of boxes issue to department' AFTER loan_issue_weight;
ALTER TABLE sm_product_rm_stock_details ADD loan_receipt_boxes varchar(100) DEFAULT '0' NULL COMMENT 'loan receipt boxes to department';
ALTER TABLE sm_product_rm_stock_details CHANGE loan_receipt_boxes loan_receipt_boxes varchar(100) DEFAULT '0' NULL COMMENT 'loan receipt boxes to department' AFTER loan_receipt_weight;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_summary source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_summary` as
select
    `sm`.`financial_year` as `financial_year`,
    `supp`.`supp_branch_name` as `supplier_name`,
    `cust`.`customer_name` as `customer_name`,
    `pt`.`product_type_name` as `product_type_name`,
    `sm`.`product_type_group` as `product_type_group`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `pu`.`product_unit_name` as `product_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_return_boxes` as `production_issue_return_boxes`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_receipt_boxes` as `loan_receipt_boxes`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`loan_issue_boxes` as `loan_issue_boxes`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `sm`.`supplier_return_quantity` as `supplier_return_quantity`,
    `sm`.`supplier_return_weight` as `supplier_return_weight`,
    `sm`.`supplier_return_boxes` as `supplier_return_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `sm`.`remark` as `remark`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `pt`.`product_type_short_name` as `product_type_short_name`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `sm`.`material_rate` as `material_rate`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    (((((((((((`sm_product_rm_stock_summary` `sm`
left join `cm_company` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_id` = `sm`.`company_id`
        and `cb`.`company_branch_id` = `sm`.`company_branch_id`
        and `v`.`is_delete` = 0))
left join `cm_supplier_branch` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supp_branch_id` = `sm`.`supplier_id`))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `sm`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `sm`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `cm_customer` `cust` on
    (`cust`.`company_branch_id` = `sm`.`company_branch_id`
        and `cust`.`company_id` = `sm`.`company_id`
        and `cust`.`customer_id` = `sm`.`customer_id`
        and `cust`.`is_delete` = 0))
left join `sm_product_type` `pt` on
    (`pt`.`product_type_id` = `sm`.`product_type_id`
        and `pt`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `sm_product_unit` `pu` on
    (`pu`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `pu`.`is_delete` = 0))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
where
    `sm`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- smv_product_rm_stock_details source

create or REPLACE algorithm = UNDEFINED view `smv_product_rm_stock_details` as
select
    `sm`.`stock_date` as `stock_date`,
    `sm`.`day_closed` as `day_closed`,
    `sm`.`batch_no` as `batch_no`,
    `supp`.`supp_branch_name` as `supplier_name`,
    `sm`.`batch_expiry_date` as `batch_expiry_date`,
    `sm`.`goods_receipt_no` as `goods_receipt_no`,
    `sm`.`goods_receipt_version` as `goods_receipt_version`,
    `cm`.`customer_code` as `customer_code`,
    `cm`.`customer_name` as `customer_name`,
    `sm`.`sales_order_no` as `sales_order_no`,
    `sm`.`sales_order_version` as `sales_order_version`,
    `sm`.`customer_goods_receipt_no` as `customer_goods_receipt_no`,
    `sm`.`customer_goods_receipt_version` as `customer_goods_receipt_version`,
    `sm`.`so_sr_no` as `so_sr_no`,
    `sm`.`customer_order_no` as `customer_order_no`,
    `rm`.`product_material_code` as `product_rm_code`,
    `rm`.`product_material_name` as `product_rm_name`,
    `rm`.`product_material_technical_name` as `product_rm_technical_name`,
    `rm`.`product_type_name` as `product_type_name`,
    `rm`.`product_material_category1_name` as `product_material_category1_name`,
    `rm`.`product_material_category2_name` as `product_material_category2_name`,
    `rm`.`product_material_short_name` as `product_rm_short_name`,
    `su`.`product_unit_name` as `product_material_unit_name`,
    `rm`.`product_material_stock_unit_name` as `product_rm_purchase_unit_name`,
    `pp`.`product_packing_name` as `product_packing_name`,
    `sm`.`batch_rate` as `batch_rate`,
    `sm`.`order_quantity` as `order_quantity`,
    `sm`.`order_weight` as `order_weight`,
    `sm`.`pending_quantity` as `pending_quantity`,
    `sm`.`pending_weight` as `pending_weight`,
    `sm`.`opening_quantity` as `opening_quantity`,
    `sm`.`opening_weight` as `opening_weight`,
    `sm`.`closing_balance_quantity` as `closing_balance_quantity`,
    `sm`.`closing_balance_weight` as `closing_balance_weight`,
    `sm`.`batch_rate` * `sm`.`closing_balance_quantity` as `closing_amount`,
    `sm`.`reserve_quantity` as `reserve_quantity`,
    `sm`.`reserve_weight` as `reserve_weight`,
    `sm`.`excess_quantity` as `excess_quantity`,
    `sm`.`excess_weight` as `excess_weight`,
    `sm`.`pree_closed_quantity` as `pree_closed_quantity`,
    `sm`.`pree_closed_weight` as `pree_closed_weight`,
    `sm`.`purchase_quantity` as `purchase_quantity`,
    `sm`.`purchase_weight` as `purchase_weight`,
    `sm`.`purchase_return_quantity` as `purchase_return_quantity`,
    `sm`.`purchase_return_weight` as `purchase_return_weight`,
    `sm`.`purchase_rejection_quantity` as `purchase_rejection_quantity`,
    `sm`.`purchase_rejection_weight` as `purchase_rejection_weight`,
    `sm`.`jobcard_quantity` as `jobcard_quantity`,
    `sm`.`jobcard_weight` as `jobcard_weight`,
    `sm`.`production_issue_quantity` as `production_issue_quantity`,
    `sm`.`production_issue_weight` as `production_issue_weight`,
    `sm`.`production_issue_return_quantity` as `production_issue_return_quantity`,
    `sm`.`production_issue_return_weight` as `production_issue_return_weight`,
    `sm`.`production_issue_return_boxes` as `production_issue_return_boxes`,
    `sm`.`supplier_return_quantity` as `supplier_return_quantity`,
    `sm`.`supplier_return_weight` as `supplier_return_weight`,
    `sm`.`supplier_return_boxes` as `supplier_return_boxes`,
    `sm`.`production_issue_rejection_quantity` as `production_issue_rejection_quantity`,
    `sm`.`production_issue_rejection_weight` as `production_issue_rejection_weight`,
    `sm`.`production_quantity` as `production_quantity`,
    `sm`.`production_weight` as `production_weight`,
    `sm`.`production_return_quantity` as `production_return_quantity`,
    `sm`.`production_return_weight` as `production_return_weight`,
    `sm`.`production_rejection_quantity` as `production_rejection_quantity`,
    `sm`.`production_rejection_weight` as `production_rejection_weight`,
    `sm`.`assembly_production_issue_quantity` as `assembly_production_issue_quantity`,
    `sm`.`assembly_production_issue_weight` as `assembly_production_issue_weight`,
    `sm`.`sales_quantity` as `sales_quantity`,
    `sm`.`sales_weight` as `sales_weight`,
    `sm`.`sales_return_quantity` as `sales_return_quantity`,
    `sm`.`sales_return_weight` as `sales_return_weight`,
    `sm`.`sales_rejection_quantity` as `sales_rejection_quantity`,
    `sm`.`sales_rejection_weight` as `sales_rejection_weight`,
    `sm`.`customer_receipt_quantity` as `customer_receipt_quantity`,
    `sm`.`customer_receipt_weight` as `customer_receipt_weight`,
    `sm`.`customer_return_quantity` as `customer_return_quantity`,
    `sm`.`customer_return_weight` as `customer_return_weight`,
    `sm`.`customer_rejection_quantity` as `customer_rejection_quantity`,
    `sm`.`customer_rejection_weight` as `customer_rejection_weight`,
    `sm`.`transfer_issue_quantity` as `transfer_issue_quantity`,
    `sm`.`transfer_issue_weight` as `transfer_issue_weight`,
    `sm`.`transfer_receipt_quantity` as `transfer_receipt_quantity`,
    `sm`.`transfer_receipt_weight` as `transfer_receipt_weight`,
    `sm`.`outsources_out_quantity` as `outsources_out_quantity`,
    `sm`.`outsources_out_weight` as `outsources_out_weight`,
    `sm`.`outsources_in_quantity` as `outsources_in_quantity`,
    `sm`.`outsources_in_weight` as `outsources_in_weight`,
    `sm`.`outsources_rejection_quantity` as `outsources_rejection_quantity`,
    `sm`.`outsources_rejection_weight` as `outsources_rejection_weight`,
    `sm`.`loan_receipt_quantity` as `loan_receipt_quantity`,
    `sm`.`loan_receipt_weight` as `loan_receipt_weight`,
    `sm`.`loan_receipt_boxes` as `loan_receipt_boxes`,
    `sm`.`loan_issue_quantity` as `loan_issue_quantity`,
    `sm`.`loan_issue_weight` as `loan_issue_weight`,
    `sm`.`loan_issue_boxes` as `loan_issue_boxes`,
    `sm`.`cancel_quantity` as `cancel_quantity`,
    `sm`.`cancel_weight` as `cancel_weight`,
    `sm`.`difference_quantity` as `difference_quantity`,
    `sm`.`difference_weight` as `difference_weight`,
    `sm`.`total_box_weight` as `total_box_weight`,
    `sm`.`total_quantity_in_box` as `total_quantity_in_box`,
    `sm`.`weight_per_box_item` as `weight_per_box_item`,
    `sm`.`opening_no_of_boxes` as `opening_no_of_boxes`,
    `sm`.`reserve_no_of_boxes` as `reserve_no_of_boxes`,
    `sm`.`purchase_no_of_boxes` as `purchase_no_of_boxes`,
    `sm`.`issue_no_of_boxes` as `issue_no_of_boxes`,
    `sm`.`closing_no_of_boxes` as `closing_no_of_boxes`,
    `gd`.`godown_name` as `godown_name`,
    `gd`.`godown_short_name` as `godown_short_name`,
    `gd`.`godown_area` as `godown_area`,
    `gd`.`godown_section_count` as `godown_section_count`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gds`.`godown_section_short_name` as `godown_section_short_name`,
    `gds`.`godown_section_area` as `godown_section_area`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `gdsb`.`godown_section_beans_short_name` as `godown_section_beans_short_name`,
    `gdsb`.`godown_section_beans_area` as `godown_section_beans_area`,
    `pp`.`quantity_per_packing` as `quantity_per_packing`,
    `pp`.`weight_per_packing` as `weight_per_packing`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `sm`.`financial_year` as `financial_year`,
    `sm`.`product_type_group` as `product_type_group`,
    case
        `sm`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `sm`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `sm`.`is_active` as `is_active`,
    `sm`.`is_delete` as `is_delete`,
    `sm`.`created_by` as `created_by`,
    `sm`.`created_on` as `created_on`,
    `sm`.`modified_by` as `modified_by`,
    `sm`.`modified_on` as `modified_on`,
    `sm`.`deleted_by` as `deleted_by`,
    `sm`.`deleted_on` as `deleted_on`,
    `sm`.`company_id` as `company_id`,
    `sm`.`company_branch_id` as `company_branch_id`,
    `sm`.`stock_transaction_id` as `stock_transaction_id`,
    `sm`.`product_rm_id` as `product_rm_id`,
    `sm`.`customer_id` as `customer_id`,
    `sm`.`godown_id` as `godown_id`,
    `sm`.`supplier_id` as `supplier_id`,
    `sm`.`godown_section_id` as `godown_section_id`,
    `sm`.`godown_section_beans_id` as `godown_section_beans_id`,
    `sm`.`product_type_id` as `product_type_id`,
    `sm`.`product_material_unit_id` as `product_material_unit_id`,
    `sm`.`product_material_packing_id` as `product_material_packing_id`,
    `rm`.`product_material_category1_id` as `product_material_category1_id`,
    `rm`.`product_material_category2_id` as `product_material_category2_id`
from
    ((((((((((`sm_product_rm_stock_details` `sm`
left join `cmv_company_summary` `v` on
    (`v`.`company_id` = `sm`.`company_id`
        and `v`.`company_branch_id` = `sm`.`company_branch_id`))
left join `smv_product_rm_fg_sr` `rm` on
    (`rm`.`is_delete` = 0
        and `rm`.`product_material_id` = `sm`.`product_rm_id`
        and `rm`.`product_type_id` = `sm`.`product_type_id`))
left join `cm_customer` `cm` on
    (`cm`.`is_delete` = 0
        and `cm`.`company_branch_id` = `sm`.`company_branch_id`
        and `cm`.`customer_id` = `sm`.`customer_id`))
left join `cmv_godown` `gd` on
    (`gd`.`is_delete` = 0
        and `gd`.`godown_id` = `sm`.`godown_id`))
left join `cmv_godown_section` `gds` on
    (`gds`.`is_delete` = 0
        and `gds`.`godown_section_id` = `sm`.`godown_section_id`))
left join `cmv_godown_section_beans` `gdsb` on
    (`gdsb`.`is_delete` = 0
        and `gdsb`.`godown_section_beans_id` = `sm`.`godown_section_beans_id`))
left join `sm_product_packing` `pp` on
    (`pp`.`is_delete` = 0
        and `pp`.`product_packing_id` = `sm`.`product_material_packing_id`))
left join `smv_product_unit` `pu` on
    (`pu`.`is_delete` = 0
        and `pu`.`product_unit_id` = `sm`.`product_material_unit_id`))
left join `cm_supplier_branch` `supp` on
    (`supp`.`is_delete` = 0
        and `supp`.`supp_branch_id` = `sm`.`supplier_id`))
left join `sm_product_unit` `su` on
    (`su`.`product_unit_id` = `sm`.`product_material_unit_id`
        and `su`.`is_delete` = 0))
where
    `sm`.`is_delete` = 0
    and `sm`.`day_closed` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE cm_department ADD godown_id BIGINT(20) NULL COMMENT 'main godown of department';
ALTER TABLE cm_department ADD godown_section_id BIGINT(20) NULL COMMENT 'godown section of department';
ALTER TABLE cm_department ADD godown_section_beans_id BIGINT(20) NULL COMMENT 'godown_section_beans of department';


-------------------------------------------------------------------------------------------------------------------------------
-- mtv_dispatch_challan_sized_yarn_master source

create or replace
algorithm = UNDEFINED view `mtv_dispatch_challan_sized_yarn_master` as
select
    `mt`.`dispatch_challan_sized_yarn_id` as `dispatch_challan_sized_yarn_id`,
    `mt`.`company_id` as `company_id`,
    `mt`.`company_branch_id` as `company_branch_id`,
    `mt`.`financial_year` as `financial_year`,
    `mt`.`set_no` as `set_no`,
    `mt`.`yarn_count` as `yarn_count`,
    `mt`.`product_material_id` as `product_material_id`,
    `mt`.`product_material_name` as `product_material_name`,
    `mt`.`total_ends` as `total_ends`,
    `mt`.`dispatch_challan_type_id` as `dispatch_challan_type_id`,
    `mt`.`dispatch_challan_type` as `dispatch_challan_type`,
    `mt`.`dispatch_challan_creation_type` as `dispatch_challan_creation_type`,
    `mt`.`dispatch_challan_no` as `dispatch_challan_no`,
    `mt`.`dispatch_challan_date` as `dispatch_challan_date`,
    `mt`.`dispatch_challan_version` as `dispatch_challan_version`,
    `mt`.`customer_id` as `customer_id`,
    `mt`.`customer_order_no` as `customer_order_no`,
    `mt`.`agent_id` as `agent_id`,
    `a`.`agent_name` as `agent_name`,
    `a`.`agent_address1` as `agent_address1`,
    `a`.`agent_cell_no` as `agent_cell_no`,
    `mt`.`customer_contacts_ids` as `customer_contacts_ids`,
    `mt`.`customer_state_id` as `customer_state_id`,
    `mt`.`customer_city_id` as `customer_city_id`,
    `mt`.`consignee_id` as `consignee_id`,
    `mt`.`consignee_state_id` as `consignee_state_id`,
    `mt`.`consignee_city_id` as `consignee_city_id`,
    `mt`.`dispatch_date` as `dispatch_date`,
    `mt`.`approved_by_id` as `approved_by_id`,
    `mt`.`approved_date` as `approved_date`,
    `mt`.`dispatch_challan_status` as `dispatch_challan_status`,
    `mt`.`rate` as `rate`,
    `mt`.`weight` as `weight`,
    `mt`.`dispatch_payment_terms` as `dispatch_payment_terms`,
    `mt`.`other_terms_conditions` as `other_terms_conditions`,
    `mt`.`remark` as `remark`,
    `mt`.`vehicle_no` as `vehicle_no`,
    case
        `mt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `mt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `mt`.`is_active` as `is_active`,
    `mt`.`is_delete` as `is_delete`,
    `mt`.`created_by` as `created_by`,
    `mt`.`created_on` as `created_on`,
    `mt`.`modified_by` as `modified_by`,
    `mt`.`modified_on` as `modified_on`,
    `mt`.`deleted_by` as `deleted_by`,
    `mt`.`deleted_on` as `deleted_on`,
    `mt`.`driver_name` as `driver_name`,
    `mt`.`yarn_bill_no` as `yarn_bill_no`,
    `c`.`customer_name` as `customer_name`,
    `c`.`cust_branch_phone_no` as `customer_phone`,
    `c`.`cust_branch_EmailId` as `customer_email`,
    `c`.`cust_branch_address1` as `cust_branch_address1`,
    `c`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `ct`.`city_name` as `customer_city_name`,
    `st`.`state_name` as `customer_state_name`,
    `cc`.`customer_name` as `consignee_name`,
    `cc`.`cust_branch_address1` as `consignee_address`,
    `cc`.`cust_branch_EmailId` as `consignee_email`,
    `st1`.`state_name` as `consignee_state_name`,
    `ct1`.`city_name` as `consignee_city_name`,
    `e1`.`employee_name` as `approved_by_name`,
    `v`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_cell_no` as `company_cell_no`,
    `cb`.`branch_EmailId` as `company_emailId`,
    `cb`.`branch_website` as `company_website`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`,
    `cb`.`branch_address1` as `company_address`,
    `cb`.`branch_pincode` as `company_pincode`
from
    ((((((((((`mt_dispatch_challan_sized_yarn_master` `mt`
left join `cm_company` `v` on
    (`v`.`company_id` = `mt`.`company_id`))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `mt`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cmv_customer` `c` on
    (`c`.`company_id` = `mt`.`company_id`
        and `c`.`customer_id` = `mt`.`customer_id`))
left join `cmv_customer` `cc` on
    (`cc`.`company_id` = `mt`.`company_id`
        and `cc`.`customer_id` = `mt`.`consignee_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `mt`.`agent_id`
        and `a`.`is_delete` = 0))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `mt`.`customer_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `mt`.`consignee_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `mt`.`customer_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `mt`.`consignee_state_id`))
left join `cm_employee` `e1` on
    (`e1`.`is_delete` = 0
        and `e1`.`employee_id` = `mt`.`approved_by_id`))
where
    `mt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
CREATE DEFINER=`root`@`localhost` PROCEDURE `Get_Material_Aging_Report`(
    IN v_productId VARCHAR(20),
    IN v_company_id INT,
    IN v_product_type_id INT,
    IN v_pageCurrent INT,
    IN v_entriesPerPage INT
)
BEGIN
    -- Declare necessary variables and cursors at the top of the procedure
    DECLARE done INT DEFAULT 0;
    DECLARE done_material INT DEFAULT 0;
    DECLARE v_closing_balance_quantity DECIMAL(10,2);
    DECLARE v_total_amount DECIMAL(10,2);
    DECLARE v_product_rm_id VARCHAR(50);
    DECLARE v_goods_receipt_no VARCHAR(255);
    DECLARE v_product_rm_code VARCHAR(255);
    DECLARE material_date DATE;
    DECLARE days INT;
    DECLARE total_1_30 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_31_60 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_61_180 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_181_365 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_above_365 DECIMAL(10,2) DEFAULT 0;
    DECLARE v_offset INT;
    DECLARE v_totalRecords INT;
    DECLARE v_totalPages INT;

    -- Ensure v_pageCurrent defaults to 1 if it's zero
    IF v_pageCurrent = 0 THEN
        SET v_pageCurrent = 1;
    END IF;

    -- Calculate total records to get pagination information
    SELECT COUNT(DISTINCT product_rm_id)
    INTO v_totalRecords
    FROM sm_product_rm_stock_details
    WHERE company_id = v_company_id
      AND (v_productId = '' OR v_productId IS NULL OR product_rm_id = v_productId)
      AND product_type_id = v_product_type_id
      AND is_delete = 0
      AND is_active = 1;

    -- Calculate total pages
    SET v_totalPages = CEIL(v_totalRecords / v_entriesPerPage);

    -- Ensure v_pageCurrent doesn't exceed total pages
    IF v_pageCurrent > v_totalPages THEN
        SET v_pageCurrent = v_totalPages;
    END IF;

    -- Calculate offset for pagination
    SET v_offset = (v_pageCurrent - 1) * v_entriesPerPage;

    -- Declare cursors after the DECLARE statements
    DECLARE product_cursor CURSOR FOR
        SELECT DISTINCT product_rm_id
        FROM sm_product_rm_stock_details
        WHERE company_id = v_company_id
          AND (v_productId = '' OR v_productId IS NULL OR product_rm_id = v_productId)
          AND product_type_id = v_product_type_id
          AND is_delete = 0
          AND is_active = 1
        LIMIT v_entriesPerPage OFFSET v_offset;

    DECLARE product_detail_cursor CURSOR FOR
        SELECT
            st.closing_balance_quantity,
            st.closing_balance_quantity * st.batch_rate AS total_amount,
            st.product_rm_id,
            st.goods_receipt_no,
            rm.product_rm_code
        FROM sm_product_rm_stock_details st
        LEFT JOIN sm_product_rm rm ON rm.product_rm_id = st.product_rm_id AND rm.is_delete = 0
        WHERE st.day_closed = 0
          AND st.is_delete = 0
          AND st.godown_id = 2
          AND st.closing_balance_quantity > 0
          AND st.company_id = v_company_id
          AND st.product_type_id = v_product_type_id
          AND st.product_rm_id = v_product_rm_id;

    -- Temporary table to store results
    DROP TEMPORARY TABLE IF EXISTS temp_aging_results;
    CREATE TEMPORARY TABLE temp_aging_results (
        product_rm_id VARCHAR(50),
        product_rm_code VARCHAR(255),
        total_1_30 DECIMAL(10,2) DEFAULT 0,
        total_31_60 DECIMAL(10,2) DEFAULT 0,
        total_61_180 DECIMAL(10,2) DEFAULT 0,
        total_181_365 DECIMAL(10,2) DEFAULT 0,
        total_above_365 DECIMAL(10,2) DEFAULT 0
    );

    -- Open the product_cursor
    OPEN product_cursor;

    -- Loop over the product ids to calculate aging details
    read_loop: LOOP
        SET done = 0;

        FETCH product_cursor INTO v_product_rm_id;

        IF done THEN
            LEAVE read_loop;
        END IF;

        -- Reset aging totals for each product
        SET total_1_30 = 0;
        SET total_31_60 = 0;
        SET total_61_180 = 0;
        SET total_181_365 = 0;
        SET total_above_365 = 0;

        -- Open the product_detail_cursor
        OPEN product_detail_cursor;

        -- Loop over product details
        material_loop: LOOP
            FETCH product_detail_cursor INTO v_closing_balance_quantity, v_total_amount, v_product_rm_id, v_goods_receipt_no, v_product_rm_code;

            IF done_material THEN
                LEAVE material_loop;
            END IF;

            -- Determine material's aging based on receipt or creation date
            IF v_goods_receipt_no != 'Opening Balance' THEN
                SELECT goods_receipt_date INTO material_date
                FROM pt_goods_receipt_details
                WHERE goods_receipt_no = v_goods_receipt_no
                  AND product_material_id = v_product_rm_id
                  AND company_id = v_company_id
                  AND is_delete = 0
                LIMIT 1;
            ELSE
                SELECT created_on INTO material_date
                FROM sm_product_rm
                WHERE is_delete = 0 AND product_rm_id = v_product_rm_id;
            END IF;

            SET days = DATEDIFF(CURDATE(), COALESCE(material_date, "2024-10-01"));

            -- Classify into aging categories
            IF days BETWEEN 1 AND 30 THEN
                SET total_1_30 = total_1_30 + v_closing_balance_quantity;
            ELSEIF days BETWEEN 31 AND 60 THEN
                SET total_31_60 = total_31_60 + v_closing_balance_quantity;
            ELSEIF days BETWEEN 61 AND 180 THEN
                SET total_61_180 = total_61_180 + v_closing_balance_quantity;
            ELSEIF days BETWEEN 181 AND 365 THEN
                SET total_181_365 = total_181_365 + v_closing_balance_quantity;
            ELSEIF days > 365 THEN
                SET total_above_365 = total_above_365 + v_closing_balance_quantity;
            END IF;
        END LOOP;

        -- Close the product_detail_cursor
        CLOSE product_detail_cursor;

        -- Insert data into the temporary table
        INSERT INTO temp_aging_results (
            product_rm_id, product_rm_code, total_1_30, total_31_60,
            total_61_180, total_181_365, total_above_365
        ) VALUES (
            v_product_rm_id, v_product_rm_code, total_1_30, total_31_60,
            total_61_180, total_181_365, total_above_365
        );

        SET done_material = 0;  -- Reset material done flag
    END LOOP;

    -- Close the product_cursor
    CLOSE product_cursor;

    -- Return the results from the temporary table
    SELECT * FROM temp_aging_results;

    -- Clean up the temporary table
    DROP TEMPORARY TABLE temp_aging_results;
END;

-------------------------------------------------------------------------------------------------------------------------------

update am_modules_forms set modules_forms_name = 'Production Stoppage (Weaving)' , display_name = 'Production Stoppage (Weaving)' WHERE is_delete = 0 and modules_forms_id = 692;
update am_modules_forms set modules_forms_name = 'Production Stoppage (Sizing)', display_name = 'Production Stoppage (Sizing)' WHERE is_delete = 0 and modules_forms_id = 691;
update am_modules_forms set modules_forms_name = 'Production Stoppage (Warping)', display_name = 'Production Stoppage (Warping)' WHERE is_delete = 0 and modules_forms_id = 650;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- pashupati_erp_qa.stv_indent_material_issue_return_details source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_return_details` AS
select
    `st`.`issue_return_details_transaction_id` AS `issue_return_details_transaction_id`,
    `st`.`issue_return_master_transaction_id` AS `issue_return_master_transaction_id`,
    `st`.`company_id` AS `company_id`,
    `st`.`company_branch_id` AS `company_branch_id`,
    `st`.`financial_year` AS `financial_year`,
    `stm`.`issue_return_no` AS `issue_return_no`,
    `p`.`product_rm_name` AS `product_material_name`,
    `st`.`product_material_id` AS `product_material_id`,
    `st`.`issue_batch_no` AS `issue_batch_no`,
    `st`.`product_material_issue_return_quantity` AS `product_material_issue_return_quantity`,
    `st`.`product_material_issue_return_weight` AS `product_material_issue_return_weight`,
    `st`.`product_material_issue_return_boxes` AS `product_material_issue_return_boxes`,
    `st`.`product_material_receipt_quantity` AS `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` AS `product_material_receipt_weight`,
    `st`.`product_material_receipt_boxes` AS `product_material_receipt_boxes`,
    `st`.`issue_return_item_status` AS `issue_return_item_status`,
    `st`.`godown_id` AS `godown_id`,
    `st`.`godown_section_id` AS `godown_section_id`,
    `st`.`godown_section_beans_id` AS `godown_section_beans_id`,
    `st`.`issue_return_remark` AS `issue_return_remark`,
    `gsb`.`godown_name` AS `godown_name`,
    `gsb`.`godown_section_name` AS `godown_section_name`,
    `gsb`.`godown_section_beans_name` AS `godown_section_beans_name`,
    `std`.`product_material_indent_quantity` AS `product_material_indent_quantity`,
    `std`.`product_material_indent_weight` AS `product_material_indent_weight`,
    `std`.`product_material_approved_quantity` AS `product_material_approved_quantity`,
    `std`.`product_material_approved_weight` AS `product_material_approved_weight`,
    `std`.`product_material_issue_quantity` AS `product_material_issue_quantity`,
    `std`.`product_material_issue_weight` AS `product_material_issue_weight`,
    `std`.`product_material_issue_boxes` AS `product_material_issue_boxes`,
    `std`.`closing_balance_quantity` AS `closing_balance_quantity`,
    `std`.`closing_balance_weight` AS `closing_balance_weight`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end AS `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end AS `Deleted`,
    `st`.`is_active` AS `is_active`,
    `st`.`is_delete` AS `is_delete`,
    `st`.`created_by` AS `created_by`,
    `st`.`created_on` AS `created_on`,
    `st`.`modified_by` AS `modified_by`,
    `st`.`modified_on` AS `modified_on`,
    `st`.`deleted_by` AS `deleted_by`,
    `st`.`deleted_on` AS `deleted_on`,
    `st`.`cone_per_wt` AS `cone_per_wt`,
    `st`.`goods_receipt_no` AS `goods_receipt_no`,
    `st`.`supplier_id` AS `supplier_id`,
    `st`.`creel_no` AS `creel_no`
from
    ((((`st_indent_material_issue_return_details` `st`
left join `st_indent_material_issue_return_master` `stm` on
    (`stm`.`issue_return_master_transaction_id` = `st`.`issue_return_master_transaction_id`))
left join `stv_indent_material_issue_details` `std` on
    (`std`.`issue_no` = `stm`.`issue_no`
        and `std`.`product_material_id` = `st`.`product_material_id`
        and `st`.`issue_batch_no` = `std`.`issue_batch_no`
        and `st`.`creel_no` = `std`.`creel_no`
        and `st`.`godown_id` = `std`.`godown_id`
        and `st`.`godown_section_id` = `std`.`godown_section_id`
        and `st`.`godown_section_beans_id` = `std`.`godown_section_beans_id`
        and `std`.`is_delete` = 0))
left join `cmv_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
    	and `gsb`.`is_delete` = 0))
left join `sm_product_rm` `p` on
    (`p`.`product_rm_id` = `st`.`product_material_id`
    and `p`.`is_delete` = 0))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- pashupati_erp_qa.inter_material_transfer_master_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `inter_material_transfer_master_rpt` AS
select
    concat(`st`.`inter_material_transfer_no`, ':Inter Material Transfer No:Y:T:') AS `inter_material_transfer_no`,
    concat(`st`.`inter_material_transfer_date`, ':Inter Material Transfer Date:Y:D:') AS `inter_material_transfer_date`,
    concat(`st`.`from_department_name`, ':From Department Name:Y:T:') AS `from_department_name`,
    concat(`st`.`from_sub_department_name`, ':From Sub Department Name:Y:T:') AS `from_sub_department_name`,
    concat(`st`.`to_department_name`, ':To Department Name:Y:T:') AS `to_department_name`,
    concat(`st`.`to_sub_department_name`, ':To Sub Department Name:Y:T:') AS `to_sub_department_name`,
    concat(`st`.`requested_by_name`, ':Requested By Name:Y:T:') AS `requested_by_name`,
--     concat(case when `st`.`inter_material_transfer_status` = 'R' then 'Received' else 'Pending' end, ':Inter Material Transfer Status:Y:H:(Received, Pending)') AS `inter_material_transfer_status_desc`,
    concat(case when `st`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `st`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`st`.`financial_year`, ':Financial Year:O:N:') AS `financial_year`,
--     concat(`st`.`inter_material_transfer_status`, ':Inter Material Transfer Status:O:N:') AS `inter_material_transfer_status`,
    concat(`st`.`inter_material_transfer_master_id`, ':Inter Material Transfer Master Id:N:N:') AS `inter_material_transfer_master_id`,
    concat(`st`.`company_id`, ':Company Id:N:N:') AS `company_id`,
    concat(`st`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`st`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`st`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`st`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`st`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`st`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`st`.`inter_material_transfer_no`, ':Field Name:N:N:') AS `field_name`,
    concat(`st`.`inter_material_transfer_master_id`, ':Field Id:N:N:') AS `field_id`
from
    `ptv_inter_material_transfer_master` `st`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
-- pashupati_erp_qa.stv_indent_material_issue_return_master_rpt source

CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_indent_material_issue_return_master_rpt` AS
select
    concat(`v`.`issue_return_no`, ':Issue Return No:O:N:') AS `issue_return_no`,
    concat(`v`.`issue_return_date`, ':Issue Return Date :Y:D:') AS `issue_return_date`,
     concat(`v`.`department_name`, ':Department:Y:T:') AS `department_name`,
    concat(`v`.`sub_department_name`, ':Sub Department:Y:T:') AS `sub_department_name`,
    concat(`v`.`issue_no`, ':Issue No:O:N:') AS `issue_no`,
    concat(`v`.`issue_return_status_desc`, ':Return Status:Y:H:(Pending,Received)') AS `issue_return_status_desc`,
    concat(`v`.`received_date`, ':Issue Received Date:Y:D:') AS `received_date`,
    concat(`v`.`indent_issue_return_type`, ':Issue Return Type:O:N:') AS `indent_issue_return_type`,
    concat(`v`.`return_by_name`, ':Return By:Y:T:') AS `return_by_name`,
    concat(`v`.`received_by_name`, ':Received By:Y:T:') AS `received_by_name`,
    concat(`v`.`remark`, ':Remark:O:N:') AS `remark`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') AS `Deleted`,
    concat(`v`.`financial_year`, ':Financial Year:O:N:') AS `financial_year`,
    concat(`v`.`created_by`, ':Created By:O:N:') AS `created_by`,
    concat(`v`.`created_on`, ':Created On:O:N:') AS `created_on`,
    concat(`v`.`modified_by`, ':Modified By:O:N:') AS `modified_by`,
    concat(`v`.`modified_on`, ':Modified On:O:N:') AS `modified_on`,
    concat(`v`.`deleted_by`, ':Deleted By:O:N:') AS `deleted_by`,
    concat(`v`.`deleted_on`, ':Deleted On:O:N:') AS `deleted_on`,
    concat(`v`.`company_branch_id`, ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(`v`.`issue_return_status`, ':Issue Return Status:O:N:') AS `issue_return_status`,
    concat(`v`.`issue_return_master_transaction_id`, ':Issue Return Master Id:O:N:') AS `issue_return_master_transaction_id`,
    concat(`v`.`return_by_id`, ':Issue Return By Id:O:N:') AS `return_by_id`,
    concat(`v`.`indent_issue_return_type_id`, ':Issue Return Type Id:O:N:') AS `indent_issue_return_type_id`,
    concat(`v`.`department_id`, ':Department Id:O:N:') AS `department_id`,
    concat(`v`.`sub_department_id`, ':Sub Department Id:O:N:') AS `sub_department_id`,
    concat(`v`.`company_id`, ':Company Id:N:N:') AS `company_id`
from
    `stv_indent_material_issue_return_master` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------


ALTER TABLE xt_weaving_production_inspection_master ADD approved_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'approve by id will store after approve';
ALTER TABLE xt_weaving_production_inspection_master CHANGE approved_by_id approved_by_id BIGINT(20) DEFAULT 0 NULL COMMENT 'approve by id will store after approve' AFTER production_supervisor_id;
ALTER TABLE xt_weaving_production_inspection_master ADD approved_date DATE NULL COMMENT 'approve date after approve record';
ALTER TABLE xt_weaving_production_inspection_master CHANGE approved_date approved_date DATE NULL COMMENT 'approve date after approve record' AFTER approved_by_id;



-- xtv_weaving_production_inspection_master source

create or REPLACE algorithm = UNDEFINED view `xtv_weaving_production_inspection_master` as
select
    `xt`.`inspection_production_date` as `inspection_production_date`,
    `xt`.`inspection_production_code` as `inspection_production_code`,
    `p`.`plant_name` as `plant_name`,
    `xt`.`prod_month` as `prod_month`,
    `xt`.`prod_year` as `prod_year`,
    `xt`.`inspection_production_set_no` as `inspection_production_set_no`,
    `sb`.`production_section_name` as `production_section_name`,
    `sb`.`production_sub_section_name` as `production_sub_section_name`,
    case
        `xt`.`inspection_production_master_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Partial Approved'
    end as `inspection_production_master_status_desc`,
    `xt`.`inspection_production_master_status` as `inspection_production_master_status`,
    `e`.`employee_name` as `approved_by_name`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `xt`.`is_active` as `is_active`,
    `xt`.`is_delete` as `is_delete`,
    `xt`.`created_by` as `created_by`,
    `xt`.`created_on` as `created_on`,
    `xt`.`modified_by` as `modified_by`,
    `xt`.`modified_on` as `modified_on`,
    `xt`.`deleted_by` as `deleted_by`,
    `xt`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `vb`.`company_branch_name` as `company_branch_name`,
    `xt`.`financial_year` as `financial_year`,
    `v`.`company_id` as `company_id`,
    `xt`.`company_branch_id` as `company_branch_id`,
    `xt`.`weaving_production_inspection_master_id` as `weaving_production_inspection_master_id`,
    `xt`.`plant_id` as `plant_id`,
    `xt`.`section_id` as `section_id`,
    `xt`.`sub_section_id` as `sub_section_id`,
    `xt`.`production_supervisor_id` as `production_supervisor_id`
from
    (((((`xt_weaving_production_inspection_master` `xt`
left join `cm_plant` `p` on
    (`p`.`plant_id` = `xt`.`plant_id`
        and `p`.`company_id` = `xt`.`company_id`))
left join `xm_production_sub_section` `sb` on
    (`sb`.`production_sub_section_id` = `xt`.`sub_section_id`
        and `sb`.`company_id` = `xt`.`company_id`))
left join `cm_company` `v` on
    (`v`.`company_id` = `xt`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `vb` on
    (`vb`.`company_id` = `xt`.`company_id`
        and `vb`.`company_branch_id` = `xt`.`company_branch_id`
        and `vb`.`is_delete` = 0))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `xt`.`approved_by_id`
        and `e`.`is_delete` = 0))
where
    `xt`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
-- xtv_weaving_production_inspection_master source

create or replace
algorithm = UNDEFINED view `xtv_weaving_production_inspection_master` as
select
    `xt`.`inspection_production_date` as `inspection_production_date`,
    `xt`.`inspection_production_code` as `inspection_production_code`,
    `p`.`plant_name` as `plant_name`,
    `xt`.`prod_month` as `prod_month`,
    `xt`.`prod_year` as `prod_year`,
    `xt`.`inspection_production_set_no` as `inspection_production_set_no`,
    `sb`.`production_section_name` as `production_section_name`,
    `sb`.`production_sub_section_name` as `production_sub_section_name`,
    case
        `xt`.`inspection_production_master_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Rejected'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Partial Approved'
    end as `inspection_production_master_status_desc`,
    `xt`.`inspection_production_master_status` as `inspection_production_master_status`,
    `e`.`employee_name` as `approved_by_name`,
    `xt`.`approved_date` as `approved_date`,
    case
        `xt`.`is_active` when 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        `xt`.`is_delete` when 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `xt`.`is_active` as `is_active`,
    `xt`.`is_delete` as `is_delete`,
    `xt`.`created_by` as `created_by`,
    `xt`.`created_on` as `created_on`,
    `xt`.`modified_by` as `modified_by`,
    `xt`.`modified_on` as `modified_on`,
    `xt`.`deleted_by` as `deleted_by`,
    `xt`.`deleted_on` as `deleted_on`,
    `v`.`company_legal_name` as `company_name`,
    `vb`.`company_branch_name` as `company_branch_name`,
    `xt`.`financial_year` as `financial_year`,
    `v`.`company_id` as `company_id`,
    `xt`.`company_branch_id` as `company_branch_id`,
    `xt`.`weaving_production_inspection_master_id` as `weaving_production_inspection_master_id`,
    `xt`.`plant_id` as `plant_id`,
    `xt`.`section_id` as `section_id`,
    `xt`.`sub_section_id` as `sub_section_id`,
    `xt`.`production_supervisor_id` as `production_supervisor_id`
from
    (((((`xt_weaving_production_inspection_master` `xt`
left join `cm_plant` `p` on
    (`p`.`plant_id` = `xt`.`plant_id`
        and `p`.`company_id` = `xt`.`company_id`))
left join `xm_production_sub_section` `sb` on
    (`sb`.`production_sub_section_id` = `xt`.`sub_section_id`
        and `sb`.`company_id` = `xt`.`company_id`))
left join `cm_company` `v` on
    (`v`.`company_id` = `xt`.`company_id`
        and `v`.`is_delete` = 0))
left join `cm_company_branch` `vb` on
    (`vb`.`company_id` = `xt`.`company_id`
        and `vb`.`company_branch_id` = `xt`.`company_branch_id`
        and `vb`.`is_delete` = 0))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `xt`.`approved_by_id`
        and `e`.`is_delete` = 0))
where
    `xt`.`is_delete` = 0;


-- xtv_weaving_production_inspection_master_rpt source

create or replace
algorithm = UNDEFINED view `xtv_weaving_production_inspection_master_rpt` as
select
    concat(ifnull(`v`.`inspection_production_date`, ''), ':Production Date:Y:D:') as `inspection_production_date`,
    concat(ifnull(`v`.`inspection_production_code`, ''), ':Production Code:Y:T:') as `inspection_production_code`,
    concat(ifnull(`v`.`inspection_production_master_status`, ''), ':Production Status:Y:H:(Pending,Approved,Rejected, Completed,Canceled,Partial Approved)') as `inspection_production_master_status_desc`,
    concat(ifnull(`v`.`production_section_name`, ''), ':Production Section:O:N:') as `production_section_name`,
    concat(ifnull(`v`.`production_sub_section_name`, ''), ':Production Sub Section:O:N:') as `production_sub_section_name`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By:Y:T:') as `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') as `approved_date`,
    concat(ifnull(`v`.`prod_year`, ''), ':Production Year:O:N:') as `prod_year`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') as `Deleted`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`weaving_production_inspection_master_id`, ''), ':Inspection Master Id:O:N:') as `weaving_production_inspection_master_id`
from
    `xtv_weaving_production_inspection_master` `v`
limit 1;


-- xtv_weaving_production_inspection_details_rpt source

create or replace
algorithm = UNDEFINED view `xtv_weaving_production_inspection_details_rpt` as
select
    concat(ifnull(`v`.`inspection_production_date`, ''), ':Production Date:Y:D:') as `inspection_production_date`,
    concat(ifnull(`v`.`inspection_production_code`, ''), ':Production Code:Y:T:') as `inspection_production_code`,
    concat(ifnull(`v`.`inspection_production_status`, ''), ':Roll Status:Y:H:(Pending, Approved, Rejected, Completed, Canceled, Partial Approved)') as `inspection_production_status_desc`,
    concat(ifnull(`v`.`sort_no`, ''), ':Sort No:Y:T:') as `sort_no`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Product Name:Y:T:') as `product_material_name`,
    concat(ifnull(`v`.`inspection_production_set_no`, ''), ':Set No:Y:T:') as `inspection_production_set_no`,
    concat(ifnull(`v`.`sizing_beam_no`, ''), ':Sizing Beam No:Y:T:') as `sizing_beam_no`,
    concat(ifnull(`v`.`machine_name`, ''), ':Machine Name:Y:T:') as `machine_name`,
    concat(ifnull(`v`.`roll_no`, ''), ':Roll No:Y:T:') as `roll_no`,
    concat(ifnull(`v`.`shift`, ''), ':Shift:Y:H:(I,II)') as `shift`,
    concat(ifnull(`v`.`width`, ''), ':Width:O:N:') as `width`,
    concat(ifnull(`v`.`product_pick`, ''), ':Product Pick:O:N:') as `product_pick`,
    concat(ifnull(`v`.`product_in_meter`, ''), ':Product In Meter:O:N:') as `product_in_meter`,
    concat(ifnull(`v`.`inspection_mtr`, ''), ':Inspection Meter:O:N:') as `inspection_mtr`,
    concat(ifnull(`v`.`difference`, ''), ':Difference:O:N:') as `difference`,
    concat(ifnull(`v`.`weight`, ''), ':Weight:O:N:') as `weight`,
    concat(ifnull(`v`.`average`, ''), ':Average:O:N:') as `average`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') as `godown_name`,
    concat(ifnull(`v`.`prod_month`, ''), ':Production Month:Y:T:') as `prod_month`,
    concat(ifnull(`v`.`prod_year`, ''), ':Production Year:O:N:') as `prod_year`,
    concat(ifnull(`v`.`production_section_name`, ''), ':Section Name:O:N:') as `production_section_name`,
    concat(ifnull(`v`.`production_sub_section_name`, ''), ':Sub Section Name:O:N') as `production_sub_section_name`,
    concat(ifnull(`v`.`status_remark`, ''), ':Status Remark:O:N:)') as `status_remark`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes, No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`weaving_production_inspection_details_id`, ''), ':Inspection Details Id:O:N:') as `weaving_production_inspection_details_id`,
    concat(ifnull(`v`.`weaving_production_inspection_master_id`, ''), ':Inspection Master Id:O:N:') as `weaving_production_inspection_master_id`
from
    `xtv_weaving_production_inspection_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------
-- 22-01-2024

create or replace PROCEDURE `GetAgingOfMaterials`(
    IN v_productId VARCHAR(20),
    IN v_company_id INT,
    IN v_product_type_id INT,
    IN page INT,
    IN pageSize INT,
    IN actionType VARCHAR(20)
)
BEGIN
    -- Declare necessary variables
    DECLARE done INT DEFAULT 0;
    DECLARE done_material INT DEFAULT 0;
    DECLARE v_closing_balance_quantity DECIMAL(10,2);
    DECLARE v_total_amount DECIMAL(10,2);
    DECLARE v_product_rm_id VARCHAR(50);
    DECLARE v_goods_receipt_no VARCHAR(255);
    DECLARE v_product_rm_code VARCHAR(255);
   	DECLARE v_product_rm_name VARCHAR(255);
    DECLARE material_date DATE;
    DECLARE days INT;
    DECLARE total_1_30 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_31_60 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_61_180 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_181_365 DECIMAL(10,2) DEFAULT 0;
    DECLARE total_above_365 DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_1_30_amount DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_31_60_amount DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_61_180_amount DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_181_365_amount DECIMAL(10,2) DEFAULT 0;
    DECLARE total_above_365_amount DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_closing_quantity DECIMAL(10,2) DEFAULT 0;
   	DECLARE total_closing_amount DECIMAL(10,2) DEFAULT 0;


    -- Declare cursors
    DECLARE getProductIds CURSOR FOR
        SELECT DISTINCT product_rm_id
        FROM sm_product_rm_stock_details
        WHERE company_id = v_company_id
        AND (v_productId = '' OR v_productId IS NULL OR product_rm_id = v_productId)
     	AND product_type_id = v_product_type_id AND is_delete  = 0 and day_closed = 0 GROUP BY product_rm_id
	    HAVING SUM(closing_balance_quantity) > 0;

    DECLARE getproductRm CURSOR FOR
        SELECT
            st.closing_balance_quantity,
            st.closing_balance_quantity * st.batch_rate AS total_amount,
            st.product_rm_id,
            st.goods_receipt_no,
            rm.product_rm_code,
            rm.product_rm_name
        FROM sm_product_rm_stock_details st
        LEFT JOIN sm_product_rm rm ON rm.product_rm_id = st.product_rm_id AND rm.is_delete = 0
        WHERE
            st.day_closed = 0
            AND st.is_delete = 0
            AND st.godown_id = 2
            AND st.closing_balance_quantity > 0
            AND st.company_id = v_company_id
    		AND st.product_type_id = v_product_type_id
            AND st.product_rm_id = v_product_rm_id;

    -- Declare handlers
    DECLARE CONTINUE HANDLER FOR NOT FOUND
        SET done = 1, done_material = 1;

    IF page < 0 THEN
	    SET
	page = 0;
	END IF;

	IF pageSize <= 0 THEN
	    SET
	pageSize = 10;
	-- Default page size
	END IF;
    -- Temporary table to store results
    DROP TEMPORARY TABLE IF EXISTS temp_aging_results;
    CREATE TEMPORARY TABLE temp_aging_results (
        product_rm_id VARCHAR(50),
        product_rm_code VARCHAR(255),
        product_rm_name VARCHAR(255),
        total_1_30 DECIMAL(10,2) DEFAULT 0,
        total_1_30_amount DECIMAL(10,2) DEFAULT 0,
        total_31_60 DECIMAL(10,2) DEFAULT 0,
        total_31_60_amount DECIMAL(10,2) DEFAULT 0,
        total_61_180 DECIMAL(10,2) DEFAULT 0,
        total_61_180_amount DECIMAL(10,2) DEFAULT 0,
        total_181_365 DECIMAL(10,2) DEFAULT 0,
        total_181_365_amount DECIMAL(10,2) DEFAULT 0,
        total_above_365 DECIMAL(10,2) DEFAULT 0,
        total_above_365_amount DECIMAL(10,2) DEFAULT 0,
        total_closing_quantity DECIMAL(10,2) DEFAULT 0,
        total_closing_amount DECIMAL(10,2) DEFAULT 0
    );

    -- Open the cursor to fetch product IDs
    OPEN getProductIds;

    read_loop: LOOP
        -- Reset the done flag before fetching a new product_rm_id
        SET done = 0;

        FETCH getProductIds INTO v_product_rm_id;

        IF done THEN
            LEAVE read_loop;
        END IF;

        -- Reset variables for each product
        SET total_1_30 = 0;
       	SET total_1_30_amount = 0;
        SET total_31_60 = 0;
       	SET total_31_60_amount = 0;
        SET total_61_180 = 0;
       	SET total_61_180_amount = 0;
        SET total_181_365 = 0;
       	SET total_181_365_amount = 0;
        SET total_above_365 = 0;
       	SET total_above_365_amount = 0;
       	SET total_closing_quantity = 0;
       	SET total_closing_amount = 0;

        -- Open the material cursor for the current product
        OPEN getproductRm;

        material_loop: LOOP
            FETCH getproductRm INTO v_closing_balance_quantity, v_total_amount, v_product_rm_id, v_goods_receipt_no, v_product_rm_code, v_product_rm_name;

            IF done_material THEN
                LEAVE material_loop;
            END IF;

            -- Calculate material date and aging days
            IF v_goods_receipt_no != 'Opening Balance' THEN
                SELECT goods_receipt_date INTO material_date
                FROM pt_goods_receipt_details
                WHERE goods_receipt_no = v_goods_receipt_no
                  AND product_material_id = v_product_rm_id
                  AND company_id = v_company_id
                  AND is_delete = 0
                LIMIT 1;
            ELSE
                SELECT created_on INTO material_date
                FROM sm_product_rm
                WHERE is_delete = 0 AND product_rm_id = v_product_rm_id;
            END IF;

            SET days = DATEDIFF(CURDATE(), COALESCE(material_date, "2024-10-01"));
			IF days = 0 THEN
    			SET days = 1;
			END IF;
            -- Categorize quantities into aging ranges
            IF days BETWEEN 1 AND 30 THEN
                SET total_1_30 = total_1_30 + v_closing_balance_quantity;
               	SET total_1_30_amount = total_1_30_amount + v_total_amount;
            ELSEIF days BETWEEN 31 AND 60 THEN
                SET total_31_60 = total_31_60 + v_closing_balance_quantity;
              	SET total_31_60_amount = total_31_60_amount + v_total_amount;
            ELSEIF days BETWEEN 61 AND 180 THEN
                SET total_61_180 = total_61_180 + v_closing_balance_quantity;
               	SET total_61_180_amount = total_61_180_amount + v_total_amount;
            ELSEIF days BETWEEN 181 AND 365 THEN
                SET total_181_365 = total_181_365 + v_closing_balance_quantity;
               	SET total_181_365_amount = total_181_365_amount + v_total_amount;
            ELSEIF days > 365 THEN
                SET total_above_365 = total_above_365 + v_closing_balance_quantity;
               	SET total_above_365_amount = total_above_365_amount + v_total_amount;
            END IF;
           	SET total_closing_quantity = total_closing_quantity + v_closing_balance_quantity;
           	SET total_closing_amount = total_closing_amount + v_total_amount;
        END LOOP;

        -- Close the material cursor
        CLOSE getproductRm;

        -- Insert the results for this product into the temporary table
        INSERT INTO temp_aging_results (
            product_rm_id, product_rm_code, product_rm_name, total_1_30,total_1_30_amount, total_31_60, total_31_60_amount,
            total_61_180,total_61_180_amount, total_181_365, total_181_365_amount, total_above_365 , total_above_365_amount,
            total_closing_quantity, total_closing_amount
        ) VALUES (
            v_product_rm_id, v_product_rm_code, v_product_rm_name, total_1_30,total_1_30_amount, total_31_60, total_31_60_amount,
            total_61_180,total_61_180_amount, total_181_365, total_181_365_amount, total_above_365 , total_above_365_amount,
            total_closing_quantity, total_closing_amount
        );

        -- Reset the done_material flag for the next iteration
        SET done_material = 0;
    END LOOP;

    -- Close the product IDs cursor
    CLOSE getProductIds;

  -- Return results based on actionType
    IF actionType = "getData&paginated" THEN
    	-- Get total row count
    	SELECT COUNT(*) AS totalRowCount FROM temp_aging_results;
    	SELECT * FROM temp_aging_results LIMIT page, pageSize;
    ELSE
    	SELECT COUNT(*) AS totalRowCount FROM temp_aging_results;
        SELECT * FROM temp_aging_results;
    END IF;
  
END
-------------------------------------------------------------------------------------------------------------------------------
 ALTER TABLE  pt_purchase_order_details ADD currency_id BIGINT(20) DEFAULT 3 NULL COMMENT 'currency id for po amount';


ALTER TABLE pt_goods_receipt_details ADD po_material_rate DECIMAL(18,2) DEFAULT 0 NULL COMMENT 'po material rate will come from po';
ALTER TABLE  pt_goods_receipt_details ADD currency_id BIGINT(20) DEFAULT 3 NULL COMMENT 'currency id for po amount';
ALTER TABLE pt_goods_receipt_details CHANGE po_material_rate po_material_rate DECIMAL(18,2) DEFAULT 0 NULL COMMENT 'po material rate will come from po' AFTER currency_id;
ALTER TABLE pt_goods_receipt_details CHANGE currency_id currency_id BIGINT(20) DEFAULT 3 NULL COMMENT 'default rupees given' AFTER product_material_grn_rejected_weight;
ALTER TABLE pt_goods_receipt_details CHANGE grn_currency_id grn_currency_id BIGINT(20) DEFAULT 3 NULL COMMENT 'default grn currency is rupees' AFTER po_material_rate;


ALTER TABLE pt_goods_receipt_details ADD currency_exchange_rate DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'exchange rate of base currency INR';
ALTER TABLE pt_goods_receipt_details CHANGE currency_exchange_rate currency_exchange_rate DECIMAL(18,4) DEFAULT 0 NULL COMMENT 'exchange rate of base currency INR' AFTER material_rate;

-------------------------------------------------------------------------------------------------------------------------------
create or replace
algorithm = UNDEFINED view `smv_product_rm_cotton_bales_rpt_details` as
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Material Name:Y:T') as `product_rm_name`,
        concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Material Short Name:O:N:') as `product_rm_short_name`,

    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:O:N:') as `product_type_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:N:N:') as `product_type_group`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Material Category 1:O:N') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Material Category 2:O:N:') as `product_category2_name`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') as `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') as `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') as `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') as `product_rm_stock_unit_name`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') as `product_rm_std_weight`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') as `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') as `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') as `routing_code`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') as `remark`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Material Id:O:N:') as `product_rm_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;



create or replace
algorithm = UNDEFINED view `smv_product_rm_cotton_bales_rpt_summary` as
select
    concat(ifnull(`rmc`.`product_rm_name`, ''), ':Material Name:Y:T') as `product_rm_name`,
        concat(ifnull(`rm`.`product_rm_short_name`, ''), ':Material Short Name:Y:T') as `product_rm_short_name`,
    concat(ifnull(`rm`.`product_rm_code`, ''), ':Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rmt`.`product_type_name`, ''), ':Material Type:O:N:') as `product_type_name`,
    concat(ifnull(`rmt`.`product_type_group`, ''), ':Material Type Group:O:N:') as `product_type_group`,
    concat(ifnull(`rmt`.`product_category1_name`, ''), ':Category 1:O:N:') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, ''), ':Category 2:O:N:') as `product_category2_name`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, ''), ':HSN_SAC Code:Y:C:smv_product_rm:O') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, ''), ':Standard Wt.:Y:T') as `product_rm_std_weight`,
    concat(ifnull(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, ''), 'Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, ''), 'Modified On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, ''), 'Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, ''), 'Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, ''), 'Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, ''), 'Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, ''), ':Material Id:O:N:') as `product_rm_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;



create or replace
algorithm = UNDEFINED view `smv_product_rm_rpt_details` as
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Raw Material Name:Y:T') as `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Raw Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:Y:C:smv_product_type:F') as `product_type_name`,
    concat(ifnull(`rm`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') as `godown_name`,
    concat(ifnull(`rm`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section:F') as `godown_section_name`,
    concat(ifnull(`rm`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans:F') as `godown_section_beans_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, 'NA'), ':Tech. Spect.:O:N:') as `product_rm_technical_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:N:N:') as `product_type_group`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Raw Material Category 1:Y:C:smv_product_category1:F') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Raw Material Category 2:Y:C:smv_product_category2:F') as `product_category2_name`,
    concat(ifnull(`rmt`.`product_category3_name`, 'NA'), ':Raw Material Category 3:N:N:') as `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, 'NA'), ':Raw Material Category 4:N:N:') as `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, 'NA'), ':Raw Material Category 5:N:N:') as `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, 'NA'), ':Raw Material Make:N:N:') as `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, 'NA'), ':Raw Material Type:N:N:') as `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, 'NA'), ':Raw Material Grade:N:N:') as `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, 'NA'), ':Raw Material Shape:N:N:') as `product_material_shape_name`,
    concat(ifnull(`rmt`.`product_rm_name`, 'NA'), ':Alternate Raw Material:N:N:') as `product_alternate_rm_name`,
    concat(ifnull(`rm`.`product_rm_tech_spect`, 'NA'), ':Tech Spect.:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, 'NA'), ':OEM Part Code:Y:T:') as `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') as `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') as `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') as `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') as `product_rm_stock_unit_name`,
    concat(ifnull(`rm`.`product_rm_packing_name`, 'NA'), ':Packing:Y:C:smv_product_packing:F') as `product_rm_packing_name`,
    concat(ifnull(`rm`.`product_rm_item_sr_no`, 'NA'), ':Item Sr. No:O:N:') as `product_rm_item_sr_no`,
    concat(ifnull(`rm`.`product_rm_drawing_no`, 'NA'), ':Drawing No:N:N:') as `product_rm_drawing_no`,
    concat(ifnull(`rm`.`product_rm_model_no`, 'NA'), ':Model No:O:N:') as `product_rm_model_no`,
    concat(ifnull(`rm`.`product_rm_bar_code`, 'NA'), ':Bar Code:O:N:') as `product_rm_bar_code`,
    concat(ifnull(`rm`.`product_rm_qr_code`, 'NA'), ':QR Code:O:N:') as `product_rm_qr_code`,
    concat(ifnull(`rm`.`product_consumption_mode`, 'NA'), ':Consumption Mode:Y:P:MaterialConsumptionMode') as `product_consumption_mode`,
    concat(ifnull(`rm`.`product_origin_type`, 'NA'), ':Origin Type:Y:P:MaterialOrigin') as `product_origin_type`,
    concat(ifnull(`rm`.`product_origin_country`, 'NA'), ':Origin Country:O:N:') as `product_origin_country`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_is_exampted`, 'NA'), ':HSN Type Exampted:O:N:') as `product_rm_hsn_sac_is_exampted`,
    concat(ifnull(`rmt`.`product_material_colour`, 'NA'), ':Colour:N:N:') as `product_material_colour`,
    concat(ifnull(`rmt`.`assembly_scrap_percent`, 'NA'), ':Scrap Percent:O:N:') as `assembly_scrap_percent`,
    concat(ifnull(`rmc`.`product_rm_gross_weight`, 'NA'), ':Gross Weight:Y:T') as `product_rm_gross_weight`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') as `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_volume`, 'NA'), ':Volume:Y:T') as `product_rm_volume`,
    concat(ifnull(`rmc`.`product_rm_mrp`, 'NA'), ':MRP:Y:T') as `product_rm_mrp`,
    concat(ifnull(`rmc`.`product_rm_landed_price`, 'NA'), ':Landed Price:Y:T') as `product_rm_landed_price`,
    concat(ifnull(`rmc`.`product_rm_avg_price`, 'NA'), ':Avg. Price:Y:T') as `product_rm_avg_price`,
    concat(ifnull(`rmc`.`product_rm_std_profit_percent`, 'NA'), ': Std. Profit Percent:Y:T') as `product_rm_std_profit_percent`,
    concat(ifnull(`rmc`.`product_rm_std_discount_percent`, 'NA'), ':Std. Discount Percent:Y:T') as `product_rm_std_discount_percent`,
    concat(ifnull(`rmc`.`product_rm_moq`, 'NA'), ':MOQ:Y:T') as `product_rm_moq`,
    concat(ifnull(`rmc`.`product_rm_mpq`, 'NA'), ':MPQ:Y:T') as `product_rm_mpq`,
    concat(ifnull(`rmc`.`product_rm_mov`, 'NA'), ':MOV:Y:T') as `product_rm_mov`,
    concat(ifnull(`rmc`.`product_rm_eoq`, 'NA'), ':EOQ:Y:T') as `product_rm_eoq`,
    concat(ifnull(`rmc`.`product_rm_min_stock_level`, 'NA'), ':Minimum Stock:Y:T') as `product_rm_min_stock_level`,
    concat(ifnull(`rmc`.`product_rm_max_stock_level`, 'NA'), ':Maximum Stock:Y:T') as `product_rm_max_stock_level`,
    concat(ifnull(`rmc`.`product_rm_reorder_stock_level`, 'NA'), ':Reorder Stock:Y:T') as `product_rm_reorder_stock_level`,
    concat(ifnull(`rmc`.`purchase_tolerance_percent`, 'NA'), ': Purchase Tolerance Percent:Y:T') as `purchase_tolerance_percent`,
    concat(ifnull(`rmc`.`product_rm_price_type`, 'NA'), ':Price Type:Y:H:(Fixed,Moving Average)') as `product_rm_price_type`,
    concat(ifnull(`rmc`.`product_rm_abc_analysis`, 'NA'), ':ABC Category:Y:H:(A,B,C)') as `product_rm_abc_analysis`,
    concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Short Name:O:N:') as `product_rm_short_name`,
    concat(ifnull(`rmc`.`qa_required`, 'NA'), ':QA Required:Y:H:(Yes,No)') as `qa_required`,
    concat(ifnull(`rmc`.`test_certificate_required`, 'NA'), ':Test Certificate Required:Y:H:(Yes,No)') as `test_certificate_required`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') as `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') as `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') as `routing_code`,
    concat(ifnull(`rm`.`product_rm_print_name`, 'NA'), ':Print Name:O:N:') as `product_rm_print_name`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') as `remark`,
    concat(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') as `Active`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`company_id`, 'NA'), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`rm`.`company_branch_id`, 'NA'), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`rm`.`product_type_id`, 'NA'), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`rm`.`product_category1_id`, 'NA'), ':Product Category Id 1:N:N:') as `product_category1_id`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Raw Material Id:O:N:') as `product_rm_id`,
    concat(ifnull(`rmc`.`profit_center_id`, ''), ':Profit Center Id:N:N:') as `profit_center_id`,
    concat(ifnull(`rmc`.`cost_center_id`, ''), ':Cost Center Id:N:N:') as `cost_center_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
create or replace
algorithm = UNDEFINED view `smv_product_rm_cotton_bales_rpt_summary` as
select
    concat(ifnull(`rmc`.`product_rm_name`, ''), ':Material Name:Y:T') as `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_short_name`, ''), ':Material Short Name:Y:T') as `product_rm_short_name`,
    concat(ifnull(`rm`.`product_rm_code`, ''), ':Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rmt`.`product_type_name`, ''), ':Material Type:O:N:') as `product_type_name`,
    concat(ifnull(`rmt`.`product_category1_name`, ''), ':Category 1:O:N:') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, ''), ':Category 2:O:N:') as `product_category2_name`,
    concat(ifnull(`rmt`.`product_type_group`, ''), ':Material Type Group:O:N:') as `product_type_group`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, ''), ':HSN_SAC Code:Y:C:smv_product_rm:O') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, ''), ':Standard Wt.:Y:T') as `product_rm_std_weight`,
    concat(ifnull(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Deleted:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, ''), 'Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, ''), 'Modified On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, ''), 'Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, ''), 'Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, ''), 'Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, ''), 'Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, ''), ':Material Id:O:N:') as `product_rm_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;



create or replace
algorithm = UNDEFINED view `smv_product_rm_cotton_bales_rpt_details` as
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Material Name:Y:T') as `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Material Short Name:O:N:') as `product_rm_short_name`,
    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:O:N:') as `product_type_name`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Material Category 1:O:N') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Material Category 2:O:N:') as `product_category2_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:N:N:') as `product_type_group`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') as `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') as `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') as `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') as `product_rm_stock_unit_name`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') as `product_rm_std_weight`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') as `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') as `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') as `routing_code`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') as `remark`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Material Id:O:N:') as `product_rm_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;




create or replace
algorithm = UNDEFINED view `smv_product_rm_rpt_details` as
select
    concat(ifnull(`rm`.`product_rm_name`, 'NA'), ':Raw Material Name:Y:T') as `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, 'NA'), ':Raw Material Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rm`.`product_type_name`, 'NA'), ':Product Type:Y:C:smv_product_type:F') as `product_type_name`,
    concat(ifnull(`rm`.`product_category1_name`, 'NA'), ':Raw Material Category 1:Y:C:smv_product_category1:F') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, 'NA'), ':Raw Material Category 2:Y:C:smv_product_category2:F') as `product_category2_name`,
    concat(ifnull(`rm`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') as `godown_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, 'NA'), ':Tech. Spect.:O:N:') as `product_rm_technical_name`,
    concat(ifnull(`rm`.`product_type_group`, 'NA'), ':Product Type Group:N:N:') as `product_type_group`,
    concat(ifnull(`rmt`.`product_category3_name`, 'NA'), ':Raw Material Category 3:N:N:') as `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, 'NA'), ':Raw Material Category 4:N:N:') as `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, 'NA'), ':Raw Material Category 5:N:N:') as `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, 'NA'), ':Raw Material Make:N:N:') as `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, 'NA'), ':Raw Material Type:N:N:') as `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, 'NA'), ':Raw Material Grade:N:N:') as `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, 'NA'), ':Raw Material Shape:N:N:') as `product_material_shape_name`,
    concat(ifnull(`rmt`.`product_rm_name`, 'NA'), ':Alternate Raw Material:N:N:') as `product_alternate_rm_name`,
    concat(ifnull(`rm`.`product_rm_tech_spect`, 'NA'), ':Tech Spect.:O:N:') as `product_rm_tech_spect`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, 'NA'), ':OEM Part Code:Y:T:') as `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, 'NA'), ':HSN/SAC Code:Y:C:cmv_hsn_sac:F') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_rate`, 'NA'), ':HSN/SAC Percent:Y:T') as `product_rm_hsn_sac_rate`,
    concat(ifnull(`rm`.`product_rm_purchase_unit_name`, 'NA'), ':Purchase Unit:Y:C:smv_product_unit:F') as `product_rm_purchase_unit_name`,
    concat(ifnull(`rm`.`product_rm_sales_unit_name`, 'NA'), ':Sales Unit:Y:C:smv_product_unit:F') as `product_rm_sales_unit_name`,
    concat(ifnull(`rm`.`product_rm_stock_unit_name`, 'NA'), ':Stock Unit:Y:C:smv_product_unit:F') as `product_rm_stock_unit_name`,
    concat(ifnull(`rm`.`product_rm_packing_name`, 'NA'), ':Packing:Y:C:smv_product_packing:F') as `product_rm_packing_name`,
    concat(ifnull(`rm`.`product_rm_item_sr_no`, 'NA'), ':Item Sr. No:O:N:') as `product_rm_item_sr_no`,
    concat(ifnull(`rm`.`product_rm_drawing_no`, 'NA'), ':Drawing No:N:N:') as `product_rm_drawing_no`,
    concat(ifnull(`rm`.`product_rm_model_no`, 'NA'), ':Model No:O:N:') as `product_rm_model_no`,
    concat(ifnull(`rm`.`product_rm_bar_code`, 'NA'), ':Bar Code:O:N:') as `product_rm_bar_code`,
    concat(ifnull(`rm`.`product_rm_qr_code`, 'NA'), ':QR Code:O:N:') as `product_rm_qr_code`,
    concat(ifnull(`rm`.`product_consumption_mode`, 'NA'), ':Consumption Mode:Y:P:MaterialConsumptionMode') as `product_consumption_mode`,
    concat(ifnull(`rm`.`product_origin_type`, 'NA'), ':Origin Type:Y:P:MaterialOrigin') as `product_origin_type`,
    concat(ifnull(`rm`.`product_origin_country`, 'NA'), ':Origin Country:O:N:') as `product_origin_country`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_is_exampted`, 'NA'), ':HSN Type Exampted:O:N:') as `product_rm_hsn_sac_is_exampted`,
    concat(ifnull(`rmt`.`product_material_colour`, 'NA'), ':Colour:N:N:') as `product_material_colour`,
    concat(ifnull(`rmt`.`assembly_scrap_percent`, 'NA'), ':Scrap Percent:O:N:') as `assembly_scrap_percent`,
    concat(ifnull(`rmc`.`product_rm_gross_weight`, 'NA'), ':Gross Weight:Y:T') as `product_rm_gross_weight`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, 'NA'), ':Std. Weight:Y:T') as `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_volume`, 'NA'), ':Volume:Y:T') as `product_rm_volume`,
    concat(ifnull(`rmc`.`product_rm_mrp`, 'NA'), ':MRP:Y:T') as `product_rm_mrp`,
    concat(ifnull(`rmc`.`product_rm_landed_price`, 'NA'), ':Landed Price:Y:T') as `product_rm_landed_price`,
    concat(ifnull(`rmc`.`product_rm_avg_price`, 'NA'), ':Avg. Price:Y:T') as `product_rm_avg_price`,
    concat(ifnull(`rmc`.`product_rm_std_profit_percent`, 'NA'), ': Std. Profit Percent:Y:T') as `product_rm_std_profit_percent`,
    concat(ifnull(`rmc`.`product_rm_std_discount_percent`, 'NA'), ':Std. Discount Percent:Y:T') as `product_rm_std_discount_percent`,
    concat(ifnull(`rmc`.`product_rm_moq`, 'NA'), ':MOQ:Y:T') as `product_rm_moq`,
    concat(ifnull(`rmc`.`product_rm_mpq`, 'NA'), ':MPQ:Y:T') as `product_rm_mpq`,
    concat(ifnull(`rmc`.`product_rm_mov`, 'NA'), ':MOV:Y:T') as `product_rm_mov`,
    concat(ifnull(`rmc`.`product_rm_eoq`, 'NA'), ':EOQ:Y:T') as `product_rm_eoq`,
    concat(ifnull(`rmc`.`product_rm_min_stock_level`, 'NA'), ':Minimum Stock:Y:T') as `product_rm_min_stock_level`,
    concat(ifnull(`rmc`.`product_rm_max_stock_level`, 'NA'), ':Maximum Stock:Y:T') as `product_rm_max_stock_level`,
    concat(ifnull(`rmc`.`product_rm_reorder_stock_level`, 'NA'), ':Reorder Stock:Y:T') as `product_rm_reorder_stock_level`,
    concat(ifnull(`rmc`.`purchase_tolerance_percent`, 'NA'), ': Purchase Tolerance Percent:Y:T') as `purchase_tolerance_percent`,
    concat(ifnull(`rmc`.`product_rm_price_type`, 'NA'), ':Price Type:Y:H:(Fixed,Moving Average)') as `product_rm_price_type`,
    concat(ifnull(`rmc`.`product_rm_abc_analysis`, 'NA'), ':ABC Category:Y:H:(A,B,C)') as `product_rm_abc_analysis`,
    concat(ifnull(`rm`.`product_rm_short_name`, 'NA'), ':Short Name:O:N:') as `product_rm_short_name`,
    concat(ifnull(`rmc`.`qa_required`, 'NA'), ':QA Required:Y:H:(Yes,No)') as `qa_required`,
    concat(ifnull(`rmc`.`test_certificate_required`, 'NA'), ':Test Certificate Required:Y:H:(Yes,No)') as `test_certificate_required`,
    concat(ifnull(`rmc`.`profit_center_name`, 'NA'), ':Profit Center Name:Y:C:fmv_profit_center:F') as `profit_center_name`,
    concat(ifnull(`rmc`.`cost_center_name`, 'NA'), ':Cost Center Name:Y:C:fmv_cost_center:F') as `cost_center_name`,
    concat(ifnull(`rmc`.`routing_code`, 'NA'), ':Routing Code:O:N:') as `routing_code`,
    concat(ifnull(`rm`.`product_rm_print_name`, 'NA'), ':Print Name:O:N:') as `product_rm_print_name`,
    concat(ifnull(`rm`.`remark`, 'NA'), ':Remark:O:N:') as `remark`,
    concat(ifnull(`rm`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section:F') as `godown_section_name`,
    concat(ifnull(`rm`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans:F') as `godown_section_beans_name`,
    concat(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active, In Active)') as `Active`,
    concat(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ':Delete Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, 'NA'), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, 'NA'), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, 'NA'), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, 'NA'), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, 'NA'), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, 'NA'), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`company_id`, 'NA'), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`rm`.`company_branch_id`, 'NA'), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`rm`.`product_type_id`, 'NA'), ':Product Type Id:N:N:') as `product_type_id`,
    concat(ifnull(`rm`.`product_category1_id`, 'NA'), ':Product Category Id 1:N:N:') as `product_category1_id`,
    concat(ifnull(`rm`.`product_rm_id`, 'NA'), ':Raw Material Id:O:N:') as `product_rm_id`,
    concat(ifnull(`rmc`.`profit_center_id`, ''), ':Profit Center Id:N:N:') as `profit_center_id`,
    concat(ifnull(`rmc`.`cost_center_id`, ''), ':Cost Center Id:N:N:') as `cost_center_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;




create or replace
algorithm = UNDEFINED view `smv_product_rm_rpt_summary` as
select
    concat(ifnull(`rmc`.`product_rm_name`, ''), ':Product Name:Y:T') as `product_rm_name`,
    concat(ifnull(`rm`.`product_rm_code`, ''), ':Product Code:Y:T') as `product_rm_code`,
    concat(ifnull(`rmt`.`product_type_name`, ''), ':Product Type:Y:C:smv_product_type:F') as `product_type_name`,
    concat(ifnull(`rmt`.`product_category1_name`, ''), ':Category 1:Y:C:smv_product_category1:F') as `product_category1_name`,
    concat(ifnull(`rmt`.`product_category2_name`, ''), ':Category 2:Y:C:smv_product_category2:F') as `product_category2_name`,
    concat(ifnull(`rm`.`godown_name`, ''), ':Godown Name:Y:C:cmv_godown:F') as `godown_name`,
    concat(ifnull(`rmt`.`product_rm_technical_name`, ''), ':Technical Name:N:N:') as `product_rm_technical_name`,
    concat(ifnull(`rmt`.`product_type_group`, ''), ':Product Type Group:O:N:') as `product_type_group`,
    concat(ifnull(`rmt`.`product_category3_name`, ''), ':Category 3:N:N:') as `product_category3_name`,
    concat(ifnull(`rmt`.`product_category4_name`, ''), ':Category 4:N:N:') as `product_category4_name`,
    concat(ifnull(`rmt`.`product_category5_name`, ''), ':Category 5:N:N:') as `product_category5_name`,
    concat(ifnull(`rmt`.`product_make_name`, ''), ':Make Name:N:N:') as `product_make_name`,
    concat(ifnull(`rmt`.`product_material_type_name`, ''), ':Material Type:Y:C:smv_product_material_type:F') as `product_material_type_name`,
    concat(ifnull(`rmt`.`product_material_grade_name`, ''), ':Material Grade:N:N:') as `product_material_grade_name`,
    concat(ifnull(`rmt`.`product_material_shape_name`, ''), ':Material Shape:N:N:') as `product_material_shape_name`,
    concat(ifnull(`rm`.`product_rm_hsn_sac_code`, ''), ':HSN_SAC Code:Y:C:smv_product_rm:O') as `product_rm_hsn_sac_code`,
    concat(ifnull(`rm`.`product_rm_oem_part_code`, ''), ':OEM Part Code:Y:C:smv_product_rm:O') as `product_rm_oem_part_code`,
    concat(ifnull(`rm`.`product_rm_our_part_code`, ''), ':OUR Part Code:N:N:') as `product_rm_our_part_code`,
    concat(ifnull(`rmt`.`product_rm_drawing_no`, ''), ':Drawing No:N:N:') as `product_rm_drawing_no`,
    concat(ifnull(`rmc`.`product_rm_std_weight`, ''), ':Standard Wt.:Y:T') as `product_rm_std_weight`,
    concat(ifnull(`rmc`.`product_rm_mrp`, ''), ':MRP:Y:T') as `product_rm_mrp`,
    concat(ifnull(`rm`.`godown_section_name`, ''), ':Godown Section Name:Y:C:cmv_godown_section:F') as `godown_section_name`,
    concat(ifnull(`rm`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:Y:C:cmv_godown_section_beans:F') as `godown_section_beans_name`,
    concat(ifnull(case when `rm`.`is_active` = 1 then 'Active' else 'In Active' end, ''), ':Is Active:Y:H:(Active, In Active)') as `Active`,
    concat(ifnull(case when `rm`.`is_delete` = 1 then 'Yes' else 'No' end, ''), ':Is Deleted:Y:H:(Yes, No)') as `Deleted`,
    concat(ifnull(`rm`.`created_by`, ''), 'Created By:O:N:') as `created_by`,
    concat(ifnull(`rm`.`created_on`, ''), 'Modified On:O:N:') as `created_on`,
    concat(ifnull(`rm`.`modified_by`, ''), 'Modified By:O:N:') as `modified_by`,
    concat(ifnull(`rm`.`modified_on`, ''), 'Modified On:O:N:') as `modified_on`,
    concat(ifnull(`rm`.`deleted_by`, ''), 'Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`rm`.`deleted_on`, ''), 'Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`rm`.`product_rm_id`, ''), ':Material Id:O:N:') as `product_rm_id`
from
    ((`smv_product_rm` `rm`
left join `smv_product_rm_technical` `rmt` on
    (`rmt`.`company_id` = `rm`.`company_id`
        and `rmt`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmt`.`is_active` = 1))
left join `smv_product_rm_commercial` `rmc` on
    (`rmc`.`company_id` = `rm`.`company_id`
        and `rmc`.`product_rm_id` = `rm`.`product_rm_id`
        and `rmc`.`is_active` = 1))
where
    `rm`.`is_delete` = 0
limit 1;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_purchase_order_master product_category2_id bigint(20) DEFAULT 5 NULL;
ALTER TABLE pt_purchase_order_master ADD product_category2_name varchar(100) DEFAULT NULL NULL;

UPDATE pt_purchase_order_master
SET product_category2_id = 5,
    product_category2_name = 'Yarn'
WHERE purchase_order_type_id = 12;


create or replace
algorithm = UNDEFINED view `ptv_purchase_order_master_summary` as
select
    case
        `pt`.`purchase_order_creation_type` when 'M' then 'Manual'
        when 'R' then 'Reorder Based'
        else 'Auto'
    end as `purchase_order_creation_type_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    case
        when `pt`.`purchase_order_status` = 'A' then 'Approved'
        when `pt`.`purchase_order_status` = 'R' then 'Rejected'
        when `pt`.`purchase_order_status` = 'I' then 'Partial Receipt'
        when `pt`.`purchase_order_status` = 'C' then 'Completed'
        when `pt`.`purchase_order_status` = 'X' then 'Canceled'
        when `pt`.`purchase_order_status` = 'Z' then 'Pree Closed'
        else 'Pending'
    end as `purchase_order_status_desc`,
    case
        `pt`.`purchase_order_life` when 'C' then 'Close'
        else 'Open'
    end as `purchase_order_life_desc`,
    case
        `pt`.`purchase_order_mail_sent_status` when 'S' then 'Email Sent'
        when 'F' then 'Email Failed'
        else 'Email Pending'
    end as `purchase_order_mail_sent_status_desc`,
    `s`.`supp_branch_name` as `supplier_name`,
    `st`.`state_name` as `state_name`,
    `s`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `s`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `cb`.`company_branch_name` as `expected_branch_name`,
    `st1`.`state_name` as `expected_branch_state_name`,
    `e`.`employee_name` as `approved_by`,
    `pt`.`product_category2_id` as `product_category2_id`,
    `pt`.`product_category2_name` as `product_category2_name`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`expected_schedule_date` as `expected_schedule_date`,
    `pt`.`quotation_no` as `quotation_no`,
    `pt`.`quotation_date` as `quotation_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `pt`.`packing_amount` as `packing_amount`,
    `pt`.`po_discount_percent` as `po_discount_percent`,
    `pt`.`po_discount_amount` as `po_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`grand_total` as `grand_total`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    case
        `pt`.`agent_paid_status` when 'A' then 'Approved'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `agent_paid_status_desc`,
    case
        convert(`pt`.`purchase_order_acceptance_status`
            using utf8mb4)
        when 'A' then 'Approved'
        when 'X' then 'Canceled'
        else 'Pending'
    end as `purchase_order_acceptance_status_desc`,
    `pt`.`purchase_order_acceptance_status` as `purchase_order_acceptance_status`,
    `pt`.`purchase_order_mail_sent_status` as `purchase_order_mail_sent_status`,
    `pt`.`status_remark` as `status_remark`,
    `pt`.`other_terms_conditions` as `other_terms_conditions`,
    `s`.`supp_branch_type` as `supplier_type`,
    `s`.`supp_branch_address1` as `supp_branch_address1`,
    `s`.`supp_branch_pincode` as `supp_branch_pincode`,
    `ct`.`city_name` as `city_name`,
    `hsn`.`hsn_sac_type` as `hsn_sac_type`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_short_name` as `expected_branch_short_name`,
    `cb`.`branch_address1` as `expected_branch_address1`,
    `cb`.`branch_pincode` as `expected_branch_pincode`,
    `ct1`.`city_name` as `expected_branch_city_name`,
    `cb`.`branch_phone_no` as `expected_branch_phone_no`,
    `cb`.`branch_EmailId` as `expected_branch_EmailId`,
    `pt`.`financial_year` as `financial_year`,
    `pt`.`purchase_process_entry` as `purchase_process_entry`,
    `pt`.`purchase_order_type` as `purchase_order_type`,
    `p`.`product_type_short_name` as `product_type_short_name`,
    `pt`.`purchase_order_life` as `purchase_order_life`,
    `pt`.`purchase_order_status` as `purchase_order_status`,
    `pt`.`grn_status` as `grn_status`,
    case
        `pt`.`purchase_process_entry` when 'M' then 'Manual'
        else 'Auto'
    end as `purchase_process_entry_desc`,
    `pt`.`purchase_order_creation_type` as `purchase_order_creation_type`,
    `pt`.`gate_pass_no` as `gate_pass_no`,
    `pt`.`gate_pass_date` as `gate_pass_date`,
    `pt`.`vehicale_no` as `vehicale_no`,
    `pt`.`vehicale_type` as `vehicale_type`,
    `pt`.`gross_weight` as `gross_weight`,
    `pt`.`tare_weight` as `tare_weight`,
    `pt`.`net_weight` as `net_weight`,
    `pt`.`variation_weight` as `variation_weight`,
    `pt`.`deduction1_name` as `deduction1_name`,
    `pt`.`deduction1_percent` as `deduction1_percent`,
    `pt`.`deduction1_amount` as `deduction1_amount`,
    `pt`.`deduction2_name` as `deduction2_name`,
    `pt`.`deduction2_percent` as `deduction2_percent`,
    `pt`.`deduction2_amount` as `deduction2_amount`,
    `pt`.`deduction3_name` as `deduction3_name`,
    `pt`.`deduction3_percent` as `deduction3_percent`,
    `pt`.`deduction3_amount` as `deduction3_amount`,
    `pt`.`deduction4_name` as `deduction4_name`,
    `pt`.`deduction4_percent` as `deduction4_percent`,
    `pt`.`deduction4_amount` as `deduction4_amount`,
    `pt`.`deduction5_name` as `deduction5_name`,
    `pt`.`deduction5_percent` as `deduction5_percent`,
    `pt`.`deduction5_amount` as `deduction5_amount`,
    `e1`.`employee_name` as `grader_by_name`,
    `pt`.`remark` as `remark`,
    case
        when `pt`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_active` as `is_active`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`purchase_order_master_transaction_id` as `purchase_order_master_transaction_id`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`purchase_order_type_id` as `purchase_order_type_id`,
    `pt`.`supplier_id` as `supplier_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `cc`.`supp_branch_name` as `supplier_cosnignee_name`,
    `cc`.`supp_branch_address1` as `supp_consignee_address1`,
    `cc`.`supp_branch_address2` as `supp_consignee_address2`,
    `cc`.`supp_branch_pincode` as `supp_consignee_pincode`,
    `ct2`.`city_name` as `supp_consignee_city_name`,
    `st2`.`state_name` as `supp_consignee_state_name`,
    `pt`.`consignee_id` as `consignee_id`,
    `pt`.`consignee_state_id` as `consignee_state_id`,
    `pt`.`consignee_city_id` as `consignee_city_id`,
    `pt`.`grader_by_id` as `grader_by_id`,
    `pt`.`deduction5_id` as `deduction5_id`,
    `pt`.`deduction4_id` as `deduction4_id`,
    `pt`.`deduction3_id` as `deduction3_id`,
    `pt`.`deduction2_id` as `deduction2_id`,
    `pt`.`deduction1_id` as `deduction1_id`,
    `pt`.`agent_paid_status` as `agent_paid_status`
from
    (((((((((((((((`pt_purchase_order_master` `pt`
left join `cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cm_supplier_branch` `s` on
    (`s`.`supp_branch_id` = `pt`.`supplier_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`grader_by_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_city` `ct1` on
    (`ct1`.`city_id` = `pt`.`expected_branch_city_id`))
left join `cm_state` `st` on
    (`st`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_state` `st1` on
    (`st1`.`state_id` = `pt`.`expected_branch_state_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`purchase_order_type_id`))
left join `cm_supplier_branch` `cc` on
    (`cc`.`supp_branch_id` = `pt`.`consignee_id`))
left join `cm_city` `ct2` on
    (`ct2`.`city_id` = `pt`.`consignee_city_id`))
left join `cm_state` `st2` on
    (`st2`.`state_id` = `pt`.`consignee_state_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE pt_material_gate_pass_master MODIFY COLUMN supplier_branch_contacts_id varchar(1000) DEFAULT NULL NULL;

ALTER TABLE pt_material_gate_pass_master MODIFY COLUMN material_type varchar(5) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT 'RGP' NOT NULL;

create or replace
algorithm = UNDEFINED view `ptv_material_gate_pass_master` as
select
    `pmgpm`.`material_gate_pass_master_id` as `material_gate_pass_master_id`,
    `pmgpm`.`company_id` as `company_id`,
    `pmgpm`.`financial_year` as `financial_year`,
    `pmgpm`.`company_branch_id` as `company_branch_id`,
    `pmgpm`.`gate_pass_date` as `gate_pass_date`,
    `pmgpm`.`gate_pass_no` as `gate_pass_no`,
    `pmgpm`.`product_type_id` as `product_type_id`,
    `pmgpm`.`product_type_name` as `product_type_name`,
    `pmgpm`.`material_type` as `material_type`,
    `pmgpm`.`vehicle_no` as `vehicle_no`,
    `pmgpm`.`service_provider_name` as `service_provider_name`,
    `pmgpm`.`supplier_branch_address` as `supplier_branch_address`,
    `pmgpm`.`checker_by_id` as `checker_by_id`,
    `pmgpm`.`checker_by_name` as `checker_by_name`,
    `pmgpm`.`approved_by_id` as `approved_by_id`,
    `pmgpm`.`approved_by_name` as `approved_by_name`,
    `pmgpm`.`approved_date` as `approved_date`,
    `pmgpm`.`gate_pass_status` as `gate_pass_status`,
    `pmgpm`.`supplier_branch_id` as `supplier_branch_id`,
    `pmgpm`.`supplier_branch_state_id` as `supplier_branch_state_id`,
    `pmgpm`.`supplier_branch_city_id` as `supplier_branch_city_id`,
    `pmgpm`.`supplier_branch_contacts_id` as `supplier_branch_contacts_id`,
    `supp`.`supp_branch_name` as `supp_branch_name`,
    `supp`.`city_name` as `city_name`,
    `supp`.`state_name` as `state_name`,
    `con`.`supp_contact_person` as `supp_contact_person`,
    `con`.`supp_contact_no` as `supp_contact_no`,
    `dept`.`department_name` as `department_name`,
    `subdpt`.`department_name` as `sub_department_name`,
    `pmgpm`.`return_status` as `return_status`,
    case
        `pmgpm`.`return_status` when 'P' then 'Pending'
        when 'R' then 'Returned'
        when 'I' then 'Partial-Returned'
        else 'Pending'
    end as `return_status_desc`,
    case
        `pmgpm`.`gate_pass_status` when 'P' then 'Pending'
        when 'A' then 'Approved'
        when 'R' then 'Returned'
        when 'I' then 'Partial-Returned'
        else 'Pending'
    end as `gate_pass_status_desc`,
    case
        when `pmgpm`.`material_type` = 'RGP' then 'Returnable'
        else 'Non-Returnable'
    end as `material_type_desc`,
    `pmgpm`.`department_id` as `department_id`,
    `pmgpm`.`sub_department_id` as `sub_department_id`,
    `pmgpm`.`is_delete` as `is_delete`,
    `pmgpm`.`created_by` as `created_by`,
    `pmgpm`.`created_on` as `created_on`,
    `pmgpm`.`modified_by` as `modified_by`,
    `pmgpm`.`modified_on` as `modified_on`,
    `pmgpm`.`deleted_by` as `deleted_by`,
    `pmgpm`.`deleted_on` as `deleted_on`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_address1` as `company_address`,
    `cb`.`branch_pincode` as `company_pincode`,
    `cb`.`branch_phone_no` as `company_phone_no`,
    `cb`.`branch_EmailId` as `company_EmailId`,
    `cb`.`branch_website` as `company_website`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`
from
    ((((((`pt_material_gate_pass_master` `pmgpm`
left join `cm_company` `c` on
    (`pmgpm`.`company_id` = `c`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pmgpm`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `cmv_supplier_branch` `supp` on
    (`supp`.`supp_branch_id` = `pmgpm`.`supplier_branch_id`
        and `supp`.`is_delete` = 0))
left join `cmv_supplier_contacts` `con` on
    (`con`.`supplier_contact_id` = `pmgpm`.`supplier_branch_contacts_id`
        and `con`.`is_delete` = 0))
left join `cm_department` `dept` on
    (`dept`.`department_id` = `pmgpm`.`department_id`
        and `con`.`is_delete` = 0))
left join `cm_department` `subdpt` on
    (`subdpt`.`department_id` = `pmgpm`.`sub_department_id`
        and `con`.`is_delete` = 0))
where
    `pmgpm`.`is_delete` = 0;



create or replace
algorithm = UNDEFINED view `erp-development`.`ptv_material_return_gate_pass_master` as
select
    `pmgpm`.`material_return_gate_pass_master_id` as `material_return_gate_pass_master_id`,
    `pmgpm`.`company_id` as `company_id`,
    `pmgpm`.`financial_year` as `financial_year`,
    `pmgpm`.`company_branch_id` as `company_branch_id`,
    `pmgpm`.`return_gate_pass_date` as `return_gate_pass_date`,
    `pmgpm`.`gate_pass_no` as `gate_pass_no`,
    `pmgpm`.`return_gate_pass_no` as `return_gate_pass_no`,
    `pmgpm`.`product_type_id` as `product_type_id`,
    `pmgpm`.`product_type_name` as `product_type_name`,
    `pmgpm`.`material_type` as `material_type`,
    `pmgpm`.`vehicle_no` as `vehicle_no`,
    `pmgpm`.`supplier_branch_address` as `supplier_branch_address`,
    `supp`.`supp_branch_name` as `supp_branch_name`,
    `supp`.`city_name` as `city_name`,
    `supp`.`state_name` as `state_name`,
    `con`.`supp_contact_person` as `supp_contact_person`,
    `con`.`supp_contact_no` as `supp_contact_no`,
    `dept`.`department_name` as `department_name`,
    `subdpt`.`department_name` as `sub_department_name`,
    `pmgpm`.`checker_by_id` as `checker_by_id`,
    `pmgpm`.`checker_by_name` as `checker_by_name`,
    `pmgpm`.`returned_by_id` as `returned_by_id`,
    `pmgpm`.`returned_by_name` as `returned_by_name`,
    `pmgpm`.`return_status` as `return_status`,
    case
        `pmgpm`.`return_status` when 'P' then 'Pending'
        when 'R' then 'Returned'
        when 'I' then 'Partial-Returned'
        else 'Pending'
    end as `return_status_desc`,
    case
        when `pmgpm`.`material_type` = 'RGP' then 'Returnable'
        else 'Non-Returnable'
    end as `material_type_desc`,
    `pmgpm`.`supplier_branch_id` as `supplier_branch_id`,
    `pmgpm`.`supplier_branch_state_id` as `supplier_branch_state_id`,
    `pmgpm`.`supplier_branch_city_id` as `supplier_branch_city_id`,
    `pmgpm`.`supplier_branch_contacts_id` as `supplier_branch_contacts_id`,
    `pmgpm`.`department_id` as `department_id`,
    `pmgpm`.`sub_department_id` as `sub_department_id`,
    `pmgpm`.`is_delete` as `is_delete`,
    `pmgpm`.`created_by` as `created_by`,
    `pmgpm`.`created_on` as `created_on`,
    `pmgpm`.`modified_by` as `modified_by`,
    `pmgpm`.`modified_on` as `modified_on`,
    `pmgpm`.`deleted_by` as `deleted_by`,
    `pmgpm`.`deleted_on` as `deleted_on`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `cb`.`branch_address1` as `company_address`,
    `cb`.`branch_pincode` as `company_pincode`,
    `cb`.`branch_phone_no` as `company_phone_no`,
    `cb`.`branch_EmailId` as `company_EmailId`,
    `cb`.`branch_website` as `company_website`,
    `cb`.`branch_gst_no` as `company_gst_no`,
    `cb`.`branch_pan_no` as `company_pan_no`
from
    ((((((`erp-development`.`pt_material_return_gate_pass_master` `pmgpm`
left join `erp-development`.`cm_company` `c` on
    (`pmgpm`.`company_id` = `c`.`company_id`
        and `c`.`is_delete` = 0))
left join `erp-development`.`cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pmgpm`.`company_branch_id`
        and `cb`.`is_delete` = 0))
left join `erp-development`.`cmv_supplier_branch` `supp` on
    (`supp`.`supp_branch_id` = `pmgpm`.`supplier_branch_id`
        and `supp`.`is_delete` = 0))
left join `erp-development`.`cmv_supplier_contacts` `con` on
    (`con`.`supplier_contact_id` = `pmgpm`.`supplier_branch_contacts_id`
        and `con`.`is_delete` = 0))
left join `erp-development`.`cm_department` `dept` on
    (`dept`.`department_id` = `pmgpm`.`department_id`
        and `con`.`is_delete` = 0))
left join `erp-development`.`cm_department` `subdpt` on
    (`subdpt`.`department_id` = `pmgpm`.`sub_department_id`
        and `con`.`is_delete` = 0))
where
    `pmgpm`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
08-02-2025

ALTER TABLE pt_grn_cotton_bales_master CHANGE supplier_id supplier_branch_id bigint(20) DEFAULT NULL NULL COMMENT '* 1/2 Header part combo box with cmv_supllier show address, Contact person list ,emails, supplier state combo,supplier city Combo ';
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_grn_cotton_bales_summary source

create or REPLACE algorithm = UNDEFINED view `ptv_grn_cotton_bales_summary` as
select
    `pt`.`goods_receipt_type` as `goods_receipt_type`,
    `pt`.`goods_receipt_no` as `goods_receipt_no`,
    `pt`.`goods_receipt_date` as `goods_receipt_date`,
    `pt`.`goods_receipt_version` as `goods_receipt_version`,
    case
        `pt`.`goods_receipt_status` when 'G' then 'GRN Done'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        else 'GRN'
    end as `goods_receipt_status_desc`,
    `sup`.`supp_branch_name` as `supp_branch_name`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `pt`.`supplier_invoice_no` as `supplier_invoice_no`,
    `pt`.`supplier_invoice_date` as `supplier_invoice_date`,
    `pt`.`supplier_challan_no` as `supplier_challan_no`,
    `pt`.`supplier_challan_date` as `supplier_challan_date`,
    `a`.`agent_name` as `agent_name`,
    `pt`.`agent_percent` as `agent_percent`,
    `pt`.`agent_paid_status` as `agent_paid_status`,
    `e1`.`employee_name` as `qa_by_name`,
    `pt`.`qa_date` as `qa_date`,
    `e`.`employee_name` as `approved_by_name`,
    `pt`.`approved_date` as `approved_date`,
    `pt`.`basic_total` as `basic_total`,
    `pt`.`transport_amount` as `transport_amount`,
    `hsn`.`hsn_sac_code` as `freight_hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `freight_hsn_sac_rate`,
    `pt`.`freight_amount` as `freight_amount`,
    `pt`.`is_freight_taxable` as `is_freight_taxable`,
    `pt`.`insurance_amount` as `insurance_amount`,
    `pt`.`goods_receipt_discount_percent` as `goods_receipt_discount_percent`,
    `pt`.`goods_receipt_discount_amount` as `goods_receipt_discount_amount`,
    `pt`.`other_amount` as `other_amount`,
    `pt`.`taxable_total` as `taxable_total`,
    `pt`.`cgst_total` as `cgst_total`,
    `pt`.`sgst_total` as `sgst_total`,
    `pt`.`igst_total` as `igst_total`,
    `pt`.`grand_total` as `grand_total`,
    `pt`.`roundoff` as `roundoff`,
    `pt`.`goods_receipt_status` as `goods_receipt_status`,
    `pt`.`lr_no` as `lr_no`,
    `pt`.`lr_date` as `lr_date`,
    `pt`.`vehicle_no` as `vehicle_no`,
    `pt`.`gate_entry_no` as `gate_entry_no`,
    `pt`.`gate_entry_date` as `gate_entry_date`,
    `pt`.`station` as `station`,
    `pt`.`invoice_amount` as `invoice_amount`,
    `pt`.`amount_difference` as `amount_difference`,
    `pt`.`transporter_name` as `transporter_name`,
    `sup`.`supp_branch_phone_no` as `supp_branch_phone_no`,
    `sup`.`supp_branch_EmailId` as `supp_branch_EmailId`,
    `sup`.`supp_branch_address1` as `supp_branch_address1`,
    `sup`.`supp_branch_pincode` as `supp_branch_pincode`,
    `sup`.`supp_branch_gst_no` as `supp_branch_gst_no`,
    `sup`.`supp_branch_pan_no` as `supp_branch_pan_no`,
    `pt`.`ev_bill_no` as `ev_bill_no`,
    `pt`.`ev_bill_date` as `ev_bill_date`,
    `pt`.`remark` as `remark`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `ct`.`city_name` as `supplier_city_name`,
    `s`.`state_name` as `supplier_state_name`,
    `pt`.`financial_year` as `financial_year`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`is_preeclosed` as `is_preeclosed`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`grn_cotton_bales_master_transaction_id` as `grn_cotton_bales_master_transaction_id`,
    `pt`.`qa_by_id` as `qa_by_id`,
    `pt`.`agent_id` as `agent_id`,
    `pt`.`supplier_branch_id` as `supplier_branch_id`,
    `pt`.`approved_by_id` as `approved_by_id`,
    `pt`.`supplier_state_id` as `supplier_state_id`,
    `pt`.`supplier_city_id` as `supplier_city_id`,
    `pt`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `pt`.`expected_branch_id` as `expected_branch_id`,
    `pt`.`expected_branch_state_id` as `expected_branch_state_id`,
    `pt`.`expected_branch_city_id` as `expected_branch_city_id`,
    `pt`.`goods_receipt_type_id` as `goods_receipt_type_id`,
    `pt`.`freight_hsn_code_id` as `freight_hsn_code_id`,
    `sup`.`supp_branch_payment_term_id` as `payment_term_id`,
    `p`.`product_type_short_name` as `product_type_short_name`
from
    ((((((((((`pt_grn_cotton_bales_master` `pt`
left join `cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `c`.`is_delete` = 0))
left join `cm_supplier_branch` `sup` on
    (`sup`.`supp_branch_id` = `pt`.`supplier_branch_id`
        and `pt`.`is_delete` = 0))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `pt`.`approved_by_id`))
left join `cm_employee` `e1` on
    (`e1`.`employee_id` = `pt`.`qa_by_id`))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `pt`.`supplier_city_id`))
left join `cm_state` `s` on
    (`s`.`state_id` = `pt`.`supplier_state_id`))
left join `cm_agent` `a` on
    (`a`.`agent_id` = `pt`.`agent_id`
        and `a`.`company_id` = `pt`.`company_id`))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`expected_branch_id`
        and `cb`.`is_delete` = 0))
left join `sm_product_type` `p` on
    (`p`.`product_type_id` = `pt`.`goods_receipt_type_id`))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`freight_hsn_code_id`
        and `hsn`.`is_delete` = 0))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-- ptv_grn_cotton_bales_details source

create or REPLACE algorithm = UNDEFINED view `ptv_grn_cotton_bales_details` as
select
    `pt`.`goods_receipt_no` as `goods_receipt_no`,
    `pt`.`goods_receipt_date` as `goods_receipt_date`,
    `pt`.`goods_receipt_version` as `goods_receipt_version`,
    case
        `pt`.`grn_item_status` when 'G' then 'GRN Done'
        when 'Q' then 'QC Done'
        when 'R' then 'Rejected'
        when 'I' then 'Partial Receipt'
        when 'C' then 'Completed'
        when 'X' then 'Canceled'
        when 'Z' then 'Pree Closed'
        else 'GRN'
    end as `grn_item_status_desc`,
    `pt`.`purchase_order_no` as `purchase_order_no`,
    `pt`.`purchase_order_date` as `purchase_order_date`,
    `pt`.`purchase_order_version` as `purchase_order_version`,
    `grm`.`supplier_challan_no` as `supplier_challan_no`,
    `grm`.`supplier_challan_date` as `supplier_challan_date`,
    `sup`.`supp_branch_name` as `supplier_name`,
    `ct`.`city_name` as `supplier_city_name`,
    `ss`.`state_name` as `supplier_state_name`,
    `pt`.`item_qa_by_id` as `item_qa_by_id`,
    `pt`.`item_qa_date` as `item_qa_date`,
    `pt`.`goods_receipt_type` as `goods_receipt_type`,
    `pt`.`batch_no` as `batch_no`,
    `rm`.`product_rm_code` as `product_material_code`,
    `rm`.`product_rm_name` as `product_material_name`,
    `u`.`product_unit_name` as `product_material_stock_unit_name`,
    `mcom`.`product_rm_std_weight` as `product_material_std_weight`,
    `cat1`.`product_category1_name` as `product_category1_name`,
    `cat2`.`product_category2_name` as `product_category2_name`,
    `pk`.`product_packing_name` as `product_packing_name`,
    `hsn`.`hsn_sac_code` as `hsn_sac_code`,
    `hsn`.`hsn_sac_rate` as `hsn_sac_rate`,
    `pt`.`product_material_po_approved_quantity` as `product_material_po_approved_quantity`,
    `pt`.`product_material_po_approved_weight` as `product_material_po_approved_weight`,
    `pt`.`product_material_grn_quantity` as `product_material_grn_quantity`,
    `pt`.`product_material_grn_weight` as `product_material_grn_weight`,
    `pt`.`product_material_conversion_factor` as `product_material_conversion_factor`,
    `pt`.`product_material_grn_rejected_quantity` as `product_material_grn_rejected_quantity`,
    `pt`.`product_material_grn_rejected_weight` as `product_material_grn_rejected_weight`,
    `rp`.`product_rejection_type` as `product_rejection_type`,
    `rp`.`product_rejection_parameters_name` as `product_rejection_parameters_name`,
    `rp`.`product_rejection_parameters_short_name` as `product_rejection_parameters_short_name`,
    `pt`.`product_material_grn_accepted_quantity` as `product_material_grn_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` as `product_material_grn_accepted_weight`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_quantity`) from `pt_grn_cotton_bales_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) as `prev_grn_quantity`,
    coalesce((select sum(`ptdetails`.`product_material_grn_accepted_weight`) from `pt_grn_cotton_bales_details` `ptdetails` where `ptdetails`.`purchase_order_no` = `pt`.`purchase_order_no` and `ptdetails`.`product_material_id` = `pt`.`product_material_id` and `ptdetails`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id` and `ptdetails`.`is_delete` = 0), 0) as `prev_grn_weight`,
    `pt`.`product_material_grn_accepted_quantity` as `product_material_prev_accepted_quantity`,
    `pt`.`product_material_grn_accepted_weight` as `product_material_prev_accepted_weight`,
    `pt`.`po_material_rate` as `po_material_rate`,
    `fpo`.`currency_name` as `currency_name`,
    `pt`.`material_rate` as `material_rate`,
    `fgrn`.`currency_name` as `grn_currency_name`,
    `pt`.`material_basic_amount` as `material_basic_amount`,
    `pt`.`material_freight_amount` as `material_freight_amount`,
    `pt`.`material_discount_percent` as `material_discount_percent`,
    `pt`.`material_discount_amount` as `material_discount_amount`,
    `pt`.`material_taxable_amount` as `material_taxable_amount`,
    `pt`.`material_cgst_percent` as `material_cgst_percent`,
    `pt`.`material_cgst_total` as `material_cgst_total`,
    `pt`.`material_sgst_percent` as `material_sgst_percent`,
    `pt`.`material_sgst_total` as `material_sgst_total`,
    `pt`.`material_igst_percent` as `material_igst_percent`,
    `pt`.`material_igst_total` as `material_igst_total`,
    `pt`.`material_total_amount` as `material_total_amount`,
    `pt`.`material_schedule_date` as `material_schedule_date`,
    `pt`.`grn_item_status` as `grn_item_status`,
    `pt`.`excess_quantity` as `excess_quantity`,
    `pt`.`excess_weight` as `excess_weight`,
    `pt`.`pree_closed_grn_quantity` as `pree_closed_grn_quantity`,
    `pt`.`pree_closed_grn_weight` as `pree_closed_grn_weight`,
    `pt`.`grn_remark` as `grn_remark`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `pt`.`financial_year` as `financial_year`,
    `e2`.`employee_name` as `approved_by_name`,
    `g`.`godown_name` as `godown_name`,
    `gs`.`godown_section_name` as `godown_section_name`,
    `gsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `pdt`.`product_type_group` as `product_material_type_group`,
    `pdt`.`product_type_name` as `product_type_name`,
    `pdt`.`product_type_short_name` as `product_type_short_name`,
    `fpc`.`cost_center_name` as `cost_center_name`,
    `pt`.`currency_exchange_rate` as `currency_exchange_rate`,
    `fgrn`.`currency_code` as `grn_currency_code`,
    `fgrn`.`currency_symbol` as `currency_symbol`,
    case
        when `pt`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `pt`.`is_delete` as `is_delete`,
    `pt`.`created_by` as `created_by`,
    `pt`.`created_on` as `created_on`,
    `pt`.`modified_by` as `modified_by`,
    `pt`.`modified_on` as `modified_on`,
    `pt`.`deleted_by` as `deleted_by`,
    `pt`.`deleted_on` as `deleted_on`,
    `pt`.`company_id` as `company_id`,
    `pt`.`company_branch_id` as `company_branch_id`,
    `pt`.`grn_cotton_bales_details_transaction_id` as `grn_cotton_bales_details_transaction_id`,
    `pt`.`grn_cotton_bales_master_transaction_id` as `grn_cotton_bales_master_transaction_id`,
    `pt`.`purchase_order_details_transaction_id` as `purchase_order_details_transaction_id`,
    `pt`.`department_id` as `department_id`,
    `pt`.`product_material_unit_id` as `product_material_unit_id`,
    `pt`.`product_material_packing_id` as `product_material_packing_id`,
    `pt`.`product_material_hsn_code_id` as `product_material_hsn_code_id`,
    `pt`.`goods_receipt_type_id` as `goods_receipt_type_id`,
    `pt`.`product_material_rejection_reason_id` as `product_material_rejection_reason_id`,
    `grm`.`goods_receipt_status` as `goods_receipt_status`,
    `grm`.`supplier_branch_id` as `supplier_branch_id`,
    `grm`.`approved_by_id` as `approved_by_id`,
    `grm`.`supplier_state_id` as `supplier_state_id`,
    `grm`.`supplier_city_id` as `supplier_city_id`,
    `grm`.`supplier_contacts_ids` as `supplier_contacts_ids`,
    `grm`.`expected_branch_id` as `expected_branch_id`,
    `grm`.`expected_branch_state_id` as `expected_branch_state_id`,
    `grm`.`expected_branch_city_id` as `expected_branch_city_id`,
    `sup`.`supp_branch_payment_term_id` as `payment_term_id`,
    `grm`.`agent_id` as `agent_id`,
    `pt`.`product_material_id` as `product_material_id`,
    `pt`.`godown_id` as `godown_id`,
    `pt`.`godown_section_id` as `godown_section_id`,
    `pt`.`godown_section_beans_id` as `godown_section_beans_id`,
    `rm`.`product_category1_id` as `product_category1_id`,
    `mtech`.`product_category2_id` as `product_category2_id`,
    `pt`.`currency_id` as `currency_id`,
    `pt`.`grn_currency_id` as `grn_currency_id`
from
    ((((((((((((((((((((((((`pt_grn_cotton_bales_details` `pt`
left join `cm_company` `c` on
    (`c`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `pt`.`company_branch_id`
        and `cb`.`company_id` = `pt`.`company_id`
        and `pt`.`is_delete` = 0))
left join `pt_grn_cotton_bales_master` `grm` on
    (`grm`.`grn_cotton_bales_master_transaction_id` = `pt`.`grn_cotton_bales_master_transaction_id`
        and `grm`.`company_id` = `pt`.`company_id`
        and `grm`.`company_branch_id` = `pt`.`company_branch_id`))
left join `cm_supplier_branch` `sup` on
    (`sup`.`supp_branch_id` = `grm`.`supplier_branch_id`
        and `pt`.`is_delete` = 0))
left join `cm_city` `ct` on
    (`ct`.`city_id` = `grm`.`supplier_city_id`))
left join `cm_state` `ss` on
    (`ss`.`state_id` = `grm`.`supplier_state_id`))
left join `sm_product_unit` `u` on
    (`u`.`product_unit_id` = `pt`.`product_material_unit_id`
        and `pt`.`is_delete` = 0))
left join `sm_product_rm` `rm` on
    (`rm`.`product_rm_id` = `pt`.`product_material_id`
        and `rm`.`is_delete` = 0))
left join `sm_product_rm_commercial` `mcom` on
    (`mcom`.`product_rm_id` = `rm`.`product_rm_id`
        and `mcom`.`is_delete` = 0))
left join `sm_product_rm_technical` `mtech` on
    (`mtech`.`product_rm_id` = `rm`.`product_rm_id`
        and `mtech`.`is_delete` = 0))
left join `sm_product_category1` `cat1` on
    (`cat1`.`product_category1_id` = `rm`.`product_category1_id`
        and `cat1`.`is_delete` = 0))
left join `sm_product_category2` `cat2` on
    (`cat2`.`product_category2_id` = `mtech`.`product_category2_id`
        and `cat2`.`is_delete` = 0))
left join `sm_product_type` `pdt` on
    (`pdt`.`product_type_id` = `pt`.`goods_receipt_type_id`
        and `pdt`.`is_delete` = 0))
left join `sm_product_packing` `pk` on
    (`pk`.`product_packing_id` = `pt`.`product_material_packing_id`
        and `pk`.`is_delete` = 0))
left join `cm_hsn_sac` `hsn` on
    (`hsn`.`hsn_sac_id` = `pt`.`product_material_hsn_code_id`
        and `hsn`.`is_delete` = 0))
left join `cm_employee` `e2` on
    (`e2`.`employee_id` = `grm`.`approved_by_id`
        and `e2`.`is_delete` = 0))
left join `sm_product_rejection_parameters` `rp` on
    (`rp`.`company_id` = `pt`.`company_id`
        and `rp`.`product_rejection_parameters_id` = `pt`.`product_material_rejection_reason_id`))
left join `cm_godown` `g` on
    (`g`.`godown_id` = `pt`.`godown_id`))
left join `cm_godown_section` `gs` on
    (`gs`.`godown_section_id` = `pt`.`godown_section_id`))
left join `cm_godown_section_beans` `gsb` on
    (`gsb`.`godown_section_beans_id` = `pt`.`godown_section_beans_id`))
left join `pt_purchase_order_details` `po` on
    (`po`.`company_branch_id` = `pt`.`company_branch_id`
        and `po`.`company_id` = `pt`.`company_id`
        and `po`.`product_material_id` = `pt`.`product_material_id`
        and `po`.`purchase_order_no` = `pt`.`purchase_order_no`
        and `po`.`purchase_order_version` = `pt`.`purchase_order_version`
        and `po`.`purchase_order_details_transaction_id` = `pt`.`purchase_order_details_transaction_id`))
left join `fm_cost_center` `fpc` on
    (`fpc`.`cost_center_id` = `po`.`cost_center_id`))
left join `fm_currency` `fpo` on
    (`fpo`.`currency_id` = `pt`.`currency_id`))
left join `fm_currency` `fgrn` on
    (`fgrn`.`currency_id` = `pt`.`grn_currency_id`))
where
    `pt`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
DEPARTMENT AND COST CENTER RELATED CHANGES (DONE ON QA)
-- FOR LOCAL AND LIVE

INSERT INTO fm_cost_center (company_id,company_branch_id,cost_center_group,cost_center_name,cost_center_short_name,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,'Engineering','Electrical','ENELC',1,0,'1','2024-09-13 11:16:41.000',NULL,'2024-09-13 11:16:41.000',NULL,NULL);


INSERT INTO fm_cost_center (company_id,company_branch_id,cost_center_group,cost_center_name,cost_center_short_name,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on) VALUES
	 (1,1,'Engineering','Mechanical','ENMEC',1,0,'1','2024-09-13 11:16:41.000',NULL,'2024-09-13 11:16:41.000',NULL,NULL);


UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Ginning Engineering', cost_center_name='Electrical', cost_center_short_name='EN ELC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=40;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Ginning Engineering', cost_center_name='Mechnical', cost_center_short_name='EN MEC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=41;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Oil Mill Engineering', cost_center_name='Electrical', cost_center_short_name='EN ELC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=49;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Oil Mill Engineering', cost_center_name='Mechnical', cost_center_short_name='EN MEC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=50;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Spinning Engineering', cost_center_name='Electrical', cost_center_short_name='EN ELC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=73;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Spinning Engineering', cost_center_name='Mechnical', cost_center_short_name='EN MEC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=74;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='TFO Engineering', cost_center_name='Electrical', cost_center_short_name='EN ELC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=81;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='TFO Engineering', cost_center_name='Mechnical', cost_center_short_name='EN MEC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=82;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Weaving Engineering', cost_center_name='Electrical - Sizing', cost_center_short_name='EN ELC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=93;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Weaving Engineering', cost_center_name='Mechnical - Sizing', cost_center_short_name='EN MEC', is_active=1, is_delete=1, created_by='1', created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=94;
UPDATE fm_cost_center
SET company_id=1, company_branch_id=1, cost_center_group='Weaving Engineering', cost_center_name='WEAVING ELECTRICAL', cost_center_short_name='WEA ELE', is_active=1, is_delete=1, created_by='9261707003', created_on='2024-09-13 11:16:41.000', modified_by=NULL, modified_on='2024-09-13 11:16:41.000', deleted_by=NULL, deleted_on=NULL
WHERE cost_center_id=289;

-- DEPARTMENT TABLE

UPDATE cm_department
SET cost_center_group = 'Common'
WHERE department_name IN (
    'Accounts', 'Constructions', 'COOK', 'Costing', 'Dispensary', 'Domestic',
    'Education', 'Export', 'Fire Fighting', 'Gardening', 'General', 'GENERAL',
    'General Administration', 'House Keeping', 'Human Resource Management', 'Office',
    'Payroll', 'Pentry', 'Plumbing', 'Purchase (GEN)', 'Purchase (RM)',
    'Religious Services', 'STORE', 'Times Keeping', 'Training', 'Transport'
);

UPDATE cm_department
SET cost_center_group = 'Engineering'
WHERE department_name IN ('Electrical', 'Mechanical');

UPDATE cm_department
SET cost_center_group = 'Utility'
WHERE department_name = 'Utility'

UPDATE cm_department
SET cost_center_group = 'Ginning Maintainance'
WHERE department_name = 'Ginning Maintainance'

UPDATE cm_department
SET cost_center_group = 'Ginning Production'
WHERE department_name = 'Ginning Production'

UPDATE cm_department
SET cost_center_group = 'Oil Mill-Production'
WHERE department_name = 'Oil Mill-Production'

UPDATE cm_department
SET cost_center_group = 'Spinning Maintainance'
WHERE department_name IN (
    'Blow Room/Carding',
    'Spinning Maintainance',
    'Spinning Maintainance(A/C)',
    'Spinning Maintainance(PREP)',
    'Spinning Maintainance(R/F)'
);

UPDATE cm_department
SET cost_center_group = 'Spinning Production'
WHERE department_name IN (
    'Autocorner',
    'Blowroom',
    'Breaker Draw Frame',
    'Carding',
    'Comber',
    'Finisher Draw Frame',
    'Lap Former',
    'Ring Frame (Unit I)',
    'Ring Frame (Unit II)',
    'Speed Frame',
    'Spinning-Packaging',
    'Spinning-Preparatory',
    'Spinning-Production',
    'Winding'
);


UPDATE cm_department
SET cost_center_group = 'TFO-Production'
WHERE department_name IN ('TFO-Packaging', 'TFO-Production');

UPDATE cm_department
SET cost_center_group = 'TFO Maintainance'
WHERE department_name IN ('Cheeses Winding', 'TFO Maintainance');

UPDATE cm_department
SET cost_center_group = 'Weaving Production'
WHERE department_name IN (
    'Sizing',
    'Warping',
    'Weaving',
    'Weaving Packing',
    'WEAVING PREPARATORY',
    'Weaving Production',
    'Weaving-Preparatory'
);
First is_delete = 1 for all ELECTRICAL AND MECHANICAL off GINNING OILMILL SPINNING WEAVING TFO
second = Add 2 new entries (BELOW QUERY)


UPDATE cm_department
SET company_id=0, company_branch_id=0, parent_department_id=18, department_type='S', department_name='Utility', cost_center_group='Utilities', department_short_name='ENUTL', department_group='Administration', department_head_id=1, department_subhead_id=1, department_std_staff_strength=1.00, department_std_worker_strength=1.00, worker_perday_salary=0.00, trainee_worker_perday_salary=0.00, semiskillled_worker_perday_salary=0.00, worker_perday_attendance_allowance=0.00, worker_perday_night_allowance=0.00, is_active=1, is_delete=0, created_by=NULL, created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL, department_req_std_staff_strength=1, department_req_std_worker_strength=1, general_worker=0, trainee_worker=0, semi_skilled_worker=0, skilled_worker=0, sr_semi_skilled_worker=0, helper_worker=0, godown_id=NULL, godown_section_id=NULL, godown_section_beans_id=NULL
WHERE department_id=59;


INSERT INTO cm_department (company_id,company_branch_id,parent_department_id,department_type,department_name,cost_center_group,department_short_name,department_group,department_head_id,department_subhead_id,department_std_staff_strength,department_std_worker_strength,worker_perday_salary,trainee_worker_perday_salary,semiskillled_worker_perday_salary,worker_perday_attendance_allowance,worker_perday_night_allowance,is_active,is_delete,created_by,created_on,modified_by,modified_on,deleted_by,deleted_on,department_req_std_staff_strength,department_req_std_worker_strength,general_worker,trainee_worker,semi_skilled_worker,skilled_worker,sr_semi_skilled_worker,helper_worker,godown_id,godown_section_id,godown_section_beans_id) VALUES
	 (1,1,19,'S','Blow Room/Carding','Spinning Maintenance','','Common',0,0,1.00,1.00,0.00,0.00,0.00,0.00,0.00,1,0,'9624073259','2024-11-07 15:05:34.000','9624073259','2024-11-07 15:05:34.000',NULL,NULL,1,1,0,0,0,0,0,0,NULL,NULL,NULL);


UPDATE cm_department
SET company_id=1, company_branch_id=1, parent_department_id=22, department_type='S', department_name='TFO-Packaging', cost_center_group='TFO Production', department_short_name='TFO-PKG', department_group='Production', department_head_id=1, department_subhead_id=1, department_std_staff_strength=1.00, department_std_worker_strength=1.00, worker_perday_salary=0.00, trainee_worker_perday_salary=0.00, semiskillled_worker_perday_salary=0.00, worker_perday_attendance_allowance=0.00, worker_perday_night_allowance=0.00, is_active=1, is_delete=0, created_by=NULL, created_on=NULL, modified_by=NULL, modified_on=NULL, deleted_by=NULL, deleted_on=NULL, department_req_std_staff_strength=1, department_req_std_worker_strength=1, general_worker=0, trainee_worker=0, semi_skilled_worker=0, skilled_worker=0, sr_semi_skilled_worker=0, helper_worker=0, godown_id=NULL, godown_section_id=NULL, godown_section_beans_id=NULL
WHERE department_id=92;

-------------------------------------------------------------------------------------------------------------------------------
MATERIAL REQ MIGRATION

ALTER TABLE st_indent_material_issue_master ADD product_category1_id BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE st_indent_material_issue_master ADD product_category2_id BIGINT(20) DEFAULT 0 NULL;

ALTER TABLE st_indent_material_issue_details ADD product_category1_id BIGINT(20) DEFAULT 0 NULL;
ALTER TABLE st_indent_material_issue_details ADD product_category2_id BIGINT(20) DEFAULT 0 NULL;



-- stv_indent_material_issue_summary source

create or replace
algorithm = UNDEFINED view `stv_indent_material_issue_summary` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `st`.`issue_group_type` as `issue_group_type`,
    `st`.`indent_issue_type` as `indent_issue_type`,
    `st`.`product_category1_id` as `product_category1_id`,
    `st`.`product_category2_id` as `product_category2_id`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`set_no` as `set_no`,
    `st`.`sales_type` as `sales_type`,
    `st`.`godown_issuer_id` as `godown_issuer_id`,
    `e`.`employee_name` as `godown_issuer_name`,
    case
        `st`.`issue_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        when 'A' then 'Approved'
        else 'Pending'
    end as `issue_status_desc`,
    case
        `st`.`issue_source` when 'S' then 'SO Based'
        when 'O' then 'Direct'
        else 'Internal'
    end as `indent_source_desc`,
    `vp`.`department_name` as `department_name`,
    `sd`.`department_name` as `sub_department_name`,
    `re`.`employee_name` as `requisition_by_name`,
    `ae`.`employee_name` as `approved_by_name`,
    `ie`.`employee_name` as `issued_by_name`,
    `c`.`customer_name` as `customer_name`,
    `st`.`customer_order_no` as `customer_order_no`,
    `st`.`customer_order_date` as `customer_order_date`,
    `c`.`state_name` as `customer_state_name`,
    `st`.`expected_schedule_date` as `expected_schedule_date`,
    `fm`.`cost_center_name` as `cost_center_name`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'In Active'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `v`.`company_legal_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `c`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `st`.`remark` as `remark`,
    `st`.`indent_issue_type_id` as `indent_issue_type_id`,
    `st`.`customer_id` as `customer_id`,
    `st`.`department_id` as `department_id`,
    `st`.`sub_department_id` as `sub_department_id`,
    `st`.`issued_by_id` as `issued_by_id`,
    `st`.`approved_by_id` as `approved_by_id`,
    `st`.`requisition_by_id` as `requisition_by_id`,
    `st`.`requisition_date` as `requisition_date`,
    `st`.`approved_date` as `approved_date`,
    `st`.`company_id` as `company_id`,
    `st`.`company_branch_id` as `company_branch_id`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`issue_status` as `issue_status`,
    `st`.`issue_source` as `issue_source`,
    `st`.`issue_no` as `field_name`,
    `st`.`issue_version` as `field_id`
from
    (((((((((`st_indent_material_issue_master` `st`
left join `cmv_company_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`))
left join `cm_department` `vp` on
    (`vp`.`department_id` = `st`.`department_id`))
left join `cm_department` `sd` on
    (`sd`.`department_id` = `st`.`sub_department_id`))
left join `cmv_customer_summary` `c` on
    (`c`.`customer_id` = `st`.`customer_id`))
left join `cm_employee` `re` on
    (`re`.`employee_id` = `st`.`requisition_by_id`))
left join `cm_employee` `ae` on
    (`ae`.`employee_id` = `st`.`approved_by_id`))
left join `cm_employee` `ie` on
    (`ie`.`employee_id` = `st`.`issued_by_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`godown_issuer_id`))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`))
where
    `st`.`is_delete` = 0
order by
    `st`.`issue_no`,
    `st`.`issue_version`;




-- stv_indent_material_issue_details source

create or replace
algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `st`.`product_category1_id` as `product_category1_id`,
    `st`.`product_category2_id` as `product_category2_id`,
    `v`.`department_name` as `department_name`,
    `v`.`sub_department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `v`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `rmfgsr`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rmfgsr`.`product_material_name` as `product_material_name`,
    `rmfgsr`.`actual_count` as `actual_count`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_issue_boxes` as `product_material_issue_boxes`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rmfgsr`.`product_material_name` as `product_rm_name`,
    `rmfgsr`.`product_material_drawing_no` as `product_rm_drawing_no`,
    `rmfgsr`.`product_material_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `rmfgsr`.`product_type_name` as `product_type_name`,
    `rmfgsr`.`product_material_make_name` as `product_make_name`,
    `rmfgsr`.`product_material_type_name` as `product_material_type_name`,
    `rmfgsr`.`product_material_stock_unit_name` as `product_material_unit_name`,
    `rmfgsr`.`lead_time` as `product_lead_time`,
    `ps`.`product_material_stock_quantity` as `product_material_stock_quantity`,
    `ps`.`product_material_stock_weight` as `product_material_stock_weight`,
    `ps`.`reserve_quantity` as `reserve_quantity`,
    `ps`.`reserve_weight` as `reserve_weight`,
    ifnull(`sd`.`closing_balance_quantity`, 0) as `closing_balance_quantity`,
    ifnull(`sd`.`closing_balance_weight`, 0) as `closing_balance_weight`,
    ifnull(`st`.`cone_per_wt`, 0) as `cone_per_wt`,
    ifnull(`sd`.`closing_no_of_boxes`, 0) as `closing_no_of_boxes`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `v`.`customer_state_name` as `customer_state_name`,
    `v`.`cust_branch_gst_no` as `cust_branch_gst_no`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `fmp`.`profit_center_name` as `profit_center_name`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `st`.`routing_code` as `routing_code`,
    `v`.`company_name` as `company_name`,
    `v`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`goods_receipt_no` as `goods_receipt_no`,
    `st`.`profit_center_id` as `profit_center_id`,
    `st`.`creel_no` as `creel_no`,
    `st`.`set_no` as `set_no`,
    `sd`.`supplier_id` as `supplier_id`,
    `st`.`issue_requisition_type` as `issue_requisition_type`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'Inactive'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmfgsr`.`product_material_type_id` as `product_material_type_id`,
    `rmfgsr`.`product_material_grade_id` as `product_material_grade_id`,
    `rmfgsr`.`product_material_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `v`.`issue_no` as `field_name`,
    `v`.`issue_version` as `field_id`
from
    ((((((((((`st_indent_material_issue_details` `st`
join `stv_indent_material_issue_summary` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `smv_product_rm_fg_sr` `rmfgsr` on
    (`rmfgsr`.`product_material_id` = `st`.`product_material_id`))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `st`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `st`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`
        and `fm`.`is_delete` = 0))
left join `fm_profit_center` `fmp` on
    (`fmp`.`profit_center_id` = `st`.`profit_center_id`
        and `fmp`.`is_delete` = 0
        and `fmp`.`is_active` = 1))
left join (
    select
        `sm_product_rm_stock_summary`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_summary`.`company_id` as `company_id`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_quantity`) as `product_material_stock_quantity`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_weight`) as `product_material_stock_weight`,
        sum(`sm_product_rm_stock_summary`.`reserve_quantity`) as `reserve_quantity`,
        sum(`sm_product_rm_stock_summary`.`reserve_weight`) as `reserve_weight`
    from
        `sm_product_rm_stock_summary`
    group by
        `sm_product_rm_stock_summary`.`product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id`,
        `sm_product_rm_stock_summary`.`company_id`) `ps` on
    (`ps`.`product_rm_id` = `st`.`product_material_id`
        and `ps`.`godown_id` = `st`.`godown_id`
        and `ps`.`company_id` = `st`.`company_id`))
left join (
    select
        `sm_product_rm_stock_details`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_details`.`batch_no` as `batch_no`,
        `sm_product_rm_stock_details`.`day_closed` as `day_closed`,
        `sm_product_rm_stock_details`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_details`.`godown_section_id` as `godown_section_id`,
        `sm_product_rm_stock_details`.`godown_section_beans_id` as `godown_section_beans_id`,
        `sm_product_rm_stock_details`.`supplier_id` as `supplier_id`,
        sum(`sm_product_rm_stock_details`.`closing_no_of_boxes`) as `closing_no_of_boxes`,
        sum(`sm_product_rm_stock_details`.`closing_balance_quantity`) as `closing_balance_quantity`,
        sum(`sm_product_rm_stock_details`.`closing_balance_weight`) as `closing_balance_weight`
    from
        `sm_product_rm_stock_details`
    where
        `sm_product_rm_stock_details`.`day_closed` = 0
        and `sm_product_rm_stock_details`.`is_delete` = 0
    group by
        `sm_product_rm_stock_details`.`company_id`,
        `sm_product_rm_stock_details`.`product_rm_id`,
        `sm_product_rm_stock_details`.`batch_no`,
        `sm_product_rm_stock_details`.`godown_id`,
        `sm_product_rm_stock_details`.`godown_section_id`,
        `sm_product_rm_stock_details`.`godown_section_beans_id`) `sd` on
    (`sd`.`product_rm_id` = `st`.`product_material_id`
        and `sd`.`batch_no` = `st`.`issue_batch_no`
        and `sd`.`godown_id` = `st`.`godown_id`
        and `sd`.`godown_section_id` = `st`.`godown_section_id`
        and `sd`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;

-------------------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE `GenerateIssueReportSummary`(
    IN from_date DATE,
    IN to_date DATE,
    IN company_id INT,
    in costCenterId VARCHAR(10),
    in productTypeId varchar(10),
    in PageCurrent INT,
    in entriesPerPage INT
)
begin



	 IF PageCurrent < 0 THEN
        SET PageCurrent = 0;
    END IF;

    IF entriesPerPage <= 0 THEN
        SET entriesPerPage = 1000;
    END IF;




    select
--     	`md`.department_name as department_name,
		`sd`.department_name as sub_department_name,
        `pc`.profit_center_short_name AS profit_center_short_name,
        `pc`.profit_center_name AS profit_center_name,
        `cc`.cost_center_name AS cost_center_name,
        `ct`.`product_category1_name` AS `product_category1_name`,
        `ct2`.`product_category2_name` as `product_category2_name`,
        SUM(`id`.`product_material_issue_quantity`) AS `total_issue_quantity`,
        SUM(`id`.`product_material_issue_quantity` * `id`.`material_batch_rate`) / SUM(`id`.`product_material_issue_quantity`) AS `average_batch_rate`,
        SUM(`id`.`product_material_issue_quantity` * `id`.`material_batch_rate`) AS total_material_value,
        `id`.`company_id` AS company_id
    FROM
        `st_indent_material_issue_details` AS `id`

  	left join
	`st_indent_material_issue_master` as `im`
    on
	`im`.`issue_no` = `id`.`issue_no`
-- 	left join
--         `cm_department` as `md`
--     on
-- 	`md`.`department_id` = `im`.`department_id`

	left join
        `cm_department` as `sd`
    on
	`sd`.`department_id` = `im`.`sub_department_id`


    LEFT JOIN
        `sm_product_rm` AS `rm`
        ON `rm`.`product_rm_id` = `id`.`product_material_id`

   left join
        `sm_product_rm_technical` as `rt`
    on
	`rt`.`product_rm_id` = `id`.`product_material_id`

	left join
        `sm_product_category2` as `ct2`
    on
	`ct2`.`product_category2_id` = `rt`.`product_category2_id`

    LEFT JOIN
        `sm_product_category1` AS `ct`
        ON `ct`.`product_category1_id` = `rm`.`product_category1_id`
    LEFT JOIN
        `sm_product_unit` AS `u`
        ON `u`.`product_unit_id` = `id`.`product_material_unit_id`
    LEFT JOIN
        `fm_cost_center` AS `cc`
        ON `cc`.`cost_center_id` = `id`.`cost_center_id`
    LEFT JOIN
        `fm_profit_center` AS `pc`
        ON `pc`.`profit_center_id` = `id`.`profit_center_id`
    WHERE
        `id`.`issue_date` BETWEEN from_date AND to_date
        AND `id`.`issue_item_status` = 'MI'
        AND `id`.`company_id` = company_id
        and (costCenterId = 'All' OR `id`.`cost_center_id` = costCenterId)
        and (productTypeId = 'All' OR `im`.`indent_issue_type_id` = productTypeId)
    GROUP BY
        `sd`.department_name,`cc`.`cost_center_name`, `ct`.`product_category1_name`,`ct2`.`product_category2_name`
    ORDER BY
        `cc`.`cost_center_name` ASC, `ct`.`product_category1_name` ASC
    LIMIT PageCurrent, entriesPerPage;
END
-------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE
ALGORITHM = UNDEFINED VIEW `stv_raw_material_issue_summary_rpt` AS
select
    concat(ifnull(`v`.`issue_group_type`, ''), ':Issue Group Type:Y:P:IssueGroupTypes') AS `issue_group_type`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:Y:C:stv_indent_material_issue_summary:O') AS `issue_no`,
    concat(ifnull(`v`.`issue_date`, ''), ':Issue Date:Y:D:') AS `issue_date`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version:O:N:') AS `issue_version`,
    concat(ifnull(`v`.`issue_status_desc`, ''), ':Issue Status:Y:H:(Material Issue,Completed,Partial Issue,Accepted,Approved,Pending)') AS `issue_status_desc`,
    concat(ifnull(`v`.`set_no`, ''), ':Set No :O:N:') AS `set_no`,
	concat(ifnull(`v`.`sales_type`, ''), ':Sales Type :O:N:') AS `sales_type`,
    concat(ifnull(`v`.`indent_source_desc`, ''), ':Issue Source:Y:H:(SO Based,Direct,Indent Based,)') AS `indent_source_desc`,
    concat(ifnull(`v`.`requisition_by_name`, ''), ':Requisition By Name:Y:C:cmv_employee:F') AS `requisition_by_name`,
    concat(ifnull(`v`.`requisition_date`, ''), ':Requisition Date:Y:D:') AS `requisition_date`,
    concat(ifnull(`v`.`approved_by_name`, ''), ':Approved By Name:Y:C:cmv_employee:F') AS `approved_by_name`,
    concat(ifnull(`v`.`approved_date`, ''), ':Approved Date:Y:D:') AS `approved_date`,
    concat(ifnull(`v`.`issued_by_name`, ''), ':Issue By Name:Y:C:cmv_employee:F') AS `issued_by_name`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') AS `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') AS `sub_department_name`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') AS `expected_schedule_date`,
    concat(ifnull(`v`.`remark`, ''), ':Remark:O:N:') AS `remark`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:C:cmv_customer:F') AS `customer_name`,
    concat(ifnull(`v`.`customer_state_name`, ''), ':Customer State Name:O:N:') AS `customer_state_name`,
    concat(ifnull(`v`.`cust_branch_gst_no`, ''), ':Customer Branch Gst No:O:N:') AS `cust_branch_gst_no`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') AS `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch') AS `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') AS `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') AS `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') AS `Deleted`,
    concat(ifnull(`v`.`issue_status`, ''), ':Issue Status:O:N:') AS `issue_status`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') AS `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') AS `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') AS `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') AS `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') AS `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') AS `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') AS `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') AS `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') AS `department_id`,
    concat(ifnull(`v`.`issue_master_transaction_id`, ''), ':Issue Master Transaction_Id:O:N:') AS `issue_master_transaction_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') AS `issued_by_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') AS `customer_id`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:N:N:') AS `field_name`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version Id:N:N:') AS `field_id`
from
    `stv_indent_material_issue_summary` `v`
limit 1;
-------------------------------------------------------------------------------------------------------------------------------



CREATE TABLE `st_material_issue_batch_wise` (
  `material_issue_batch_wise_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '*read only back end auto generated*',
  `company_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session*',
  `company_branch_id` bigint(20) NOT NULL DEFAULT 1 COMMENT '*backend from session*',
  `transaction_no` varchar(50) NOT NULL,
  `transaction_date` date NOT NULL,
  `set_no` varchar(100) DEFAULT NULL,
  `goods_receipt_no` varchar(50) NOT NULL,
  `batch_no` varchar(100) DEFAULT NULL,
  `indent_no` varchar(255) DEFAULT NULL,
  `supplier_id` bigint(20) NOT NULL,
  `product_material_id` varchar(20) NOT NULL,
  `cone_per_wt` decimal(18,4) DEFAULT 0.0000,
  `requisition_no_boxes` decimal(18,4) DEFAULT 0.0000,
  `requisition_quantity` bigint(20) NOT NULL,
  `requisition_weight` decimal(18,4) DEFAULT 0.0000,
  `issue_no_boxes` decimal(18,4) DEFAULT 0.0000,
  `issue_quantity` bigint(20) NOT NULL,
  `issue_weight` decimal(18,4) DEFAULT 0.0000,
  `product_material_unit_id` bigint(20) DEFAULT NULL,
  `godown_id` bigint(20) NOT NULL DEFAULT 2 COMMENT '* NO Front End Only  Back End Entry Data will come from respective transaction will updated on transaction to transaction  level  *',
  `godown_section_id` bigint(20) DEFAULT 2 COMMENT '* NO Front End Only  Back End Entry Data will come from respective transaction will updated on transaction to transaction  level  *',
  `godown_section_beans_id` bigint(20) DEFAULT 2 COMMENT '* NO Front End Only  Back End Entry Data will come from respective transaction will updated on transaction to transaction  level  *',
  `issue_status` varchar(2) DEFAULT 'P' COMMENT 'P-Pending, C-Completed, I- Partial Issue, MI- Material Issued',
  `issue_requisition_type` varchar(2) DEFAULT 'M',
  `remark` varchar(255) DEFAULT NULL,
  `is_delete` bit(1) DEFAULT b'0',
  `created_by` varchar(255) DEFAULT '1',
  `created_on` datetime DEFAULT NULL,
  `modified_by` varchar(255) DEFAULT NULL,
  `modified_on` datetime DEFAULT NULL,
  `deleted_by` varchar(255) DEFAULT NULL,
  `deleted_on` datetime DEFAULT null,
  PRIMARY KEY (`material_issue_batch_wise_id`)
);



ALTER TABLE st_material_issue_batch_wise ADD department_id BIGINT(20) DEFAULT 0 NULL COMMENT 'department whome issued';
ALTER TABLE st_material_issue_batch_wise CHANGE department_id department_id BIGINT(20) DEFAULT 0 NULL COMMENT 'department whome issued' AFTER issue_status;
ALTER TABLE st_material_issue_batch_wise ADD sub_department_id BIGINT(20) DEFAULT 0 NULL COMMENT 'subdepartment to whome issued';
ALTER TABLE st_material_issue_batch_wise CHANGE sub_department_id sub_department_id BIGINT(20) DEFAULT 0 NULL COMMENT 'subdepartment to whome issued' AFTER department_id;


-------------------------------------------------------------------------------------------------------------------------------
INSERT INTO st_material_issue_batch_wise (
    company_id,
    company_branch_id,
    financial_year,
    transaction_no,
    transaction_date,
    set_no,
    goods_receipt_no,
    batch_no,
    indent_no,
    supplier_id,
    product_material_id,
    cone_per_wt,
    requisition_no_boxes,
    requisition_quantity,
    requisition_weight,
    issue_no_boxes,
    issue_quantity,
    issue_weight,
    product_material_unit_id,
    godown_id,
    godown_section_id,
    godown_section_beans_id,
    issue_status,
    department_id,
    sub_department_id,
    issue_requisition_type,
    remark,
    created_by,
    created_on
  )
  SELECT
    d.company_id,
    d.company_branch_id,
    d.financial_year,
    d.issue_no AS transaction_no,
    d.issue_date AS transaction_date,
    d.set_no,
    d.goods_receipt_no,
    d.issue_batch_no AS batch_no,
    d.indent_no,
    0 AS supplier_id,
    d.product_material_id,
    d.cone_per_wt,
    d.product_material_issue_boxes AS requisition_no_boxes,
    d.product_material_issue_quantity AS requisition_quantity,
    d.product_material_issue_weight AS requisition_weight,
    d.product_material_issue_boxes AS issue_no_boxes,
    d.product_material_issue_quantity AS issue_quantity,
    d.product_material_issue_weight AS issue_weight,
    d.product_material_unit_id,
    CAST(d.godown_id AS UNSIGNED),
    CAST(d.godown_section_id AS UNSIGNED),
    CAST(d.godown_section_beans_id AS UNSIGNED),
    d.issue_item_status as issue_status,
    COALESCE(m.department_id, 0),
    COALESCE(m.sub_department_id, 0),
    d.issue_requisition_type,
    d.issue_remark,
    d.created_by,
    d.created_on
  FROM st_indent_material_issue_details d
  JOIN st_indent_material_issue_master m
    ON d.issue_master_transaction_id = m.issue_master_transaction_id
  WHERE
    d.is_delete = 0
    AND d.issue_item_status IN ('MI', 'I')
   and m.indent_issue_type_id = 12;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details source

create or REPLACE algorithm = UNDEFINED view `stv_indent_material_issue_details` as
select
    `st`.`issue_no` as `issue_no`,
    `st`.`issue_date` as `issue_date`,
    `st`.`issue_version` as `issue_version`,
    `st`.`product_category1_id` as `product_category1_id`,
    `st`.`product_category2_id` as `product_category2_id`,
    `dp`.`department_name` as `department_name`,
    `sdp`.`department_name` as `sub_department_name`,
    case
        `st`.`issue_item_status` when 'MI' then 'Material Issue'
        when 'C' then 'Completed'
        when 'I' then 'Partial Issue'
        when 'AC' then 'Accepted'
        else 'Pending'
    end as `issue_item_status_desc`,
    `e`.`employee_name` as `indented_by_name`,
    `cu`.`customer_name` as `customer_name`,
    `v`.`expected_schedule_date` as `expected_schedule_date`,
    `st`.`customer_order_no` as `customer_order_no`,
    `pdt`.`product_type_group` as `product_type_group`,
    `st`.`product_material_id` as `product_material_id`,
    `rm`.`product_rm_code` as `product_material_code`,
    `rm`.`product_rm_name` as `product_material_name`,
    `rm`.`actual_count` as `actual_count`,
    `st`.`product_material_indent_quantity` as `product_material_indent_quantity`,
    `st`.`product_material_indent_weight` as `product_material_indent_weight`,
    `st`.`product_material_issue_quantity` as `product_material_issue_quantity`,
    `st`.`product_material_issue_weight` as `product_material_issue_weight`,
    `st`.`product_material_issue_boxes` as `product_material_issue_boxes`,
    `st`.`product_material_receipt_quantity` as `product_material_receipt_quantity`,
    `st`.`product_material_receipt_weight` as `product_material_receipt_weight`,
    `rm`.`product_rm_name` as `product_rm_name`,
    `rm`.`product_rm_drawing_no` as `product_rm_drawing_no`,
    `rm`.`product_rm_tech_spect` as `product_rm_tech_spect`,
    `st`.`product_material_issue_return_quantity` as `product_material_issue_return_quantity`,
    `pdt`.`product_type_name` as `product_type_name`,
    `u`.`product_unit_name` as `product_material_unit_name`,
    `rmc`.`lead_time` as `product_lead_time`,
    `ps`.`product_material_stock_quantity` as `product_material_stock_quantity`,
    `ps`.`product_material_stock_weight` as `product_material_stock_weight`,
    `ps`.`reserve_quantity` as `reserve_quantity`,
    `ps`.`reserve_weight` as `reserve_weight`,
    ifnull(`sd`.`closing_balance_quantity`, 0) as `closing_balance_quantity`,
    ifnull(`sd`.`closing_balance_weight`, 0) as `closing_balance_weight`,
    ifnull(`st`.`cone_per_wt`, 0) as `cone_per_wt`,
    ifnull(`sd`.`closing_no_of_boxes`, 0) as `closing_no_of_boxes`,
    `st`.`product_material_approved_quantity` as `product_material_approved_quantity`,
    `st`.`product_material_approved_weight` as `product_material_approved_weight`,
    `st`.`product_material_rejected_quantity` as `product_material_rejected_quantity`,
    `st`.`product_material_rejected_weight` as `product_material_rejected_weight`,
    `st`.`product_material_issue_return_weight` as `product_material_issue_return_weight`,
    `st`.`product_std_weight` as `product_std_weight`,
    `st`.`indent_no` as `indent_no`,
    `st`.`indent_date` as `indent_date`,
    `st`.`indent_version` as `indent_version`,
    `st`.`issue_item_status` as `issue_item_status`,
    `st`.`issue_batch_no` as `issue_batch_no`,
    `st`.`material_batch_rate` as `material_batch_rate`,
    `st`.`product_material_issue_quantity` * `st`.`material_batch_rate` as `material_issue_amount`,
    `fmp`.`profit_center_name` as `profit_center_name`,
    `fm`.`cost_center_name` as `cost_center_name`,
    `st`.`routing_code` as `routing_code`,
    `c`.`company_legal_name` as `company_name`,
    `cb`.`company_branch_name` as `company_branch_name`,
    `st`.`financial_year` as `financial_year`,
    `st`.`issue_remark` as `issue_remark`,
    `gd`.`godown_name` as `godown_name`,
    `gds`.`godown_section_name` as `godown_section_name`,
    `gdsb`.`godown_section_beans_name` as `godown_section_beans_name`,
    `st`.`godown_id` as `godown_id`,
    `st`.`godown_section_id` as `godown_section_id`,
    `st`.`godown_section_beans_id` as `godown_section_beans_id`,
    `st`.`cost_center_id` as `cost_center_id`,
    `st`.`goods_receipt_no` as `goods_receipt_no`,
    `st`.`profit_center_id` as `profit_center_id`,
    `st`.`creel_no` as `creel_no`,
    `st`.`set_no` as `set_no`,
    `sd`.`supplier_id` as `supplier_id`,
    `st`.`issue_requisition_type` as `issue_requisition_type`,
    case
        when `st`.`is_active` = 1 then 'Active'
        else 'Inactive'
    end as `Active`,
    case
        when `st`.`is_delete` = 1 then 'Yes'
        else 'No'
    end as `Deleted`,
    `st`.`is_active` as `is_active`,
    `st`.`is_delete` as `is_delete`,
    `st`.`created_by` as `created_by`,
    `st`.`created_on` as `created_on`,
    `st`.`modified_by` as `modified_by`,
    `st`.`modified_on` as `modified_on`,
    `st`.`deleted_by` as `deleted_by`,
    `st`.`deleted_on` as `deleted_on`,
    `v`.`customer_id` as `customer_id`,
    `v`.`department_id` as `department_id`,
    `st`.`indented_by_id` as `indented_by_id`,
    `v`.`issued_by_id` as `issued_by_id`,
    `v`.`company_id` as `company_id`,
    `v`.`company_branch_id` as `company_branch_id`,
    `v`.`indent_issue_type_id` as `product_type_id`,
    `rmt`.`product_material_type_id` as `product_material_type_id`,
    `rmt`.`product_material_grade_id` as `product_material_grade_id`,
    `rm`.`product_rm_packing_id` as `product_material_packing_id`,
    `st`.`product_material_unit_id` as `product_material_unit_id`,
    `st`.`issue_details_transaction_id` as `issue_details_transaction_id`,
    `st`.`issue_master_transaction_id` as `issue_master_transaction_id`,
    `st`.`indent_details_id` as `indent_details_id`,
    `v`.`sub_department_id` as `sub_department_id`,
    `st`.`issue_no` as `field_name`,
    `st`.`issue_version` as `field_id`
from
    (((((((((((((((((((`st_indent_material_issue_details` `st`
left join `cm_company` `c` on
    (`c`.`company_id` = `st`.`company_id`
        and `st`.`is_delete` = 0))
left join `cm_company_branch` `cb` on
    (`cb`.`company_branch_id` = `st`.`company_branch_id`
        and `cb`.`company_id` = `st`.`company_id`
        and `st`.`is_delete` = 0))
join `st_indent_material_issue_master` `v` on
    (`v`.`company_branch_id` = `st`.`company_branch_id`
        and `v`.`company_id` = `st`.`company_id`
        and `v`.`issue_master_transaction_id` = `st`.`issue_master_transaction_id`
        and `v`.`is_delete` = 0))
left join `cm_customer` `cu` on
    (`cu`.`customer_id` = `v`.`customer_id`
        and `v`.`is_delete` = 0))
left join `cm_department` `dp` on
    (`dp`.`department_id` = `v`.`department_id`))
left join `cm_department` `sdp` on
    (`sdp`.`department_id` = `v`.`sub_department_id`))
left join `sm_product_rm` `rm` on
    (`rm`.`product_rm_id` = `st`.`product_material_id`
        and `rm`.`is_delete` = 0))
left join `sm_product_unit` `u` on
    (`u`.`product_unit_id` = `st`.`product_material_unit_id`
        and `st`.`is_delete` = 0))
left join `sm_product_rm_commercial` `rmc` on
    (`rmc`.`is_delete` = 0
        and `rmc`.`product_rm_id` = `st`.`product_material_id`
        and `rmc`.`is_delete` = 0))
left join `sm_product_rm_technical` `rmt` on
    (`rmt`.`product_rm_id` = `st`.`product_material_id`
        and `rmt`.`is_delete` = 0))
left join `sm_product_type` `pdt` on
    (`pdt`.`product_type_id` = `v`.`indent_issue_type_id`
        and `pdt`.`is_delete` = 0))
left join `cm_employee` `e` on
    (`e`.`employee_id` = `st`.`indented_by_id`
        and `e`.`is_delete` = 0))
left join `cm_godown` `gd` on
    (`gd`.`godown_id` = `st`.`godown_id`
        and `gd`.`is_delete` = 0))
left join `cm_godown_section` `gds` on
    (`gds`.`godown_section_id` = `st`.`godown_section_id`
        and `gds`.`is_delete` = 0))
left join `cm_godown_section_beans` `gdsb` on
    (`gdsb`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
        and `gdsb`.`is_delete` = 0))
left join `fm_cost_center` `fm` on
    (`fm`.`cost_center_id` = `st`.`cost_center_id`
        and `fm`.`is_delete` = 0))
left join `fm_profit_center` `fmp` on
    (`fmp`.`profit_center_id` = `st`.`profit_center_id`
        and `fmp`.`is_delete` = 0
        and `fmp`.`is_active` = 1))
left join (
    select
        `sm_product_rm_stock_summary`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_summary`.`company_id` as `company_id`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_quantity`) as `product_material_stock_quantity`,
        sum(`sm_product_rm_stock_summary`.`closing_balance_weight`) as `product_material_stock_weight`,
        sum(`sm_product_rm_stock_summary`.`reserve_quantity`) as `reserve_quantity`,
        sum(`sm_product_rm_stock_summary`.`reserve_weight`) as `reserve_weight`
    from
        `sm_product_rm_stock_summary`
    group by
        `sm_product_rm_stock_summary`.`product_rm_id`,
        `sm_product_rm_stock_summary`.`godown_id`,
        `sm_product_rm_stock_summary`.`company_id`) `ps` on
    (`ps`.`product_rm_id` = `st`.`product_material_id`
        and `ps`.`godown_id` = `st`.`godown_id`
        and `ps`.`company_id` = `st`.`company_id`))
left join (
    select
        `sm_product_rm_stock_details`.`product_rm_id` as `product_rm_id`,
        `sm_product_rm_stock_details`.`batch_no` as `batch_no`,
        `sm_product_rm_stock_details`.`day_closed` as `day_closed`,
        `sm_product_rm_stock_details`.`godown_id` as `godown_id`,
        `sm_product_rm_stock_details`.`godown_section_id` as `godown_section_id`,
        `sm_product_rm_stock_details`.`godown_section_beans_id` as `godown_section_beans_id`,
        `sm_product_rm_stock_details`.`supplier_id` as `supplier_id`,
        sum(`sm_product_rm_stock_details`.`closing_no_of_boxes`) as `closing_no_of_boxes`,
        sum(`sm_product_rm_stock_details`.`closing_balance_quantity`) as `closing_balance_quantity`,
        sum(`sm_product_rm_stock_details`.`closing_balance_weight`) as `closing_balance_weight`
    from
        `sm_product_rm_stock_details`
    where
        `sm_product_rm_stock_details`.`day_closed` = 0
        and `sm_product_rm_stock_details`.`is_delete` = 0
    group by
        `sm_product_rm_stock_details`.`company_id`,
        `sm_product_rm_stock_details`.`product_rm_id`,
        `sm_product_rm_stock_details`.`batch_no`,
        `sm_product_rm_stock_details`.`godown_id`,
        `sm_product_rm_stock_details`.`godown_section_id`,
        `sm_product_rm_stock_details`.`godown_section_beans_id`) `sd` on
    (`sd`.`product_rm_id` = `st`.`product_material_id`
        and `sd`.`batch_no` = `st`.`issue_batch_no`
        and `sd`.`godown_id` = `st`.`godown_id`
        and `sd`.`godown_section_id` = `st`.`godown_section_id`
        and `sd`.`godown_section_beans_id` = `st`.`godown_section_beans_id`))
where
    `st`.`is_delete` = 0;
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-- stv_indent_material_issue_details_rpt source

create or REPLACE algorithm = UNDEFINED view `stv_indent_material_issue_details_rpt` as
select
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:Y:T') as `issue_no`,
    concat(ifnull(`v`.`issue_date`, ''), ':Issue Date:Y:D:') as `issue_date`, 
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version:O:N:') as `issue_version`,
    concat(ifnull(`v`.`department_name`, ''), ':Department Name:Y:C:cmv_department:F') as `department_name`,
    concat(ifnull(`v`.`sub_department_name`, ''), ':Sub Department Name:Y:C:cmv_department:F') as `sub_department_name`,
    concat(ifnull(`v`.`product_material_name`, ''), ':Material Name:Y:T:') as `product_material_name`,
    concat(ifnull(`v`.`godown_name`, ''), ':Godown Name:O:N:') as `godown_name`,
    concat(ifnull(`v`.`godown_section_name`, ''), ':Godown Section Name:O:N:') as `godown_section_name`,
    concat(ifnull(`v`.`godown_section_beans_name`, ''), ':Godown Section Beans Name:O:N:') as `godown_section_beans_name`,
    concat(ifnull(`v`.`issue_item_status_desc`, ''), ':Issue Status:Y:H:(Pending,Completed)') as `issue_item_status_desc`,
    concat(ifnull(`v`.`product_material_indent_quantity`, ''), ':Material Requisition Quantity:O:N:') as `product_material_indent_quantity`,
    concat(ifnull(`v`.`product_material_indent_weight`, ''), ':Material Requisition Weight:O:N:') as `product_material_indent_weight`,
    concat(ifnull(`v`.`product_material_approved_quantity`, ''), ':Material Approved Quantity:O:N:') as `product_material_approved_quantity`,
    concat(ifnull(`v`.`product_material_approved_weight`, ''), ':Material Approved Weight:O:N:') as `product_material_approved_weight`,
    concat(ifnull(`v`.`product_material_rejected_quantity`, ''), ':Material Rejected Quantity:O:N:') as `product_material_rejected_quantity`,
    concat(ifnull(`v`.`product_material_rejected_weight`, ''), ':Material Rejected Weight:O:N:') as `product_material_rejected_weight`,
    concat(ifnull(`v`.`product_material_issue_quantity`, ''), ':Material Issue Quantity:O:N:') as `product_material_issue_quantity`,
    concat(ifnull(`v`.`product_material_issue_weight`, ''), ':Material Issue Weight:O:N:') as `product_material_issue_weight`,
    concat(ifnull(`v`.`product_material_issue_return_quantity`, ''), ':Material Issue Return Quantity:O:N:') as `product_material_issue_return_quantity`,
    concat(ifnull(`v`.`product_material_issue_return_weight`, ''), ':Material Return Weight:O:N:)') as `product_material_issue_return_weight`,
    concat(ifnull(`v`.`product_material_receipt_quantity`, ''), ':Material Receipt Quantity:O:N:)') as `product_material_receipt_quantity`,
    concat(ifnull(`v`.`product_material_receipt_weight`, ''), ':Material Receipt Weight:O:N:)') as `product_material_receipt_weight`,
    concat(ifnull(`v`.`material_batch_rate`, ''), ':Material Rate:Y:T:') as `material_batch_rate`,
    concat(ifnull(`v`.`material_issue_amount`, ''), ':Material Issue Amount:Y:T:') as `material_issue_amount`,
    concat(ifnull(`v`.`indent_no`, ''), ':Indent No:Y:C:stv_indent_master_summary:F') as `indent_no`,
    concat(ifnull(`v`.`indented_by_name`, ''), ':Indented By Name:Y:C:cmv_employee_list:F') as `indented_by_name`,
    concat(ifnull(`v`.`customer_name`, ''), ':Customer Name:O:C:cmv_customer:F') as `customer_name`,
    concat(ifnull(`v`.`customer_order_no`, ''), ':Customer Order No:O:N:') as `customer_order_no`,
    concat(ifnull(`v`.`expected_schedule_date`, ''), ':Expected Schedule Date:Y:D:') as `expected_schedule_date`,
    concat(ifnull(`v`.`issue_remark`, ''), ':Remark:O:N:') as `issue_remark`,
    concat(ifnull(`v`.`issue_batch_no`, ''), ':Issue Batch No.:Y:T:') as `issue_batch_no`,
    concat(ifnull(`v`.`company_name`, ''), ':Company Name:Y:C:cmv_company:F') as `company_name`,
    concat(ifnull(`v`.`company_branch_name`, ''), ':Company Branch Name:Y:C:cmv_company_branch') as `company_branch_name`,
    concat(ifnull(`v`.`financial_year`, ''), ':Financial Year:Y:C:amv_financial_year:F') as `financial_year`,
    concat(case when `v`.`is_active` = 1 then 'Active' else 'In Active' end, ':Active Status:Y:H:(Active,In Active)') as `Active`,
    concat(case when `v`.`is_delete` = 1 then 'Yes' else 'No' end, ':Deleted Status:Y:H:(Yes,No)') as `Deleted`,
    concat(ifnull(`v`.`created_by`, ''), ':Created By:O:N:') as `created_by`,
    concat(ifnull(`v`.`created_on`, ''), ':Created On:O:N:') as `created_on`,
    concat(ifnull(`v`.`modified_by`, ''), ':Modified By:O:N:') as `modified_by`,
    concat(ifnull(`v`.`modified_on`, ''), ':Modified On:O:N:') as `modified_on`,
    concat(ifnull(`v`.`deleted_by`, ''), ':Deleted By:O:N:') as `deleted_by`,
    concat(ifnull(`v`.`deleted_on`, ''), ':Deleted On:O:N:') as `deleted_on`,
    concat(ifnull(`v`.`company_id`, ''), ':Company Id:N:N:') as `company_id`,
    concat(ifnull(`v`.`company_branch_id`, ''), ':Company Branch Id:N:N:') as `company_branch_id`,
    concat(ifnull(`v`.`department_id`, ''), ':Department Id:N:N:') as `department_id`,
    concat(ifnull(`v`.`issue_master_transaction_id`, ''), ':Issue Master Transaction_Id:O:N:') as `issue_master_transaction_id`,
    concat(ifnull(`v`.`issue_details_transaction_id`, ''), ':Issue Details Transaction_Id:O:N:') as `issue_details_transaction_id`,
    concat(ifnull(`v`.`indented_by_id`, ''), ':Indented By Id Id:N:N:') as `indented_by_id`,
    concat(ifnull(`v`.`issued_by_id`, ''), ':Issued By Id:N:N:') as `issued_by_id`,
    concat(ifnull(`v`.`customer_id`, ''), ':Customer Id:N:N:') as `customer_id`,
    concat(ifnull(`v`.`product_material_id`, ''), ':Product Material Id:N:N:') as `product_material_id`,
    concat(ifnull(`v`.`product_material_unit_id`, ''), ':Product Material Id:N:N:') as `product_material_unit_id`,
    concat(ifnull(`v`.`godown_id`, ''), ':Godown Id:N:N:') as `godown_id`,
    concat(ifnull(`v`.`godown_section_id`, ''), ':Godown Section Id:N:N:') as `godown_section_id`,
    concat(ifnull(`v`.`godown_section_beans_id`, ''), ':Godown Section Beans Id:N:N:') as `godown_section_beans_id`,
    concat(ifnull(`v`.`issue_no`, ''), ':Issue No:N:N:') as `field_name`,
    concat(ifnull(`v`.`issue_version`, ''), ':Issue Version Id:N:N:') as `field_id`
from
    `stv_indent_material_issue_details` `v`
limit 1;

-------------------------------------------------------------------------------------------------------------------------------

UPDATE st_indent_material_issue_return_details d
LEFT JOIN st_indent_material_issue_return_master m
    ON m.issue_return_master_transaction_id = d.issue_return_master_transaction_id
SET d.issue_return_no = m.issue_return_no
WHERE d.is_delete = 0;




UPDATE sm_product_rm_stock_details
SET goods_receipt_no = LEFT(goods_receipt_no, LENGTH(goods_receipt_no) - 1)
WHERE goods_receipt_no LIKE '%-';



UPDATE st_indent_material_issue_details
SET goods_receipt_no = LEFT(goods_receipt_no, LENGTH(goods_receipt_no) - 1)
WHERE goods_receipt_no LIKE '%-';

-------------------------------------------------------------------------------------------------------------------------------

INSERT INTO st_material_issue_batch_wise (
    company_id,
    company_branch_id,
    financial_year,
    transaction_no,
    transaction_date,
    set_no,
    goods_receipt_no,
    batch_no,
    indent_no,
    supplier_id,
    product_material_id,
    cone_per_wt,
    requisition_no_boxes,
    requisition_quantity,
    requisition_weight,
    issue_no_boxes,
    issue_quantity,
    issue_weight,
    product_material_unit_id,
    godown_id,
    godown_section_id,
    godown_section_beans_id,
    issue_status,
    department_id,
    sub_department_id,
    issue_requisition_type,
    remark,
    created_by,
    created_on
  )
  SELECT
    d.company_id,
    d.company_branch_id,
    d.financial_year,
    d.issue_return_no AS transaction_no,
    m.issue_return_date AS transaction_date,
--     d.set_no,
    d.goods_receipt_no,
    d.issue_batch_no AS batch_no,
    '' as indent_no,
    d.supplier_id AS supplier_id,
    d.product_material_id,
    d.cone_per_wt,
    0 AS requisition_no_boxes,
    0 AS requisition_quantity,
    0 AS requisition_weight,
    0 AS issue_no_boxes,
    0 AS issue_quantity,
    0 AS issue_weight,

    d.product_material_receipt_boxes AS return_boxes,
    d.product_material_receipt_quantity AS return_qantity,
    d.product_material_receipt_weight AS return_weight,
    d.product_material_receipt_boxes AS receipt_boxes,
    d.product_material_receipt_quantity AS receipt_quantity,
    d.product_material_receipt_weight AS receipt_weight,
    d.product_material_unit_id,
    CAST(d.godown_id AS UNSIGNED),
    CAST(d.godown_section_id AS UNSIGNED),
    CAST(d.godown_section_beans_id AS UNSIGNED),
    d.issue_return_item_status as issue_status,
    COALESCE(m.department_id, 0),
    COALESCE(m.sub_department_id, 0),
    '' as issue_requisition_type,
    d.issue_return_remark,
    d.created_by,
    d.created_on
  FROM st_indent_material_issue_return_details d
  JOIN st_indent_material_issue_return_master m
    ON d.issue_return_master_transaction_id = m.issue_return_master_transaction_id
  WHERE
    d.is_delete = 0
    AND d.issue_return_item_status IN ('R')
   and m.indent_issue_return_type_id = 12;
-------------------------------------------------------------------------------------------------------------------------------

CREATE DEFINER=`root`@`localhost` PROCEDURE `reschedule_stock_issue`(
    IN goodsReceiptNo VARCHAR(50),
    IN issueDate DATE,
    IN material_id VARCHAR(30),
    IN companyId Integer
)
BEGIN
    DECLARE stockDate DATE;
    DECLARE currentDate DATE;
    DECLARE openQty DECIMAL(10,2);
    DECLARE openWeight DECIMAL(10,2);
    DECLARE openBoxes INT;
    DECLARE reserveQty DECIMAL(10,2);
    DECLARE reserveWeight DECIMAL(10,2);
    DECLARE reserveBoxes INT;
    DECLARE closingQty DECIMAL(10,2);
    DECLARE closingWeight DECIMAL(10,2);
    DECLARE closingBoxes INT;
    DECLARE issueQTY DECIMAL(10,2);
    DECLARE issueWeight DECIMAL(10,2);
    DECLARE issueBox INT;
    DECLARE transferIssueQTY DECIMAL(10,2);
    DECLARE transferIssueWeight DECIMAL(10,2);
    DECLARE transferReceiptQTY DECIMAL(10,2);
    DECLARE transferReceiptWeight DECIMAL(10,2);
    DECLARE supplierReturnQty DECIMAL(10,2);

  -- Get the current date
    SET currentDate = CURDATE();

    -- Loop through each day from the issueDate to the current date
    WHILE issueDate < currentDate DO
        -- Move to the next day
        SET stockDate = DATE_ADD(issueDate, INTERVAL 1 DAY);

       -- Get the previous day's data
        SELECT
             production_issue_quantity as issueQTY, production_issue_weight as issueWeight, issue_no_of_boxes as issueBox,
             transfer_issue_quantity as transferIssueQTY, transfer_issue_weight as transferIssueWeight,
             transfer_receipt_quantity as transferReceiptQTY, transfer_receipt_weight as transferReceiptWeight, supplier_return_quantity as supplierReturnQty
        INTO issueQTY, issueWeight, issueBox, transferIssueQTY ,transferIssueWeight,transferReceiptQTY ,transferReceiptWeight, supplierReturnQty
        FROM sm_product_rm_stock_details
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = 2
       and is_delete = 0;

        -- Get the previous day's data
        SELECT
             (closing_balance_quantity - issueQTY - transferIssueQTY + transferReceiptQTY - supplierReturnQty ) as closingQty, (closing_balance_weight - issueWeight - transferIssueWeight + transferReceiptWeight ) as closingWeight
             , (closing_no_of_boxes - issueBox) as closingBoxes,
            reserve_quantity, reserve_weight, reserve_no_of_boxes,
            closing_balance_quantity AS openQty,
            closing_balance_weight AS openWeight,
            closing_no_of_boxes AS openBoxes
        INTO closingQty, closingWeight, closingBoxes, reserveQty, reserveWeight, reserveBoxes, openQty, openWeight, openBoxes
        FROM sm_product_rm_stock_details
        WHERE stock_date = DATE_SUB(stockDate, INTERVAL 1 DAY)
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = 2
 		and is_delete = 0;

        -- Update the stock details for the current stockDate
        UPDATE sm_product_rm_stock_details
        SET
            opening_quantity = openQty,
            opening_weight = openWeight,
            opening_no_of_boxes = openBoxes,
            reserve_quantity = reserveQty,
            reserve_weight = reserveWeight,
            reserve_no_of_boxes = reserveBoxes,
            closing_balance_quantity = closingQty,
            closing_balance_weight = closingWeight,
            closing_no_of_boxes = closingBoxes
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
         and company_id = companyId
        and godown_id = 2;

        -- Move the issueDate to the next day for the loop
        SET issueDate = stockDate;
    END WHILE;

end
-------------------------------------------------------------------------------------------------------------------------------

CREATE DEFINER=`root`@`localhost` PROCEDURE `GetMaterialTransactionsByDate`(
    in p_material_id VARCHAR(20),
    in from_date DATE,
    in to_date DATE,
    in companyId Integer
)
begin
-- Declare variables to store opening and closing quantities
    declare opening_quantity DOUBLE default 0;
	declare closing_balance_quantity DOUBLE default 0;
	declare previous_date_closing DOUBLE default 0;
	declare godown_section_name VARCHAR(255) DEFAULT '0';
	declare godown_section_beans_name VARCHAR(255) DEFAULT '0';
-- Fetch the  closing balance quantitie of previous date by from_date
    select
	SUM(`st`.`closing_balance_quantity`)
    into
	previous_date_closing
from
	`sm_product_rm_stock_details` as `st`
where
	`st`.`company_id` = companyId
	and `st`.`product_rm_id` = p_material_id
	and `st`.`stock_date` = DATE_SUB(from_date, interval 1 day);
-- Fetch the opening and closing balance quantities
    select
	SUM(`st`.`opening_quantity`) as `opening_quantity`,
	SUM(`st`.`closing_balance_quantity`) as `closing_balance_quantity`,
	`gd`.`godown_section_name` as `godown_section_name`,
	`gds`.`godown_section_beans_name` as `godown_section_beans_name`
	into
	opening_quantity,
	closing_balance_quantity,
	godown_section_name,
	godown_section_beans_name
from
	`sm_product_rm_stock_details` as `st`
left join
        `cm_godown_section` as `gd`
    on
	`gd`.`godown_section_id` = `st`.`godown_section_id`
left join
        `cm_godown_section_beans` as `gds`
    on
	`gds`.`godown_section_beans_id` = `st`.`godown_section_beans_id`
where
	`st`.`company_id` = companyId
	and `st`.`product_rm_id` = p_material_id
	and `st`.`stock_date` between from_date and from_date;



-- Stock Details
        select
	'Stock Details' as `transaction_type`,
	`st`.`stock_date` as `Date`,
	`st`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	SUM(`st`.`opening_quantity`) as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	'-' as `stock_adjustment_type`,
	0 as `stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	if(`st`.`stock_date` = from_date,
	 IF(previous_date_closing IS NULL,
--         SUM(`st`.`closing_balance_quantity`),
	 SUM(`st`.`opening_quantity`),
        previous_date_closing
    ),
	SUM(`st`.`closing_balance_quantity`)) as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`st`.`created_on` as `created_on`,
	0 AS `transaction_id`
from
	`sm_product_rm_stock_details` as `st`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `st`.`product_rm_id`
where
	`st`.`company_id` = companyId
	and `st`.`product_rm_id` = p_material_id
	and `st`.`stock_date` between from_date and to_date
	and `st`.is_delete = 0
group by
	`st`.`product_rm_id`,
	`st`.`stock_date`

union all
-- Goods Receipt Details
    select
	`grn`.`goods_receipt_no` as `transaction_type`,
	`grn`.`goods_receipt_date` as `Date`,
	`grn`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	opening_quantity as `opening_quantity`,
	`grn`.`product_material_grn_accepted_quantity` as `purchase_quantity`,
	0 as `issue_quantity`,
	'-' as `stock_adjustment_type`,
	0 as `stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	0 as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`grn`.`created_on` as `created_on`,
	0 AS `transaction_id`
from
	`pt_goods_receipt_details` as `grn`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `grn`.`product_material_id`
where
	`grn`.`company_id` = companyId
	and `grn`.`product_material_id` = p_material_id
	and `grn`.`goods_receipt_date` between from_date and to_date
	and `grn`.is_delete = 0
	and `grn`.grn_item_status IN ('I', 'G')

union all
-- Material Issue Details
    select
	`ms`.`issue_no` as `transaction_type`,
	`ms`.`issue_date` as `Date`,
	`ms`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	opening_quantity as `opening_quantity`,
	0 as `purchase_quantity`,
	`ms`.`product_material_issue_quantity` as `issue_quantity`,
	'-' as `stock_adjustment_type`,
	0 as `stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	0 as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`ms`.`created_on` as `created_on`,
	0 AS `transaction_id`
from
	`st_indent_material_issue_details` as `ms`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `ms`.`product_material_id`
where
	`ms`.`company_id` = companyId
	and `ms`.`product_material_id` = p_material_id
	and `ms`.`issue_date` between from_date and to_date
	and `ms`.is_delete = 0
	and `ms`.issue_item_status IN ('I', 'MI')
union all
-- Stock Adjustment Details
    select
	'Stock Adjustment' as `transaction_type`,
	`sd`.`stock_date` as `Date`,
	`sd`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	`sd`.`stock_quantity` as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	`sd`.`stock_adjustment_type`,
	`sd`.`stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	`sd`.`closing_balance_quantity` as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`sd`.`created_on` as `created_on`,
    `sd`.`stock_adjustment_transaction_id` AS `transaction_id`
from
	`sm_product_stock_adjustment_details` as `sd`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `sd`.`product_material_id`
where
	`sd`.`company_id` = companyId
	and `sd`.`product_material_id` = p_material_id
	and `sd`.`stock_date` between from_date and to_date
	and `sd`.is_delete = 0


	union all
-- Stock Tranfer Unit outward
    select
	`mt`.transfer_no as `transaction_type`,
	`mt`.`transfer_date` as `Date`,
	`mt`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	`mt`.`stock_quantity` as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	'Outward' as `stock_adjustment_type`,
	0 as`stock_adjustment_quantity`,
	`mt`.`transfer_quantity` as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	`mt`.`closing_balance_quantity` as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`mt`.`created_on` as `created_on`,
	0 AS `transaction_id`
from
	`pt_material_transfer_details` as `mt`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `mt`.`product_material_id`
left join
        `pt_material_transfer_master` as `tsm`
    on
	`tsm`.`material_transfer_master_id` = `mt`.`material_transfer_master_id`
where
	`tsm`.`from_company_id` = companyId
	and `mt`.`product_material_id` = p_material_id
	and `mt`.`transfer_date` between from_date and to_date
	and `mt`.is_delete = 0

	union all
-- Stock Tranfer Unit Inward
    select
	`mt`.transfer_no as `transaction_type`,
	`mt`.`transfer_date` as `Date`,
	`mt`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	opening_quantity as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	'Inward' as `stock_adjustment_type`,
	0 as`stock_adjustment_quantity`,
	`mt`.`transfer_quantity` as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	0 as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`mt`.`created_on` as `created_on`,
	0 AS `transaction_id`
from
	`pt_material_transfer_details` as `mt`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `mt`.`product_material_id`
left join
        `pt_material_transfer_master` as `tsm`
    on
	`tsm`.`material_transfer_master_id` = `mt`.`material_transfer_master_id`
where
	`tsm`.`to_company_id` = companyId
	and `mt`.`product_material_id` = p_material_id
	and `mt`.`transfer_date` between from_date and to_date
	and `mt`.is_delete = 0

	union all
-- Department to Stores Return
    select
	`mrd`.issue_return_no as `transaction_type`,
	`mrd`.`issue_return_date` as `Date`,
	`mrd`.`financial_year` as `financial_year`,
	`rm`.`product_rm_code` as `material_code`,
	`rm`.`product_rm_name` as `material_name`,
	opening_quantity as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	'Returned'  as `stock_adjustment_type`,
	0 as`stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	`mrd`.`product_material_receipt_quantity` as `product_material_return_quantity`,
	0 as `supplier_return_quantity`,
	0 as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`mrd`.`created_on` as `created_on`,
	`mrd`.`issue_return_master_transaction_id` AS `transaction_id`
from
	`st_indent_material_issue_return_details` as `mrd`
left join
        `sm_product_rm` as `rm`
    on
	`rm`.`product_rm_id` = `mrd`.`product_material_id`
left join
        `st_indent_material_issue_return_master` as `mrm`
    on
	`mrm`.`issue_return_master_transaction_id` = `mrd`.`issue_return_master_transaction_id`
where
	`mrd`.`company_id` = companyId
	and `mrd`.`product_material_id` = p_material_id
	and mrm.indent_issue_return_type_id = 2
	and mrm.material_type = 'UU'
	and `mrd`.`issue_return_date` between from_date and to_date
	and `mrd`.is_delete = 0


   union all
-- Material Gate Pass Details
select
	`mgpd`.`gate_pass_no` as `transaction_type`,
	`mgpd`.`gate_pass_date` as `Date`,
	`mgpd`.`financial_year` as `financial_year`,
	`mgpd`.`product_material_id` as `material_code`,
	`mgpd`.`material_name` as `material_name`,
	opening_quantity as `opening_quantity`,
	0 as `purchase_quantity`,
	0 as `issue_quantity`,
	'Gate Pass' as `stock_adjustment_type`,
	0 as `stock_adjustment_quantity`,
	0 as `transfer_quantity`,
	0 as `product_material_return_quantity`,
	`mgpd`.`outward_quantity` as `supplier_return_quantity`,
	closing_balance_quantity as `closing_balance_quantity`,
	godown_section_name as godown_section_name,
	godown_section_beans_name as godown_section_beans_name,
	`mgpd`.`created_on` as `created_on`,
	`mgpd`.`material_gate_pass_master_id` AS `transaction_id`
from
	`pt_material_gate_pass_details` as `mgpd`
left join
	`sm_product_rm` as `rm`
on
	`rm`.`product_rm_id` = `mgpd`.`product_material_id`
where
	`mgpd`.`company_id` = companyId
	and `mgpd`.`product_material_id` = p_material_id
	and `mgpd`.`gate_pass_date` between from_date and to_date
	and `mgpd`.`is_delete` = 0
	and `mgpd`.`gate_pass_item_status` = 'A'


	-- Order the results by Date and created_on
order by
	`Date` asc ,
	`created_on` asc;
end

-------------------------------------------------------------------------------------------------------------------------------

CREATE DEFINER=`root`@`localhost` PROCEDURE `reschedule_stock_issue`(
    IN goodsReceiptNo VARCHAR(50),
    IN issueDate DATE,
    IN material_id VARCHAR(30),
    IN companyId Integer,
    IN GodownId Integer
)
BEGIN
    DECLARE stockDate DATE;
    DECLARE currentDate DATE;
    DECLARE openQty DECIMAL(10,2);
    DECLARE openWeight DECIMAL(10,2);
    DECLARE openBoxes INT;
    DECLARE reserveQty DECIMAL(10,2);
    DECLARE reserveWeight DECIMAL(10,2);
    DECLARE reserveBoxes INT;
    DECLARE closingQty DECIMAL(10,2);
    DECLARE closingWeight DECIMAL(10,2);
    DECLARE closingBoxes INT;
    DECLARE issueQTY DECIMAL(10,2);
    DECLARE issueWeight DECIMAL(10,2);
    DECLARE issueBox INT;
    DECLARE transferIssueQTY DECIMAL(10,2);
    DECLARE transferIssueWeight DECIMAL(10,2);
    DECLARE transferReceiptQTY DECIMAL(10,2);
    DECLARE transferReceiptWeight DECIMAL(10,2);
    DECLARE supplierReturnQty DECIMAL(10,2);
    DECLARE supplierReturnWeight DECIMAL(10,2);

  -- Get the current date
    SET currentDate = CURDATE();

    -- Loop through each day from the issueDate to the current date
    WHILE issueDate < currentDate DO
        -- Move to the next day
        SET stockDate = DATE_ADD(issueDate, INTERVAL 1 DAY);

       -- Get the previous day's data
        SELECT
             production_issue_quantity as issueQTY, production_issue_weight as issueWeight, issue_no_of_boxes as issueBox,
             transfer_issue_quantity as transferIssueQTY, transfer_issue_weight as transferIssueWeight,
             transfer_receipt_quantity as transferReceiptQTY, transfer_receipt_weight as transferReceiptWeight, supplier_return_quantity as supplierReturnQty, supplier_return_weight as supplierReturnWeight
        INTO issueQTY, issueWeight, issueBox, transferIssueQTY ,transferIssueWeight,transferReceiptQTY ,transferReceiptWeight, supplierReturnQty, supplierReturnWeight
        FROM sm_product_rm_stock_details
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = GodownId
       and is_delete = 0;

        -- Get the previous day's data
        SELECT
             (closing_balance_quantity - issueQTY - transferIssueQTY + transferReceiptQTY - supplierReturnQty ) as closingQty, (closing_balance_weight - issueWeight - transferIssueWeight + transferReceiptWeight - supplierReturnWeight ) as closingWeight
             , (closing_no_of_boxes - issueBox) as closingBoxes,
            reserve_quantity, reserve_weight, reserve_no_of_boxes,
            closing_balance_quantity AS openQty,
            closing_balance_weight AS openWeight,
            closing_no_of_boxes AS openBoxes
        INTO closingQty, closingWeight, closingBoxes, reserveQty, reserveWeight, reserveBoxes, openQty, openWeight, openBoxes
        FROM sm_product_rm_stock_details
        WHERE stock_date = DATE_SUB(stockDate, INTERVAL 1 DAY)
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = GodownId
 		and is_delete = 0;

        -- Update the stock details for the current stockDate
        UPDATE sm_product_rm_stock_details
        SET
            opening_quantity = openQty,
            opening_weight = openWeight,
            opening_no_of_boxes = openBoxes,
            reserve_quantity = reserveQty,
            reserve_weight = reserveWeight,
            reserve_no_of_boxes = reserveBoxes,
            closing_balance_quantity = closingQty,
            closing_balance_weight = closingWeight,
            closing_no_of_boxes = closingBoxes
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
         and company_id = companyId
        and godown_id = GodownId;

        -- Move the issueDate to the next day for the loop
        SET issueDate = stockDate;
    END WHILE;

end
-------------------------------------------------------------------------------------------------------------------------------

CREATE DEFINER=`root`@`localhost` PROCEDURE  `reschedule_stock_issue`(
    IN goodsReceiptNo VARCHAR(50),
    IN issueDate DATE,
    IN material_id VARCHAR(30),
    IN companyId Integer
)
BEGIN
    DECLARE stockDate DATE;
    DECLARE currentDate DATE;
    DECLARE openQty DECIMAL(10,2);
    DECLARE openWeight DECIMAL(10,2);
    DECLARE openBoxes INT;
    DECLARE reserveQty DECIMAL(10,2);
    DECLARE reserveWeight DECIMAL(10,2);
    DECLARE reserveBoxes INT;
    DECLARE closingQty DECIMAL(10,2);
    DECLARE closingWeight DECIMAL(10,2);
    DECLARE closingBoxes INT;
    DECLARE issueQTY DECIMAL(10,2);
    DECLARE issueWeight DECIMAL(10,2);
    DECLARE issueBox INT;
    DECLARE transferIssueQTY DECIMAL(10,2);
    DECLARE transferIssueWeight DECIMAL(10,2);
    DECLARE transferReceiptQTY DECIMAL(10,2);
    DECLARE transferReceiptWeight DECIMAL(10,2);
    DECLARE supplierReturnQty DECIMAL(10,2);
 	DECLARE supplierReturnWeight DECIMAL(10,2);
  -- Get the current date
    SET currentDate = CURDATE();

    -- Loop through each day from the issueDate to the current date
    WHILE issueDate < currentDate DO
        -- Move to the next day
        SET stockDate = DATE_ADD(issueDate, INTERVAL 1 DAY);

       -- Get the previous day's data
        SELECT
             production_issue_quantity as issueQTY, production_issue_weight as issueWeight, issue_no_of_boxes as issueBox,
             transfer_issue_quantity as transferIssueQTY, transfer_issue_weight as transferIssueWeight,
             transfer_receipt_quantity as transferReceiptQTY, transfer_receipt_weight as transferReceiptWeight, supplier_return_quantity as supplierReturnQty, supplier_return_weight as supplierReturnWeight
        INTO issueQTY, issueWeight, issueBox, transferIssueQTY ,transferIssueWeight,transferReceiptQTY ,transferReceiptWeight, supplierReturnQty ,supplierReturnWeight
        FROM sm_product_rm_stock_details
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = 2
       and is_delete = 0;

        -- Get the previous day's data
        SELECT
             (closing_balance_quantity - issueQTY - transferIssueQTY + transferReceiptQTY - supplierReturnQty ) as closingQty, (closing_balance_weight - issueWeight - transferIssueWeight + transferReceiptWeight - supplierReturnWeight) as closingWeight
             , (closing_no_of_boxes - issueBox) as closingBoxes,
            reserve_quantity, reserve_weight, reserve_no_of_boxes,
            closing_balance_quantity AS openQty,
            closing_balance_weight AS openWeight,
            closing_no_of_boxes AS openBoxes
        INTO closingQty, closingWeight, closingBoxes, reserveQty, reserveWeight, reserveBoxes, openQty, openWeight, openBoxes
        FROM sm_product_rm_stock_details
        WHERE stock_date = DATE_SUB(stockDate, INTERVAL 1 DAY)
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
        and company_id = companyId
        and godown_id = 2
 		and is_delete = 0;

        -- Update the stock details for the current stockDate
        UPDATE sm_product_rm_stock_details
        SET
            opening_quantity = openQty,
            opening_weight = openWeight,
            opening_no_of_boxes = openBoxes,
            reserve_quantity = reserveQty,
            reserve_weight = reserveWeight,
            reserve_no_of_boxes = reserveBoxes,
            closing_balance_quantity = closingQty,
            closing_balance_weight = closingWeight,
            closing_no_of_boxes = closingBoxes
        WHERE stock_date = stockDate
        AND goods_receipt_no = goodsReceiptNo
        AND product_rm_id = material_id
         and company_id = companyId
        and godown_id = 2;

        -- Move the issueDate to the next day for the loop
        SET issueDate = stockDate;
    END WHILE;

end

-------------------------------------------------------------------------------------------------------------------------------
UPDATE mt_sales_order_sauda_sheet s
JOIN sm_product_fg p ON s.product_id = p.product_fg_id
SET s.product_material_code = p.product_fg_code;


UPDATE xt_warping_production_order w
JOIN sm_product_fg p ON w.product_material_id = p.product_fg_id
SET
  w.sort_no = p.product_fg_code;



 UPDATE xt_weaving_beam_issue_master i
JOIN xt_warping_production_order w ON i.set_no = w.set_no
SET i.sort_no = w.sort_no;




UPDATE xt_weaving_production_loom_details l
JOIN xt_warping_production_order w ON l.set_no = w.set_no
SET l.sort_no = w.sort_no;
-------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE xt_weaving_production_inspection_details ADD dispatch_challan_no varchar(100) NULL COMMENT 'challan no will update from dispatch fabric .... after approved';
ALTER TABLE xt_weaving_production_inspection_details CHANGE dispatch_challan_no dispatch_challan_no varchar(100) NULL COMMENT 'challan no will update from dispatch fabric .... after approved' AFTER dispatch_date;
ALTER TABLE xt_weaving_production_inspection_details CHANGE dispatch_weight dispatch_weight decimal(18,4) DEFAULT 0.0000 NULL AFTER dispatch_quantity;
ALTER TABLE xt_weaving_production_inspection_details CHANGE dispatch_date dispatch_date varchar(100) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL AFTER dispatch_weight;
ALTER TABLE xt_weaving_production_inspection_details CHANGE product_material_name product_material_name varchar(555) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL AFTER product_material_id;
ALTER TABLE xt_weaving_production_inspection_details CHANGE `style` `style` varchar(155) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL AFTER product_material_name;
ALTER TABLE xt_weaving_production_inspection_details CHANGE godown_section_id godown_section_id bigint(20) DEFAULT NULL NULL AFTER godown_id;
ALTER TABLE xt_weaving_production_inspection_details CHANGE godown_section_beans_id godown_section_beans_id bigint(20) DEFAULT NULL NULL AFTER godown_section_id;
ALTER TABLE xt_weaving_production_inspection_details CHANGE sub_section_id sub_section_id bigint(20) DEFAULT NULL NULL AFTER section_id;
ALTER TABLE xt_weaving_production_inspection_details CHANGE approved_date approved_date date DEFAULT NULL NULL AFTER dispatch_challan_no;
ALTER TABLE xt_weaving_production_inspection_details CHANGE stock_status stock_status varchar(55) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT 'P' NULL AFTER approved_date;
ALTER TABLE xt_weaving_production_inspection_details CHANGE stock_status_description stock_status_description varchar(100) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL AFTER stock_status;
ALTER TABLE xt_weaving_production_inspection_details CHANGE book_type_id book_type_id bigint(20) DEFAULT 0 NULL AFTER stock_status_description;

ALTER TABLE xt_weaving_production_inspection_details CHANGE dispatch_challan_no dispatch_challan_no varchar(100) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL COMMENT 'challan no will update from dispatch fabric .... after approved' AFTER dispatch_date;
ALTER TABLE xt_weaving_production_inspection_details CHANGE approved_date approved_date date DEFAULT NULL NULL AFTER dispatch_challan_no;
ALTER TABLE xt_weaving_production_inspection_details CHANGE stock_status stock_status varchar(55) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT 'P' NULL AFTER approved_date;
ALTER TABLE xt_weaving_production_inspection_details CHANGE stock_status_description stock_status_description varchar(100) CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci DEFAULT NULL NULL AFTER stock_status;
ALTER TABLE xt_weaving_production_inspection_details CHANGE book_type_id book_type_id bigint(20) DEFAULT 0 NULL AFTER stock_status_description;

	
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------------------------------0000000000000000000000000-------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------
-------------------------------------------------------------------------------------------------------------------------------

